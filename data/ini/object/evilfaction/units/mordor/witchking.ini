Object MordorWitchKing

    SelectPortrait = HPNazgulWitchKing
    ButtonImage    = HINazgulWitchKing

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model           = munazhk
        End

        ModelConditionState = MOUNTED
            Model           = mublackridhk
        End

        ModelConditionState = MOUNTED USER_2
            Model           = mublackridhk
        End

        ModelConditionState = INVISIBLE_STEALTH
            Model           = MUNazgulGhs
        End


        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLB
                AnimationPriority    = 4
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript
        End




        AnimationState        = PASSENGER MOUNTED
            Animation           = grabbed
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GBDA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState         = SPECIAL_WEAPON_TWO MOUNTED
            Animation           = PNTA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode       = ONCE
                AnimationBlendTime  = 20
            End
        End


        AnimationState        = FREEFALL MOUNTED
            Animation           = freefall
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING MOUNTED
            Animation           = JustDie
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    splatted
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED DYING
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_MFDA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    10
                Distance            =    80
            End
        End

        AnimationState                = DYING MOUNTED
            Animation
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode       = ONCE
            End
            Animation
                AnimationName        = MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        = ONCE
            End
        End

        AnimationState        = STUNNED_STANDING_UP MOUNTED
            Animation           = StandUp
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GTPA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED MOUNTED
            Animation           = Land
                AnimationName       = MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            ShareAnimation        = Yes
            Animation           = TrotAndFire
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATRA
                AnimationMode       = LOOP
                Distance            = 70
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End


        AnimationState                = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End
        AnimationState                = MOVING EMOTION_TERROR MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState        = MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState        = MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState            = MOVING ACCELERATE MOUNTED
            Animation           = Accelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_ACCL
                AnimationMode   = ONCE
            End
        End

        AnimationState            = MOVING DECELERATE MOUNTED
            Animation           = Decelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_DECL
                AnimationMode   = ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState        = MOVING MOUNTED
            ShareAnimation        = Yes
            Animation           = RunA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FIRING_OR_PREATTACK_A MOUNTED
            Animation           = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
            Animation           = ATKB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKB
                AnimationMode       = ONCE
            End
            Animation           = Defend
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DFDA
                AnimationMode       = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = SPECIAL_WEAPON_ONE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
        End


        AnimationState        = SPECIAL_WEAPON_ONE
            Animation             = ATKB
                AnimationName       = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode       = ONCE
                UseWeaponTiming       = Yes
            End
        End


        AnimationState        = SPECIAL_WEAPON_TWO
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_SPCC
                AnimationMode       = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1 MOUNTED
            Animation = Hit_Level_1_a
                AnimationName = MUBlkRider_SKL.MUBlkRider_HFMA
                AnimationMode = ONCE
            End
        End

        AnimationState                    = EMOTION_TAUNTING MOUNTED
            ShareAnimation                = Yes
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTB
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED MOUNTED
            StateName                =    State_Selected
            Animation                =    AtAttention
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode        =    Loop
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState = MOUNTED
            StateName                = Idle
            Animation                = IdleA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationPriority   = 20
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLB
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleC
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLC
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleG
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End


        TransitionState                    =    TRANS_Selected_to_Idle
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Flags                        = START_FRAME_LAST
        End





        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End


        AnimationState = DYING
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode       = ONCE
            End
        End

        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

        AnimationState = FREEFALL
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_GTPA
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End

            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKB
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_LVLA
                AnimationMode = ONCE
            End
        End

        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = MUNazgul_SKL.MUNazgul_TNTA
                AnimationMode                    = ONCE
                AnimationSpeedFactorRange        = 0.8 1.2
            End
        End

        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

    TransitionState = TRANS_Idle_to_Selected
        Animation = ATNA
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNA
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End

    TransitionState = TRANS_Selected_to_Idle
        Animation = ATNF
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNF
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End
 End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End


    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = WITCHKING_THREAT_LEVEL
    ThingClass            = MEDIUM_MONSTER
    BuildCost             = 4200
    BuildTime             = STRONG_HERO_BUILDTIME
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO

    CommandSet            = MordorWitchKingModCommandSet
    CommandPoints         = 0
    VisionRange           = VISION_STANDARD_MELEE
    ShroudClearingRange   = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    DisplayMeleeDamage    = STRONG_HERO_DAMAGE
    VisionBonusPercentPerFoot = 1.0%

    RecruitText           = CONTROLBAR:MordorWitchKingRecruit
    ReviveText            = CONTROLBAR:MordorWitchKingRevive
    Hotkey                = CONTROLBAR:MordorWitchKingHotkey
    DisplayName           = OBJECT:MordorWitchKing
    CrushableLevel        = 2
    RamPower              = 30
    RamZMult              = 0.5
    MaxSimultaneousOfType = 1

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY     WitchKingStandardSword
        Weapon               = TERTIARY    WitchKingMorgulBladeSpecialPower
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources    = SECONDARY FROM_PLAYER
        AutoChooseSources    = TERTIARY NONE
    End

    WeaponSet
        Conditions           = WEAPONSET_HERO_MODE
        Weapon               = PRIMARY     WitchKingFireSword
        Weapon               = TERTIARY    WitchKingMorgulBladeSpecialPower
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources    = SECONDARY FROM_PLAYER
        AutoChooseSources    = TERTIARY NONE
    End

    WeaponSet
        Conditions      = HIDDEN
    End

    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_WitchKingArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WitchKingWeapon
    End



    VoiceCreated                  = HKModVoiceSalute
    VoiceFullyCreated             = HKModVoiceSalute
    VoiceFear                     = HKModModVoiceHelpMe
    VoiceAttack                   = HKModVoiceAttack
    VoiceAttackCharge             = HKModVoiceAttack
    VoiceAttackMachine            = HKModVoiceAttack
    VoiceAttackStructure          = HKModVoiceAttack
    VoiceMove                     = HKModVoiceMove
    VoiceMoveToCamp               = HKModVoiceMove
    VoiceMoveWhileAttacking       = HKModVoiceMove
    VoicePriority                 = 90
    VoiceRetreatToCastle          = HKModVoiceMove
    VoiceSelect                   = HKModVoiceSelect
    VoiceSelectBattle             = HKModVoiceSelect
    VoiceGuard                    = HKModVoiceMove

    SoundImpact                   = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = HKModVoiceMove
        VoiceEnterUnitMordorMumakil            = HKModVoiceMove
        VoiceEnterUnitSlaughterHouse           = HKModVoiceMove
        VoiceGarrison                          = HKModVoiceMove
        VoiceInitiateCaptureBuilding           = HKModVoiceMove
        VoiceSpecialAbilityCurseEnemy          = WitchKingHourOfTheWitchKing
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_DIEA    Frames:67
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_DIEB    Frames:122
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_LNDB    Frames:4
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner        = WitchKingDie


    RadarPriority    = UNIT
    KindOf           = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY HERO HEAVY_MELEE_HITTER SCORE

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = STRONG_HERO_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End





    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = AutoHealBehavior ModuleTag_WitchKingHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_HK
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                 = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        TargetEnemy      = Yes
        AntiCategory     = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter     = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                     = No
        TriggeredBy                         = Upgrade_Level_1
        WhichSpecialPower                   = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                  = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        EmotionPulseInterval                = 2000
    End





    Behavior = SpecialPowerModule ModuleTag_MountedWitchkingModToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_MountedWitchkingModToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         MountedTemplate             = MordorWitchKingPferd
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 1000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End

    Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 2000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
		SpecialAbility			= SpecialAbilityCurseEnemy
		MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
		Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
		Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_3
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200
        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 1500
			  
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 1500
        PackTime                  = 1500
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End
	
	;Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag_2
      ;  FireWeaponNugget
     ;       WeaponName = WitchKingRingBlastWeapon
      ;      FireDelay = 500
           ; OneShot = No
     ;   End
      ;  HeroModeTrigger = Yes
    ;End  



    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
		SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
		Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ToggleMountedWitchkingSauronsDienerEnabler
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         TriggeredBy                 = Upgrade_StreitmachtMinasMorguls
    End

    Behavior = SpecialPowerModule ModuleTag_ToggleMountedWitchkingSauronsDienerStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ToggleMountedWitchkingSauronsDiener
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         MountedTemplate             = MordorWitchKingSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = OBJECT_TOGGLE_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeEnthuellung
        TriggeredBy                     = Upgrade_InsignienMorgulfurst Upgrade_MyHour
		RequiresAllTriggers 			= No
        GetUpgradeCommandButtonName     = Command_WitchKingSauronsDienerButton
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingModChangeCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingModCommandSet
    End




    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_AI
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList  	   = FellBeastHKFunctions
    End

    LocomotorSet
        Locomotor = NazgulLocomotor
        Condition = SET_NORMAL
        Speed     = 56
    End

    Behavior = PhysicsBehavior ModuleTag_Physics
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay             = 3000
        SinkRate              = 1.20
        DestructionDelay      = 15000
        Sound                 = INITIAL FellBeastDieExplode
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP          = Yes
    End

    Behavior = SubObjectsUpgrade ModuleTag_HideMace
        TriggeredBy       = Upgrade_Level_1
        HideSubObjects    = MACE
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI
        TriggeredBy  = Upgrade_ObjectUnderAIControl Upgrade_Level_3
	RequiresAllTriggers = Yes
        GrantUpgrade = Upgrade_InsignienMorgulfurst
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_ToggleMountedWitchkingonHorse
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Scale 		= 1.05
    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End

ChildObject MordorWitchKing_Mounted MordorWitchKing
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY
End

Object MordorWitchKingPferd

    

    
    SelectPortrait = HPNazgulWitchKing
    
    
    ButtonImage    = HINazgulWitchKing
    
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    EquivalentTo = MordorWitchKing

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes 

        
        StaticModelLODMode = Yes 

        RandomTexture = muwitchking_lod_ha.tga  0 muwitchking_lod.tga
        RandomTexture = muwitchking2h_ha.tga  0 muwitchking2h.tga  

        DefaultModelConditionState
            Model           = munazhk 
        End

        ModelConditionState = MOUNTED
            Model           = mublackridhk 
        End

        ModelConditionState = MOUNTED USER_2
            Model           = mublackridhk 
        End

 

                
        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLB
                AnimationPriority    = 4
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE        
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript    
        End
        
        
        
        
        
        AnimationState        = PASSENGER MOUNTED
            Animation           = grabbed
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GBDA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState         = SPECIAL_WEAPON_TWO
            Animation           = PNTA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode       = ONCE
                AnimationBlendTime  = 20
            End
            
        End

        
        AnimationState        = FREEFALL MOUNTED
            Animation           = freefall
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End
        
        AnimationState        = STUNNED_FLAILING MOUNTED
            Animation           = JustDie
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    splatted
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    BURNINGDEATH MOUNTED DYING
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_MFDA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    10
                Distance            =    80
            End
        End

        AnimationState                = DYING MOUNTED     
            Animation                
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode       = ONCE
            End
            Animation                
                AnimationName        = MUBlkRider_SKL.MUBlkRider_DIEC 
                AnimationMode        = ONCE
            End
        End
        
        AnimationState        = STUNNED_STANDING_UP MOUNTED
            Animation           = StandUp
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GTPA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED MOUNTED
            Animation           = Land
                AnimationName       = MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            ShareAnimation        = Yes
            Animation           = TrotAndFire
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATRA
                AnimationMode       = LOOP
                Distance            = 70
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End
        

        AnimationState                = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End
        AnimationState                = MOVING EMOTION_TERROR MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End
    
        AnimationState        = MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState        = MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End
    
        AnimationState            = MOVING ACCELERATE MOUNTED
            Animation           = Accelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_ACCL
                AnimationMode   = ONCE 
            End
        End

        AnimationState            = MOVING DECELERATE MOUNTED
            Animation           = Decelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_DECL
                AnimationMode   = ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState        = MOVING MOUNTED
            ShareAnimation        = Yes
            Animation           = RunA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FIRING_OR_PREATTACK_A MOUNTED
            Animation           = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
            Animation           = ATKB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKB
                AnimationMode       = ONCE
            End
            Animation           = Defend
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DFDA
                AnimationMode       = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End
        
        
        AnimationState        = SPECIAL_WEAPON_ONE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
        End

        
        AnimationState = HIT_REACTION HIT_LEVEL_1 MOUNTED
            Animation = Hit_Level_1_a
                AnimationName = MUBlkRider_SKL.MUBlkRider_HFMA
                AnimationMode = ONCE
            End
        End
    



















        
        AnimationState                    = EMOTION_TAUNTING MOUNTED
            ShareAnimation                = Yes
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTB
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        
        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationMode            = LOOP
            End
        End
        
        AnimationState                    = RAISING_FLAG MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED MOUNTED
            StateName                =    State_Selected
            Animation                =    AtAttention
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode        =    Loop
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState = MOUNTED
            StateName                = Idle
            Animation                = IdleA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationPriority   = 20
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLB
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleC
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLC
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleG
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        
        
        TransitionState                    =    TRANS_Selected_to_Idle
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Flags                        = START_FRAME_LAST
        End
        
        
        
        
        
        
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End
        

        AnimationState = DYING
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode       = ONCE
            End
        End
        
        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

        AnimationState = FREEFALL
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End
        
        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End
        
        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_GTPA
                AnimationMode = ONCE
            End
        End        

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End
            
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End
                
        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKB
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNA
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        
        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_HITA
                AnimationMode = ONCE
            End
        End
            
        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_LVLA
                AnimationMode = ONCE
            End
        End            
            






        
        
        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End
        
        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = MUNazgul_SKL.MUNazgul_TNTA
                AnimationMode                    = ONCE
                AnimationSpeedFactorRange        = 0.8 1.2
            End
        End
                
        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript            
        End
        
    TransitionState = TRANS_Idle_to_Selected
        Animation = ATNA
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNA
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End
    
    TransitionState = TRANS_Selected_to_Idle
        Animation = ATNF
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNF
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End
            
    End
        
    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING MOUNTED
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING MOUNTED
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End


    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = WITCHKING_THREAT_LEVEL
    ThingClass            = MEDIUM_MONSTER
    BuildCost             = 4200
    BuildTime             = STRONG_HERO_BUILDTIME
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    CommandSet            = MordorWitchKingModCommandSet
    CommandPoints         = 0
    VisionRange           = VISION_STANDARD_HORSE
    ShroudClearingRange   = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    RecruitText           = CONTROLBAR:MordorWitchKingRecruit
    ReviveText            = CONTROLBAR:MordorWitchKingRevive
    Hotkey                = CONTROLBAR:MordorWitchKingHotkey
    DisplayName           = OBJECT:MordorWitchKing
    CommandSet            = MordorWitchKingRidingHorseCommandSet
    CrushableLevel        = 2
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 3
    CrushWeapon           = HKundKhamulUnenthulltCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    RamPower                 = 30
    RamZMult                 = 0.5
    DisplayMeleeDamage       = STRONG_HERO_DAMAGE
    MaxSimultaneousOfType    = 1

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    WitchKingStandardSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    WitchKingStandardSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_HERO_MODE
        Weapon            = PRIMARY    WitchKingWarMaceRiderSwordDiener
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED PLAYER_UPGRADE
        Weapon            = PRIMARY    WitchKingWarMaceRiderMace
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_HERO_MODE MOUNTED
        Weapon            = PRIMARY    WitchKingWarMaceRiderSwordDiener
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = MediumHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = MediumHeroArmorMounted
        DamageFX        = NormalDamageFX
    End




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_WitchKingArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WitchKingWeapon
    End




    VoiceCreated                  = HKModVoiceSalute
    VoiceFullyCreated             = HKModVoiceSalute
    VoiceFear                     = HKModModVoiceHelpMe
    VoiceAttack                   = HKModVoiceAttack
    VoiceAttackCharge             = HKModVoiceAttack
    VoiceAttackMachine            = HKModVoiceAttack
    VoiceAttackStructure          = HKModVoiceAttack
    VoiceMove                     = HKModVoiceMove
    VoiceMoveToCamp               = HKModVoiceMove
    VoiceMoveWhileAttacking       = HKModVoiceMove
    VoicePriority                 = 90
    VoiceRetreatToCastle          = HKModVoiceMove
    VoiceSelect                   = HKModVoiceSelect
    VoiceSelectBattle             = HKModVoiceSelect
    VoiceGuard                    = HKModVoiceMove

    SoundImpact                   = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = HKModVoiceMove
        VoiceEnterUnitMordorMumakil            = HKModVoiceMove
        VoiceEnterUnitSlaughterHouse           = HKModVoiceMove
        VoiceGarrison                          = HKModVoiceMove
        VoiceInitiateCaptureBuilding           = HKModVoiceMove
        VoiceSpecialAbilityCurseEnemy          = WitchKingHourOfTheWitchKing
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA                Animation:MUBLKRIDER_SKL.MUBLKRIDER_CHRA    Frames:26 38
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_ACCL    Frames:8 30
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNB    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNR1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNL    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNR    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_IDLC    Frames:9
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_TNTB    Frames:9
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:10 46
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:20 43
        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:70
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:3 11
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:0
    End



   #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner        = WitchKingDie


    RadarPriority    = UNIT
    KindOf            = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY HERO HEAVY_MELEE_HITTER SCORE

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = STRONG_HERO_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End


    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = AutoHealBehavior ModuleTag_WitchKingHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End


    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_HK
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = No
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        TargetEnemy        = Yes
        AntiCategory          = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                     = No
        TriggeredBy                         = Upgrade_Level_1
        WhichSpecialPower                   = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                  = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        EmotionPulseInterval                = 2000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 1000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End

    Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 2000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
	SpecialAbility			= SpecialAbilityCurseEnemy
	MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
	Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_3
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter  +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End






    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 2000
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_AI
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList  = FellBeastHKFunctions
    End


    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_Physics
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay             = 3000
        SinkRate              = 1.20
        DestructionDelay      = 15000
        Sound                 = INITIAL FellBeastDieExplode
    End

    Behavior = ModelConditionUpgrade ModuleTag_ModellMounted
        TriggeredBy              = Upgrade_Level_1
        AddConditionFlags        = MOUNTED
    End






    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         MountedTemplate             = MordorWitchKingOnFellBeast
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End






    Behavior = SpecialPowerModule ModuleTag_MountedWitchkingModToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_MountedWitchkingModToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         MountedTemplate             = MordorWitchKing
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ToggleMountedWitchkingSauronsDienerEnabler
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         TriggeredBy                 = Upgrade_StreitmachtMinasMorguls
    End

    Behavior = SpecialPowerModule ModuleTag_ToggleMountedWitchkingSauronsDienerStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ToggleMountedWitchkingSauronsDiener
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         MountedTemplate             = MordorWitchKingSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = OBJECT_TOGGLE_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeEnthuellung
        TriggeredBy                     = Upgrade_InsignienMorgulfurst Upgrade_MyHour
		RequiresAllTriggers				= No
        GetUpgradeCommandButtonName     = Command_WitchKingSauronsDienerButton
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingRidingHorseChangeCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingRidingHorseCommandSet
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI
        TriggeredBy  = Upgrade_ObjectUnderAIControl Upgrade_Level_3
	RequiresAllTriggers = Yes
        GrantUpgrade = Upgrade_InsignienMorgulfurst
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_ToggleMountedWitchkingonHorse
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ToggleMountedNazgulAI
        CommandButtonName = Command_WitchKingToggleMountedonFellbeast
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate WitchKingWOPAI
	CommandButtonName = Command_SpecialAbilityDieStundedesHexenkonigs
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
    Scale 		= 1.05
End

Object MordorWitchKingSpell


    SelectPortrait = HPWitchKing
    ButtonImage    = HIWitchKingnew

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    EquivalentTo = MordorWitchKing

    Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model            = muhexenk_skn
			ParticleSysBone =  NONE  WitchKingTrails FollowBone:Yes FXTrigger:NONE Persist:SPAWN PersistID:100
            Skeleton         = MUWchKng_SKL
        End

        ModelConditionState  = USER_3
            Model            = MUNazgulGhs_SKN
            Skeleton         = MUWchKng_SKL
        End

        ModelConditionState  = INVISIBLE_STEALTH
            Model            = MUNazgulGhs_SKN
            Skeleton         = MUWchKng_SKL
        End

        ModelConditionState  = WEAPONSET_HERO_MODE
            ParticleSysBone  = B_SWORD FeuerSchwertHK FollowBone:Yes
			;ParticleSysBone  = NONE MinasMorgulUpgDotes FollowBone:Yes
			;ParticleSysBone  = NONE MinasMorgulUpgDotes2 FollowBone:Yes
        End


        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUWchKng_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUWchKng_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUWchKng_IDLE
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript
        End

        AnimationState        = DYING BURNINGDEATH
            Animation           = DIEA
                AnimationName     = MUWchKng_DIEB
                AnimationMode     = ONCE
                AnimationBlendTime = 10
            End
        End
        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = MUWchKng_DIEB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = BURNINGDEATH
            Animation           = DIEA
                AnimationName     = MUWchKng_MFDA
                AnimationMode     = LOOP
                Distance          = 60
            End
        End


        AnimationState = FREEFALL
            Animation
                AnimationName = MUWchKng_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUWchKng_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUWchKng_GTPB
                AnimationMode = ONCE
            End
        End

        AnimationState            = STUNNED
            Animation           = LNDA
                AnimationName   = MUWchKng_LNDB
                AnimationMode   = ONCE
            End
        End






        AnimationState         =  FIRING_OR_PREATTACK_A WEAPONSET_HERO_MODE
            Animation             = ATA1
                AnimationName         = MUWchKng_ATKA
                AnimationMode         = ONCE
                UseWeaponTiming            = Yes
            End
            Animation             = ATB1
                AnimationName         = MUWchKng_ATKB
                AnimationMode         = ONCE
                UseWeaponTiming            = Yes
            End
        End



        AnimationState        = SPECIAL_WEAPON_THREE
            StateName        = Attacking
            Animation             = ATA1
                AnimationName       = MUWchKng_ATKA
                AnimationMode       = ONCE
            End
            ParticleSysBone = B_SWORD GiftSchwertHK FollowBone:Yes
        End


        AnimationState        = SPECIAL_WEAPON_ONE
            Animation
                AnimationName         = MUWchKng_CHRA
                AnimationMode         = ONCE
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End


        AnimationState            = WEAPONSET_HERO_MODE UNPACKING PACKING_TYPE_1
            Animation = StartIgniteRoar
                AnimationName = MUWchKng_SPCA
                AnimationMode = ONCE
            End
			FXEvent            = Frame:5 Name:FX_WitchKingMorgulPower
            ParticleSysBone = B_SWORD HKSwordWindCenter FollowBone:Yes
            ParticleSysBone = B_SWORD FeuerSchwertHK FollowBone:Yes
            ParticleSysBone = B_SWORD GandalfBlastRipple FollowBone:Yes
        End

        AnimationState            = HERO PACKING PACKING_TYPE_1
            Animation = FinishIgniteRoar
                AnimationName = MUWchKng_CHRA
                AnimationMode = ONCE
            End
            EnteringStateFX = FX_HKSwordBlast
        End

        AnimationState            = USER_2
            Animation
                AnimationName = MUWchKng_SPCA
                AnimationMode = ONCE
            End
            ParticleSysBone = B_SWORD HKSwordWindCenter FollowBone:Yes
            ParticleSysBone = B_SWORD FeuerSchwertHK FollowBone:Yes
            ParticleSysBone = B_SWORD GandalfBlastRipple FollowBone:Yes
        End

        AnimationState        = SPECIAL_WEAPON_TWO
            Animation
                AnimationName         = MUWchKng_ATNB
                AnimationMode         = ONCE
                AnimationBlendTime    = 20
            End
        End

        AnimationState         = FIRING_OR_PREATTACK_A
            Animation           = ATA1
                AnimationName     = MUWchKng_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATB1
                AnimationName     = MUWchKng_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            Animation           = RUNB
                AnimationName     = MUWchKng_ATRA
                AnimationMode     = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = BETWEEN_FIRING_SHOTS_A
            Animation           = ALERT_1
                AnimationName     = MUWchKng_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime        = 10
            End
        End

        AnimationState        = MOVING
            Animation           = RUNB
                AnimationName     = MUWchKng_RUNB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End









        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUWchKng_LVLA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUWchKng_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = MUWchKng_IDLC
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUWchKng_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUWchKng_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        TransitionState       = TRANS_IdleToSelected
            Animation           = ATNA
                AnimationName     = MUWchKng_ATNA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SelectedToIdle
            Animation           = ATNA
                AnimationName     = MUWchKng_ATNC
                AnimationMode     = ONCE
            End
            Flags = START_FRAME_LAST
        End
    End


    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End



    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = WITCHKING_THREAT_LEVEL
    ThingClass            = MEDIUM_MONSTER
    BuildCost             = 4200
    BuildTime             = STRONG_HERO_BUILDTIME
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    CommandSet            = MordorWitchKingModDienerCommandSet
    CommandPoints         = 0
    VisionRange           = VISION_STANDARD_MELEE
    ShroudClearingRange   = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    Scale                 = 1.6
    RecruitText           = CONTROLBAR:MordorWitchKingRecruit
    ReviveText            = CONTROLBAR:MordorWitchKingRevive
    Hotkey                = CONTROLBAR:MordorWitchKingHotkey
    DisplayName           = OBJECT:MordorWitchKing
    CrushableLevel        = 2
    RamPower              = 30
    RamZMult              = 0.5
    DisplayMeleeDamage    = STRONG_HERO_DAMAGE
    MaxSimultaneousOfType        = 1

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY     WitchKingWarMaceNewMod
        Weapon               = TERTIARY    WitchKingMorgulBladeSpecialPower
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources    = SECONDARY FROM_PLAYER
        AutoChooseSources    = TERTIARY NONE
    End

    WeaponSet
        Conditions           = WEAPONSET_HERO_MODE
        Weapon               = PRIMARY     WitchKingFireSword
        Weapon               = TERTIARY    WitchKingMorgulBladeSpecialPower
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources    = SECONDARY FROM_PLAYER
        AutoChooseSources    = TERTIARY NONE
    End


    WeaponSet
        Conditions           = HIDDEN
    End


    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = None
    End



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_WitchKingArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WitchKingWeapon
    End






    VoiceCreated                  = HKModVoiceSalute
    VoiceFullyCreated             = HKModVoiceSalute
    VoiceFear                     = HKModModVoiceHelpMe
    VoiceAttack                   = HKModVoiceAttack
    VoiceAttackCharge             = HKModVoiceAttack
    VoiceAttackMachine            = HKModVoiceAttack
    VoiceAttackStructure          = HKModVoiceAttack
    VoiceMove                     = HKModVoiceMove
    VoiceMoveToCamp               = HKModVoiceMove
    VoiceMoveWhileAttacking       = HKModVoiceMove
    VoicePriority                 = 90
    VoiceRetreatToCastle          = HKModVoiceMove
    VoiceSelect                   = HKModVoiceSelect
    VoiceSelectBattle             = HKModVoiceSelect
    VoiceGuard                    = HKModVoiceMove

    SoundImpact                   = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = HKModVoiceMove
        VoiceEnterUnitMordorMumakil            = HKModVoiceMove
        VoiceEnterUnitSlaughterHouse           = HKModVoiceMove
        VoiceGarrison                          = HKModVoiceMove
        VoiceInitiateCaptureBuilding           = HKModVoiceMove
        VoiceSpecialAbilityCurseEnemy          = WitchKingHourOfTheWitchKing
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_DIEA    Frames:67
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_DIEB    Frames:122
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier    Animation:MUWCHKNG_SKL.MUWCHKNG_LNDB    Frames:4
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner        = WitchKingDie


    RadarPriority    = UNIT
    KindOf            = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY HERO HEAVY_MELEE_HITTER SCORE

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = STRONG_HERO_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING

        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED

        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End

    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End


    Behavior = AutoHealBehavior ModuleTag_WitchKingHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End


    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_HK
    End






    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 2000
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = No
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        TargetEnemy        = Yes
        AntiCategory          = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                    = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        EmotionPulseInterval                = 2000
    End







    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         MountedTemplate             = MordorWitchKingOnFellBeastSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End







    Behavior = SpecialPowerModule ModuleTag_MountedWitchkingModToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_MountedWitchkingModToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonHorse
         MountedTemplate             = MordorWitchKingPferdSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 1000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End

    Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 2000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
	SpecialAbility			= SpecialAbilityCurseEnemy
	MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
	Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_3
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter  +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End

	Behavior = AttributeModifierAuraUpdate ModuleTag_OrcsLeadership
		StartsActive		= Yes
		BonusName           = MordorSauronLeadership
        RefreshDelay        = 2000
        Range               = 99999
        ObjectFilter        = ANY +MordorMorgulOrkHorde +MordorMorgulOrk +MordorMorgulOrkHorde_Summoned +MordorMorgulOrk_Summoned +MordorAufseherMorgulOrkHordeComboHorde ALLIES
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End


    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingModDienerChangeCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingModDienerCommandSet
    End





    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_AI
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList  = FellBeastHKFunctions
    End

    LocomotorSet
        Locomotor = NazgulLocomotor
        Condition = SET_NORMAL
        Speed     = 56
    End

    Behavior = PhysicsBehavior ModuleTag_Physics
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay             = 3000
        SinkRate              = 1.20
        DestructionDelay      = 15000
        Sound                 = INITIAL FellBeastDieExplode
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP          = Yes
    End





    Behavior = AttributeModifierUpgrade ModuleTag_TurnMyHourBonus
        TriggeredBy           = Upgrade_Level_1
        AttributeModifier     = SpellBookMyHour
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_ToggleMountedWitchkingonHorse
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate WitchKingWOPAI
	CommandButtonName = Command_SpecialAbilityDieStundedesHexenkonigs
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End

ChildObject MordorWitchKingSpell_Mounted MordorWitchKingSpell

    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY
End

Object MordorWitchKingPferdSpell

    

    
    SelectPortrait = HPWitchKing
    
    
    ButtonImage    = HIWitchKingnew
    
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    EquivalentTo = MordorWitchKing

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes 

        
        StaticModelLODMode = Yes 


        DefaultModelConditionState
            Model           = muhexenk_skn 
			ParticleSysBone =  NONE  WitchKingTrails FollowBone:Yes FXTrigger:NONE Persist:SPAWN PersistID:100
        End

        ModelConditionState = MOUNTED
            Model           = muhexenk_hrs 
        End


                
        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLB
                AnimationPriority    = 4
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE        
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript    
        End
        
        
        
        
        
        AnimationState        = PASSENGER MOUNTED
            Animation           = grabbed
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GBDA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState         = SPECIAL_WEAPON_TWO
            Animation           = PNTA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode       = ONCE
                AnimationBlendTime  = 20
            End
            
        End

        
        AnimationState        = FREEFALL MOUNTED
            Animation           = freefall
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End
        
        AnimationState        = STUNNED_FLAILING MOUNTED
            Animation           = JustDie
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    splatted
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                =    BURNINGDEATH MOUNTED DYING
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_MFDA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    10
                Distance            =    80
            End
        End

        AnimationState                = DYING MOUNTED     
            Animation                
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode       = ONCE
            End
            Animation                
                AnimationName        = MUBlkRider_SKL.MUBlkRider_DIEC 
                AnimationMode        = ONCE
            End
        End
        
        AnimationState        = STUNNED_STANDING_UP MOUNTED
            Animation           = StandUp
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GTPA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED MOUNTED
            Animation           = Land
                AnimationName       = MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            ShareAnimation        = Yes
            Animation           = TrotAndFire
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATRA
                AnimationMode       = LOOP
                Distance            = 70
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End
        

        AnimationState                = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End
        AnimationState                = MOVING EMOTION_TERROR MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End
    
        AnimationState        = MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState        = MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End
    
        AnimationState            = MOVING ACCELERATE MOUNTED
            Animation           = Accelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_ACCL
                AnimationMode   = ONCE 
            End
        End

        AnimationState            = MOVING DECELERATE MOUNTED
            Animation           = Decelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_DECL
                AnimationMode   = ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState        = MOVING MOUNTED
            ShareAnimation        = Yes
            Animation           = RunA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FIRING_OR_PREATTACK_A MOUNTED
            Animation           = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
            Animation           = ATKB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKB
                AnimationMode       = ONCE
            End
            Animation           = Defend
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DFDA
                AnimationMode       = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End
        
        
        AnimationState        = SPECIAL_WEAPON_ONE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
        End

        
        AnimationState = HIT_REACTION HIT_LEVEL_1 MOUNTED
            Animation = Hit_Level_1_a
                AnimationName = MUBlkRider_SKL.MUBlkRider_HFMA
                AnimationMode = ONCE
            End
        End
    



















        
        AnimationState                    = EMOTION_TAUNTING MOUNTED
            ShareAnimation                = Yes
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTB
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        
        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationMode            = LOOP
            End
        End
        
        AnimationState                    = RAISING_FLAG MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED MOUNTED
            StateName                =    State_Selected
            Animation                =    AtAttention
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode        =    Loop
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState = MOUNTED
            StateName                = Idle
            Animation                = IdleA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationPriority   = 20
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLB
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleC
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLC
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleG
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End
        
        
        TransitionState                    =    TRANS_Selected_to_Idle
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Flags                        = START_FRAME_LAST
        End
        
        
        
        
        
        
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End
        

        AnimationState = DYING
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode       = ONCE
            End
        End
        
        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

        AnimationState = FREEFALL
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End
        
        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End
        
        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_GTPA
                AnimationMode = ONCE
            End
        End        

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End
            
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End
                
        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKB
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNA
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        
        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_HITA
                AnimationMode = ONCE
            End
        End
            
        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_LVLA
                AnimationMode = ONCE
            End
        End            
            






        
        
        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End
        
        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = MUNazgul_SKL.MUNazgul_TNTA
                AnimationMode                    = ONCE
                AnimationSpeedFactorRange        = 0.8 1.2
            End
        End
                
        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript            
        End
        
    TransitionState = TRANS_Idle_to_Selected
        Animation = ATNA
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNA
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End
    
    TransitionState = TRANS_Selected_to_Idle
        Animation = ATNF
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNF
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End
            
    End
        
    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING MOUNTED
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING MOUNTED
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End



    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = WITCHKING_THREAT_LEVEL
    ThingClass            = MEDIUM_MONSTER
    BuildCost             = 4200
    BuildTime             = STRONG_HERO_BUILDTIME
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO

    CommandSet            = MordorWitchKingModCommandSet
    CommandPoints         = 0
    VisionRange           = VISION_STANDARD_HORSE
    ShroudClearingRange   = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    RecruitText           = CONTROLBAR:MordorWitchKingRecruit
    ReviveText            = CONTROLBAR:MordorWitchKingRevive
    Hotkey                = CONTROLBAR:MordorWitchKingHotkey
    DisplayName           = OBJECT:MordorWitchKing
    CommandSet            = MordorWitchKingRidingHorseDienerCommandSet
    CrushableLevel        = 2
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 3
    CrushWeapon           = HKundKhamulEnthulltCrush

    MinCrushVelocityPercent  = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_HERO

    RamPower                 = 30
    RamZMult                 = 0.5
    DisplayMeleeDamage       = WITCHKINGMDAG_DAMAGE
    MaxSimultaneousOfType    = 1

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    WitchKingWarMaceRiderMace
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    WitchKingWarMaceRiderMace
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = VeryStrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = VeryStrongHeroArmor
        DamageFX        = NormalDamageFX
    End




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_WitchKingArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WitchKingWeapon
    End



    VoiceCreated                  = HKModVoiceSalute
    VoiceFullyCreated             = HKModVoiceSalute
    VoiceFear                     = HKModModVoiceHelpMe
    VoiceAttack                   = HKModVoiceAttack
    VoiceAttackCharge             = HKModVoiceAttack
    VoiceAttackMachine            = HKModVoiceAttack
    VoiceAttackStructure          = HKModVoiceAttack
    VoiceMove                     = HKModVoiceMove
    VoiceMoveToCamp               = HKModVoiceMove
    VoiceMoveWhileAttacking       = HKModVoiceMove
    VoicePriority                 = 90
    VoiceRetreatToCastle          = HKModVoiceMove
    VoiceSelect                   = HKModVoiceSelect
    VoiceSelectBattle             = HKModVoiceSelect
    VoiceGuard                    = HKModVoiceMove

    SoundImpact                   = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = HKModVoiceMove
        VoiceEnterUnitMordorMumakil            = HKModVoiceMove
        VoiceEnterUnitSlaughterHouse           = HKModVoiceMove
        VoiceGarrison                          = HKModVoiceMove
        VoiceInitiateCaptureBuilding           = HKModVoiceMove
        VoiceSpecialAbilityCurseEnemy          = WitchKingHourOfTheWitchKing
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA                Animation:MUBLKRIDER_SKL.MUBLKRIDER_CHRA    Frames:26 38
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_ACCL    Frames:8 30
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNB    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNR1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNL    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNR    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_IDLC    Frames:9
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_TNTB    Frames:9
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:10 46
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:20 43
        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:70
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:3 11
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:0
    End

   #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner        = WitchKingDie


    RadarPriority    = UNIT
    KindOf            = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY MONSTER PATH_THROUGH_INFANTRY SCARY ARMY_SUMMARY HERO HEAVY_MELEE_HITTER SCORE

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = WITCHKINGMDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING

        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED

        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End


    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End


    Behavior = AutoHealBehavior ModuleTag_WitchKingHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End


    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_HK
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = No
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        TargetEnemy        = Yes
         AntiCategory          = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                    = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        EmotionPulseInterval                = 2000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 1000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End

    Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 2000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
	SpecialAbility			= SpecialAbilityCurseEnemy
	MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
	Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_3
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter  +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End


	Behavior = AttributeModifierAuraUpdate ModuleTag_OrcsLeadership
		StartsActive		= Yes
		BonusName           = MordorSauronLeadership
        RefreshDelay        = 2000
        Range               = 99999
        ObjectFilter        = ANY +MordorMorgulOrkHorde +MordorMorgulOrk +MordorMorgulOrkHorde_Summoned +MordorMorgulOrk_Summoned +MordorAufseherMorgulOrkHordeComboHorde ALLIES
    End





    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 2000
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_AI
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList  = FellBeastHKFunctions
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_Physics
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay             = 3000
        SinkRate              = 1.20
        DestructionDelay      = 15000
        Sound                 = INITIAL FellBeastDieExplode
    End

    Behavior = ModelConditionUpgrade ModuleTag_ModellMounted
        TriggeredBy              = Upgrade_Level_1
        AddConditionFlags        = MOUNTED
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End






    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingonFellbeast
         MountedTemplate             = MordorWitchKingOnFellBeastSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = MORDOR_MOUNT_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP          = Yes
    End






    Behavior = AttributeModifierUpgrade ModuleTag_TurnMyHourBonus
        TriggeredBy           = Upgrade_Level_1
        AttributeModifier     = SpellBookMyHour
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingRidingHorseDienerChangeCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingRidingHorseDienerCommandSet
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_WitchKingToggleMountedonFellbeast
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate WitchKingWOPAI
	CommandButtonName = Command_SpecialAbilityDieStundedesHexenkonigs
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
    Scale 		= 1.2
End


Object MordorWitchKingOnFellBeast

    SelectPortrait = HPNazgulWitchKing
    ButtonImage    = HINazgulWitchKing

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    EquivalentTo = MordorWitchKing

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        RandomTexture = muwitchking2h_ha.tga  0 muwitchking2h.tga

        DefaultModelConditionState
            Model = mufellbst_skf
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End



        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End



        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End

        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End



        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

    AnimationState = DYING
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

    End


    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = exldrspmord
        End
    End



    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = FELL_BEAST_THREAT_LEVEL
    ThingClass            = LARGE_MONSTER
    TransportSlotCount    = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    MaxSimultaneousOfType        = 1

    DisplayMeleeDamage = MEDIUM_HERO_DAMAGE


     WeaponSet
         Conditions = None
         DefaultWeaponChoiceCritera = SELECT_AT_RANDOM
         ReadyStatusSharedWithinSet = Yes
         Weapon                     = PRIMARY        NazgulGrabAttack
         OnlyAgainst                = PRIMARY        GRAB_AND_DROP
         Weapon                     = SECONDARY      NazgulClawAttack
         OnlyAgainst                = SECONDARY      MONSTER HERO
         Weapon                     = TERTIARY       NazgulPlowAttack
         PreferredAgainst           = TERTIARY       STRUCTURE MACHINE HORDE SHIP CAN_RIDE_SIEGE_LADDER
     End

    ArmorSet
        Conditions       = None
        Armor            = MediumHeroArmor
        DamageFX         = FellBeastDamageFX
    End

    VisionRange          = VISION_FLIER
    ShroudClearingRange  = SHROUD_CLEAR_FLIER
    DisplayName          = OBJECT:MordorWitchKingOnFellBeast
    DisplayNameStrategic = OBJECT:MordorWitchKingOnFellBeast
    RecruitText          = CONTROLBAR:MordorWitchKingOnFellBeastRecruit
    ReviveText           = CONTROLBAR:MordorWitchKingOnFellBeastRevive
    Hotkey               = CONTROLBAR:MordorWitchKingOnFellBeastHotkey
    RamPower             = 45
    RamZMult             = 0.5
    CrusherLevel         = 3
    CrushKnockback       = 50
    CrushZFactor         = 1.0
    CommandSet           = MordorWitchKingRidingFellBeastModCommandSet
    BuildCost            = 4200
    BuildTime            = STRONG_HERO_BUILDTIME
    CommandPoints        = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_WitchKingArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WitchKingWeapon
    End




    VoiceAttack           = FellBeastVoiceAttackMS
    VoiceFear             = FellBeastAlert
    VoiceMove             = FellBeastVoiceMoveMS
    VoicePriority         = 90
    VoiceSelect           = FellBeastVoiceSelectMS
    VoiceGuard            = FellBeastVoiceMove

    SoundAmbient          = FellBeastVoxAmbientLoop
    SoundMoveStart        = FellBeastMoveStart
    SoundImpact           = ImpactHorse

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps     Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps     Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps     Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack   Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt          Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt          Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps     Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    	Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    	Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    	Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD


    Body = RespawnBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = STRONG_HERO_HEALTH
        HealingBuffFx     = None
		DodgePercent        = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING

        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED

        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End


    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive = Yes
        HealingAmount = NAZGUL_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = 15000
        HealOnlyIfNotInCombat = Yes
    End



    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End



    EvaEventDieOwner             = WitchKingDie

    Behavior = TransportContain TransportContainModuleTag


        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1


        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No
    End


    Behavior = SpecialAbilityUpdate ModuleTag_FellBeastScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 1
        AwardXPForTriggering        = 0
        TriggerSound                = WitchKingScreechMS
        EffectRange                    = 180
        PreparationTime                = 1
        PackTime                    = 3000
        CustomAnimAndDuration        = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End





    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_HK
    End


     Behavior = SpecialPowerModule ModuleTag_DismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
        InitiateSound                = FellBeastVoiceMove
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Dismount
         SpecialPowerTemplate    = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = MordorWitchKing
         SynchronizeTimerOnSpecialPower = SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWordOfPower SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime              = MORDOR_MOUNT_TIME
         PreparationTime         = 1
         PackTime                = 0
         OpacityTarget            = 1
         AwardXPForTriggering    = 0
         IgnoreFacingCheck        = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechUnPause
        SpecialPowerTemplate        = SpecialAbilityScreech
        TriggeredBy                 = Upgrade_Level_4
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_Screech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = SpecialAbilityUpdate ModuleTag_ScreechUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 1000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End
    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = No
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS_MOUNTED
        TargetEnemy        = Yes
        AntiCategory          = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End
    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                    = WITCHKING_DREADVISAGE_EFFECT_RADIUS_MOUNTED
        EmotionPulseInterval                = 2000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End
     Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 1000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
	SpecialAbility			= SpecialAbilityCurseEnemy
	MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
	Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_3
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter  +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 2000
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ToggleMountedWitchkingSauronsDienerEnabler
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         TriggeredBy                 = Upgrade_StreitmachtMinasMorguls
    End

    Behavior = SpecialPowerModule ModuleTag_ToggleMountedWitchkingSauronsDienerStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ToggleMountedWitchkingSauronsDiener
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         MountedTemplate             = MordorWitchKingSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityWordOfPower SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime                  = OBJECT_TOGGLE_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeEnthuellung
        TriggeredBy                     = Upgrade_InsignienMorgulfurst
        GetUpgradeCommandButtonName     = Command_WitchKingSauronsDienerButton
    End


     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    FellBeastHKFunctions
        FollowThroughDistance        =    200
        FollowThroughCheckStep        =    50
        FollowThroughGradient        =    1.0

        GrabTossTimeTrigger            =    2.5
        GrabTossHeightTrigger        =   100.0
        TossFX                = FX_DiebyFalling
        SpecialContactPoints        = Swoop

        AttackPriority = AttackPriority_FellBeast
      End

      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 95
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 78
      End
      LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 160
      End


    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack = Yes
    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UnpackTime               = 1
        AwardXPForTriggering     = 0
        StartAbilityRange        = 1000.0
    End



    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingRidingFellBeastModChangeCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingRidingFellBeastModCommandSet
    End


   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellBeastDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_WitchKingDismount
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    FormationPreviewDecal
            Texture = FPflyingUnitDecal
            Width = 128
            Height = 128
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 42.0
    GeometryHeight      = 45.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
    Scale               = 1.05

End


ChildObject MordorWitchKingOnFellBeastSpell MordorWitchKingOnFellBeast

    SelectPortrait = HPWitchKing

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    EquivalentTo = MordorWitchKing

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model = mufellbst_wk
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End


        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
        End


        AnimationState            = WEAPONSET_HERO_MODE UNPACKING PACKING_TYPE_1
            Animation = StartIgniteRoar
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
            End
			FXEvent            = Frame:5 Name:FX_WitchKingMorgulPower
            ParticleSysBone = BAT_NHEAD HKSwordWindCenter FollowBone:Yes
            ParticleSysBone = B_NHANDR FeuerSchwertHK FollowBone:Yes
            ParticleSysBone = BAT_NHEAD GandalfBlastRipple FollowBone:Yes
        End

        AnimationState            = HERO PACKING PACKING_TYPE_1
            Animation = FinishIgniteRoar
                AnimationName = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode = ONCE
            End

            EnteringStateFX = FX_HKFellbeastSwordBlast
        End

        AnimationState            = USER_2
            Animation
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
            End
            ParticleSysBone = B_SWORD HKSwordWindCenter FollowBone:Yes
            ParticleSysBone = B_SWORD FeuerSchwertHK FollowBone:Yes
            ParticleSysBone = B_SWORD GandalfBlastRipple FollowBone:Yes
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End


        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

    AnimationState = DYING
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

    End


    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = exldrspmord
        End
    End


    DisplayName            = OBJECT:MordorWitchKingOnFellBeast
    DisplayNameStrategic = OBJECT:MordorWitchKingOnFellBeast
    RecruitText            = CONTROLBAR:MordorWitchKingOnFellBeastRecruit
    ReviveText            = CONTROLBAR:MordorWitchKingOnFellBeastRevive
    Hotkey                = CONTROLBAR:MordorWitchKingOnFellBeastHotkey


    ButtonImage            = HIWitchKingnew

    CommandSet           = MordorWitchKingRidingFellBeastModDienerCommandSet
    BuildCost            = 4200
    BuildTime            = STRONG_HERO_BUILDTIME
    CommandPoints        = 0



    SoundMoveStart        = NoSound

    Body = RespawnBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = STRONG_HERO_HEALTH
        HealingBuffFx     = None
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 5133
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HINazgulWitchKing
        RespawnAsTemplate            = MordorWitchKing

        RespawnRules =    AutoSpawn:No           Cost:4000       Time:STRONG_HERO_RESPAWNTIME        Health:100%
   End

    EvaEventDieOwner             = WitchKingDie

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1
        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No
    End






    Behavior = AttributeModifierAuraUpdate ModuleTag_Nekromant
        StartsActive        = Yes
        BonusName           = SklavenModifierHK
        RefreshDelay        = 2000
        Range               = 10000000
        ObjectFilter        = ANY +MordorNekromantSauron ALLIES
    End



     Behavior = SpecialPowerModule ModuleTag_DismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
        InitiateSound                = FellBeastVoiceMove
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Dismount
         SpecialPowerTemplate    = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = MordorWitchKingSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityCurseEnemy SpecialAbilityScreech SpecialAbilityWordOfPower SpecialAbilityWitchkingMorgulBlade SpecialAbilityNazgulGeisterform SpecialAbilityHexenkonigStundeSpell SpecialAbilityKampfschreiEffect
         UnpackTime              = OBJECT_TOGGLE_TIME
         PreparationTime         = 1
         PackTime                = 0
         OpacityTarget            = 1
         AwardXPForTriggering    = 0
         IgnoreFacingCheck        = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechEnabler
        SpecialPowerTemplate     = SpecialAbilityKampfschreiEffect
        TriggeredBy              = Upgrade_Level_3
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ScreechStarter
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = WitchKingScreechMS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ScreechWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityKampfschreiEffect
        SpecialWeapon             = WitchkingFearWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange         = 10.0
        SkipContinue              = Yes
        UnpackTime                = 2000
        PackTime                  = 2000
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ScreechAutoAbility
	SpecialAbility		= SpecialAbilityKampfschreiEffect
	MaxScanRange		= 150
	Query			= 10 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End
    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = No
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS_MOUNTED
        TargetEnemy        = Yes
        AntiCategory          = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End
    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                    = WITCHKING_DREADVISAGE_EFFECT_RADIUS_MOUNTED
        EmotionPulseInterval                = 2000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HOFTWEnabler
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        TriggeredBy                 = Upgrade_Level_9
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FellBeastVoiceAttack
    End
     Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate        = SpecialAbilityCurseEnemy
        CursePercentage             = 100.0%
        StartAbilityRange           = 200.0
        CursedFX                    = FX_SarumanDominateTargets
        TriggerFX                   = FX_CreateaHeroCurse
        UnpackTime                  = 2000
        PreparationTime             = 1000
        FreezeAfterTriggerDuration  = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_HotWKAutoAbility
	SpecialAbility			= SpecialAbilityCurseEnemy
	MaxScanRange			= 280
        ForbiddenStatus 		= INSIDE_GARRISON
	Query				= 1 ANY ENEMIES +HERO -MONSTER -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query				= 30 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformEnabler
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        TriggeredBy                 = Upgrade_Level_1
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WitchkingMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = HKModVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WitchkingMorgulBladeUpdate
        SpecialPowerTemplate        = SpecialAbilityWitchkingMorgulBlade
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        WhichSpecialWeapon          = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = 15.0
        MustFinishAbility           = Yes
        SpecialWeapon               = MordorEdainWitchkingMorgulBlade
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility              = SpecialAbilityWitchkingMorgulBlade
        ForbiddenStatus             = INSIDE_GARRISON
        AllowSelf                   = No
        Query                       = 1 MORGULBLADE_OBJECT_FILTER
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
        BonusName                = WitchkingRingjagerSelf
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 1
        AllowSelf                = Yes

        ObjectFilter             = NONE +MordorWitchKing
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive             = No
        BonusName                = WitchkingRingjager
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +MordorNazgul +GasthausKhamul +GasthausKhamulonFellBeast +MordorNazgul_CGmod +MordorNazgul_CGmod2 +MordorFellBeastInterface +MordorFellBeast_edainmod +MordorFellBeast_edainmod2 +MordorSchwarzeReiter  +MordorNazgul_Enthullung +MordorNazgul_Enthullung2 ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership3
        StartsActive             = No
        BonusName                = WitchkingRingjagerTruppen
        TriggeredBy              = Upgrade_Level_4
        RefreshDelay             = 2000
        Range                    = 200

        ObjectFilter             = ANY +INFANTRY +CAVALRY -HERO ALLIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WitchkingMorgulBladeEnabler
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        TriggeredBy                 = Upgrade_Level_7
        ObeyRechageOnTrigger        = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformStarter
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_GeisterformUpdate
        SpecialPowerTemplate        = SpecialAbilityNazgulGeisterform
        EffectDuration              = 60000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeisterformFake
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GeisterformFakeUpdate
        SpecialPowerTemplate     = SpecialAbilityNazgulGeisterformFake
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = HexenkonigStundeHeroEffect
            FireDelay = 2000
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLHexenkonigStundeEnabler
       SpecialPowerTemplate       = SpecialAbilityHexenkonigStundeSpell
       TriggeredBy                = Upgrade_Level_10
       ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HexenkonigStundeStarter
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UpdateModuleStartsAttack  = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_HexenkonigStundeUpdate
        SpecialPowerTemplate      = SpecialAbilityHexenkonigStundeSpell
        UnpackingVariation        = 1
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = HKFeuerSchwertBonusSpell
        HeroEffectDuration        = 30000
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityHexenkonigStundeSpell
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = AttributeModifierUpgrade ModuleTag_TurnMyHourBonus
        TriggeredBy           = Upgrade_Level_1
        AttributeModifier     = SpellBookMyHour
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorWitchKingRidingFellBeastModChangeDienerCommandSet
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = MordorWitchKingRidingFellBeastModDienerCommandSet
    End


    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_WitchKingDismount
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityMordorWitchkingScreechEffeckt
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate HourOfTheWitchKingAI
        CommandButtonName = Command_HourOfTheWitchKing
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End
End

