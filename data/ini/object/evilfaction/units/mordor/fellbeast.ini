Object MordorFellBeastInterface

    ButtonImage = HIMordorFellBeast_New
    SelectPortrait = HPNazgul

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_FellBeast

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model = CUFellBst_SKN
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End

        ModelConditionState = RIDER2
            Model = MUWchKngFB_SKN
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End

        End

        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

        AnimationState = DYING DEATH_2
            Animation = Dying
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

    AnimationState = DYING DEATH_1
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

End

    Side                  = Mordor
    EditorSorting         = UNIT
    ThreatLevel           = FELL_BEAST_THREAT_LEVEL
    ThingClass            = LARGE_MONSTER
    TransportSlotCount    = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE

     BuildCost         = NAZGUL_BUILDCOST
     BuildTime         = NAZGUL_BUILDTIME

	WeaponSet
		Weapon				= PRIMARY	NazgulPlowAttack
		PreferredAgainst		= PRIMARY	STRUCTURE MACHINE HORDE
		Weapon				= SECONDARY	NazgulGrabAttack
		PreferredAgainst		= SECONDARY	INFANTRY THROWN_OBJECT CAVALRY
		Weapon				= TERTIARY	NazgulClawAttack
		OnlyAgainst			= TERTIARY	MONSTER
		ReadyStatusSharedWithinSet 	= Yes
	End

    ArmorSet
        Conditions       = None
        Armor            = NazgulArmor
        DamageFX         = FellBeastDamageFX
    End

    VisionRange          = VISION_FLIER
    ShroudClearingRange  = SHROUD_CLEAR_FLIER
    DisplayName          = OBJECT:MordorFellBeast
    DisplayNameStrategic = OBJECT:MordorFellBeast
    RecruitText          = CONTROLBAR:MordorFellBeastRecruit
    ReviveText           = CONTROLBAR:MordorFellBeastRevive
    Hotkey               = CONTROLBAR:MordorFellBeastHotkey
    RamPower             = 45
    RamZMult             = 0.5
    CrusherLevel         = 3
    CrushKnockback       = 50
    CrushZFactor         = 1.0
    CommandSet           = FellBeastCommandSet
    CommandPoints        = 20

    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_NazgulBody

    AutoResolveWeapon
        Weapon = AutoResolve_NazgulWeapon
    End
    AutoResolveArmor
        Armor = AutoResolve_NazgulArmor
    End

    VoiceAttack            = FellBeastVoiceAttackMS

    VoiceFear            = FellBeastAlert
    VoiceMove            = FellBeastVoiceMoveMS
    VoicePriority        = 76
    VoiceSelect            = FellBeastVoiceSelectMS
    VoiceGuard            = FellBeastVoiceMove

    SoundAmbient        = FellBeastVoxAmbientLoop
    SoundMoveStart        = FellBeastMoveStart
    SoundImpact            = ImpactHorse


    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End

    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD

    Body = RespawnBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = NAZGUL_HEALTH
        HealingBuffFx     = None
    End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive = Yes
        HealingAmount = NAZGUL_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = 15000
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    FellBeastFunctions
        FollowThroughDistance        =    200
        FollowThroughCheckStep        =    50
        FollowThroughGradient        =    1.0

        GrabTossTimeTrigger            =    2.5
        GrabTossHeightTrigger        =   100.0
        TossFX                = FX_DiebyFalling
        SpecialContactPoints        = Swoop

        AttackPriority = AttackPriority_FellBeast
      End

      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 95
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 78
      End
      LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 160
      End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack = Yes

    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UnpackTime               = 1
        AwardXPForTriggering     = 0
        StartAbilityRange        = 1000.0
    End

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1

        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No

        ReleaseSnappyness = 0.05

    End

   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL -FADED
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellBeastDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
       DeathFlags                   = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreech
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    FormationPreviewDecal
            Texture = FPflyingUnitDecal
            Width = 128
            Height = 128
        End

    Geometry            = CYLINDER
    GeometryMajorRadius = 42.0
    GeometryHeight      = 45.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
    Scale               = 0.92

End

ChildObject MordorFellBeast MordorFellBeastInterface

     Behavior = SpecialPowerModule ModuleTag_FellbeastScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_FellBeastScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                    = 180
        PreparationTime                = 1
        PackTime                    = 3000
        CustomAnimAndDuration        = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End


    EvaEventDieOwner             = NazgulDie
End



ChildObject MordorFellBeast_Summoned MordorFellBeast
    IsTrainable = No
    CommandPoints = 0

    KindOf = +SUMMONED

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant = 5
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 180000
        MaxLifetime      = 180000
        DeathType        = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End
End



ChildObject AngmarFellBeast_Summoned MordorFellBeast
    IsTrainable = No
    CommandPoints = 0

    KindOf = +SUMMONED

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant = 5
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 62000
        MaxLifetime        = 62000
        DeathType        = FADED
    End


    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End
End



ChildObject MordorFellBeast_SummonedwithoutRider MordorFellBeast
    IsTrainable = No
    CommandPoints = 0

    KindOf = +SUMMONED

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant = 5
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = SubObjectsUpgrade ModuleTag_Making
        TriggeredBy         = Upgrade_MordorFaction
        HideSubObjects      = NAZGUL_SKIN RIDER RIDER2
    End


End


ChildObject KhamulFellBeast MordorFellBeastInterface

    DisplayName        = OBJECT:MordorKhamul
    DisplayNameStrategic        = OBJECT:MordorKhamul
    RecruitText        = CONTROLBAR:MordorKhamulRecruit
    ReviveText        = CONTROLBAR:MordorKhamulRevive
    Hotkey            = CONTROLBAR:MordorKhamulHotkey

    CommandSet        = KhamulFellBeastCommandSet

     Behavior = SpecialPowerModule ModuleTag_FellbeastScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_FellBeastScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime            = 1
        AwardXPForTriggering        = 0
        TriggerSound            = NazgulScreech
        EffectRange            = 180
        PreparationTime            = 1
        PackTime            = 3000
        CustomAnimAndDuration        = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End



    EvaEventDieOwner             = NazgulDie


     Behavior = SpecialPowerModule ModuleTag_KhamulDismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused            = No
        InitiateSound            = FellBeastVoiceMove
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_KhamulDismount
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = KhamulMounted
         SynchronizeTimerOnSpecialPower     = SpecialAbilityBlackRiderMorgulBlade SpecialAbilityScreech
         UnpackTime                  = 0
         PreparationTime             = 1
         PackTime                    = 0
         OpacityTarget            = 1
         AwardXPForTriggering        = 0
         IgnoreFacingCheck        = Yes
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

End



ChildObject MorgomirFellBeast MordorFellBeastInterface

    DisplayName        = OBJECT:MordorMorgomir
    DisplayNameStrategic        = OBJECT:MordorMorgomir
    RecruitText        = CONTROLBAR:MordorMorgomirRecruit
    ReviveText        = CONTROLBAR:MordorMorgomirRevive
    Hotkey            = CONTROLBAR:MordorMorgomirHotkey

    CommandSet        = KhamulFellBeastCommandSet

     Behavior = SpecialPowerModule ModuleTag_FellbeastScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_FellBeastScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime            = 1
        AwardXPForTriggering        = 0
        TriggerSound            = NazgulScreech
        EffectRange            = 180
        PreparationTime            = 1
        PackTime            = 3000
        CustomAnimAndDuration        = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End


    EvaEventDieOwner             = NazgulDie


     Behavior = SpecialPowerModule ModuleTag_MorgomirDismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused            = No
        InitiateSound            = FellBeastVoiceMove
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_MorgomirDismount
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = MordorMorgromirMounted
         SynchronizeTimerOnSpecialPower     = SpecialAbilityBlackRiderMorgulBlade SpecialAbilityScreech
         UnpackTime                  = 0
         PreparationTime             = 1

         PackTime                        = 0
         OpacityTarget            = 1
         AwardXPForTriggering        = 0
         IgnoreFacingCheck        = Yes
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

End


Object AngmarFellBeastInterface

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_FellBeast

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        RandomTexture = kuschattenbestie.tga 0 cufellbst.tga
        RandomTexture = kuschattenbestie_wings.tga 0 cufellbstwings.tga

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model = kushadow1_skn
            ParticleSysBone = BAT_LWINGARM04 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_LWING07 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_LWING05 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_LWING03 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_LWING02 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_RWING03 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_RWING05 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_RWING07 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_RWINGARM04 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_LWINGARM01 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_RWINGARM01 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_WINGD06 GaladAura02 FollowBone:Yes
            ParticleSysBone = B_WINGD01 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_SPINE01 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL02 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_NECK02 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL03 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_NECK01 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL06 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL04 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL05 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL01 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_HAUNCHL GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_HAUNCHR GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_HEAD GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL08 GaladAura02 FollowBone:Yes
            ParticleSysBone = BAT_TAIL07 GaladAura02 FollowBone:Yes
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End



        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End



        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

    AnimationState = DYING
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End


          AnimationState = DYING DEATH_3
             Animation = DyingA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                  AnimationMode = LOOP
                  AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.5 0.5
              End
              StateName = DYING
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
                AnimationBlendTime = 4
            End
        End

    End




    Side                  = Angmar
    EditorSorting         = UNIT
    ThreatLevel           = FELL_BEAST_THREAT_LEVEL
    ThingClass            = LARGE_MONSTER
    TransportSlotCount    = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    Scale                 = 0.95
    MaxSimultaneousOfType = 2
    IsTrainable           = No
     BuildCost         = NAZGUL_BUILDCOST
     BuildTime         = NAZGUL_BUILDTIME

	WeaponSet
		Weapon				= PRIMARY	NazgulPlowAttack
		PreferredAgainst		= PRIMARY	STRUCTURE MACHINE HORDE
		Weapon				= SECONDARY	NazgulGrabAttack
		PreferredAgainst		= SECONDARY	INFANTRY THROWN_OBJECT CAVALRY
		Weapon				= TERTIARY	NazgulClawAttack
		OnlyAgainst			= TERTIARY	MONSTER
		ReadyStatusSharedWithinSet 	= Yes
	End

    ArmorSet
        Conditions       = None
        Armor            = NazgulArmor
        DamageFX         = FellBeastDamageFX
    End

    VisionRange          = VISION_FLIER
    ShroudClearingRange  = SHROUD_CLEAR_FLIER
    DisplayName          = OBJECT:AngmarFellBeast
    RecruitText          = CONTROLBAR:AngmarFellBeastRecruit
    RamPower             = 50
    RamZMult             = 0.5
    CrusherLevel         = 3
    CrushKnockback       = 60
    CrushZFactor         = 1.0
    CommandSet           = EmptyCommandSet
    CommandPoints        = 0




    VoiceAttack            = ShadeWolfAttack
    VoiceAttackCharge        = ShadeWolfAttack
    VoiceAttackMachine    = ShadeWolfAttack
    VoiceAttackStructure    = ShadeWolfAttack
    VoiceGuard            = ShadeWolfIdle
    VoiceMove            = ShadeWolfIdle
    VoiceSelect            = ShadeWolfIdle
    VoiceSelectBattle        = ShadeWolfIdle

    SoundAmbient        = ShadeWolfIdle
    SoundImpact            = ImpactHorse

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103

    End

    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD

    Body = RespawnBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 3500
        HealingBuffFx     = None
    End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive = Yes
        HealingAmount = NAZGUL_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = 15000
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = SubObjectsUpgrade ModuleTag_MakingTheSchattenbestie
        TriggeredBy         = Upgrade_LeuchtfeuerZwerge
        HideSubObjects      = NAZGUL_SKIN RIDER RIDER2
    End


    Behavior = SpecialPowerModule ModuleTag_FellbeastScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_FellBeastScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End


     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    600
        AILuaEventsList                =    AngmarFellBeastFunctions
        FollowThroughDistance        =    200
        FollowThroughCheckStep        =    50
        FollowThroughGradient        =    1.0

        GrabTossTimeTrigger            =    2.5
        GrabTossHeightTrigger        =   100.0
        TossFX                = FX_DiebyFalling
        SpecialContactPoints        = Swoop

        AttackPriority = AttackPriority_FellBeast
      End

      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 95
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 78
      End
      LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 160
      End

    Behavior = PhysicsBehavior ModuleTag_04


    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack = Yes

    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate     = SpecialAbilityLevelAttack
        UnpackTime               = 1
        AwardXPForTriggering     = 0
        StartAbilityRange        = 1000.0
    End

    Behavior = TransportContain TransportContainModuleTag


        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1

        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No

        ReleaseSnappyness = 0.05

    End


   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellBeastDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive   = No
        WhichSpecialPower = 1
        GenerateTerror    = No
        GenerateFear      = Yes
        EmotionPulseRadius   = 100
        EmotionPulseInterval = 1000
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreech
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    FormationPreviewDecal
            Texture = FPflyingUnitDecal
            Width = 128
            Height = 128
        End

    Geometry            = CYLINDER
    GeometryMajorRadius = 42.0
    GeometryHeight      = 45.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
    Scale               = 0.92

End


ChildObject AngmarFellBeastInterface_Summoned AngmarFellBeastInterface
    IsTrainable     = No
    CommandPoints   = 0
    CommandSet      = CreepCommandSet
    EquivalentTo    = AngmarFellBeastInterface

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes          = NONE +FADED
        FadeDelay           = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags          = DEATH_3
        Sound               = INITIAL SpellGenericUnsummonFasterMS
    End

End









Object MordorFellBeast_SlavedwithoutRider

    ButtonImage = HIMordorFellBeast_New
    SelectPortrait = HPNazgul

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_FellBeast

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model = CUFellBst_SKN
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End

        ModelConditionState = RIDER2
            Model = MUWchKngFB_SKN
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End

        End

        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

        AnimationState = DYING DEATH_2
            Animation = Dying
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

    AnimationState = DYING DEATH_1
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

End


	Side			= Mordor
	EditorSorting		= UNIT
	ThreatLevel		= FELL_BEAST_THREAT_LEVEL
	ThingClass		= LARGE_MONSTER
	TransportSlotCount	= TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
  
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

  WeaponSet
	Conditions	= None
	Weapon          = PRIMARY	NazgulGrabAttack
	PreferredAgainst= PRIMARY	INFANTRY THROWN_OBJECT CAVALRY

	Weapon		= SECONDARY	NazgulPlowAttack
	OnlyAgainst	= SECONDARY	STRUCTURE MACHINE HORDE SHIP CAN_RIDE_SIEGE_LADDER

	Weapon		= TERTIARY	NazgulClawAttack
	PreferredAgainst = TERTIARY	HERO MONSTER
 End

         ArmorSet
		Conditions      = None
        Armor            = NazgulArmor
        DamageFX         = FellBeastDamageFX
	End

	VisionRange = VISION_FLIER
	ShroudClearingRange = SHROUD_CLEAR_FLIER

	BountyValue = GONDOR_GWAIHIR_BOUNTY_VALUE

    DisplayName          = OBJECT:MordorFellBeast
    DisplayNameStrategic = OBJECT:MordorFellBeast

	CrusherLevel	= 3
	RamPower 	= 45
	RamZMult 	= 0.5
	CommandSet 	= emptyCommandSet
	CommandPoints = 0
	
	EvaEnemyObjectSightedEvent = None 

	SoundCreated = FellBeastVoiceSelectMS

    VoiceAttack            = FellBeastVoiceAttackMS

    VoiceFear            = FellBeastAlert
    VoiceMove            = FellBeastVoiceMoveMS
    VoicePriority        = 76
    VoiceSelect            = FellBeastVoiceSelectMS
    VoiceGuard            = FellBeastVoiceMove

    SoundAmbient        = FellBeastVoxAmbientLoop
    SoundMoveStart        = FellBeastMoveStart
    SoundImpact            = ImpactHorse


    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End


	RadarPriority	= UNIT
	KindOf	= PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER MONSTER SCARY CAN_ATTACK GIANT_BIRD
	
	Body = ActiveBody ModuleTag_02
		CheerRadius 	= EMOTION_CHEER_RADIUS
		MaxHealth       = 4000
		HealingBuffFx	= None
		DodgePercent    = 20
	End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive                   = Yes
        HealingAmount                  = 25
        HealingDelay                   = 1000
        StartHealingDelay              = 15000
        HealOnlyIfNotInCombat          = Yes
    End
	
    Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = FellBeastFunctions
        FollowThroughDistance           = 200
        FollowThroughCheckStep          = 50
        FollowThroughGradient           = 1.0
        GrabTossTimeTrigger             = 2.5
        GrabTossHeightTrigger           = 100.0
        TossFX                          = FX_DiebyFalling
        SpecialContactPoints            = Swoop
        AttackPriority                  = AttackPriority_FellBeast
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius              = 100
        EmotionPulseInterval            = 2500
        GenerateFear                    = Yes
        InitiallyActive                 = Yes
        VictimFilter                    = ALL ENEMIES
    End

   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL -FADED
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellBeastDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
       DeathFlags                   = DEATH_1
    End

    Behavior = SubObjectsUpgrade ModuleTag_Making
        TriggeredBy         = Upgrade_MordorFaction
        HideSubObjects      = NAZGUL_SKIN RIDER RIDER2
    End
	
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_NORMAL 
		Speed     = 120
	End
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_SUPERSONIC 
		Speed     = 165
	End
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_WANDER 
		Speed     = 88
	End

	  LocomotorSet
	    Locomotor = MordorFlyingFireSwoopLocomotor
	    Condition = SET_PANIC
	    Speed     = 185
	  End

	Behavior = PhysicsBehavior ModuleTag_04
	End
	
	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
	End

	Behavior = SquishCollide ModuleTag_06
	End

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained     = UNSELECTABLE UNATTACKABLE
        PassengerFilter             = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots                       = 1
        ShowPips                    = No
        CollidePickup               = No
        AllowEnemiesInside          = Yes
        AllowNeutralInside          = Yes
        AllowAlliesInside           = Yes
        DamagePercentToUnits        = 0%
        PassengerBonePrefix         = PassengerBone:B_PASSENGER KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath      = No
        GrabWeapon                  = FellbeastGrabWeapon
        FireGrabWeaponOnVictim      = No
        ReleaseSnappyness           = 0.05
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate              = 500
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

         Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 500
		GuardWanderRange	= 250
		UseSlaverAsControlForEvaObjectSightedEvents = No 
                DieOnMastersDeath	= Yes
	End

    Geometry            = CYLINDER
    GeometryMajorRadius = 42.0
    GeometryHeight      = 45.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
    Scale               = 0.92

End