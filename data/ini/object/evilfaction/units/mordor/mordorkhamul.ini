Object GasthausKhamul

    SelectPortrait    = HPKhamulStart
    ButtonImage       = HIKhamulStart

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

    Draw = W3DHordeModelDraw ModuleTag_01

        DefaultModelConditionState
            Model            = munazgula
        End

        ModelConditionState = MOUNTED
            Model           = mublackridera
        End

        AnimationState        = PACKING_TYPE_2
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = ONCE
            End
        End

        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLB
                AnimationPriority    = 4
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript
        End





        AnimationState        = PASSENGER MOUNTED
            Animation           = grabbed
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GBDA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FREEFALL MOUNTED
            Animation           = freefall
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING MOUNTED
            Animation           = JustDie
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    splatted
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED DYING
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_MFDA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    10
                Distance            =    80
            End
        End

        AnimationState                = DYING MOUNTED
            Animation
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode       = ONCE
            End
            Animation
                AnimationName        = MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        = ONCE
            End
        End

        AnimationState        = STUNNED_STANDING_UP MOUNTED
            Animation           = StandUp
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GTPA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED MOUNTED
            Animation           = Land
                AnimationName       = MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            ShareAnimation        = Yes
            Animation           = TrotAndFire
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATRA
                AnimationMode       = LOOP
                Distance            = 70
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End


        AnimationState                = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode        = LOOP
            End
        End
        AnimationState                = MOVING EMOTION_TERROR MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState        = MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState        = MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState            = MOVING ACCELERATE MOUNTED
            Animation           = Accelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_ACCL
                AnimationMode   = ONCE
            End
        End

        AnimationState            = MOVING DECELERATE MOUNTED
            Animation           = Decelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_DECL
                AnimationMode   = ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState        = MOVING MOUNTED
            ShareAnimation        = Yes
            Animation           = RunA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode       = LOOP
            End
            Animation           = RunB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FIRING_OR_PREATTACK_A MOUNTED
            Animation           = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
            Animation           = ATKB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKB
                AnimationMode       = ONCE
            End
            Animation           = Defend
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DFDA
                AnimationMode       = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = SPECIAL_WEAPON_ONE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCB
                AnimationMode       = ONCE
            End
        End

        AnimationState        = SPECIAL_WEAPON_TWO MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode       = ONCE
            End
        End

        AnimationState        = SPECIAL_WEAPON_THREE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode       = ONCE
            End
        End



        AnimationState = HIT_REACTION HIT_LEVEL_1 MOUNTED
            Animation = Hit_Level_1_a
                AnimationName = MUBlkRider_SKL.MUBlkRider_HFMA
                AnimationMode = ONCE
            End
        End


        AnimationState                    = EMOTION_TAUNTING MOUNTED
            ShareAnimation                = Yes
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTB
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = MOUNTED USER_1
            Animation
                AnimationName            = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode = LOOP
            End
            Flags             = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    SELECTED MOUNTED
            StateName                =    State_Selected
            Animation                =    AtAttention
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode        =    Loop
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState = MOUNTED
            StateName                = Idle
            Animation                = IdleA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationPriority   = 20
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLB
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleC
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLC
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleG
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End


        TransitionState                    =    TRANS_Selected_to_Idle
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Flags                        = START_FRAME_LAST
        End





        AnimationState        =  SPECIAL_WEAPON_ONE
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCB
                AnimationMode = ONCE
            End
        End

        AnimationState        =  SPECIAL_WEAPON_TWO
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCA
                AnimationMode = ONCE
            End
        End

        AnimationState        =  SPECIAL_WEAPON_THREE
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCC
                AnimationMode = ONCE
            End
        End


        AnimationState                    = USER_1
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_SPCC
                AnimationMode = LOOP
            End
            Flags             = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End


        AnimationState = DYING
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode       = ONCE
            End
        End

        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

        AnimationState = FREEFALL
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_GTPA
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End

            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKB
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNA
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_LVLA
                AnimationMode = ONCE
            End
        End


        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = MUNazgul_SKL.MUNazgul_TNTA
                AnimationMode                    = ONCE
                AnimationSpeedFactorRange        = 0.8 1.2
            End
        End

        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

    TransitionState = TRANS_Idle_to_Selected
        Animation = ATNA
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNA
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End

    TransitionState = TRANS_Selected_to_Idle
        Animation = ATNF
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNC
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End

    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING MOUNTED
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING MOUNTED
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End



    Side                   = Mordor
    EditorSorting          = UNIT
    ThreatLevel            = BLACKRIDER_THREAT_LEVEL
    TransportSlotCount     = TRANSPORTSLOTCOUNT_HERO
    MaxSimultaneousOfType  = 1
    DisplayMeleeDamage     = KHAMULDAG_DAMAGE
    BountyValue            = 1000
    DisplayName            = OBJECT:MordorKhamul
    DisplayNameStrategic   = OBJECT:MordorKhamul
    RecruitText            = CONTROLBAR:MordorKhamulRecruit
    ReviveText             = CONTROLBAR:MordorKhamulRevive
    Hotkey                 = CONTROLBAR:MordorKhamulHotkey
    CommandSet             = KhamulStartCommandSet
    CommandPoints          = 0

    BuildCost              = STRONG_HERO_COST
    BuildTime              = MEDIUM_HERO_BUILDTIME

    ShroudClearingRange    = 320
    VisionRange            = 190
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot    = 2.0%

    CrushableLevel            = 2
	CrusherLevel			  = 0
	
    MountedCrusherLevel       = 1
    MountedCrushableLevel     = 2
    CrushWeapon               = HKundKhamulUnenthulltCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    RamPower            = 30
    RamZMult            = 0.5
	
	CrushKnockback = 40
    CrushZFactor = 1.0

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    KhamulSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    KhamulSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = HIDDEN
        Weapon            = PRIMARY    KhamulSwordLeech
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End


    ArmorSet
        Conditions      = None
        Armor           = MediumHeroArmor	
        DamageFX        = WraithDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = MediumHeroArmorMounted
        DamageFX        = WraithDamageFX
    End



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_NazgulArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_NazgulWeapon
    End





    VoiceAttack                  = KhamulVoiceAttack
    VoiceAttackCharge            = KhamulVoiceAttack
    VoiceAttackMachine           = KhamulVoiceAttack
    VoiceAttackStructure         = KhamulVoiceAttack
    VoiceCreated                 = KhamulVoiceRecruit
    VoiceFullyCreated            = KhamulVoiceRecruit
    VoiceGuard                   = RinggeistVoiceMove
    VoiceMove                    = RinggeistVoiceMove
    VoicePriority                = 90
    VoiceRetreatToCastle         = RinggeistVoiceMove
    VoiceSelect                  = KhamulVoiceSelect
    VoiceSelectBattle            = KhamulVoiceSelect

    SoundImpact                  = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip  = KhamulVoiceSelect
        VoiceEnterUnitMordorMumakil         = KhamulVoiceSelect
        VoiceEnterUnitSlaughterHouse        = KhamulVoiceSelect
        VoiceGarrison                       = KhamulVoiceSelect
        VoiceInitiateCaptureBuilding        = KhamulVoiceSelect
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove             = RinggeisterVoiceMove
            VoiceSelect           = KhamulVoiceSelect
        End
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner             = NazgulDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound:FootstepDirtA                Animation:MUBLKRIDER_SKL.MUBLKRIDER_CHRA    Frames:26 38

        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_ACCL    Frames:8 30
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNB    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNR1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNL    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNR    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_IDLC    Frames:9
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_TNTB    Frames:9
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:10 46
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:20 43
        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:70
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:3 11
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:0
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Cavalry Knight
    End


    RadarPriority = UNIT
    ThingClass = CAVALRY_UNIT

    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE HERO GRAB_AND_DROP INFANTRY ARMY_SUMMARY HEAVY_MELEE_HITTER

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = KHAMULDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 5500
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 2000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIKhamulStart
        RespawnAsTemplate          = GasthausKhamul

        RespawnRules =    AutoSpawn:No           Cost:STRONG_HERO_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
    End


    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
        End

    Behavior = AutoHealBehavior ModuleTag_KhamulHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        AILuaEventsList             = EvilMenBlackRiderFunctions
    End

    LocomotorSet
        Locomotor = NazgulLocomotor
        Condition = SET_NORMAL
        Speed     = 54
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_MOUNTED
        Speed     = 110
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 2533
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_08

        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.80
        DestructionDelay = 12000

        Sound = INITIAL RinggeistVoiceDie
    End

      Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2000
        HitReactionLifeTimer2 = 2000
        HitReactionLifeTimer3 = 2000

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    =    Terror_Base
        AddEmotion    =    OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf            = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion    =    Alert_Base
        IgnoreVeterancy = Yes
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End





    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 100
        ThingToSpawn    = MordorHeroesSklavenPing_Khamul
    End





     Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes
         StartsPaused 		   = No
     End

     Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseTogglePferd
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         UnpackTime              = MORDOR_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = MORDOR_MOUNT_TIME
         OpacityTarget            = .3
         AwardXPForTriggering    = 0
     End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderHorseToggle
        SpecialPowerTemplate = SpecialAbilityToggleMountedonFellbeast
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulHorseToggle
        SpecialPowerTemplate        = SpecialAbilityToggleMountedonFellbeast
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = FellBeastVoiceAttack
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggleFellbeast
         SpecialPowerTemplate    = SpecialAbilityToggleMountedonFellbeast
         MountedTemplate            = GasthausKhamulonFellBeast
         SynchronizeTimerOnSpecialPower = SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime              = 1000
         PreparationTime         = 0
         PackTime                = 0
         OpacityTarget            = .0
         AwardXPForTriggering    = 0
         IgnoreFacingCheck        = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory     = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        TriggeredBy             = Upgrade_Level_7
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = DrohungderNazgulModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapperDrohung
        WeaponSetFlags          = WEAPONSET_HERO_MODE
        WeaponToggleCommandSet  = KhamulStartCommandSet_Drohung
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ShakeFoundationEnabler
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        TriggeredBy               = Upgrade_Level_6
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ShakeFoundationStarter
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ShakeFoundationWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        SpecialWeapon             = KhamulStreikWeapon
        WhichSpecialWeapon        = 3
        StartAbilityRange         = 15.0
        SkipContinue              = Yes
        UnpackTime                = 1400
        PackTime                  = 2433
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ShakeFoundationAutoAbility
        SpecialAbility            = SpecialAbilityDwarvenGloinShakeFoundation
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SpionageEnabler
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        TriggeredBy              = Upgrade_Level_4
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_SpionagePower
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SpionageUpdate
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        SkipContinue             = Yes
        UnpackTime               = 1500
        PreparationTime          = 1
        PersistentPrepTime       = 1000
        PackTime                 = 500
        AwardXPForTriggering     = 0
        StartAbilityRange        = 290
        ApproachRequiresLOS      = Yes
        SpecialWeapon            = KhamulSpionageObjectWeapon
        MustFinishAbility        = Yes
        WhichSpecialWeapon       = 3
        BusyForDuration          = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_SpionageAutoAbility
        SpecialAbility            = SpecialAbilityAvariSpionage
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TributEnabler
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        TriggeredBy               = Upgrade_Level_5
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TributStarter
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TributUpdate
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        StartAbilityRange         = CREATE_A_HERO_STEAL_MONEY_DO_POWER_RANGE
        ApproachRequiresLOS       = Yes
        SpecialWeapon             = KhamulTributWeapon
        WhichSpecialWeapon        = 3
    End

    Behavior = AutoAbilityBehavior ModuleTag_TributAutoAbility
        SpecialAbility            = SpecialAbilityCreateAHeroStealMoney_Level2
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Level_4
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes
        UnpackTime              = 250
        PreparationTime         = 1
        PersistentPrepTime      = 500
        PackTime                = 100
        AwardXPForTriggering    = 0
        StartAbilityRange       = 15.0
        SpecialWeapon           = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon      = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility   = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus  = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 FIRST_AGE_VALARS_SILMARIL_OBJECTFILTER ENEMIES
    End


    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper
        WeaponSetFlags            = MOUNTED
        WeaponToggleCommandSet    = KhamulStartMountedCommandSet
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VasallenEnabler
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        TriggeredBy             = Upgrade_Level_10
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerVasallen
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        OCL                     = OCL_SpawnSchwarzeOstlingeEgg
        TriggerFX               = FX_SummonShagratUruks
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 3.2
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ToggleMountedWitchkingSauronsDienerEnabler
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
    End

    Behavior = SpecialPowerModule ModuleTag_ToggleMountedWitchkingSauronsDienerStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ToggleMountedWitchkingSauronsDiener
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         MountedTemplate             = GasthausKhamulSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityKhamulBlackEasterlingSummon SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime                  = OBJECT_TOGGLE_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeEnthuellung
        TriggeredBy                  = Upgrade_InsignienStatthalter
		ConflictsWith						= Upgrade_ObjectUnderAIControl
        GetUpgradeCommandButtonName  = Command_KhamulSauronsDienerButton
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End




    Behavior = ObjectCreationUpgrade ModuleTag_IamAI
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 200000
        GrantUpgrade = Upgrade_InsignienStatthalter
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulSauronsDienerButton
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_BlackRiderMorgulBlade_Khamul
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Scale 		= 1.04
    Geometry            = CYLINDER
    GeometryMajorRadius = 16.0
    GeometryHeight      = 25.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 30
    ShadowSizeY         = 21
    ShadowTexture       = ShadowI
End

Object GasthausKhamulonFellBeast

    SelectPortrait     = HPKhamulStart
    ButtonImage        = HIKhamulNew

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_FellBeast

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

     EquivalentTo = GasthausKhamul

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        DefaultModelConditionState
            Model = mufellbst_ske
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End



        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End



        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End



        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

    AnimationState = DYING
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

End


    Side                = Mordor
    EditorSorting        = UNIT
    ThreatLevel            = FELL_BEAST_THREAT_LEVEL
    ThingClass            = LARGE_MONSTER
    TransportSlotCount    = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    DisplayMeleeDamage = STRONG_HERO_DAMAGE
    BuildCost            = KHAMULDAG_COST
    BuildTime            = MEDIUM_HERO_BUILDTIME

	WeaponSet
		Weapon				= PRIMARY	NazgulPlowAttack
		PreferredAgainst		= PRIMARY	STRUCTURE MACHINE HORDE
		Weapon				= SECONDARY	NazgulGrabAttack
		PreferredAgainst		= SECONDARY	INFANTRY THROWN_OBJECT CAVALRY
		Weapon				= TERTIARY	NazgulClawAttack
		OnlyAgainst			= TERTIARY	MONSTER
		ReadyStatusSharedWithinSet 	= Yes
	End

    ArmorSet
        Conditions       = None
        Armor            = WeakHeroArmor
        DamageFX         = FellBeastDamageFX
    End

    VisionRange         = VISION_FLIER
    ShroudClearingRange = SHROUD_CLEAR_FLIER

    DisplayName         = OBJECT:MordorKhamul
    DisplayNameStrategic = OBJECT:MordorKhamul
    RecruitText         = CONTROLBAR:MordorKhamulRecruit
    ReviveText          = CONTROLBAR:MordorKhamulRevive
    Hotkey              = CONTROLBAR:MordorKhamulHotkey

    RamPower            = 45
    RamZMult            = 0.5
    CrusherLevel        = 3
    CrushKnockback      = 50
    CrushZFactor        = 1.0
    CommandSet          = KhamulStartFellBeastCommandSet
    CommandPoints       = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_NazgulBody

    AutoResolveWeapon
        Weapon = AutoResolve_NazgulWeapon
    End
    AutoResolveArmor
        Armor = AutoResolve_NazgulArmor
    End




    VoiceAttack                 = FellBeastVoiceAttack
    VoiceAttackCharge           = FellBeastVoiceAttack
    VoiceAttackMachine          = FellBeastVoiceAttack
    VoiceAttackStructure        = FellBeastVoiceAttack
    VoiceGuard                  = FellBeastVoiceMove
    VoiceMove                   = FellBeastVoiceMove
    VoicePriority               = 90
    VoiceRetreatToCastle        = FellBeastVoiceMove
    VoiceSelect                 = FellBeastVoiceSelect
    VoiceSelectBattle           = FellBeastVoiceSelect

    SoundImpact                    = ImpactHorse

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD


    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = KHAMULDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                   = DYING
        DeathAnimationTime          = 5500
        RespawnAnim                 = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter   = NONE +CASTLE_KEEP
        ButtonImage                 = HIKhamulStart
        RespawnAsTemplate           = GasthausKhamul

        RespawnRules =    AutoSpawn:No           Cost:KHAMULDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
   End


    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = AutoHealBehavior ModuleTag_KhamulHealing
        StartsActive = Yes
        HealingAmount = NAZGUL_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = 15000
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End


     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    FellBeastFunctions
        FollowThroughDistance        =    200
        FollowThroughCheckStep        =    50
        FollowThroughGradient        =    1.0

        GrabTossTimeTrigger            =    2.5
        GrabTossHeightTrigger        =   100.0
        TossFX                = FX_DiebyFalling
        SpecialContactPoints        = Swoop

        AttackPriority = AttackPriority_FellBeast
      End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    =    Terror_Base
        AddEmotion    =    OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf            = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion    =    Alert_Base
        IgnoreVeterancy = Yes
    End


      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 95
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 78
      End
      LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 160
      End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate      = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack  = Yes

    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate        = SpecialAbilityLevelAttack
        UnpackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange            = 1000.0
    End

    Behavior = TransportContain TransportContainModuleTag


        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1

        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No

        ReleaseSnappyness = 0.05

    End

   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellbestieDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
    End

    Behavior = SquishCollide ModuleTag_06

    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_Khamul
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechUnPause
        SpecialPowerTemplate        = SpecialAbilityScreech
        TriggeredBy                 = Upgrade_Level_2
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_Screech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = SpecialAbilityUpdate ModuleTag_ScreechUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End



     Behavior = SpecialPowerModule ModuleTag_KhamulDismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused            = No
        InitiateSound            = FellBeastVoiceMove
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_KhamulDismount
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = GasthausKhamul
         SynchronizeTimerOnSpecialPower     = SpecialAbilityKhamulBlackEasterlingSummon SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime                  = 0
         PreparationTime             = 1
         PackTime                    = 0
         OpacityTarget            = 1
         AwardXPForTriggering        = 0
         IgnoreFacingCheck        = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VasallenEnabler
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        TriggeredBy             = Upgrade_Level_10
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerVasallen
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        OCL                     = OCL_SpawnSchwarzeOstlingeEgg
        TriggerFX               = FX_SummonShagratUruks
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 3.2
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory     = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        TriggeredBy             = Upgrade_Level_4
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = DrohungderNazgulModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapperDrohung
        WeaponSetFlags          = WEAPONSET_HERO_MODE
        WeaponToggleCommandSet  = KhamulStartCommandSet_Drohung
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ShakeFoundationEnabler
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        TriggeredBy               = Upgrade_Level_6
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ShakeFoundationStarter
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ShakeFoundationWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        SpecialWeapon             = KhamulStreikWeapon
        WhichSpecialWeapon        = 3
        StartAbilityRange         = 15.0
        SkipContinue              = Yes
        UnpackTime                = 1400
        PackTime                  = 2433
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ShakeFoundationAutoAbility
        SpecialAbility            = SpecialAbilityDwarvenGloinShakeFoundation
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SpionageEnabler
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        TriggeredBy              = Upgrade_Level_4
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_SpionagePower
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SpionageUpdate
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        SkipContinue             = Yes
        UnpackTime               = 1500
        PreparationTime          = 1
        PersistentPrepTime       = 1000
        PackTime                 = 500
        AwardXPForTriggering     = 0
        StartAbilityRange        = 290
        ApproachRequiresLOS      = Yes
        SpecialWeapon            = KhamulSpionageObjectWeapon
        MustFinishAbility        = Yes
        WhichSpecialWeapon       = 3
        BusyForDuration          = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_SpionageAutoAbility
        SpecialAbility            = SpecialAbilityAvariSpionage
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TributEnabler
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        TriggeredBy               = Upgrade_Level_5
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TributStarter
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TributUpdate
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        StartAbilityRange         = CREATE_A_HERO_STEAL_MONEY_DO_POWER_RANGE
        ApproachRequiresLOS       = Yes
        SpecialWeapon             = KhamulTributWeapon
        WhichSpecialWeapon        = 3
    End

    Behavior = AutoAbilityBehavior ModuleTag_TributAutoAbility
        SpecialAbility            = SpecialAbilityCreateAHeroStealMoney_Level2
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Level_4
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility   = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus  = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 FIRST_AGE_VALARS_SILMARIL_OBJECTFILTER ENEMIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ToggleMountedWitchkingSauronsDienerEnabler
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
    End

    Behavior = SpecialPowerModule ModuleTag_ToggleMountedWitchkingSauronsDienerStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ToggleMountedWitchkingSauronsDiener
         SpecialPowerTemplate        = SpecialAbilityToggleMountedWitchkingSauronsDiener
         MountedTemplate             = GasthausKhamulSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime                  = OBJECT_TOGGLE_TIME
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeEnthuellung
        TriggeredBy                     = Upgrade_InsignienStatthalter
        GetUpgradeCommandButtonName     = Command_KhamulSauronsDienerButton
    End






    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange       = 300
        DetectionRate        = 700
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulSauronsDienerButton
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_BlackRiderMorgulBlade_Khamul
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    FormationPreviewDecal
            Texture = FPflyingUnitDecal
            Width = 128
            Height = 128
    End

    Scale 		= 1.04
    Geometry            = CYLINDER
    GeometryMajorRadius = 39.0
    GeometryHeight      = 40.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
End

Object GasthausKhamulSpell

    SelectPortrait  = HPKhamulMovie
    ButtonImage     = HIKhamulMovie

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WitchKing

     EquivalentTo = GasthausKhamul

    Draw = W3DHordeModelDraw ModuleTag_01

        DefaultModelConditionState
            Model            = mukhamul_skn
            Texture          = MUBlkRiderH.tga mukhamul.tga
        End

        ModelConditionState = MOUNTED
            Model           = mukhamul_hrs
            Texture         = MUBlkRiderH.tga mukhamul.tga
        End

        IdleAnimationState
            StateName                = Idle
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLB
                AnimationPriority    = 4
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLC
                AnimationPriority    = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_IDLD
                AnimationPriority = 1
                AnimationBlendTime    = 15
                AnimationMode       = ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") end
            EndScript
        End





        AnimationState        = PASSENGER MOUNTED
            Animation           = grabbed
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GBDA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = FREEFALL MOUNTED
            Animation           = freefall
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING MOUNTED
            Animation           = JustDie
                AnimationName       = MUBlkRider_SKL.MUBlkRider_FLYB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    splatted
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED DYING
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH MOUNTED
            Animation
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_MFDA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    10
                Distance            =    80
            End
        End

        AnimationState                = DYING MOUNTED
            Animation
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DIEA
                AnimationMode       = ONCE
            End
            Animation
                AnimationName        = MUBlkRider_SKL.MUBlkRider_DIEC
                AnimationMode        = ONCE
            End
        End

        AnimationState        = STUNNED_STANDING_UP MOUNTED
            Animation           = StandUp
                AnimationName       = MUBlkRider_SKL.MUBlkRider_GTPA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED MOUNTED
            Animation           = Land
                AnimationName       = MUBlkRider_SKL.MUBlkRider_LNDA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            ShareAnimation        = Yes
            Animation           = TrotAndFire
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATRA
                AnimationMode       = LOOP
                Distance            = 70
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End


        AnimationState                = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode        = LOOP
            End
        End
        AnimationState                = MOVING EMOTION_TERROR MOUNTED
            Animation                = RUNB
                AnimationName        = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState        = MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState        = MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= .8 .8
            End
        End

        AnimationState            = MOVING ACCELERATE MOUNTED
            Animation           = Accelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_ACCL
                AnimationMode   = ONCE
            End
        End

        AnimationState            = MOVING DECELERATE MOUNTED
            Animation           = Decelerate
                AnimationName   = MUBlkRider_SKL.MUBlkRider_DECL
                AnimationMode   = ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState        = MOVING MOUNTED
            ShareAnimation        = Yes
            Animation           = RunA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNA
                AnimationMode       = LOOP
            End
            Animation           = RunB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_RUNB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = FIRING_OR_PREATTACK_A MOUNTED
            Animation           = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKA
                AnimationMode       = ONCE
            End
            Animation           = ATKB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_ATKB
                AnimationMode       = ONCE
            End
            Animation           = Defend
                AnimationName       = MUBlkRider_SKL.MUBlkRider_DFDA
                AnimationMode       = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = SPECIAL_WEAPON_ONE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCB
                AnimationMode       = ONCE
            End
        End

        AnimationState        = SPECIAL_WEAPON_TWO MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode       = ONCE
            End
        End

        AnimationState        = SPECIAL_WEAPON_THREE MOUNTED
            Animation             = ATKA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode       = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1 MOUNTED
            Animation = Hit_Level_1_a
                AnimationName = MUBlkRider_SKL.MUBlkRider_HFMA
                AnimationMode = ONCE
            End
        End

        AnimationState                    = EMOTION_TAUNTING MOUNTED
            ShareAnimation                = Yes
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTB
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = MUBlkRider_SKL.MUBlkRider_TNTC
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = MUBlkRider_SKL.MUBlkRider_PNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG MOUNTED
            ShareAnimation                = Yes
            Animation                    = CHRA
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Animation                    = CHRB
                AnimationName            = MUBlkRider_SKL.MUBlkRider_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange        = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = MOUNTED USER_1
            Animation
                AnimationName            = MUBlkRider_SKL.MUBlkRider_SPCC
                AnimationMode = LOOP
            End
            Flags             = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    SELECTED MOUNTED
            StateName                =    State_Selected
            Animation                =    AtAttention
                AnimationName        =    MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode        =    Loop
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState = MOUNTED
            StateName                = Idle
            Animation                = IdleA
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLA
                AnimationPriority   = 20
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleB
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLB
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleC
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLC
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Animation           = IdleG
                AnimationName       = MUBlkRider_SKL.MUBlkRider_IDLG
                AnimationMode       = ONCE
                AnimationBlendTime  = 15
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End


        TransitionState                    =    TRANS_Selected_to_Idle
            Animation                    =    ATNA
                AnimationName            =    MUBlkRider_SKL.MUBlkRider_ATNA
                AnimationMode            =    ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Flags                        = START_FRAME_LAST
        End






        AnimationState        =  SPECIAL_WEAPON_ONE
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCB
                AnimationMode = ONCE
            End
        End

        AnimationState        =  SPECIAL_WEAPON_TWO
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCA
                AnimationMode = ONCE
            End
        End

        AnimationState        =  SPECIAL_WEAPON_THREE
            Animation           = ATKB
                AnimationName = MUNazgul_SKL.MUNazgul_SPCC
                AnimationMode = ONCE
            End
        End

        AnimationState                    = USER_1
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_SPCC
                AnimationMode = LOOP
            End
            Flags             = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End


        AnimationState = DYING
            Animation
                AnimationName       = MUNazgul_SKL.MUNazgul_DTHA
                AnimationMode       = ONCE
            End
        End

        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    MUNazgul_SKL.MUNazgul_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

        AnimationState = FREEFALL
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_GTPA
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNB
                AnimationMode = LOOP
            End

            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATKB
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_RUNA
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = MUNazgul_SKL.MUNazgul_LVLA
                AnimationMode = ONCE
            End
        End

        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = MUNazgul_SKL.MUNazgul_TNTA
                AnimationMode                    = ONCE
                AnimationSpeedFactorRange        = 0.8 1.2
            End
        End

        AnimationState = RAISING_FLAG
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_CHRA
                AnimationMode = LOOP
            End
        End

        AnimationState = SELECTED
            Animation
                AnimationName = MUNazgul_SKL.MUNazgul_ATNB
                AnimationMode = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

    TransitionState = TRANS_Idle_to_Selected
        Animation = ATNA
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNA
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End

    TransitionState = TRANS_Selected_to_Idle
        Animation = ATNF
            AnimationName        = MUNazgul_SKL.MUNazgul_ATNC
            AnimationMode        = ONCE
            AnimationBlendTime    = 10
        End
    End

    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING MOUNTED
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE MOUNTED
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING MOUNTED
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = None
            ParticleSysBone = None BlackRiderFlare FXTrigger:NONE Persist:SPAWN PersistID:100
        End
    End


    Side                   = Mordor
    EditorSorting          = UNIT
    ThreatLevel            = BLACKRIDER_THREAT_LEVEL
    TransportSlotCount     = TRANSPORTSLOTCOUNT_HERO
    MaxSimultaneousOfType  = 1
    BountyValue            = 1300
    DisplayName            = OBJECT:MordorKhamul
    DisplayNameStrategic   = OBJECT:MordorKhamul
    RecruitText            = CONTROLBAR:MordorKhamulRecruit
    ReviveText             = CONTROLBAR:MordorKhamulRevive
    Hotkey                 = CONTROLBAR:MordorKhamulHotkey
    CommandSet             = KhamulSpellCommandSet
    CommandPoints          = 0
    DisplayMeleeDamage     = STRONG_HERO_DAMAGE
    BuildCost              = KHAMULDAG_COST
    BuildTime              = MEDIUM_HERO_BUILDTIME

    ShroudClearingRange    = 320
    VisionRange            = 190
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot    = 2.0%

    CrushableLevel            = 2
	CrusherLevel			  = 0

    MountedCrusherLevel       = 1
    MountedCrushableLevel     = 2
    CrushWeapon               = HKundKhamulUnenthulltCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    RamPower            = 30
    RamZMult            = 0.5
	
	CrushKnockback = 40
    CrushZFactor = 1.0

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    KhamulSwordSpell
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    KhamulSwordSpell
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = HIDDEN
        Weapon            = PRIMARY    KhamulSwordLeech
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = WraithDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = StrongHeroArmorMounted
        DamageFX        = WraithDamageFX
    End



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WitchKingBody

    AutoResolveArmor
        Armor = AutoResolve_NazgulArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_NazgulWeapon
    End





    VoiceAttack                  = KhamulVoiceAttack
    VoiceAttackCharge            = KhamulVoiceAttack
    VoiceAttackMachine           = KhamulVoiceAttack
    VoiceAttackStructure         = KhamulVoiceAttack
    VoiceGuard                   = RinggeistVoiceMove
    VoiceMove                    = RinggeistVoiceMove
    VoicePriority                = 90
    VoiceRetreatToCastle         = RinggeistVoiceMove
    VoiceSelect                  = KhamulVoiceSelect
    VoiceSelectBattle            = KhamulVoiceSelect

    SoundImpact                  = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip  = KhamulVoiceSelect
        VoiceEnterUnitMordorMumakil         = KhamulVoiceSelect
        VoiceEnterUnitSlaughterHouse        = KhamulVoiceSelect
        VoiceGarrison                       = KhamulVoiceSelect
        VoiceInitiateCaptureBuilding        = KhamulVoiceSelect
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove             = RinggeisterVoiceMove
            VoiceSelect           = KhamulVoiceSelect
        End
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner             = NazgulDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound:FootstepDirtA                Animation:MUBLKRIDER_SKL.MUBLKRIDER_CHRA    Frames:26 38

        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_ACCL    Frames:8 30
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_RUNB    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TNR1    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNL    Frames:0
        AnimationSound = Sound:HorseMoveFootstepsLoose        Animation:MUBlkRider_SKL.MUBlkRider_TRNR    Frames:0
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:0

        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:0

        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_IDLC    Frames:9
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_TNTB    Frames:9
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEA    Frames:10 46
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:20 43
        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:MUBlkRider_SKL.MUBlkRider_DIEC    Frames:70
        AnimationSound = Sound:BodyFallGeneric1                Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:3 11
        AnimationSound = Sound:HorseWhinny                    Animation:MUBlkRider_SKL.MUBlkRider_LNDA    Frames:0
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Cavalry Knight
    End



    RadarPriority = UNIT
    ThingClass = CAVALRY_UNIT

    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE HERO GRAB_AND_DROP ARMY_SUMMARY HEAVY_MELEE_HITTER

    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = KHAMULDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 5500
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 2000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIKhamulStart
        RespawnAsTemplate          = GasthausKhamul

        RespawnRules =    AutoSpawn:No           Cost:KHAMULDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
   End

    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableHK
        UpgradeToGrant              = Upgrade_InsignienStatthalterArrive
        GiveOnBuildComplete         = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
        End

    Behavior = AutoHealBehavior ModuleTag_KhamulHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        AILuaEventsList             = EvilMenBlackRiderFunctions
    End

    LocomotorSet
        Locomotor = NazgulLocomotor
        Condition = SET_NORMAL
        Speed     = 54
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_MOUNTED
        Speed     = 110
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime = 2533
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End

    Behavior = SlowDeathBehavior ModuleTag_08

        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.80
        DestructionDelay = 12000

        Sound = INITIAL RinggeistVoiceDie
    End

      Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2000
        HitReactionLifeTimer2 = 2000
        HitReactionLifeTimer3 = 2000

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    =    Terror_Base
        AddEmotion    =    OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf            = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion    =    Alert_Base
        IgnoreVeterancy = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End





    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_Khamul
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechUnPause
        SpecialPowerTemplate        = SpecialAbilityScreech
        TriggeredBy                 = Upgrade_Level_2
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_Screech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = SpecialAbilityUpdate ModuleTag_ScreechUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End







     Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes

         StartsPaused = No
     End

     Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseTogglePferd
         SpecialPowerTemplate    = SpecialAbilityToggleMounted



         UnpackTime              = 2000
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = 2000

         OpacityTarget            = .3

         AwardXPForTriggering    = 0
     End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderHorseToggle
        SpecialPowerTemplate = SpecialAbilityToggleMountedonFellbeast
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulHorseToggle
        SpecialPowerTemplate        = SpecialAbilityToggleMountedonFellbeast
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = FellBeastVoiceAttack
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggleFellbeast
         SpecialPowerTemplate    = SpecialAbilityToggleMountedonFellbeast
         MountedTemplate         = GasthausKhamulonFellBeastSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityKhamulBlackEasterlingSummon SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime              = 1000
         PreparationTime         = 0
         PackTime                = 0
         OpacityTarget           = .0
         AwardXPForTriggering    = 0
         IgnoreFacingCheck       = Yes
    End






    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = KhamulsPrasenzRadiusWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory     = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        TriggeredBy             = Upgrade_Level_4
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = DrohungderNazgulModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapperDrohung
        WeaponSetFlags          = WEAPONSET_HERO_MODE
        WeaponToggleCommandSet  = KhamulSpellCommandSet_Zugriff
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerderbnisEnabler
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        TriggeredBy               = Upgrade_Level_6
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_VerderbnisStarter
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_VerderbnisWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        SpecialWeapon             = KhamulVerderbenWeapon
        WhichSpecialWeapon        = 3
        StartAbilityRange         = 15.0
        SkipContinue              = Yes
        UnpackTime                = 1400
        PackTime                  = 2433
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_VerderbenAutoAbility
        SpecialAbility            = SpecialAbilityDwarvenGloinShakeFoundation
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End



	Behavior = AttributeModifierAuraUpdate ModuleTag_OrcsLeadership
		StartsActive		= Yes
		BonusName           = MordorSauronLeadership3
        RefreshDelay        = 2000
        Range               = 99999
        ObjectFilter        = ANY +DolguldurOrkHorde +DolguldurOrk +DolguldurOrkHordeShieldWall +MordorDolGuldurBannerOrc +DolguldurOrkHorde_Summoned +DolguldurOrk_Summoned +DolguldurArcherHorde +DolguldurArcher +MordorAufseherGuldurOrkHordeComboHorde ALLIES
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FledermauseEnabler
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        TriggeredBy              = Upgrade_Level_4
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_FledermausePower
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FledermauseUpdate
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        SkipContinue             = Yes
        UnpackTime               = 1500
        PreparationTime          = 1
        PersistentPrepTime       = 1000
        PackTime                 = 500
        AwardXPForTriggering     = 0
        StartAbilityRange        = 290
        ApproachRequiresLOS      = Yes
        SpecialWeapon            = FledermauseKhamulObjectWeapon
        MustFinishAbility        = Yes
        WhichSpecialWeapon       = 3
        BusyForDuration          = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_SpionageAutoAbility
        SpecialAbility            = SpecialAbilityAvariSpionage
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TributEnabler
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        TriggeredBy               = Upgrade_Level_5
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TributStarter
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TributUpdate
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        StartAbilityRange         = CREATE_A_HERO_STEAL_MONEY_DO_POWER_RANGE
        ApproachRequiresLOS       = Yes
        SpecialWeapon             = KhamulTributWeapon
        WhichSpecialWeapon        = 3
    End

    Behavior = AutoAbilityBehavior ModuleTag_TributAutoAbility
        SpecialAbility            = SpecialAbilityCreateAHeroStealMoney_Level2
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Level_4
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 FIRST_AGE_VALARS_SILMARIL_OBJECTFILTER ENEMIES
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VasallenEnabler
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        TriggeredBy             = Upgrade_Level_10
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerVasallen
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        OCL                     = OCL_SpawnSchwarzeOstlingeEgg
        TriggerFX               = FX_SummonShagratUruks
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 3.2
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper
        WeaponSetFlags            = MOUNTED
        WeaponToggleCommandSet    = KhamulSpellMountedCommandSet
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulSauronsDienerButton
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_BlackRiderMorgulBlade_Khamul
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Scale 		= 1.04
    Geometry            = CYLINDER
    GeometryMajorRadius = 16.0
    GeometryHeight      = 25.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 30
    ShadowSizeY         = 21
    ShadowTexture       = ShadowI
End



Object GasthausKhamulonFellBeastSpell


    SelectPortrait    = HPKhamulMovie
    ButtonImage       = HIKhamulMovie

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_FellBeast

    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

     EquivalentTo = GasthausKhamul

    Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone = B_PASSENGER

        DefaultModelConditionState
            Model = mukhamul_flb
            WeaponLaunchBone = PRIMARY BAT_TOER1
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                 AnimationSpeedFactorRange = 0.95 1.05
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
               if CurDrawableIsCurrentTargetKindof("GRAB_AND_DROP")
               then
               CurDrawableSetTransitionAnimState("Trans_Begin_Attacking")
               end
            EndScript
        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End



        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.95 1.05
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
      End

        AnimationState = ACCELERATE
            StateName = Accelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
            BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
            EndScript
        End

        AnimationState = DECELERATE
            StateName = decelerate
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = LOOP_BACKWARDS
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.9 1.1
            End
        End

        TransitionState = Trans_Begin_Moving
            Animation = Transition
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                AnimationMode = ONCE
                AnimationBlendTime = 6
           End
        End



        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIEO
                AnimationMode = ONCE
                AnimationBlendTime = 8
            End
        End

    AnimationState = DYING
    Animation = DyingA
      AnimationName = CUFellBst_SKL.CUFellBst_DIEN
        AnimationMode = ONCE
        AnimationBlendTime = 3
        AnimationSpeedFactorRange = 1.0 1.5
      End
      StateName = DYING
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Idle"       then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Moving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "decelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Accelerate" then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Climbing"  then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Diving"    then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "backup"   then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Claw"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
        if Prev == "Grab"     then CurDrawableSetTransitionAnimState("Trans_Dying") return end
      EndScript
        End

        TransitionState = Trans_Dying
            Animation = Transition
        AnimationName = CUFellBst_SKL.CUFellBst_DIEM
        AnimationMode = ONCE
        AnimationBlendTime = 5
      End
    End

End


    Side                = Mordor
    EditorSorting        = UNIT
    ThreatLevel            = FELL_BEAST_THREAT_LEVEL
    ThingClass            = LARGE_MONSTER
    TransportSlotCount    = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    DisplayMeleeDamage = MEDIUM_HERO_DAMAGE
    BuildCost            = KHAMULDAG_COST
    BuildTime            = MEDIUM_HERO_BUILDTIME

	WeaponSet
		Weapon				= PRIMARY	NazgulPlowAttack
		PreferredAgainst		= PRIMARY	STRUCTURE MACHINE HORDE
		Weapon				= SECONDARY	NazgulGrabAttack
		PreferredAgainst		= SECONDARY	INFANTRY THROWN_OBJECT CAVALRY
		Weapon				= TERTIARY	NazgulClawAttack
		OnlyAgainst			= TERTIARY	MONSTER
		ReadyStatusSharedWithinSet 	= Yes
	End

    ArmorSet
        Conditions       = None
        Armor            = MediumHeroArmor
        DamageFX         = FellBeastDamageFX
    End

    VisionRange            = VISION_FLIER
    ShroudClearingRange = SHROUD_CLEAR_FLIER

    DisplayName        = OBJECT:MordorKhamul
    DisplayNameStrategic        = OBJECT:MordorKhamul
    RecruitText        = CONTROLBAR:MordorKhamulRecruit
    ReviveText        = CONTROLBAR:MordorKhamulRevive
    Hotkey            = CONTROLBAR:MordorKhamulHotkey

    RamPower            = 45
    RamZMult            = 0.5
    CrusherLevel        = 3
    CrushKnockback        = 50
    CrushZFactor        = 1.0
    CommandSet            = KhamulSpellFellBeastCommandSet
    CommandPoints        = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_NazgulBody

    AutoResolveWeapon
        Weapon = AutoResolve_NazgulWeapon
    End
    AutoResolveArmor
        Armor = AutoResolve_NazgulArmor
    End







    VoiceAttack                    = FellBeastVoiceAttack
    VoiceAttackCharge            = FellBeastVoiceAttack
    VoiceAttackMachine            = FellBeastVoiceAttack
    VoiceAttackStructure        = FellBeastVoiceAttack
    VoiceGuard                    = FellBeastVoiceMove
    VoiceMove                    = FellBeastVoiceMove
    VoicePriority                = 90
    VoiceRetreatToCastle        = FellBeastVoiceMove
    VoiceSelect                    = FellBeastVoiceSelect
    VoiceSelectBattle             = FellBeastVoiceSelect

    SoundImpact                    = ImpactHorse





    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5

        AnimationSound = Sound: FellBeastEagleAttack    Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10

        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt        Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10

        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps    Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103








    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD


    Body = RespawnBody ModuleTag_02
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = KHAMULDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        BurningDeathBehavior        = Yes
        BurningDeathFX              = FX_InfantryBurningFlame
		DodgePercent        = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                = DYING
        DeathAnimationTime        = 5500
        RespawnAnim            = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                = HIKhamulStart
        RespawnAsTemplate            = GasthausKhamul

        RespawnRules =    AutoSpawn:No           Cost:KHAMULDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
    End



    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End

    Behavior = AutoHealBehavior ModuleTag_KhamulHealing
        StartsActive = Yes
        HealingAmount = NAZGUL_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = 15000
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End



     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    FellBeastFunctions
        FollowThroughDistance        =    200
        FollowThroughCheckStep        =    50
        FollowThroughGradient        =    1.0

        GrabTossTimeTrigger            =    2.5
        GrabTossHeightTrigger        =   100.0
        TossFX                = FX_DiebyFalling
        SpecialContactPoints        = Swoop

        AttackPriority = AttackPriority_FellBeast
      End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    =    Terror_Base
        AddEmotion    =    OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf            = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion    =    Alert_Base
        IgnoreVeterancy = Yes
    End









      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 95
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
      End
      LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 78
      End
      LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 160
      End

    Behavior = PhysicsBehavior ModuleTag_04


    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate      = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack  = Yes

    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate        = SpecialAbilityLevelAttack
        UnpackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange            = 1000.0
    End

    Behavior = TransportContain TransportContainModuleTag


        ObjectStatusOfContained = UNSELECTABLE UNATTACKABLE
        PassengerFilter = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots = 1

        ShowPips = No
        CollidePickup = No
        AllowEnemiesInside = Yes
        AllowNeutralInside = Yes
        AllowAlliesInside  = Yes
        DamagePercentToUnits = 0%
        PassengerBonePrefix = PassengerBone:B_PASSENGER       KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath = No

        GrabWeapon = FellbeastGrabWeapon
        FireGrabWeaponOnVictim = No

        ReleaseSnappyness = 0.05

    End

   Behavior = GiantBirdSlowDeathBehavior ModuleTag_GiantBirdSlowDeath
       DeathTypes                   = ALL
       SinkDelay                    = 10000
       SinkRate                     = 1.0
       DestructionDelay             = 20000
       Sound                        = INITIAL FellBeastDie
       Weapon                       = HIT_GROUND FlyingUnitDeathWarhead
       FX                           = HIT_GROUND FX_TrebuchetImpactHit
       Sound                        = HIT_GROUND FellBeastDieImpact
       CrashAvoidKindOfs            = STRUCTURE
       CrashAvoidRadius             = CRASH_AVOID_RADIUS
       CrashAvoidStrength           = 0.2
       NeedToMaintainFlailingHeight = No
    End

    Behavior = SquishCollide ModuleTag_06
    End


    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_Khamul
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScreechUnPause
        SpecialPowerTemplate        = SpecialAbilityScreech
        TriggeredBy                 = Upgrade_Level_2
        ObeyRechageOnTrigger        = Yes
    End
    Behavior = SpecialPowerModule ModuleTag_Screech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End
    Behavior = SpecialAbilityUpdate ModuleTag_ScreechUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End




     Behavior = SpecialPowerModule ModuleTag_KhamulDismountStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         UpdateModuleStartsAttack    = Yes
         StartsPaused            = No
        InitiateSound            = FellBeastVoiceMove
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_KhamulDismount
         SpecialPowerTemplate        = SpecialAbilityToggleMountedFromFellBeast
         StartAbilityRange        = 50.0
         MountedTemplate            = GasthausKhamulSpell
         SynchronizeTimerOnSpecialPower = SpecialAbilityKhamulBlackEasterlingSummon SpecialAbilityScreech SpecialAbilityAragornBladeMaster SpecialAbilityDwarvenGloinShakeFoundation SpecialAbilityAvariSpionage SpecialAbilityCreateAHeroStealMoney_Level2
         UnpackTime                  = 0
         PreparationTime             = 1

         PackTime                    = 0
         OpacityTarget            = 1
         AwardXPForTriggering        = 0
         IgnoreFacingCheck        = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VasallenEnabler
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        TriggeredBy             = Upgrade_Level_10
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerVasallen
        SpecialPowerTemplate    = SpecialAbilityKhamulBlackEasterlingSummon
        OCL                     = OCL_SpawnSchwarzeOstlingeEgg
        TriggerFX               = FX_SummonShagratUruks
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 3.2
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory     = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End


    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        TriggeredBy             = Upgrade_Level_4
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = DrohungderNazgulModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapperDrohung
        WeaponSetFlags          = WEAPONSET_HERO_MODE
        WeaponToggleCommandSet  = KhamulSpellCommandSet_Zugriff
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ShakeFoundationEnabler
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        TriggeredBy               = Upgrade_Level_6
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ShakeFoundationStarter
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ShakeFoundationWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityDwarvenGloinShakeFoundation
        SpecialWeapon             = KhamulStreikWeapon
        WhichSpecialWeapon        = 3
        StartAbilityRange         = 15.0
        SkipContinue              = Yes
        UnpackTime                = 1400
        PackTime                  = 2433
        MustFinishAbility         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_ShakeFoundationAutoAbility
        SpecialAbility            = SpecialAbilityDwarvenGloinShakeFoundation
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SpionageEnabler
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        TriggeredBy              = Upgrade_Level_4
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_SpionagePower
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SpionageUpdate
        SpecialPowerTemplate     = SpecialAbilityAvariSpionage
        SkipContinue             = Yes
        UnpackTime               = 1500
        PreparationTime          = 1
        PersistentPrepTime       = 1000
        PackTime                 = 500
        AwardXPForTriggering     = 0
        StartAbilityRange        = 290
        ApproachRequiresLOS      = Yes
        SpecialWeapon            = KhamulSpionageObjectWeapon
        MustFinishAbility        = Yes
        WhichSpecialWeapon       = 3
        BusyForDuration          = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_SpionageAutoAbility
        SpecialAbility            = SpecialAbilityAvariSpionage
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TributEnabler
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        TriggeredBy               = Upgrade_Level_5
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TributStarter
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TributUpdate
        SpecialPowerTemplate      = SpecialAbilityCreateAHeroStealMoney_Level2
        UnpackTime                = 2000
        PackTime                  = 2000
        AwardXPForTriggering      = 0
        StartAbilityRange         = CREATE_A_HERO_STEAL_MONEY_DO_POWER_RANGE
        ApproachRequiresLOS       = Yes
        SpecialWeapon             = KhamulTributWeapon
        WhichSpecialWeapon        = 3
    End

    Behavior = AutoAbilityBehavior ModuleTag_TributAutoAbility
        SpecialAbility            = SpecialAbilityCreateAHeroStealMoney_Level2
        Query                     = 1 ANY ENEMIES +STRUCTURE -UNATTACKABLE
        MaxScanRange              = 100
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Verfall
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        TriggeredBy               = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_VerfallUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Level_4
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility  = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf       = No
        Query           = 1 FIRST_AGE_VALARS_SILMARIL_OBJECTFILTER ENEMIES
    End






    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange       = 300
        DetectionRate        = 700
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_KhamulSauronsDienerButton
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_BlackRiderMorgulBlade_Khamul
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    FormationPreviewDecal
            Texture = FPflyingUnitDecal
            Width = 128
            Height = 128
    End

    Scale 		= 1.04
    Geometry            = CYLINDER
    GeometryMajorRadius = 39.0
    GeometryHeight      = 40.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = No
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 89
End

