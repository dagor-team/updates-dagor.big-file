Object WildBeutewagen



    ButtonImage        = HIBeutewagen_Wotr
    SelectPortrait     = UPBeutewagen

    #include "..\..\..\includes\StunDrawModuleLarge.inc"

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbigbox
        End
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState =  MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState =  MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw DrawSpawnFX
        DefaultModelConditionState
            Model               = None
        End

        ModelConditionState    = USER_2
            Model    = None
            FXEvent  = Frame:0 Name:FX_HordeResurrection
        End
    End

    Draw = W3DTruckDraw ModuleTag_01

        ExtraPublicBone         = PASS01
        ExtraPublicBone         = PASS02

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        DefaultModelConditionState
            Model               = wubeutew_ska
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        ModelConditionState     = DYING
            Model               = wubeutew_ska
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        TrackMarks                  = EXTireTrack2_Temp.tga
        TrackMarksLeftBone          = Wheel_L
        TrackMarksRightBone         = Wheel_R
        LeftRearTireBone            = Wheel_L
        RightRearTireBone           = Wheel_R
        TireRotationMultiplier      = 0.07
        PowerslideRotationAddition  = 1.5


        IdleAnimationState
            Animation            = IDLA
                AnimationName        = DUBtlWagon_IDLA
                AnimationPriority    = 5
            End
            Animation = IDLB
                AnimationName = DUBtlWagon_IDLB
            End
            StateName = Idle
        End

        AnimationState         = DYING DEATH_1
            Animation            = DIEA
                AnimationName      = DUBtlWagon_DIEA
                AnimationMode      = ONCE
                AnimationBlendTime = 0
            End
        End

        AnimationState         = DYING DEATH_2
            Animation            = ByeBye
                AnimationName      = DUBtlWagon_IDLA
                AnimationMode      = LOOP
                AnimationBlendTime = 0
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUBtlWagon_IDLA
                AnimationMode                = LOOP
            End
        End


        ModelConditionState = JUST_BUILT
            Model    =  wubeutew_ska
        End

        AnimationState  = JUST_BUILT
            Animation            = Being_Built
                AnimationName        = DUBtlWagon_BLDA
                AnimationMode        = ONCE
                AnimationBlendTime = 0
            End
        End




        AnimationState            = MOVING TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End

        End

        AnimationState    = MOVING TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState            = TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = MOVING BACKING_UP
            Animation        = BackingUp
                AnimationName        =    DUBtlWagon_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState    = MOVING
            ShareAnimation    = Yes
            Animation            = RUNB
                AnimationName            = DUBtlWagon_RUNA
                AnimationMode            = LOOP
                Distance                = 30
                AnimationBlendTime        = 10
            End
            Flags            = RANDOMSTART
        End

        AnimationState                        = ATTACKING_STRUCTURE FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = EMOTION_CELEBRATING
            Animation
                AnimationName                = DUBtlWagon_CHRA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End
    End









    Side                          = Wild
    EditorSorting                 = UNIT

    ThreatLevel                   = DWARVEN_BATTLEWAGON_THREAT_LEVEL
    ThreatBreakdown DwarvenBattleWagon_DetailedThreat
        AIKindOf = CAVALRY
    End

    ShowHealthInSelectionDecal    = Yes
    TransportSlotCount            = TRANSPORTSLOTCOUNT_MACHINE
    ShockwaveResistance           = 100

    ArmorSet
        Conditions         = None
        Armor              = BattleWagonArmor
    End



    VisionRange            = 300
    ShroudClearingRange    = 450

    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200



    BountyValue                 = 20
    DisplayName                 = OBJECT:WildBeutewagen
    DisplayNameStrategic        = CONTROLBAR:LW_Unit_WildBeutewagen
    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_WildBeutewagen

    CrusherLevel                = 0
    CrushWeapon                 = EntCrush
    UseCrushAttack              = No
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CommandSet                  = WildBeutekarrenCommandSet
    CommandPoints               = 20



    VoiceMove                               = GoblinBuilderVoiceMove
    VoiceMoveToCamp                         = GoblinBuilderVoiceMoveCamp
    VoicePriority                           = 5
    VoiceRetreatToCastle                    = GoblinBuilderVoiceRetreat
    VoiceSelect                             = GoblinBuilderVoiceSelectMS
    VoiceSelectBattle                       = GoblinBuilderVoiceSelectBattle




    UnitSpecificSounds
        VoiceBuildResponse                  = GoblinBuilderVoiceBuild
        VoiceEnterUnitSlaughterHouse        = GoblinBuilderVoiceMoveShip
        VoiceEnterUnitEvilMenTransportShip  = GoblinBuilderVoiceMoveShip
        VoiceExtinguishFireAtLocation       = GoblinBuilderVoiceMove
        VoiceGarrison                       = GoblinBuilderVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = GoblinBuilderVoiceCapture
        VoiceNoBuild                        = GoblinBuilderVoiceNoBuild
        VoiceSelectIdleWorker               = GoblinBuilderVoiceSelectIdle
    End

    SoundAmbient                            = WargAmbienceVOX
    SoundImpact                             = ImpactHorse
    SoundMoveLoop                           = DwarfBattleWagonMoveLoop

    CrowdResponseKey = Goblin

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Goblin Dwarf_BattleWagon Dwarf_Siege
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS ARMY_SUMMARY NOTIFY_OF_PREATTACK MACHINE
    CamouflageDetectionMultiplier = 0.8

    BuildCost = DWARVEN_BATTLEWAGON_BUILDCOST
    BuildTime = STRONG_BUILDTIME

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End


    BuildFadeInOnCreateTime = 6.7

    Body = DelayedDeathBody ModuleTag_02
        CheerRadius             = EMOTION_CHEER_RADIUS
        MaxHealth               = 2000
        MaxHealthDamaged        = 1000
        DoHealthCheck           = No
        DelayedDeathTime        = 5000
        CanRespawn              = No
        ImmortalUntilDeathTime  = No
    End


    Behavior = AutoHealBehavior ModuleTag_BannerCarrierHeal
        StartsActive            = Yes
        HealingAmount           = 30
        HealingDelay            = 1000
        StartHealingDelay       = 2000
        HealOnlyIfNotInCombat   = Yes
    End




    Behavior = AIUpdateInterface ModuleTag_03
        AILuaEventsList            = DwarvenBattleWagonFunctions
        AutoAcquireEnemiesWhenIdle = No
        AttackPriority             = AttackPriority_Cavalry
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior LifetimeUpdate LifetimeTag
        WaitForWakeUp        = Yes
    End


    Behavior = ModelConditionUpgrade ModuleTag_SpawnFX
        TriggeredBy          = Upgrade_BattleWagonAxeThrowers Upgrade_BattleWagonCrossbow Upgrade_BattleWagonBow Upgrade_BattleWagonBannerCarrier
        AddTempConditionFlag = ModelConditionState:USER_2
        TempConditionTime    = 0.01
    End

    LocomotorSet
        Locomotor = BattleWagonLocomotor
        Condition = SET_NORMAL
        Speed     = 65
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes          = ALL -FADED
        SinkDelay           = 5000
        SinkRate            = 2.4
        DestructionDelay    = 6000
        DecayBeginTime      = 2000
        ProbabilityModifier = 10
        DeathFlags          = DEATH_1
        ShadowWhenDead      = Yes
        FX                  = INITIAL FX_PorterDieExplosion
        Sound               = INITIAL GoblinVoxDieMS
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 0
        DestructionDelay = 0
        DeathFlags = DEATH_2
    End


    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1000
        HitReactionThreshold1 = 200.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes

    End







    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnFleisch
       SpecialPowerTemplate          = SpecialAbilityGroﬂerRaubzug
       OCL                           = OCL_WildFleischwagen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnFleischUpdate
        SpecialPowerTemplate         = SpecialAbilityGroﬂerRaubzug
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End






    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnGold
       SpecialPowerTemplate          = SpecialAbilityBannerderOrkhordeKing
       OCL                           = OCL_WildGoldwagen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnGoldUpdate
        SpecialPowerTemplate         = SpecialAbilityBannerderOrkhordeKing
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End






    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnBeute
       SpecialPowerTemplate          = SpecialAbilitySalemeGiftfalleauslegen
       OCL                           = OCL_WildBeutewagen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnBeuteUpdate
        SpecialPowerTemplate         = SpecialAbilitySalemeGiftfalleauslegen
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End








    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    FormationPreviewDecal
            Texture = FPBattleWagonDecal
            Width = 96
            Height = 96
        End

    Scale = 0.9
    Geometry = Box
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 17.0
    GeometryHeight = 44.8
    GeometryOffset = X:5.0 Y:0.0 Z:0.0

    GeometryIsSmall = No
    DeadCollideSize = LARGE

    Shadow = SHADOW_VOLUME_NON_SELF_2
    ShadowSizeX = 36



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_DwarvenBattleWagonBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenBattleWagonArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenBattleWagonWeapon
    End
End


Object WildBeutewagenFleisch



    ButtonImage        = HSBeutewagen
    SelectPortrait     = UPBeutewagen

    #include "..\..\..\includes\StunDrawModuleLarge.inc"

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbigbox
        End
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState =  MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState =  MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw DrawSpawnFX
        DefaultModelConditionState
            Model               = None
        End

        ModelConditionState    = USER_2
            Model    = None
            FXEvent  = Frame:0 Name:FX_HordeResurrection
        End
    End

    Draw = W3DTruckDraw ModuleTag_01

        ExtraPublicBone         = PASS01
        ExtraPublicBone         = PASS02

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        DefaultModelConditionState
            Model               = wubeutew_skd
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        ModelConditionState     = DYING
            Model               = wubeutew_skd
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        TrackMarks                  = EXTireTrack2_Temp.tga
        TrackMarksLeftBone          = Wheel_L
        TrackMarksRightBone         = Wheel_R
        LeftRearTireBone            = Wheel_L
        RightRearTireBone           = Wheel_R
        TireRotationMultiplier      = 0.07
        PowerslideRotationAddition  = 1.5


        IdleAnimationState
            Animation            = IDLA
                AnimationName        = DUBtlWagon_IDLA
                AnimationPriority    = 5
            End
            Animation = IDLB
                AnimationName = DUBtlWagon_IDLB
            End
            StateName = Idle
        End

        AnimationState         = DYING DEATH_1
            Animation            = DIEA
                AnimationName      = DUBtlWagon_DIEA
                AnimationMode      = ONCE
                AnimationBlendTime = 0
            End
        End

        AnimationState         = DYING DEATH_2
            Animation            = ByeBye
                AnimationName      = DUBtlWagon_IDLA
                AnimationMode      = LOOP
                AnimationBlendTime = 0
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUBtlWagon_IDLA
                AnimationMode                = LOOP
            End
        End


        ModelConditionState = JUST_BUILT
            Model    =  wubeutew_ska
        End

        AnimationState  = JUST_BUILT
            Animation            = Being_Built
                AnimationName        = DUBtlWagon_BLDA
                AnimationMode        = ONCE
                AnimationBlendTime = 0
            End
        End




        AnimationState            = MOVING TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End

        End

        AnimationState    = MOVING TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState            = TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = MOVING BACKING_UP
            Animation        = BackingUp
                AnimationName        =    DUBtlWagon_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState    = MOVING
            ShareAnimation    = Yes
            Animation            = RUNB
                AnimationName            = DUBtlWagon_RUNA
                AnimationMode            = LOOP
                Distance                = 30
                AnimationBlendTime        = 10
            End
            Flags            = RANDOMSTART
        End

        AnimationState                        = ATTACKING_STRUCTURE FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = EMOTION_CELEBRATING
            Animation
                AnimationName                = DUBtlWagon_CHRA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End
    End








	EquivalentTo				  = WildBeutewagen
    Side                          = Wild
    EditorSorting                 = UNIT

    ThreatLevel                   = DWARVEN_BATTLEWAGON_THREAT_LEVEL
    ThreatBreakdown DwarvenBattleWagon_DetailedThreat
        AIKindOf = CAVALRY
    End

    ShowHealthInSelectionDecal    = Yes
    TransportSlotCount            = TRANSPORTSLOTCOUNT_MACHINE
    ShockwaveResistance           = SHOCKWAVE_RESISTANCE_IMMUNE

    ArmorSet
        Conditions         = None
        Armor              = BattleWagonArmor
    End



    VisionRange            = 300
    ShroudClearingRange    = 450

    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200



    BountyValue                 = DWARVEN_BATTLEWAGON_BOUNTY_VALUE
    DisplayName                 = OBJECT:WildBeutewagen
    DisplayNameStrategic        = CONTROLBAR:LW_Unit_WildBeutewagen
    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_WildBeutewagen

    CrusherLevel                = 0
    CrushWeapon                 = EntCrush
    UseCrushAttack              = No
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CommandSet                  = WildBeutekarrenCommandSet_Fleisch
    CommandPoints               = 20



    VoiceMove                               = GoblinBuilderVoiceMove
    VoiceMoveToCamp                         = GoblinBuilderVoiceMoveCamp
    VoicePriority                           = 5
    VoiceRetreatToCastle                    = GoblinBuilderVoiceRetreat
    VoiceSelect                             = GoblinBuilderVoiceSelectMS
    VoiceSelectBattle                       = GoblinBuilderVoiceSelectBattle




    UnitSpecificSounds
        VoiceBuildResponse                  = GoblinBuilderVoiceBuild
        VoiceEnterUnitSlaughterHouse        = GoblinBuilderVoiceMoveShip
        VoiceEnterUnitEvilMenTransportShip  = GoblinBuilderVoiceMoveShip
        VoiceExtinguishFireAtLocation       = GoblinBuilderVoiceMove
        VoiceGarrison                       = GoblinBuilderVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = GoblinBuilderVoiceCapture
        VoiceNoBuild                        = GoblinBuilderVoiceNoBuild
        VoiceSelectIdleWorker               = GoblinBuilderVoiceSelectIdle
    End

    SoundAmbient                            = WargAmbienceVOX
    SoundImpact                             = ImpactHorse
    SoundMoveLoop                           = DwarfBattleWagonMoveLoop

    CrowdResponseKey = Goblin

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Goblin Dwarf_BattleWagon Dwarf_Siege
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS ARMY_SUMMARY NOTIFY_OF_PREATTACK MACHINE
    CamouflageDetectionMultiplier = 0.8

    BuildCost = DWARVEN_BATTLEWAGON_BUILDCOST
    BuildTime = STRONG_BUILDTIME

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End


    BuildFadeInOnCreateTime = 6.7

    Body = DelayedDeathBody ModuleTag_02
        CheerRadius             = EMOTION_CHEER_RADIUS
        MaxHealth               = 2700
        MaxHealthDamaged        = 1300
        DoHealthCheck           = No
        DelayedDeathTime        = 5000
        CanRespawn              = No
        ImmortalUntilDeathTime  = No
    End


    Behavior = AutoHealBehavior ModuleTag_BannerCarrierHeal
        StartsActive            = Yes
        HealingAmount           = 30
        HealingDelay            = 1000
        StartHealingDelay       = 2000
        HealOnlyIfNotInCombat   = Yes
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AILuaEventsList            = DwarvenBattleWagonFunctions
        AutoAcquireEnemiesWhenIdle = No
        AttackPriority             = AttackPriority_Cavalry
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior LifetimeUpdate LifetimeTag
        WaitForWakeUp        = Yes
    End


    LocomotorSet
        Locomotor = BattleWagonLocomotor
        Condition = SET_NORMAL
        Speed     = 65
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes          = ALL -FADED
        SinkDelay           = 5000
        SinkRate            = 2.4
        DestructionDelay    = 6000
        DecayBeginTime      = 2000
        ProbabilityModifier = 10
        DeathFlags          = DEATH_1
        ShadowWhenDead      = Yes
        FX                  = INITIAL FX_PorterDieExplosion
        Sound               = INITIAL GoblinVoxDieMS
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 0
        DestructionDelay = 0
        DeathFlags = DEATH_2
    End


    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1000
        HitReactionThreshold1 = 200.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes

    End



    Behavior = SubObjectsUpgrade Banner_UpgradeStart
        TriggeredBy       = Upgrade_Level_1
        HideSubObjects    = FLEISCH01 FLEISCH02 FLEISCH03
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade1
        TriggeredBy       = Upgrade_Level_2
        ShowSubObjects    = FLEISCH01
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade2
        TriggeredBy       = Upgrade_Level_3
        ShowSubObjects    = FLEISCH01 FLEISCH02
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade3
        TriggeredBy       = Upgrade_Level_4
        ShowSubObjects    = FLEISCH01 FLEISCH02 FLEISCH03
    End







    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnFleischentladen
       SpecialPowerTemplate          = SpecialAbilitySalemeGiftfalleauslegen
       OCL                           = OCL_Fleischentladen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnFleischentladenUpdate
        SpecialPowerTemplate         = SpecialAbilitySalemeGiftfalleauslegen
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    FormationPreviewDecal
            Texture = FPBattleWagonDecal
            Width = 96
            Height = 96
        End

    Scale = 0.9
    Geometry = Box
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 17.0
    GeometryHeight = 44.8
    GeometryOffset = X:5.0 Y:0.0 Z:0.0

    GeometryIsSmall = No
    DeadCollideSize = LARGE

    Shadow = SHADOW_VOLUME_NON_SELF_2
    ShadowSizeX = 36



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_DwarvenBattleWagonBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenBattleWagonArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenBattleWagonWeapon
    End
End


Object WildBeutewagenBeute



    ButtonImage        = HSBeutewagen
    SelectPortrait     = UPBeutewagen

    #include "..\..\..\includes\StunDrawModuleLarge.inc"

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbigbox
        End
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState =  MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState =  MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw DrawSpawnFX
        DefaultModelConditionState
            Model               = None
        End

        ModelConditionState    = USER_2
            Model    = None
            FXEvent  = Frame:0 Name:FX_HordeResurrection
        End
    End

    Draw = W3DTruckDraw ModuleTag_01

        ExtraPublicBone         = PASS01
        ExtraPublicBone         = PASS02

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        DefaultModelConditionState
            Model               = wubeutew_skb
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        ModelConditionState     = DYING
            Model               = wubeutew_skb
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        TrackMarks                  = EXTireTrack2_Temp.tga
        TrackMarksLeftBone          = Wheel_L
        TrackMarksRightBone         = Wheel_R
        LeftRearTireBone            = Wheel_L
        RightRearTireBone           = Wheel_R
        TireRotationMultiplier      = 0.07
        PowerslideRotationAddition  = 1.5


        IdleAnimationState
            Animation            = IDLA
                AnimationName        = DUBtlWagon_IDLA
                AnimationPriority    = 5
            End
            Animation = IDLB
                AnimationName = DUBtlWagon_IDLB
            End
            StateName = Idle
        End

        AnimationState         = DYING DEATH_1
            Animation            = DIEA
                AnimationName      = DUBtlWagon_DIEA
                AnimationMode      = ONCE
                AnimationBlendTime = 0
            End
        End

        AnimationState         = DYING DEATH_2
            Animation            = ByeBye
                AnimationName      = DUBtlWagon_IDLA
                AnimationMode      = LOOP
                AnimationBlendTime = 0
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUBtlWagon_IDLA
                AnimationMode                = LOOP
            End
        End


        ModelConditionState = JUST_BUILT
            Model    =  wubeutew_ska
        End

        AnimationState  = JUST_BUILT
            Animation            = Being_Built
                AnimationName        = DUBtlWagon_BLDA
                AnimationMode        = ONCE
                AnimationBlendTime = 0
            End
        End




        AnimationState            = MOVING TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End

        End

        AnimationState    = MOVING TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState            = TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = MOVING BACKING_UP
            Animation        = BackingUp
                AnimationName        =    DUBtlWagon_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState    = MOVING
            ShareAnimation    = Yes
            Animation            = RUNB
                AnimationName            = DUBtlWagon_RUNA
                AnimationMode            = LOOP
                Distance                = 30
                AnimationBlendTime        = 10
            End
            Flags            = RANDOMSTART
        End

        AnimationState                        = ATTACKING_STRUCTURE FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = EMOTION_CELEBRATING
            Animation
                AnimationName                = DUBtlWagon_CHRA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End
    End








	EquivalentTo				  = WildBeutewagen
    Side                          = Wild
    EditorSorting                 = UNIT

    ThreatLevel                   = DWARVEN_BATTLEWAGON_THREAT_LEVEL
    ThreatBreakdown DwarvenBattleWagon_DetailedThreat
        AIKindOf = CAVALRY
    End

    ShowHealthInSelectionDecal    = Yes
    TransportSlotCount            = TRANSPORTSLOTCOUNT_MACHINE
    ShockwaveResistance           = SHOCKWAVE_RESISTANCE_IMMUNE

    ArmorSet
        Conditions         = None
        Armor              = BattleWagonArmor
    End



    VisionRange            = 300
    ShroudClearingRange    = 450

    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200



    BountyValue                 = DWARVEN_BATTLEWAGON_BOUNTY_VALUE
    DisplayName                 = OBJECT:WildBeutewagen
    DisplayNameStrategic        = CONTROLBAR:LW_Unit_WildBeutewagen
    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_WildBeutewagen

    CrusherLevel                = 0
    CrushWeapon                 = EntCrush
    UseCrushAttack              = No
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CommandSet                  = WildBeutekarrenCommandSet_Beute
    CommandPoints               = 20



    VoiceMove                               = GoblinBuilderVoiceMove
    VoiceMoveToCamp                         = GoblinBuilderVoiceMoveCamp
    VoicePriority                           = 5
    VoiceRetreatToCastle                    = GoblinBuilderVoiceRetreat
    VoiceSelect                             = GoblinBuilderVoiceSelectMS
    VoiceSelectBattle                       = GoblinBuilderVoiceSelectBattle




    UnitSpecificSounds
        VoiceBuildResponse                  = GoblinBuilderVoiceBuild
        VoiceEnterUnitSlaughterHouse        = GoblinBuilderVoiceMoveShip
        VoiceEnterUnitEvilMenTransportShip  = GoblinBuilderVoiceMoveShip
        VoiceExtinguishFireAtLocation       = GoblinBuilderVoiceMove
        VoiceGarrison                       = GoblinBuilderVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = GoblinBuilderVoiceCapture
        VoiceNoBuild                        = GoblinBuilderVoiceNoBuild
        VoiceSelectIdleWorker               = GoblinBuilderVoiceSelectIdle
    End

    SoundAmbient                            = WargAmbienceVOX
    SoundImpact                             = ImpactHorse
    SoundMoveLoop                           = DwarfBattleWagonMoveLoop

    CrowdResponseKey = Goblin

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Goblin Dwarf_BattleWagon Dwarf_Siege
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS ARMY_SUMMARY NOTIFY_OF_PREATTACK MACHINE
    CamouflageDetectionMultiplier = 0.8

    BuildCost = DWARVEN_BATTLEWAGON_BUILDCOST
    BuildTime = STRONG_BUILDTIME

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End


    BuildFadeInOnCreateTime = 6.7

    Body = DelayedDeathBody ModuleTag_02
        CheerRadius             = EMOTION_CHEER_RADIUS
        MaxHealth               = 2700
        MaxHealthDamaged        = 1300
        DoHealthCheck           = No
        DelayedDeathTime        = 5000
        CanRespawn              = No
        ImmortalUntilDeathTime  = No
    End


    Behavior = AutoHealBehavior ModuleTag_BannerCarrierHeal
        StartsActive            = Yes
        HealingAmount           = 30
        HealingDelay            = 1000
        StartHealingDelay       = 2000

        HealOnlyIfNotInCombat   = Yes
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AILuaEventsList            = DwarvenBattleWagonFunctions
        AutoAcquireEnemiesWhenIdle = No
        AttackPriority             = AttackPriority_Cavalry
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior LifetimeUpdate LifetimeTag
        WaitForWakeUp        = Yes
    End


    LocomotorSet
        Locomotor = BattleWagonLocomotor
        Condition = SET_NORMAL
        Speed     = 65
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes          = ALL -FADED
        SinkDelay           = 5000
        SinkRate            = 2.4
        DestructionDelay    = 6000
        DecayBeginTime      = 2000
        ProbabilityModifier = 10
        DeathFlags          = DEATH_1
        ShadowWhenDead      = Yes
        FX                  = INITIAL FX_PorterDieExplosion
        Sound               = INITIAL GoblinVoxDieMS
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 0
        DestructionDelay = 0
        DeathFlags = DEATH_2
    End


    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1000
        HitReactionThreshold1 = 200.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes

    End



    Behavior = SubObjectsUpgrade Banner_UpgradeStart
        TriggeredBy       = Upgrade_Level_1
        HideSubObjects    = BEUTE11 BEUTE12 BEUTE13 BEUTE14 BEUTE21 BEUTE22 BEUTE23 BEUTE24 BEUTE31 BEUTE32 BEUTE33 BEUTE34
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade1
        TriggeredBy       = Upgrade_Level_2
        ShowSubObjects    = BEUTE11 BEUTE12 BEUTE13 BEUTE14
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade2
        TriggeredBy       = Upgrade_Level_3
        ShowSubObjects    = BEUTE11 BEUTE12 BEUTE13 BEUTE14 BEUTE21 BEUTE22 BEUTE23 BEUTE24
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade3
        TriggeredBy       = Upgrade_Level_4
        ShowSubObjects    = BEUTE11 BEUTE12 BEUTE13 BEUTE14 BEUTE21 BEUTE22 BEUTE23 BEUTE24 BEUTE31 BEUTE32 BEUTE33 BEUTE34
    End







    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnBeuteentladen
       SpecialPowerTemplate          = SpecialAbilitySalemeGiftfalleauslegen
       OCL                           = OCL_Beuteentladen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnBeuteentladenUpdate
        SpecialPowerTemplate         = SpecialAbilitySalemeGiftfalleauslegen
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    FormationPreviewDecal
            Texture = FPBattleWagonDecal
            Width = 96
            Height = 96
        End

    Scale = 0.9
    Geometry = Box
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 17.0
    GeometryHeight = 44.8
    GeometryOffset = X:5.0 Y:0.0 Z:0.0

    GeometryIsSmall = No
    DeadCollideSize = LARGE

    Shadow = SHADOW_VOLUME_NON_SELF_2
    ShadowSizeX = 36



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_DwarvenBattleWagonBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenBattleWagonArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenBattleWagonWeapon
    End
End


Object WildBeutewagenGold



    ButtonImage        = HSBeutewagen
    SelectPortrait     = UPBeutewagen

    #include "..\..\..\includes\StunDrawModuleLarge.inc"

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbigbox
        End
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState =  MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState =  MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw DrawSpawnFX
        DefaultModelConditionState
            Model               = None
        End

        ModelConditionState    = USER_2
            Model    = None
            FXEvent  = Frame:0 Name:FX_HordeResurrection
        End
    End

    Draw = W3DTruckDraw ModuleTag_01

        ExtraPublicBone         = PASS01
        ExtraPublicBone         = PASS02

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        DefaultModelConditionState
            Model               = wubeutew_skc
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        ModelConditionState     = DYING
            Model               = wubeutew_skc
            Skeleton            = DUBtlWagon_SKL
            WeaponLaunchBone    = PRIMARY BONE01
        End

        TrackMarks                  = EXTireTrack2_Temp.tga
        TrackMarksLeftBone          = Wheel_L
        TrackMarksRightBone         = Wheel_R
        LeftRearTireBone            = Wheel_L
        RightRearTireBone           = Wheel_R
        TireRotationMultiplier      = 0.07
        PowerslideRotationAddition  = 1.5


        IdleAnimationState
            Animation            = IDLA
                AnimationName        = DUBtlWagon_IDLA
                AnimationPriority    = 5
            End
            Animation = IDLB
                AnimationName = DUBtlWagon_IDLB
            End
            StateName = Idle
        End

        AnimationState         = DYING DEATH_1
            Animation            = DIEA
                AnimationName      = DUBtlWagon_DIEA
                AnimationMode      = ONCE
                AnimationBlendTime = 0
            End
        End

        AnimationState         = DYING DEATH_2
            Animation            = ByeBye
                AnimationName      = DUBtlWagon_IDLA
                AnimationMode      = LOOP
                AnimationBlendTime = 0
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUBtlWagon_IDLA
                AnimationMode                = LOOP
            End
        End


        ModelConditionState = JUST_BUILT
            Model    =  wubeutew_ska
        End

        AnimationState  = JUST_BUILT
            Animation            = Being_Built
                AnimationName        = DUBtlWagon_BLDA
                AnimationMode        = ONCE
                AnimationBlendTime = 0
            End
        End




        AnimationState            = MOVING TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End

        End

        AnimationState    = MOVING TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRA
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState            = TURN_LEFT
            Animation            = Turn
                AnimationName        = DUBtlWagon_TNLB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = TURN_RIGHT
            Animation        = Turn
                AnimationName        = DUBtlWagon_TNRB
                AnimationMode       = LOOP
                AnimationBlendTime  = 10
            End
        End

        AnimationState    = MOVING BACKING_UP
            Animation        = BackingUp
                AnimationName        =    DUBtlWagon_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState    = MOVING
            ShareAnimation    = Yes
            Animation            = RUNB
                AnimationName            = DUBtlWagon_RUNA
                AnimationMode            = LOOP
                Distance                = 30
                AnimationBlendTime        = 10
            End
            Flags            = RANDOMSTART
        End

        AnimationState                        = ATTACKING_STRUCTURE FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATKB
                AnimationName                = DUBtlWagon_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = EMOTION_CELEBRATING
            Animation
                AnimationName                = DUBtlWagon_CHRA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End
    End








	EquivalentTo				  = WildBeutewagen
    Side                          = Wild
    EditorSorting                 = UNIT

    ThreatLevel                   = DWARVEN_BATTLEWAGON_THREAT_LEVEL
    ThreatBreakdown DwarvenBattleWagon_DetailedThreat
        AIKindOf = CAVALRY
    End

    ShowHealthInSelectionDecal    = Yes
    TransportSlotCount            = TRANSPORTSLOTCOUNT_MACHINE
    ShockwaveResistance           = SHOCKWAVE_RESISTANCE_IMMUNE

    ArmorSet
        Conditions         = None
        Armor              = BattleWagonArmor
    End



    VisionRange            = 300
    ShroudClearingRange    = 450

    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200



    BountyValue                 = DWARVEN_BATTLEWAGON_BOUNTY_VALUE
    DisplayName                 = OBJECT:WildBeutewagen
    DisplayNameStrategic        = CONTROLBAR:LW_Unit_WildBeutewagen
    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_WildBeutewagen

    CrusherLevel                = 0
    CrushWeapon                 = EntCrush
    UseCrushAttack              = No
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CommandSet                  = WildBeutekarrenCommandSet_Gold
    CommandPoints               = 20



    VoiceMove                               = GoblinBuilderVoiceMove
    VoiceMoveToCamp                         = GoblinBuilderVoiceMoveCamp
    VoicePriority                           = 5
    VoiceRetreatToCastle                    = GoblinBuilderVoiceRetreat
    VoiceSelect                             = GoblinBuilderVoiceSelectMS
    VoiceSelectBattle                       = GoblinBuilderVoiceSelectBattle




    UnitSpecificSounds
        VoiceBuildResponse                  = GoblinBuilderVoiceBuild
        VoiceEnterUnitSlaughterHouse        = GoblinBuilderVoiceMoveShip
        VoiceEnterUnitEvilMenTransportShip  = GoblinBuilderVoiceMoveShip
        VoiceExtinguishFireAtLocation       = GoblinBuilderVoiceMove
        VoiceGarrison                       = GoblinBuilderVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = GoblinBuilderVoiceCapture
        VoiceNoBuild                        = GoblinBuilderVoiceNoBuild
        VoiceSelectIdleWorker               = GoblinBuilderVoiceSelectIdle
    End

    SoundAmbient                            = WargAmbienceVOX
    SoundImpact                             = ImpactHorse
    SoundMoveLoop                           = DwarfBattleWagonMoveLoop

    CrowdResponseKey = Goblin

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Goblin Dwarf_BattleWagon Dwarf_Siege
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionGoblinCompilationVoxTauntSinglesLoop
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS ARMY_SUMMARY NOTIFY_OF_PREATTACK MACHINE
    CamouflageDetectionMultiplier = 0.8

    BuildCost = DWARVEN_BATTLEWAGON_BUILDCOST
    BuildTime = STRONG_BUILDTIME

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End


    BuildFadeInOnCreateTime = 6.7

    Body = DelayedDeathBody ModuleTag_02
        CheerRadius             = EMOTION_CHEER_RADIUS
        MaxHealth               = 2700
        MaxHealthDamaged        = 1300
        DoHealthCheck           = No
        DelayedDeathTime        = 5000
        CanRespawn              = No
        ImmortalUntilDeathTime  = No
    End


    Behavior = AutoHealBehavior ModuleTag_BannerCarrierHeal
        StartsActive            = Yes
        HealingAmount           = 30
        HealingDelay            = 1000
        StartHealingDelay       = 2000

        HealOnlyIfNotInCombat   = Yes
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AILuaEventsList            = DwarvenBattleWagonFunctions
        AutoAcquireEnemiesWhenIdle = No
        AttackPriority             = AttackPriority_Cavalry
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior LifetimeUpdate LifetimeTag
        WaitForWakeUp        = Yes
    End


    LocomotorSet
        Locomotor = BattleWagonLocomotor
        Condition = SET_NORMAL
        Speed     = 65
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes          = ALL -FADED
        SinkDelay           = 5000
        SinkRate            = 2.4
        DestructionDelay    = 6000
        DecayBeginTime      = 2000
        ProbabilityModifier = 10
        DeathFlags          = DEATH_1
        ShadowWhenDead      = Yes
        FX                  = INITIAL FX_PorterDieExplosion
        Sound               = INITIAL GoblinVoxDieMS
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 0
        DestructionDelay = 0
        DeathFlags = DEATH_2
    End


    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1000
        HitReactionThreshold1 = 200.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes

    End



    Behavior = SubObjectsUpgrade Banner_UpgradeStart
        TriggeredBy       = Upgrade_Level_1
        HideSubObjects    = GOLD01 GOLD02 GOLD03
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade1
        TriggeredBy       = Upgrade_Level_2
        ShowSubObjects    = GOLD01
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade2
        TriggeredBy       = Upgrade_Level_3
        ShowSubObjects    = GOLD01 GOLD02
    End

    Behavior = SubObjectsUpgrade Banner_Upgrade3
        TriggeredBy       = Upgrade_Level_4
        ShowSubObjects    = GOLD01 GOLD02 GOLD03
    End







    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnGoldentladen
       SpecialPowerTemplate          = SpecialAbilitySalemeGiftfalleauslegen
       OCL                           = OCL_Goldentladen
       CreateLocation                = CREATE_AT_LOCATION
       StartsPaused                  = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnGoldentladenUpdate
        SpecialPowerTemplate         = SpecialAbilitySalemeGiftfalleauslegen
        UnpackTime                   = 1
        PreparationTime              = 3
        PackTime                     = 0
        AwardXPForTriggering         = 0
        FreezeAfterTriggerDuration   = 0
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    FormationPreviewDecal
            Texture = FPBattleWagonDecal
            Width = 96
            Height = 96
        End

    Scale = 0.9
    Geometry = Box
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 17.0
    GeometryHeight = 44.8
    GeometryOffset = X:5.0 Y:0.0 Z:0.0

    GeometryIsSmall = No
    DeadCollideSize = LARGE

    Shadow = SHADOW_VOLUME_NON_SELF_2
    ShadowSizeX = 36



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_DwarvenBattleWagonBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenBattleWagonArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenBattleWagonWeapon
    End
End


