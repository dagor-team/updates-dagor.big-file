Object IsengardWormTongue

    ButtonImage    = HIWormtonguenew
    SelectPortrait = HPWormtonguenew

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model                  = IUWrmTng_SKN
            Skeleton               = IUWrmTng_SKL
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:101
        End
        ModelConditionState        = INVISIBLE_STEALTH
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:101
        End





        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = IUWrmTng_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                    = DYING BURNINGDEATH
            Animation
                AnimationName            = IUWrmTng_DTHA
                AnimationMode            = ONCE
                AnimationBlendTime        = 10
            End
        End

        AnimationState                    = BURNINGDEATH
            Animation
                AnimationName            = IUWrmTng_MFDA
                AnimationMode            = LOOP
                Distance                = 100
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDB
                AnimationName     = IUWrmTng_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = IUWrmTng_DTHA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = IUWrmTng_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = IUWrmTng_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUWrmTng_IDLA
                AnimationMode                = LOOP
            End
        End




        AnimationState                =    MOVING ATTACKING
            Animation                =    RUNB
                AnimationName        =    IUWrmTng_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                =    MOVING
            Animation                =    RUNA
                AnimationName        =    IUWrmTng_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End


        AnimationState                = PACKING_TYPE_1
            StateName                = Dominate
            Animation
                AnimationName        = IUWrmTng_SPCE
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanDominateAtSelf
        End


        AnimationState                = PACKING_TYPE_2
            StateName                = Spped_Craft
            Animation
                AnimationName        = IUWrmTng_SPCD
                AnimationMode        = ONCE
            End
            FXEvent    = Frame:15    Name: FX_SpeechCraft
        End


        AnimationState          = SPECIAL_WEAPON_ONE
            Animation
                AnimationName        = IUWrmTng_SPCC
                AnimationMode        = ONCE
                UseWeaponTiming      = Yes
            End
        End

        AnimationState          = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = IUWrmTng_SPCD
                AnimationMode        = ONCE
                UseWeaponTiming      = Yes
            End
        End



        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = IUWrmTng_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName     = IUWrmTng_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKC
                AnimationName     = IUWrmTng_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = IUWrmTng_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = IUWrmTng_LVLA
                AnimationMode        = ONCE
            End
        End


        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRA
                AnimationName   = IUWrmTng_CHRA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState            = EMOTION_TAUNTING
            Animation
                AnimationName   = IUWrmTng_TNTA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                    = EMOTION_ALERT
            Animation                    = Ready
                AnimationName            = IUWrmTng_IDLA
                AnimationMode            = LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript

        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = IUWrmTng_CHRA
                AnimationMode   = LOOP
            End
        End



        AnimationState                =    SELECTED
            StateName                =    AtAttentionIdle
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =     IUWrmTng_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript

                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End



        IdleAnimationState
            StateName                = STATE_Idle
            Animation           = IDLB
                AnimationName     = IUWrmTng_IDLB
                AnimationMode     = ONCE
                AnimationPriority = 30
            End
            Animation           = IDLC
                AnimationName     = IUWrmTng_IDLC
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
            Animation           = IDLD
                AnimationName     = IUWrmTng_IDLD
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
            Animation           = IDLE
                AnimationName     = IUWrmTng_IDLE
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
        End




        TransitionState       = TRANS_SelectedToIdle
            Animation           = ATNC
                AnimationName     = IUWrmTng_ATNC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =     IUWrmTng_ATNA
                AnimationMode        =    ONCE
            End
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Isengard
    EditorSorting = UNIT
    ThreatLevel = WORMTONGUE_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost           = WORMTONGUEDAG_COST
    BuildTime           = WEAK_HERO_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    DisplayMeleeDamage = WORMTONGUEDAG_DAMAGE
    TransportSlotCount = 1
	
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    WormtongueWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
	
    WeaponSet
        Conditions = HIDDEN
    End
	
    ArmorSet
        Conditions      = None
        Armor           = WeakHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = VISION_STANDARD_MELEE
    ShroudClearingRange = SHROUD_CLEAR_HERO

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     = ISENGARD_WORMTONGUE_BOUNTY_VALUE
    DisplayName        = OBJECT:IsengardWormTongue
    RecruitText        = CONTROLBAR:IsengardWormtongueRecruit
    ReviveText        = CONTROLBAR:IsengardWormtongueRevive
    Hotkey            = CONTROLBAR:IsengardWormtongueHotkey
    CrushableLevel    = 2
    CrusherLevel = 0

    CommandSet = WormtongueModCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_WormtongueBody

    AutoResolveArmor
        Armor = AutoResolve_WormtongueArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WormtongueWeapon
    End




    VoiceAttack                          = WormtongueVoiceAttack
    VoiceAttackCharge                    = WormtongueVoiceAttackCharge
    VoiceAttackMachine                   = WormtongueVoiceAttack
    VoiceAttackStructure                 = WormtongueVoiceAttackBuilding
    VoiceFear                            = WormtongueVoiceHelpMe
    VoiceGuard                           = WormtongueVoiceMove
    VoiceCreated                         = CampOrcCreateWormtongue
    VoiceFullyCreated                    = CampOrcCreateWormtongue
    VoiceMove                            = WormtongueVoiceMove
    VoiceMoveToCamp                      = WormtongueVoiceMoveCamp
    VoiceMoveWhileAttacking              = WormtongueVoiceDisengage
    VoicePriority                        = 80
    VoiceRetreatToCastle                 = WormtongueVoiceRetreat
    VoiceSelect                          = WormtongueVoiceSelectMS
    VoiceSelectBattle                    = WormtongueVoiceSelectBattle

    SoundImpact                          = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = WormtongueVoiceMoveShip
        VoiceEnterUnitMordorMumakil            = WormtongueVoiceMoveGarrison
        VoiceEnterUnitSlaughterHouse           = WormtongueVoiceMoveGarrison
        VoiceGarrison                          = WormtongueVoiceMoveGarrison
        VoiceInitiateCaptureBuilding           = WormtongueVoiceCaptureBuilding
    End

    CrowdResponseKey = EvilMen2

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner            = WormTongueDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKB    Frames:39 104
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKC    Frames:43 92
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKD    Frames:13 29 55
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATRA    Frames:9 20 31 43 55 67
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:20
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_DIEB   Frames:34
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_GTPA    Frames:51 75 113 139
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_HITA    Frames:12
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_IDLC    Frames:116 188
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_IDLD    Frames:43
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_LNDA   Frames:4
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_MFDA    Frames:10 19 29 39 48 57 66
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_RUNA    Frames:11 22 34 46 57 69
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_RUNB    Frames:10 23 36 49 62 75
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_TNTA    Frames:36 49 103 123
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_TNTB    Frames:24 111
    End



    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE NOTIFY_OF_PREATTACK ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = 70000
        PermanentlyKilledByFilter   = NONE
        DodgePercent                = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 5500
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIWormtonguenew

        RespawnRules =    AutoSpawn:No           Cost:WORMTONGUEDAG_COST       Time:WEAK_HERO_RESPAWNTIME        Health:100%
   End


    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WormtongueVenomousWordsUnpause
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        TriggeredBy                 = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueVenomousWordsSpecialPower
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_WormtongueVenomousWordsUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        StartAbilityRange           = 300
        TriggerSpecialPower         = ModuleTag_WormtongueVenomousWordsDebuff TARGETPOS
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueVenomousWordsDebuff
        SpecialPowerTemplate        = SpecialAbilityActivateeDummy
        AntiCategory                = LEADERSHIP BUFF
        AttributeModifier           = WormtongueVenomousWordsDebuff
        AttributeModifierRange      = 100.0
        AttributeModifierAffects    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

    Behavior = AutoAbilityBehavior ModuleTag_WormtongueVenomousWordsAutoAbilityBehavior

	SpecialAbility	= SpecialAbilityWormtongueVenomousWords
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 300
	Query		= 15 ALL ENEMIES -STRUCTURE
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WormtongueBackstabUnpause
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        TriggeredBy                 = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueBackstabSpecialPower
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = WormtongueVoiceBackstab
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WormtongueBackstabUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        MustFinishAbility           = Yes
        StartAbilityRange           = WORMTONGUE_WEAPON_RANGE
        SpecialWeapon               = WormtongueBackstab
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WormtongueBackstabAutoAbility
	SpecialAbility		= SpecialAbilityWormtongueBackstab
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= 100

	Query			= 1 ANY ENEMIES +HERO +MONSTER
    End




    Behavior = SpecialPowerModule ModuleTag_ElfCloakStarter
        SpecialPowerTemplate        = SpecialAbilityWormtongueEscape
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_ElfCloakUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueEscape
        EffectDuration              = 15000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = USING_ABILITY
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End


    Behavior = AutoHealBehavior ModuleTag_WormtongueHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        AttackPriority                = AttackPriority_HeroKiller
        BurningDeathTime              = BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_EVIL_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 32
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL WormtongueVoiceDie
        ShadowWhenDead = No
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 3000
        HitReactionThreshold1 = 5.0
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DominateEnabler
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        TriggeredBy                   = Upgrade_Level_9
    End

    Behavior = SpecialPowerModule ModuleTag_DominateEnemySpecialPowerModule
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        StartsPaused                  = Yes
        UpdateModuleStartsAttack      = Yes
    End

     Behavior = DominateEnemySpecialPower ModuleTag_DominateEnemySpecialPower
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        UnpackingVariation            = 1
        StartAbilityRange             = 200.0
        AttributeModifierAffects      = ANY +HERO NOT_FLYING_UNITS -MordorFellBeast -MordorFellBeastInterface -MordorWitchKingOnFellBeast -AngbandMelkor -AngbandMelkor_WOR -AngbandAncalagon -TolinGaurhothTarMairon -TolinGaurhothTarMairon_WOR -AngbandAncalagon_WOR -AvatharUngoliant -AvatharUngoliant_WOR -ValinorManwe -ValinorManwe_WOR -DoriathMelian -DoriathMelian_WOR -ValinorEonwe -ValinorEonwe_WOR -ValinorTulkas -ValinorTulkas_WOR -ValinorAule -ValinorAule_WOR -ValinorOrome -ValinorOrome_Summoned
        DominateRadius                = 60
        DominatedFX                   = FX_WormtongueCorrodeAllegiance
        TriggerFX                     = FX_SarumanDominateTrigger
        UnpackTime                    = 2000
        PreparationTime               = 1
        FreezeAfterTriggerDuration    = 2500
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnterwandernEnabler
        SpecialPowerTemplate = SpecialAbilityUnterwandern
        TriggeredBy = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_UnterwandernPower
        SpecialPowerTemplate        = SpecialAbilityUnterwandern
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = GrimaSpellVoiceUnterwandern
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_UnterwandernUpdate
        SpecialPowerTemplate    = SpecialAbilityUnterwandern
        SkipContinue            = Yes
        UnpackTime              = 1500
        PreparationTime         = 1
        PersistentPrepTime      = 1000
        PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange       = 290
        ApproachRequiresLOS     = Yes
        SpecialWeapon           = SchlangenzungeUnterwandernWeapon
        MustFinishAbility       = Yes
        WhichSpecialWeapon      = 2
        BusyForDuration         = 2500
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = 200
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate EscapeAI
        CommandButtonName = Command_SpecialAbilityWormtongueEscape
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate VenomousWordsAI
        CommandButtonName = Command_SpecialAbilityWormtongueVenomousWords
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_SpecialAbilitySchlangenzungeBackstab
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate UnterwandernAI
	CommandButtonName = Command_SpecialAbilityUnterwandern
	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
	SpecialPowerRadius = 100
    End

    Geometry                 = CYLINDER
    GeometryMajorRadius      = 8.0
    GeometryMinorRadius      = 8.0
    GeometryHeight           = 19.2
    GeometryIsSmall          = Yes
    Shadow                   = SHADOW_DECAL
    ShadowSizeX              = 19
    ShadowSizeY              = 19
    ShadowTexture            = ShadowI
End


Object IsengardWormTongue_Mod


    ButtonImage    = HIWormtonguenew
    SelectPortrait = HPWormtonguenew

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes

        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = IUWrmTng_SKN
            Skeleton            = IUWrmTng_SKL
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:101
        End
        ModelConditionState        = INVISIBLE_STEALTH
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:101
        End



        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = IUWrmTng_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                    = DYING BURNINGDEATH
            Animation
                AnimationName            = IUWrmTng_DTHA
                AnimationMode            = ONCE
                AnimationBlendTime        = 10
            End
        End

        AnimationState                    = BURNINGDEATH
            Animation
                AnimationName            = IUWrmTng_MFDA
                AnimationMode            = LOOP
                Distance                = 100
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDB
                AnimationName     = IUWrmTng_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = IUWrmTng_DTHA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = IUWrmTng_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = IUWrmTng_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUWrmTng_IDLA
                AnimationMode                = LOOP
            End
        End




        AnimationState                =    MOVING ATTACKING
            Animation                =    RUNB
                AnimationName        =    IUWrmTng_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                =    MOVING
            Animation                =    RUNA
                AnimationName        =    IUWrmTng_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End


        AnimationState                = PACKING_TYPE_1
            StateName                = Dominate
            Animation
                AnimationName        = IUWrmTng_SPCE
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanDominateAtSelf
        End


        AnimationState                = PACKING_TYPE_2
            StateName                = Spped_Craft
            Animation
                AnimationName        = IUWrmTng_SPCD
                AnimationMode        = ONCE
            End
            FXEvent    = Frame:15    Name: FX_SpeechCraft
        End


        AnimationState          = SPECIAL_WEAPON_ONE
            Animation
                AnimationName        = IUWrmTng_SPCC
                AnimationMode        = ONCE
                UseWeaponTiming      = Yes
            End
        End

        AnimationState          = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = IUWrmTng_SPCD
                AnimationMode        = ONCE
                UseWeaponTiming      = Yes
            End
        End



        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = IUWrmTng_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName     = IUWrmTng_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKC
                AnimationName     = IUWrmTng_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = IUWrmTng_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = IUWrmTng_LVLA
                AnimationMode        = ONCE
            End
        End


        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRA
                AnimationName   = IUWrmTng_CHRA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState            = EMOTION_TAUNTING
            Animation
                AnimationName   = IUWrmTng_TNTA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                    = EMOTION_ALERT
            Animation                    = Ready
                AnimationName            = IUWrmTng_IDLA
                AnimationMode            = LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript

        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = IUWrmTng_CHRA
                AnimationMode   = LOOP
            End
        End



        AnimationState                =    SELECTED
            StateName                =    AtAttentionIdle
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =     IUWrmTng_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript

                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End



        IdleAnimationState
            StateName                = STATE_Idle
            Animation           = IDLB
                AnimationName     = IUWrmTng_IDLB
                AnimationMode     = ONCE
                AnimationPriority = 30
            End
            Animation           = IDLC
                AnimationName     = IUWrmTng_IDLC
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
            Animation           = IDLD
                AnimationName     = IUWrmTng_IDLD
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
            Animation           = IDLE
                AnimationName     = IUWrmTng_IDLE
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
        End




        TransitionState       = TRANS_SelectedToIdle
            Animation           = ATNC
                AnimationName     = IUWrmTng_ATNC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =     IUWrmTng_ATNA
                AnimationMode        =    ONCE
            End
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Isengard
    EditorSorting = UNIT
    ThreatLevel = WORMTONGUE_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost           = WORMTONGUEDAG_COST
    BuildTime           = WEAK_HERO_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    DisplayMeleeDamage = WEAK_HERO_DAMAGE

    TransportSlotCount = 1
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    WormtongueWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions = HIDDEN
    End
    ArmorSet
        Conditions      = None
        Armor           = MediumHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = VISION_STANDARD_MELEE
    ShroudClearingRange = SHROUD_CLEAR_HERO

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     = ISENGARD_WORMTONGUE_BOUNTY_VALUE
    DisplayName        = OBJECT:IsengardWormTongue
    RecruitText        = CONTROLBAR:IsengardWormtongueRecruit
    ReviveText        = CONTROLBAR:IsengardWormtongueRevive
    Hotkey            = CONTROLBAR:IsengardWormtongueHotkey
    CrushableLevel    = 2
    CrusherLevel = 0

    CommandSet = WormtongueModCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroKillerCombatChain

    AutoResolveBody = AutoResolve_WormtongueBody

    AutoResolveArmor
        Armor = AutoResolve_WormtongueArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_WormtongueWeapon
    End




    VoiceAttack                          = WormtongueVoiceAttack
    VoiceAttackCharge                    = WormtongueVoiceAttackCharge
    VoiceAttackMachine                   = WormtongueVoiceAttack
    VoiceAttackStructure                 = WormtongueVoiceAttackBuilding
    VoiceFear                            = WormtongueVoiceHelpMe
    VoiceGuard                           = WormtongueVoiceMove
    VoiceCreated                         = CampOrcCreateWormtongue
    VoiceFullyCreated                    = CampOrcCreateWormtongue
    VoiceMove                            = WormtongueVoiceMove
    VoiceMoveToCamp                      = WormtongueVoiceMoveCamp
    VoiceMoveWhileAttacking              = WormtongueVoiceDisengage
    VoicePriority                        = 80
    VoiceRetreatToCastle                 = WormtongueVoiceRetreat
    VoiceSelect                          = WormtongueVoiceSelectMS
    VoiceSelectBattle                    = WormtongueVoiceSelectBattle

    SoundImpact                          = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip     = WormtongueVoiceMoveShip
        VoiceEnterUnitMordorMumakil            = WormtongueVoiceMoveGarrison
        VoiceEnterUnitSlaughterHouse           = WormtongueVoiceMoveGarrison
        VoiceGarrison                          = WormtongueVoiceMoveGarrison
        VoiceInitiateCaptureBuilding           = WormtongueVoiceCaptureBuilding
    End

    CrowdResponseKey = EvilMen2

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner            = WormTongueDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKB    Frames:39 104
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKC    Frames:43 92
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATKD    Frames:13 29 55
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_ATRA    Frames:9 20 31 43 55 67
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:20
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_DIEB   Frames:34
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_GTPA    Frames:51 75 113 139
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_HITA    Frames:12
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_IDLC    Frames:116 188
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_IDLD    Frames:43
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_LNDA   Frames:4
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_MFDA    Frames:10 19 29 39 48 57 66
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_RUNA    Frames:11 22 34 46 57 69
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_RUNB    Frames:10 23 36 49 62 75
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_TNTA    Frames:36 49 103 123
        AnimationSound = Sound:FootstepDirtA            Animation:IUSaruman_SKL.IUSaruman_TNTB    Frames:24 111
    End



    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE NOTIFY_OF_PREATTACK ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                 = EMOTION_CHEER_RADIUS
        MaxHealth                   = WORMTONGUEDAG_HEALTH
        PermanentlyKilledByFilter   = NONE
        DodgePercent                = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 5500
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIWormtonguenew

        RespawnRules =    AutoSpawn:No           Cost:WORMTONGUEDAG_COST       Time:WEAK_HERO_RESPAWNTIME        Health:100%
   End


    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WormtongueVenomousWordsUnpause
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        TriggeredBy                 = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueVenomousWordsSpecialPower
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_WormtongueVenomousWordsUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueVenomousWords
        StartAbilityRange           = 300
        TriggerSpecialPower         = ModuleTag_WormtongueVenomousWordsDebuff TARGETPOS
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueVenomousWordsDebuff
        SpecialPowerTemplate        = SpecialAbilityActivateeDummy
        AntiCategory                = LEADERSHIP BUFF
        AttributeModifier           = WormtongueVenomousWordsDebuff
        AttributeModifierRange      = 100.0
        AttributeModifierAffects    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

    Behavior = AutoAbilityBehavior ModuleTag_WormtongueVenomousWordsAutoAbilityBehavior

	SpecialAbility	= SpecialAbilityWormtongueVenomousWords
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 300
	Query		= 15 ALL ENEMIES -STRUCTURE
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WormtongueBackstabUnpause
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        TriggeredBy                 = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_WormtongueBackstabSpecialPower
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = WormtongueVoiceBackstab
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WormtongueBackstabUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueBackstab
        SkipContinue                = Yes
        UnpackTime                  = 250
        PreparationTime             = 1
        PersistentPrepTime          = 500
        PackTime                    = 100
        MustFinishAbility           = Yes
        StartAbilityRange           = WORMTONGUE_WEAPON_RANGE
        SpecialWeapon               = WormtongueBackstab
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WormtongueBackstabAutoAbility
	SpecialAbility		= SpecialAbilityWormtongueBackstab
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= 100

	Query			= 1 ANY ENEMIES +HERO +MONSTER
    End




    Behavior = SpecialPowerModule ModuleTag_ElfCloakStarter
        SpecialPowerTemplate        = SpecialAbilityWormtongueEscape
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_ElfCloakUpdate
        SpecialPowerTemplate        = SpecialAbilityWormtongueEscape
        EffectDuration              = 15000
        ShowPalantirTimer           = Yes
    End

    Behavior = InvisibilityUpdate ModuleTag_StealthForEscape
        InvisibilityNugget
            InvisibilityType        = STEALTH
            ForbiddenConditions     = USING_ABILITY
            ForbiddenConditions     = FIRING_ANY
            BecomeStealthedFX       = FX_WormtongueEscapeOn
            ExitStealthFX           = FX_WormtongueEscapeOff
        End
        StartsActive                = No
        UpdatePeriod                = 2000
    End


    Behavior = AutoHealBehavior ModuleTag_WormtongueHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        AttackPriority               = AttackPriority_HeroKiller
        BurningDeathTime             = BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_EVIL_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 32
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL WormtongueVoiceDie
        ShadowWhenDead = No
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 3000
        HitReactionThreshold1 = 5.0
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DominateEnabler
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        TriggeredBy                   = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_DominateEnemySpecialPowerModule
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        StartsPaused                  = Yes
        UpdateModuleStartsAttack      = Yes
    End

     Behavior = DominateEnemySpecialPower ModuleTag_DominateEnemySpecialPower
        SpecialPowerTemplate          = SpecialAbilityWormtongueCorrodeAllegiance
        UnpackingVariation            = 1
        StartAbilityRange             = 200.0
        AttributeModifierAffects      = ANY +HERO NOT_FLYING_UNITS -MordorFellBeast -MordorFellBeastInterface -MordorWitchKingOnFellBeast -AngbandMelkor -AngbandMelkor_WOR -AngbandAncalagon -TolinGaurhothTarMairon -TolinGaurhothTarMairon_WOR -AngbandAncalagon_WOR -AvatharUngoliant -AvatharUngoliant_WOR -ValinorManwe -ValinorManwe_WOR -DoriathMelian -DoriathMelian_WOR -ValinorEonwe -ValinorEonwe_WOR -ValinorTulkas -ValinorTulkas_WOR -ValinorAule -ValinorAule_WOR -ValinorOrome -ValinorOrome_Summoned
        DominateRadius                = 60
        DominatedFX                   = FX_WormtongueCorrodeAllegiance
        TriggerFX                     = FX_SarumanDominateTrigger
        UnpackTime                    = 2000
        PreparationTime               = 1
        FreezeAfterTriggerDuration    = 2500
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnterwandernEnabler
        SpecialPowerTemplate = SpecialAbilityUnterwandern
        TriggeredBy = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_UnterwandernPower
        SpecialPowerTemplate        = SpecialAbilityUnterwandern
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = GrimaSpellVoiceUnterwandern
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_UnterwandernUpdate
        SpecialPowerTemplate    = SpecialAbilityUnterwandern
        SkipContinue            = Yes
        UnpackTime              = 1500
        PreparationTime         = 1
        PersistentPrepTime      = 1000
        PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange       = 290
        ApproachRequiresLOS     = Yes
        SpecialWeapon           = SchlangenzungeUnterwandernWeapon
        MustFinishAbility       = Yes
        WhichSpecialWeapon      = 2
        BusyForDuration         = 2500
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = 200
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate EscapeAI
        CommandButtonName = Command_SpecialAbilityWormtongueEscape
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate VenomousWordsAI
        CommandButtonName = Command_SpecialAbilityWormtongueVenomousWords
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate BackstabAI
        CommandButtonName = Command_SpecialAbilitySchlangenzungeBackstab
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate UnterwandernAI
	CommandButtonName = Command_SpecialAbilityUnterwandern
	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
	SpecialPowerRadius = 100
    End

    Geometry                 = CYLINDER
    GeometryMajorRadius      = 8.0
    GeometryMinorRadius      = 8.0
    GeometryHeight           = 19.2
    GeometryIsSmall          = Yes
    Shadow                   = SHADOW_DECAL
    ShadowSizeX              = 19
    ShadowSizeY              = 19
    ShadowTexture            = ShadowI
End

ChildObject IsengardWormTongue_Mod_Slaved IsengardWormTongue_Mod

    CommandPoints = 0

    KindOf = +CREEP

    KindOf = PRELOAD CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE NOTIFY_OF_PREATTACK ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER UNATTACKABLE


    VisionRange = CREEP_VISION

    ThreatBreakdown MordorGoblinSwordsmanSlaved_ThreatBreakdown
        AIKindOf = CREEP
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End

    WeaponSet
        Conditions = None
    End



    Behavior = SlavedUpdate ModuleTag_Slave
        GuardMaxRange       = 150
        GuardWanderRange    = 40
        UseSlaverAsControlForEvaObjectSightedEvents = Yes
        DieOnMastersDeath   = Yes
    End
End

