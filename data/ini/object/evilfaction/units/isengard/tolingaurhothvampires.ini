Object TolinGaurhothVampires

    SelectPortrait = UPBatCloud
    ButtonImage    = HICaveBats

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_TolinGaurhothVampiresHorde

    Draw = W3DScriptedModelDraw ModuleTag_01

    ExtraPublicBone  = B_PASSENGER

        DefaultModelConditionState
            Model                    = autolvamp
            WeaponLaunchBone         = PRIMARY BAT_TOER1
        End



        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 CurDrawableSetTransitionAnimState("Trans_Begin_Attacking") return
             EndScript

        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End
        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_ATKB
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

           TransitionState = Trans_Begin_Moving
               Animation = Transition
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                   AnimationMode = ONCE
                   AnimationBlendTime = 6
               End
           End

          AnimationState = DYING
             Animation = DyingA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                  AnimationMode = LOOP
                  AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.5 0.5
              End
              StateName = DYING
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
                AnimationBlendTime = 4
            End
        End
    End

    Side                               = Isengard
    EditorSorting                      = UNIT
    ThreatLevel                        = FELL_BEAST_THREAT_LEVEL
    ThingClass                         = MEDIUM_MONSTER
    BuildCost                          = 900
    BuildTime                          = ELITE_BUILDTIME
    TransportSlotCount                 = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    ShockwaveResistance                = SHOCKWAVE_RESISTANCE_ALWAYS
    BountyValue                        = 120
    MaxSimultaneousOfType              = 5
    VisionRange                        = VISION_FLIER
    ShroudClearingRange                = SHROUD_CLEAR_FLIER
    RamPower                           = 45
    RamZMult                           = 0.5
    CrusherLevel                       = 3
    CrushKnockback                     = 50
    CrushZFactor                       = 1.0
    DisplayName                        = OBJECT:TolinGaurhothVampiresHorde
    CommandSet                         = TolinGaurhothVampiresHordeCommandSet
    CommandPoints                      = 15

    WeaponSet
        Weapon                        = PRIMARY    ThuringwethilBatPlowAttack
        PreferredAgainst              = PRIMARY    STRUCTURE MACHINE HORDE
        Weapon                        = SECONDARY  ThuringwethilBatGrabAttack
        PreferredAgainst              = SECONDARY  INFANTRY THROWN_OBJECT CAVALRY
        Weapon                        = TERTIARY   ThuringwethilBatClawAttack
        OnlyAgainst                   = TERTIARY   MONSTER
        ReadyStatusSharedWithinSet    = Yes
    End

    ArmorSet
        Conditions                     = None
        Armor                          = VeryWeakFlyingHeroArmor
        DamageFX                       = FellBeastDamageFX
    End

    ArmorSet
        Conditions                     = PLAYER_UPGRADE
        Armor                          = WeakFlyingHeroArmor
        DamageFX                       = FellBeastDamageFX
    End


    AutoResolveUnitType               = AutoResolveUnit_Monster
    AutoResolveCombatChain            = AutoResolve_MonsterCombatChain

    AutoResolveBody                    = AutoResolve_EliteLegndaryUnitBody

    AutoResolveWeapon
        Weapon                         = AutoResolve_EliteLegndaryFlyWeapon
    End
    AutoResolveArmor
        Armor                          = AutoResolve_EliteLegndaryFlyArmor
    End


    VoiceFullyCreated                 = CaveBatsSelect
    VoiceSelect                       = CaveBatsSelect

    SoundAmbient                      = CaveBatsAmbientLoop
    SoundMoveStart                    = CaveBatsSelect

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5
        AnimationSound = Sound: FellBeastEagleAttack        Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort        Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort        Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End


    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE ARMY_SUMMARY GIANT_BIRD

    ThreatBreakdown MordorDrummerTroll_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ActiveBody ModuleTag_02
        CheerRadius                    = EMOTION_CHEER_RADIUS
        MaxHealth                      = WEAK_FLYING_UNITS_HEALTH
        HealingBuffFx                  = None
    End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive                   = Yes
        HealingAmount                  = 25
        HealingDelay                   = 1000
        StartHealingDelay              = 15000
        HealOnlyIfNotInCombat          = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = FellBeastFunctions
        FollowThroughDistance           = 200
        FollowThroughCheckStep          = 50
        FollowThroughGradient           = 1.0
        GrabTossTimeTrigger             = 2.5
        GrabTossHeightTrigger           = 100.0
        TossFX                          = FX_DiebyFalling
        SpecialContactPoints            = Swoop
        AttackPriority                  = AttackPriority_FellBeast
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 130
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 140
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 90
    End

    LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 150
    End

    Behavior = SlowDeathBehavior ModuleTag_NormalDeath
        DeathTypes                = ALL
        DestructionDelay          = 500
        ShadowWhenDead            = No
        FX                        = INITIAL FX_FellBeastDeath
        Sound                     = INITIAL SpellGenericUnsummonFasterMS
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained     = UNSELECTABLE UNATTACKABLE
        PassengerFilter             = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots                       = 1
        ShowPips                    = No
        CollidePickup               = No
        AllowEnemiesInside          = Yes
        AllowNeutralInside          = Yes
        AllowAlliesInside           = Yes
        DamagePercentToUnits        = 0%
        PassengerBonePrefix         = PassengerBone:B_PASSENGER KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath      = No
        GrabWeapon                  = FellbeastGrabWeapon
        FireGrabWeaponOnVictim      = No
        ReleaseSnappyness           = 0.05
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate              = 500
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                = Upgrade_EliteHordeLvl10
        ArmorSetFlag               = PLAYER_UPGRADE
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        TriggeredBy                     = Upgrade_EliteHordeLvl10
        EmotionPulseRadius              = 100
        EmotionPulseInterval            = 2500
        GenerateFear                    = Yes
        InitiallyActive                 = No
        VictimFilter                    = ALL ENEMIES
    End


    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate              = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack          = Yes
    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
        SpecialPowerTemplate              = SpecialAbilityLevelAttack
        UnpackTime                        = 1
        AwardXPForTriggering              = 0
        StartAbilityRange                 = 1000.0
    End


     Behavior = SpecialPowerModule ModuleTag_SchutztmichSpecialStarter
        UpdateModuleStartsAttack        = No
        SpecialPowerTemplate            = SpecialPowerThuringwethilBatServentSpawn
        StartsPaused                    = No
        SetModelCondition               = ModelConditionState:SPECIAL_WEAPON_TWO
        SetModelConditionTime           = 3.0
        AttributeModifier               = OverlordServentSpawn
        AttributeModifierRange          = 1
        AttributeModifierAffectsSelf    = Yes
        AttributeModifierAffects        = NONE +TolinGaurhothVampires
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_SchutztmichSpecialUpdate
        SpecialPowerTemplate            = SpecialPowerThuringwethilBatServentSpawn
        UnpackTime                      = 2000
        PackTime                        = 3000
        AwardXPForTriggering            = 0
        MustFinishAbility               = Yes
    End

    Behavior = ObjectCreationUpgrade MaketheEagle
        TriggeredBy                     = Upgrade_RaiseShield
        Delay                           = 0.0
        ThingToSpawn                    = TolinGaurhothVampiresMinion
        Offset                          = X:20.0 Y:0.0 Z:0.0
        FadeInTime                      = 100
    End

    Behavior = ObjectCreationUpgrade MaketheEagle2
        TriggeredBy                     = Upgrade_RaiseShield
        Delay                           = 0.0
        ThingToSpawn                    = TolinGaurhothVampiresMinion
        Offset                          = X:-20.0 Y:0.0 Z:0.0
        FadeInTime                      = 100
    End

    Behavior = ObjectCreationUpgrade MaketheEagle3
        TriggeredBy                     = Upgrade_RaiseShield
        Delay                           = 0.0
        ThingToSpawn                    = TolinGaurhothVampiresMinion
        Offset                          = X:0.0 Y:20.0 Z:0.0
        FadeInTime                      = 100
    End


    Behavior = SlaveWatcherBehavior WatchTheEagle
        RemoveUpgrade                   = Upgrade_RaiseShield
        LetSlaveLive                    = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership
        TriggeredBy                     = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Debuff
        StartsActive                  = No
        TriggeredBy                   = Upgrade_EliteHordeLvl2
        RefreshDelay                  = 2000
        Range                         = 350
        TargetEnemy                   = Yes
        AntiCategory                  = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName                     = TolinGaurhothVampiresDebuff
        ObjectFilter                  = ANY +ARCHER +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -MACHINE -SHIP -DOZER
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisage2
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        TriggeredBy                     = Upgrade_EliteHordeLvl6
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate2
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive                  = No
        TriggeredBy                   = Upgrade_EliteHordeLvl6
        RefreshDelay                  = 2000
        Range                         = 300
        TargetEnemy                   = Yes
        AntiCategory                  = LEADERSHIP BUFF
        BonusName                     = GenericDebuff
        ObjectFilter                  = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION +HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                = No
        TriggeredBy                    = Upgrade_EliteHordeLvl5
        WhichSpecialPower              = 1
        GenerateFear                   = Yes
        EmotionPulseRadius             = 300
        EmotionPulseInterval           = 2000
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate Summmon_AI
        CommandButtonName  = Command_TolinGaurhothVampiresMinionsSpawn
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    FormationPreviewDecal
        Texture = FPflyingUnitDecal
        Width   = 60
        Height  = 60
    End

    Scale               = 0.14
    Geometry            = CYLINDER
    GeometryMinorRadius = 20.0
    GeometryMajorRadius = 20.0
    GeometryHeight      = 20.0
    GeometryOffset      = X:0 Y:0 Z:-10
    GeometryIsSmall     = Yes
    Shadow              = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle      = 20
End


Object TolinGaurhothVampiresMinion

    SelectPortrait = UPBatCloud
    ButtonImage    = HICaveBats

    Draw = W3DScriptedModelDraw ModuleTag_01

    ExtraPublicBone  = B_PASSENGER

        DefaultModelConditionState
            Model                    = autolvamp
            WeaponLaunchBone         = PRIMARY BAT_TOER1
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 CurDrawableSetTransitionAnimState("Trans_Begin_Attacking") return
             EndScript

        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End
        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_ATKB
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

           TransitionState = Trans_Begin_Moving
               Animation = Transition
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                   AnimationMode = ONCE
                   AnimationBlendTime = 6
               End
           End

          AnimationState = DYING
             Animation = DyingA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                  AnimationMode = LOOP
                  AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.5 0.5
              End
              StateName = DYING
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
                AnimationBlendTime = 4
            End
        End
    End

    Side                               = Isengard
    EditorSorting                      = UNIT
    ThreatLevel                        = FELL_BEAST_THREAT_LEVEL
    ThingClass                         = MEDIUM_MONSTER
    TransportSlotCount                 = TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
    ShockwaveResistance                = SHOCKWAVE_RESISTANCE_ALWAYS
    BountyValue                        = 50

    VisionRange                        = 300
    ShroudClearingRange                = 400

    RamPower                           = 45
    RamZMult                           = 0.5
    CrusherLevel                       = 3
    CrushKnockback                     = 50
    CrushZFactor                       = 1.0

    DisplayName                        = OBJECT:TolinGaurhothVampiresHorde

    CommandSet                         = UnderworldServentCommandSet
    CommandPoints                      = 0

    WeaponSet
        Weapon                        = PRIMARY    ThuringwethilBatMinionPlowAttack
        PreferredAgainst               = PRIMARY    STRUCTURE MACHINE HORDE
        Weapon                       = SECONDARY  ThuringwethilBatMinionGrabAttack
        PreferredAgainst               = SECONDARY  INFANTRY THROWN_OBJECT CAVALRY
        Weapon                       = TERTIARY   ThuringwethilBatMinionClawAttack
        OnlyAgainst                   = TERTIARY   MONSTER
        ReadyStatusSharedWithinSet     = Yes
    End

    ArmorSet
        Conditions                     = None
        Armor                          = VeryWeakFlyingHeroArmor
        DamageFX                        = FellBeastDamageFX
    End

    ArmorSet
        Conditions                     = PLAYER_UPGRADE
        Armor                          = WeakFlyingHeroArmor
        DamageFX                       = FellBeastDamageFX
    End

    VoiceFullyCreated                  = CaveBatsSelect

    SoundAmbient                       = CaveBatsAmbientLoop
    SoundMoveStart                     = CaveBatsSelect

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
    End


    RadarPriority = UNIT
    KindOf = PRELOAD CREEP SELECTABLE CAN_CAST_REFLECTIONS SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT NO_FREEWILL_ENTER SCARY MONSTER CANNOT_RETALIATE GIANT_BIRD

    ThreatBreakdown MordorGoblinSwordsmanSlaved_ThreatBreakdown
        AIKindOf = CREEP
    End

    Behavior = SlavedUpdate ModuleTag_Slave
        GuardMaxRange                = 200
        GuardWanderRange             = 75
        UseSlaverAsControlForEvaObjectSightedEvents = Yes
    End

    Body = ActiveBody ModuleTag_02
        CheerRadius                    = EMOTION_CHEER_RADIUS
        MaxHealth                      = VERY_WEAK_FLYING_UNITS_HEALTH
        HealingBuffFx                  = None
    End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive                   = Yes
        HealingAmount                  = 15
        HealingDelay                   = 2000
        StartHealingDelay              = 15000
        HealOnlyIfNotInCombat          = Yes
    End

    Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = FellBeastFunctions
        FollowThroughDistance           = 200
        FollowThroughCheckStep          = 50
        FollowThroughGradient           = 1.0
        GrabTossTimeTrigger             = 2.5
        GrabTossHeightTrigger           = 100.0
        TossFX                          = FX_DiebyFalling
        SpecialContactPoints            = Swoop
        AttackPriority                  = AttackPriority_FellBeast
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 142
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_SUPERSONIC
        Speed     = 150
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 90
    End

    LocomotorSet
        Locomotor = FellBeastSwoopLocomotor
        Condition = SET_PANIC
        Speed     = 150
    End

    Behavior = SlowDeathBehavior ModuleTag_NormalDeath
        DeathTypes                = ALL
        DestructionDelay          = 500
        ShadowWhenDead              = No
        Sound                     = INITIAL SpellGenericUnsummonFasterMS
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained     = UNSELECTABLE UNATTACKABLE
        PassengerFilter             = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots                       = 1
        ShowPips                    = No
        CollidePickup               = No
        AllowEnemiesInside          = Yes
        AllowNeutralInside          = Yes
        AllowAlliesInside           = Yes
        DamagePercentToUnits        = 0%
        PassengerBonePrefix         = PassengerBone:B_PASSENGER KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath      = No
        GrabWeapon                  = FellbeastGrabWeapon
        FireGrabWeaponOnVictim      = No
        ReleaseSnappyness           = 0.05
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate              = 500
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                = Upgrade_EliteHordeLvl10
        ArmorSetFlag               = PLAYER_UPGRADE
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    Behavior = SpecialPowerModule ModuleTag_FellbeastLevelAttack
        SpecialPowerTemplate              = SpecialAbilityLevelAttack
        UpdateModuleStartsAttack          = Yes
    End

    Behavior = FellBeastSwoopPower ModuleTag_FellBeastSwoopPower
           SpecialPowerTemplate              = SpecialAbilityLevelAttack
        UnpackTime                      = 1
           AwardXPForTriggering              = 0
        StartAbilityRange                  = 1000.0
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    FormationPreviewDecal
        Texture = FPflyingUnitDecal
        Width   = 60
        Height  = 60
    End

    Scale         = 0.14
    Geometry         = CYLINDER
    GeometryMinorRadius = 20.0
    GeometryMajorRadius = 20.0
    GeometryHeight     = 20.0
    GeometryOffset     = X:0 Y:0 Z:-10
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_VOLUME_NON_SELF_3
    ShadowSunAngle     = 20
End






Object TolinGaurhothVampires_Slaved

    SelectPortrait = UPBatCloud
    ButtonImage    = HICaveBats

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_TolinGaurhothVampiresHorde

    Draw = W3DScriptedModelDraw ModuleTag_01

    ExtraPublicBone  = B_PASSENGER

        DefaultModelConditionState
            Model                    = autolvamp
            WeaponLaunchBone         = PRIMARY BAT_TOER1
        End

        IdleAnimationState
            StateName = Idle
            Animation = IDLA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End

         AnimationState    = BACKING_UP
               StateName = backup
               Animation = IDLA
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRA
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
               End
           End

           AnimationState = DIVING
               StateName = Diving
               Animation = Diving
                   AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                   AnimationMode = LOOP
                   AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
              End
           End

        AnimationState = ABOUT_TO_HIT
            StateName = Claw
            Animation = Claw
                AnimationName = CUFellBst_SKL.CUFellBst_ATKD
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 CurDrawableSetTransitionAnimState("Trans_Begin_Attacking") return
             EndScript

        End
        TransitionState = Trans_Begin_Attacking
            Animation = Grab
                AnimationName = CUFellBst_SKL.CUFellBst_GRBA
                AnimationMode = ONCE
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.4 0.4
            End
        End

        AnimationState  STUNNED SPECIAL_DAMAGED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_ATKH
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End
        AnimationState  STUNNED
            StateName =  STUNNED
            Animation = HitA
                AnimationName = CUFellBst_SKL.CUFellBst_HITA
                AnimationMode = ONCE
                AnimationBlendTime = 6
            End
        End

        AnimationState = SPECIAL_WEAPON_TWO
            Animation
                AnimationName        = CUFellBst_SKL.CUFellBst_ATKA
                AnimationMode        = ONCE
                AnimationBlendTime    = 20
            End
            FXEvent                    = Frame:30 Name:FX_FearBlast
        End



        AnimationState = CLIMBING
            StateName = Climbing
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_HVRB
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
        End
        AnimationState = FREEFALL
            StateName = Freefall
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_IDLA
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
        End

        AnimationState = MOVING SPECIAL_WEAPON_ONE
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_ATKB
                AnimationMode = LOOP
                AnimationBlendTime = 10
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

        AnimationState = MOVING
            StateName = Moving
            Animation = Moving
                AnimationName = CUFellBst_SKL.CUFellBst_FLYA
                AnimationMode = LOOP
                AnimationBlendTime = 10
                AnimationSpeedFactorRange = 3.25 3.75
            End
              BeginScript
                 Prev = CurDrawablePrevAnimationState()
                 if Prev == "Idle"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
                 if Prev == "Climbing"    then CurDrawableSetTransitionAnimState("Trans_Begin_Moving") return end
             EndScript
        End

           TransitionState = Trans_Begin_Moving
               Animation = Transition
                   AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                   AnimationMode = ONCE
                   AnimationBlendTime = 6
               End
           End

          AnimationState = DYING
             Animation = DyingA
                AnimationName = CUFellBst_SKL.CUFellBst_HVRC
                  AnimationMode = LOOP
                  AnimationBlendTime = 10
                AnimationSpeedFactorRange = 0.5 0.5
              End
              StateName = DYING
        End

        AnimationState = RUBBLE
            Animation = RubbleDieF
                AnimationName = CUFellBst_SKL.CUFellBst_DIVA
                AnimationMode = ONCE
                AnimationBlendTime = 4
            End
        End
    End

	Side			= Isengard
	EditorSorting		= UNIT
	ThreatLevel		= FELL_BEAST_THREAT_LEVEL
	ThingClass		= MEDIUM_MONSTER
	TransportSlotCount	= TRANSPORTSLOTCOUNT_NOT_TRANSPORTABLE
  
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

  WeaponSet
	Conditions	= None
	Weapon          = PRIMARY	ThuringwethilBatClawAttack
	PreferredAgainst= PRIMARY	INFANTRY THROWN_OBJECT CAVALRY MONSTER
	Weapon		= SECONDARY	ThuringwethilBatPlowAttack
	OnlyAgainst	= SECONDARY	STRUCTURE MACHINE HORDE SHIP CAN_RIDE_SIEGE_LADDER
	Weapon		= TERTIARY	ThuringwethilBatClawAttack
	PreferredAgainst = TERTIARY	HERO	
 End

    ArmorSet
		Conditions      = None
		Armor           = VeryWeakFlyingHeroArmor
		DamageFX        = None
	End

	VisionRange = VISION_FLIER
	ShroudClearingRange = SHROUD_CLEAR_FLIER

	BountyValue = GONDOR_GWAIHIR_BOUNTY_VALUE
    DisplayName = OBJECT:TolinGaurhothVampiresHorde

	CrusherLevel	= 3
	RamPower 	= 30
	RamZMult 	= 0.5
	CommandSet 	= emptyCommandSet
	CommandPoints = 0
	
	EvaEnemyObjectSightedEvent = None 

	SoundCreated = CaveBatsSelect
    VoiceFullyCreated    = CaveBatsSelect
    VoiceSelect          = CaveBatsSelect

    SoundAmbient         = CaveBatsAmbientLoop
    SoundMoveStart       = CaveBatsSelect

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_IDLA Frames: 33
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_ATKB Frames: 1 24 65 87 112
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 5
        AnimationSound = Sound: FellBeastEagleAttack        Animation:CUFELLBST_SKL.CUFELLBST_ATKD Frames: 10
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_ATKH Frames: 0
        AnimationSound = Sound: FellBeastHurt                Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 0
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HITA Frames: 10
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_FLYA Frames: 5
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HVRA Frames: 7
        AnimationSound = Sound: FellBeastWingFlapsShort        Animation:CUFELLBST_SKL.CUFELLBST_HVRB Frames: 3
        AnimationSound = Sound: FellBeastWingFlapsShort        Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 5 32
        AnimationSound = Sound: FellBeastWingFlaps            Animation:CUFELLBST_SKL.CUFELLBST_HVRC Frames: 62 103
    End

	RadarPriority	= UNIT
	KindOf	= PRELOAD SELECTABLE CAN_CAST_REFLECTIONS SCORE NO_FREEWILL_ENTER MONSTER SCARY CAN_ATTACK
	
	Body = ActiveBody ModuleTag_02
		CheerRadius 	= EMOTION_CHEER_RADIUS
		MaxHealth       = WEAK_FLYING_UNITS_HEALTH
		HealingBuffFx	= None
		DodgePercent    = 20
	End

    Behavior = AutoHealBehavior ModuleTag_FellbeastHealing
        StartsActive                   = Yes
        HealingAmount                  = 25
        HealingDelay                   = 1000
        StartHealingDelay              = 15000
        HealOnlyIfNotInCombat          = Yes
    End
	
    Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = FellBeastFunctions
        FollowThroughDistance           = 200
        FollowThroughCheckStep          = 50
        FollowThroughGradient           = 1.0
        GrabTossTimeTrigger             = 2.5
        GrabTossHeightTrigger           = 100.0
        TossFX                          = FX_DiebyFalling
        SpecialContactPoints            = Swoop
        AttackPriority                  = AttackPriority_FellBeast
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius              = 100
        EmotionPulseInterval            = 2500
        GenerateFear                    = Yes
        InitiallyActive                 = Yes
        VictimFilter                    = ALL ENEMIES
    End

    Behavior = SlowDeathBehavior ModuleTag_NormalDeath
        DeathTypes                = ALL
        DestructionDelay          = 500
        ShadowWhenDead            = No
        FX                        = INITIAL FX_FellBeastDeath
        Sound                     = INITIAL SpellGenericUnsummonFasterMS
    End
	
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_NORMAL 
		Speed     = 120
	End
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_SUPERSONIC 
		Speed     = 165
	End
	LocomotorSet
		Locomotor = MordorFlyingFireLocomotor
		Condition = SET_WANDER 
		Speed     = 88
	End

	  LocomotorSet
	    Locomotor = MordorFlyingFireSwoopLocomotor
	    Condition = SET_PANIC
	    Speed     = 185
	  End

	Behavior = PhysicsBehavior ModuleTag_04
	End
	
	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
	End

	Behavior = SquishCollide ModuleTag_06
	End

    Behavior = TransportContain TransportContainModuleTag
        ObjectStatusOfContained     = UNSELECTABLE UNATTACKABLE
        PassengerFilter             = ANY +INFANTRY +HULK +CAVALRY +GRAB_AND_DROP -HERO -PORTER
        Slots                       = 1
        ShowPips                    = No
        CollidePickup               = No
        AllowEnemiesInside          = Yes
        AllowNeutralInside          = Yes
        AllowAlliesInside           = Yes
        DamagePercentToUnits        = 0%
        PassengerBonePrefix         = PassengerBone:B_PASSENGER KindOf:GRAB_AND_DROP
        EjectPassengersOnDeath      = No
        GrabWeapon                  = FellbeastGrabWeapon
        FireGrabWeaponOnVictim      = No
        ReleaseSnappyness           = 0.05
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate              = 500
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

         Behavior = SlavedUpdate ModuleTag_Slave
		GuardMaxRange		= 500
		GuardWanderRange	= 250
		UseSlaverAsControlForEvaObjectSightedEvents = No 
                DieOnMastersDeath	= Yes
	End

	Scale               = 0.18

End