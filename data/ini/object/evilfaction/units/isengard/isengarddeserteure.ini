Object IsengardDeserteure

    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
       Model    = ruspearman_skn
    End
    End

    Side = Isengard
    ThreatLevel = 1.0
    EditorSorting = UNIT
    BountyValue = GONDOR_SOLDIER_BOUNTY_VALUE
    BuildVariations = IsengardDeserteure1 IsengardDeserteure2 IsengardDeserteure3 IsengardDeserteure4 IsengardDeserteure5
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK GRAB_AND_DROP

End

Object IsengardDeserteure1


    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    EquivalentTo = IsengardDeserteure

    Draw = W3DHordeModelDraw ModuleTag_01





        LodOptions    = LOW
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_LOW
        End

        LodOptions    = MEDIUM
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_MED
        End

        LodOptions    = HIGH
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_HIGH
        End


        DefaultModelConditionState
            Model                           = ruspearman_skn
            Model                           = ruspearman_skb  ExtraMesh:Yes
            Model                           = ruspearman_skc  ExtraMesh:Yes
            Model                           = ruspearman_skd  ExtraMesh:Yes
            Model                           = ruspearman_ske  ExtraMesh:Yes
            Model                           = ruspearman_skf  ExtraMesh:Yes
            Skeleton                        = GUTowerGrd_SKL
        End

        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model                           = ruspearman_skn
            Model                           = ruspearman_skb  ExtraMesh:Yes
            Model                           = ruspearman_skc  ExtraMesh:Yes
            Model                           = ruspearman_skd  ExtraMesh:Yes
            Model                           = ruspearman_ske  ExtraMesh:Yes
            Model                           = ruspearman_skf  ExtraMesh:Yes
            Skeleton                        = GUTowerGrd_SKL
        End

        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTowerGrd_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTowerGrd_FLLA
                AnimationMode                    = LOOP
            End
        End

        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTowerGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End




        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTowerGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTowerGrd_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTowerGrd_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTowerGrd_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState        = MOVING ALTERNATE_FORMATION
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_PSHA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        = MOVING USING_COMBO_LOCOMOTOR
            ShareAnimation        = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_WLKA
                AnimationMode     = LOOP
                Distance          = 40
            End
            Flags               = RANDOMSTART

        End

        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_RUNA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTowerGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End

        End


        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTowerGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTowerGrd_LNDB
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTowerGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End


        AnimationState              = DYING DEATH_5
            Animation           = DIEA
                AnimationName     = GUTowerGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            EnteringStateFX         = FX_UndeadModule
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTowerGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTowerGrd_LNDB
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTowerGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End

        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTowerGrd_PLTB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End

        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTowerGrd_HITA
                AnimationMode                = ONCE
            End
        End


        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTowerGrd_APPA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTowerGrd_FERA
                AnimationMode            = LOOP
            End
            Animation                    = FERB
                AnimationName            = GUTowerGrd_FERB
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTowerGrd_TNTA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTowerGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTowerGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTowerGrd_PNTA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End



        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTowerGrd_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTowerGrd_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = LOOP
            End
        End




        AnimationState                    = SELECTED ALTERNATE_FORMATION
            ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation                    = IDLB
                AnimationName            = GUTowerGrd_IDLB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected

            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUTowerGrd_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End



        AnimationState                    = ALTERNATE_FORMATION
            StateName                    = STATE_SelectedAlternateFormation

            ShareAnimation                = Yes
            Animation                    = IDLB
                AnimationName            = GUTowerGrd_IDLB
                AnimationMode            = LOOP
            End
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation                    = IDLA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = ONCE_BACKWARDS
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End

    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side              = Isengard
    EditorSorting     = UNIT
    ThreatLevel       = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints     = 3
    BountyValue       = GONDOR_SOLDIER_BOUNTY_VALUE
    EmotionRange      = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    IsengardDeserteurePikeWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions      = HIDDEN
    End



  ArmorSet
    Conditions      = None
    Armor           = EdainPikemanArmor
    DamageFX        = NormalDamageFX
  End

    ArmorSet
        Conditions    = PLAYER_UPGRADE
        Armor        = EdainPikemanHeavyArmor
        DamageFX    = NormalDamageFX
    End


    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName = OBJECT:IsengardDeserteure
    CrushableLevel = 0
    CrushRevengeWeapon = AntiCavalryInfantryCrushRevenge
    CrusherLevel = 0
    CrushableLevel = 0

    CommandSet = IsengardDeserteureHordeCommandSet





    VoiceAttack                 = PeasantMaleVoiceAttack
    VoiceAttackCharge             = PeasantMaleVoiceAttackCharge
    VoiceAttackStructure             = PeasantMaleVoiceAttackBuilding
    VoiceAttackMachine             = PeasantMaleVoiceAttack
    VoiceCreated                 = PeasantMaleVoiceSalute
    VoiceFullyCreated             = PeasantMaleVoiceSalute
    VoiceGuard                = PeasantMaleVoiceMove
    VoiceMove                 = PeasantMaleVoiceMove
    VoiceMoveToCamp             = PeasantMaleVoiceMoveCamp
    VoiceMoveWhileAttacking         = PeasantMaleVoiceDisengage
    VoicePriority                = 30
    VoiceRetreatToCastle             = PeasantMaleVoiceRetreat
    VoiceSelect                 = PeasantMaleVoiceSelectMS
    VoiceSelectBattle              = PeasantMaleVoiceSelectBattle

    VoiceEnterStateAttack             = PeasantMaleVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = PeasantMaleVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove             = PeasantMaleVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = PeasantMaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking     = PeasantMaleVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle        = PeasantMaleVoiceEnterStateRetreat

    SoundImpact                = ImpactHorse

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TauntHitShieldPitchShifted    Animation:GUTwrGrd_SKL.GUTwrGrd_TNTB    Frames: 23 43
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEA    Frames:30 51
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEB    Frames:57
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEC    Frames:38
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTWRGRD_SKL.GUTWRGRD_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTwrGrd_SKL.GUTwrGrd_LNDB    Frames:2
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE

    Body                          =    PorcupineFormationBodyModule ModuleTag_porcupineFormation
        CheerRadius               =    EMOTION_CHEER_RADIUS
        MaxHealth                 =    ROHAN_WACHTERMEDUSELDS_HEALTH
        MaxHealthDamaged          =    ROHAN_WACHTERMEDUSELDS_HEALTH_DAMAGED
        DamageWeaponTemplate      =    EasterlingPorcupineDamage
        CrushDamageWeaponTemplate =    EasterlingPorcupineCrushDamage
        CrusherLevelResisted      =    1
        BurningDeathBehavior      =    Yes
        BurningDeathFX            =    FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

   Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_HeavyArmor

        ArmorSetFlag            = PLAYER_UPGRADE
    End





    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy               = Upgrade_HeavyArmor
        UpgradeTexture            = rusoldier1.tga 0 rusoldier1_ha.tga
        UpgradeTexture            = rusoldier2.tga 0 rusoldier2_ha.tga
        UpgradeTexture            = rusoldier3.tga 0 rusoldier3_ha.tga
        UpgradeTexture            = rusoldier4.tga 0 rusoldier4_ha.tga
        UpgradeTexture            = rusoldier5.tga 0 rusoldier5_ha.tga
        UpgradeTexture            = rusoldier6.tga 0 rusoldier6_ha.tga
        RecolorHouse              = Yes
        ExcludeSubobjects         = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade1
        TriggeredBy        = Upgrade_IsengardFaction
        HideSubObjects     = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End






    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 80
        AttackPriority                =     AttackPriority_Spearman
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 1233
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy = Upgrade_GondorFighterFearless
        AttributeModifier = FearlessForever
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL HumanVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object IsengardDeserteure2



    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    EquivalentTo = IsengardDeserteure

    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes

        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = gupelargir_skn
            Skeleton            = GUTowerGrd_SKL
        End

        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = gupelargir_skn
            Skeleton            = GUTowerGrd_SKL
        End

         AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTowerGrd_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTowerGrd_FLLA
                AnimationMode                    = LOOP
            End
        End

        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTowerGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End


       AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking
            Animation
                AnimationName           = GUTowerGrd_SKL.GUTowerGrd_ATKA
                AnimationMode       = ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTowerGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTowerGrd_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTowerGrd_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTowerGrd_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState        = MOVING ALTERNATE_FORMATION
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_PSHA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        = MOVING USING_COMBO_LOCOMOTOR
            ShareAnimation        = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_WLKA
                AnimationMode     = LOOP
                Distance          = 40
            End
            Flags               = RANDOMSTART

        End

        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTowerGrd_RUNA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTowerGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End

        End


        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTowerGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = DYING DEATH_1 SPLATTED
            Animation           = LNDA
                AnimationName     = GUTowerGrd_LNDB
                AnimationMode     = ONCE
            End
        End


        AnimationState          = DYING DEATH_5
            Animation           = DIEA
                AnimationName     = GUTowerGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            EnteringStateFX                  = FX_UndeadModule
        End


        AnimationState        = DYING DEATH_1
            Animation           = DIEA
                AnimationName     = GUTowerGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End

        AnimationState        = DYING DEATH_2
            Animation                    = FadeOut
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = ONCE
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTowerGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTowerGrd_LNDB
                AnimationMode     = ONCE
            End

        End

        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTowerGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End

        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTowerGrd_PLTB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End

        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTowerGrd_HITA
                AnimationMode                = ONCE
            End
        End


        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTowerGrd_APPA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTowerGrd_FERA
                AnimationMode            = LOOP
            End
            Animation                    = FERB
                AnimationName            = GUTowerGrd_FERB
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTowerGrd_TNTA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTowerGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTowerGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTowerGrd_PNTA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End



        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTowerGrd_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = LOOP
            End
        End




        AnimationState                    = SELECTED ALTERNATE_FORMATION
            ShareAnimation                = Yes
            StateName                    = STATE_SelectedAlternateFormation
            Animation                    = IDLB
                AnimationName            = GUTowerGrd_IDLB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = SELECTED
            StateName                    = STATE_Selected

            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUTowerGrd_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End



        AnimationState                    = ALTERNATE_FORMATION
            StateName                    = STATE_SelectedAlternateFormation

            ShareAnimation                = Yes
            Animation                    = IDLB
                AnimationName            = GUTowerGrd_IDLB
                AnimationMode            = LOOP
            End
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation                    = IDLA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLA
                AnimationName            = GUTowerGrd_IDLA
                AnimationMode            = ONCE_BACKWARDS
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side              = Isengard
    EditorSorting     = UNIT
    ThreatLevel       = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints     = 3
    BountyValue       = GONDOR_SOLDIER_BOUNTY_VALUE
    EmotionRange      = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    IsengardDeserteurePikeWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions      = HIDDEN
    End



    ArmorSet
        Conditions      = None
        Armor           = EdainPikemanArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions    = PLAYER_UPGRADE
        Armor        = EdainPikemanHeavyArmor
        DamageFX    = NormalDamageFX
    End


    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName = OBJECT:IsengardDeserteure
    CrushableLevel = 0
    CrushRevengeWeapon = AntiCavalryInfantryCrushRevenge
    CrusherLevel = 0
    CrushableLevel = 0

    CommandSet = IsengardDeserteureHordeCommandSet





    VoiceAttack                 = PeasantMaleVoiceAttack
    VoiceAttackCharge             = PeasantMaleVoiceAttackCharge
    VoiceAttackStructure             = PeasantMaleVoiceAttackBuilding
    VoiceAttackMachine             = PeasantMaleVoiceAttack
    VoiceCreated                 = PeasantMaleVoiceSalute
    VoiceFullyCreated             = PeasantMaleVoiceSalute
    VoiceGuard                = PeasantMaleVoiceMove
    VoiceMove                 = PeasantMaleVoiceMove
    VoiceMoveToCamp             = PeasantMaleVoiceMoveCamp
    VoiceMoveWhileAttacking         = PeasantMaleVoiceDisengage
    VoicePriority                = 30
    VoiceRetreatToCastle             = PeasantMaleVoiceRetreat
    VoiceSelect                 = PeasantMaleVoiceSelectMS
    VoiceSelectBattle              = PeasantMaleVoiceSelectBattle

    VoiceEnterStateAttack             = PeasantMaleVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = PeasantMaleVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove             = PeasantMaleVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = PeasantMaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking     = PeasantMaleVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle        = PeasantMaleVoiceEnterStateRetreat

    SoundImpact                = ImpactHorse

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TauntHitShieldPitchShifted    Animation:GUTowerGrd_SKL.GUTowerGrd_TNTB    Frames: 23 43
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTowerGrd_SKL.GUTowerGrd_DIEA    Frames:30 51
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTowerGrd_SKL.GUTowerGrd_DIEB    Frames:57
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTowerGrd_SKL.GUTowerGrd_DIEC    Frames:38
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTowerGrd_SKL.GUTowerGrd_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTowerGrd_SKL.GUTowerGrd_LNDB    Frames:2
    End





    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE

    Body                          =    PorcupineFormationBodyModule ModuleTag_porcupineFormation
        CheerRadius               =    EMOTION_CHEER_RADIUS
        MaxHealth                 =    250
        MaxHealthDamaged          =    125
        DamageWeaponTemplate      =    EasterlingPorcupineDamage
        CrushDamageWeaponTemplate =    EasterlingPorcupineCrushDamage
        CrusherLevelResisted      =    1
        BurningDeathBehavior      =    Yes
        BurningDeathFX            =    FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = WeaponSetUpgrade ModuleTag_Weaponpgrade
        TriggeredBy = Upgrade_ForgedBlades
    End

     Behavior = ArmorUpgrade ModuleTag_ArmorUpgrade
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End





    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy    = Upgrade_HeavyArmor
        UpgradeTexture    = rupeasant02.tga 0 sfpelspear_HA.tga
        UpgradeTexture    = gupelargir.tga 0 gupelargir_HA.tga
        RecolorHouse    = Yes
        ExcludeSubobjects = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ModuleTag_Making
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects    = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 80
        AttackPriority                =     AttackPriority_Spearman
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 1233
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy = Upgrade_GondorFighterFearless
        AttributeModifier = FearlessForever
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL HumanVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object IsengardDeserteure3



    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    EquivalentTo = IsengardDeserteure

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes

        StaticModelLODMode = Yes


        LodOptions    = LOW
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_LOW
        End

        LodOptions    = MEDIUM
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_MED
        End

        LodOptions    = HIGH
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_HIGH
        End


        DefaultModelConditionState
            Model = guspeer_skn
        End


        IdleAnimationState
            Animation = IDLEA
                AnimationName            =    MUEastern_SKL.MUEastern_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    10
                AnimationSpeedFactorRange    = 0.8 1.2
            End
            Flags                            =    RANDOMSTART
            StateName = Idle
            BeginScript
                Prev =    CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TransitionFromAttention") end
            EndScript
        End



        AnimationState                    =    THROWN_PROJECTILE
            Animation                    =    THROWN
                AnimationName            =    MUEastern_SKL.MUEastern_FLYA
                AnimationMode            =    LOOP
            End
        End


        AnimationState                        =    PASSENGER FREEFALL
            Animation                        =    Grabbed
                AnimationName                =    MUEastern_SKL.MUEastern_FLLA
                AnimationMode                =    LOOP
            End
        End

        AnimationState                        =    FREEFALL
            Animation                        =    Falling
                AnimationName                =    MUEastern_SKL.MUEastern_FLYA
                AnimationMode                =    LOOP
                AnimationBlendTime            =    10
                AnimationSpeedFactorRange    =    0.5    0.5
            End
        End


        AnimationState                        =    STUNNED_FLAILING
            Animation                        =    StunnedFlailing
                AnimationName                =    MUEastern_SKL.MUEastern_FLYA
                AnimationMode                =    LOOP
            End
            Flags                            =    RANDOMSTART
        End


        AnimationState                        =    DYING SPLATTED
            Animation                        =    Splattered_On_Ground
                AnimationName                =    MUEastern_SKL.MUEastern_LNDA
                AnimationMode                =    ONCE
            End
            EnteringStateFX                    =    FX_HaradrimHitGround
        End

        AnimationState                        =    DYING AFLAME
            Animation                        =    Flaming_Death
                AnimationName                =    MUEastern_SKL.MUEastern_DIEA
                AnimationMode                =    ONCE
            End
            ParticleSysBone                    =    BAT_HEAD FireBuildingLargeSmoke FollowBone:Yes
            ParticleSysBone                    =    BAT_HEAD FireSmall FollowBone:Yes
            ParticleSysBone                    =    BAT_RIBS FireBuildingLargeSmoke FollowBone:Yes
            ParticleSysBone                    =    BAT_RIBS FireSmall FollowBone:Yes
        End

        AnimationState                        =    DYING
            Animation                        =    Dying
                AnimationName                =    MUEastern_SKL.MUEastern_DIEA
                AnimationMode                =    ONCE
            End
        End




        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    Standing_Back_Up
                AnimationName                =    MUEastern_SKL.MUEastern_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                        =    STUNNED
            Animation                        =    Stunned
                AnimationName                =    MUEastern_SKL.MUEastern_LNDA
                AnimationMode                =    ONCE
            End
            EnteringStateFX                    =    FX_HaradrimHitGround
        End


        AnimationState                    =    PASSENGER
            Animation                    =    Grabbed
                AnimationName            =    MUEastern_SKL.MUEastern_FLLA
                AnimationMode            =    LOOP
            End
        End



        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = MUEastern_SKL.MUEastern_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART

        End


        AnimationState                    = MOVING CLIMBING BACKING_UP
            Animation                    = ClimbingBackwards
                AnimationName            = MUEastern_SKL.MUEastern_CLMA
                AnimationMode            = LOOP_BACKWARDS
            End
        End

        AnimationState                    = MOVING CLIMBING
            Animation                    = Climbing
                AnimationName            = MUEastern_SKL.MUEastern_CLMA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    =    MOVING PANICKING
            ShareAnimation                =    Yes
            Animation                    =    PANICKING
                AnimationName            =    MUEastern_SKL.MUEastern_MFDA
                AnimationMode            =    LOOP
            End
            Flags                        =    RANDOMSTART
        End

        AnimationState                    =    MOVING BACKING_UP
            ShareAnimation                =    Yes
            Animation                    =    BACKINUP
                AnimationName            =    MUEastern_SKL.MUEastern_BAKA
                AnimationMode            =    LOOP
            End

        End


        AnimationState                    =    MOVING AFLAME
            ShareAnimation                =    Yes
            Animation                    =    MovingOnFire
                AnimationName            =    MUEastern_SKL.MUEastern_RUNA
                AnimationMode            =    LOOP
            End

            ParticleSysBone                =    BAT_HEAD FireBuildingLargeSmoke FollowBone:Yes
            ParticleSysBone                =    BAT_HEAD FireSmall FollowBone:Yes
            ParticleSysBone                =    BAT_RIBS FireBuildingLargeSmoke FollowBone:Yes
            ParticleSysBone                =    BAT_RIBS FireSmall FollowBone:Yes
        End

        AnimationState                    =    MOVING EMOTION_TERROR
            ShareAnimation                =    Yes
            Animation                    =    Moving
                AnimationName            =    MUEastern_SKL.MUEastern_RUNA
                AnimationMode            =    LOOP
            End
            ParticleSysBone                =    None InfantryDustTrails

        End

        AnimationState                    =    MOVING
            ShareAnimation                =    Yes
            Animation                    =    Moving
                AnimationName            =    MUEastern_SKL.MUEastern_RUNA
                AnimationMode            =    LOOP
                Distance                =   50
            End
            ParticleSysBone                =    None InfantryDustTrails

        End


        AnimationState                    =    FIRING_OR_PREATTACK_A
            Animation                    =    ATTACKA
                AnimationName            =    MUEastern_SKL.MUEastern_ATKA
                AnimationMode            =    ONCE
            End
        End

        AnimationState                    =    BETWEEN_FIRING_SHOTS_A
            Animation                    =    between
                AnimationName            =    MUEastern_SKL.MUEastern_IDLA
                AnimationMode            =    LOOP
            End
        End

        AnimationState                        =    EMOTION_UNCONTROLLABLY_AFRAID
            ShareAnimation                    =    Yes
            Animation                        =    Cower
                AnimationName                =    MUEastern_SKL.MUEastern_FERA
                AnimationMode                =    LOOP
            End
        End

        AnimationState                    =    ATTACKING
            Animation                    =    AttackingReady
                AnimationName            =    MUEastern_SKL.MUEastern_IDLA
                AnimationMode            =    LOOP
            End
        End




    AnimationState = ALTERNATE_FORMATION FIRING_OR_PREATTACK_A
         Animation = ATKC
            AnimationName        = MUEastern_SKL.MUEastern_ATKA
            AnimationMode        = LOOP
            UseWeaponTiming        = Yes
        End
    End

    AnimationState = ALTERNATE_FORMATION FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
        Animation = ATKC
            AnimationName        = MUEastern_SKL.MUEastern_ATKA
            AnimationMode        = ONCE
            UseWeaponTiming        = Yes
        End
        StateName = PikeUp
    End

    AnimationState = ALTERNATE_FORMATION MOVING BACKING_UP
        Animation = Moving_Back
            AnimationName = MUEastern_SKL.MUEastern_BAKA
            AnimationMode = LOOP
        End
    End

    AnimationState = ALTERNATE_FORMATION MOVING
         Animation = RUNA
            AnimationName        = MUEastern_SKL.MUEastern_RUNA
            AnimationMode        = LOOP
        End
    End


     AnimationState = ALTERNATE_FORMATION DYING AFLAME
        Animation = Flaming_Death
            AnimationName = MUEastern_SKL.MUEastern_MFDA
            AnimationMode = ONCE
        End
    End


    AnimationState    = DYING BURNINGDEATH
        Animation
            AnimationName = MUEastern_SKL.MUEastern_DIEA
            AnimationMode = ONCE
            AnimationBlendTime = 10
        End
    End

    AnimationState =  ALTERNATE_FORMATION DYING
        Animation = Dying_1
            AnimationName = MUEastern_SKL.MUEastern_DIEA
            AnimationMode = ONCE
            AnimationBlendTime            = 15
        End
    End


     AnimationState = ALTERNATE_FORMATION PORCUPINE
         Animation = ATKC
            AnimationName        = MUEastern_SKL.MUEastern_IDLA
            AnimationMode        = LOOP
        End
        StateName = STATE_Planted
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            if Prev ~= "STATE_Planted"    and Prev ~= "Trans_Up_To_Down" then CurDrawableSetTransitionAnimState("Trans_Up_To_Down") return end
        EndScript
    End

     AnimationState = ALTERNATE_FORMATION
         Animation = ATKC
            AnimationName        = MUEastern_SKL.MUEastern_IDLA
            AnimationMode        = LOOP
        End
    End


        AnimationState                        =    EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                    =    Yes
            Animation                        =    Apprehensive
                AnimationName                =    MUEastern_SKL.MUEastern_APPA
                AnimationMode                =    LOOP
            End
        End

        AnimationState                        =    EMOTION_AFRAID
            ShareAnimation                    =    Yes
            Animation                        =    Cower
                AnimationName                =    MUEastern_SKL.MUEastern_FERA
                AnimationMode                =    LOOP
            End
        End

        AnimationState                        = EMOTION_TAUNTING
            Animation                        = TNTA
                AnimationName                = MUEastern_SKL.MUEastern_TNTA
                AnimationMode                = ONCE
                AnimationBlendTime            = 15
                AnimationSpeedFactorRange    = 0.8 1.2
            End
            Animation                        = TNTB
                AnimationName                = MUEastern_SKL.MUEastern_TNTB
                AnimationMode                = ONCE
                AnimationBlendTime            = 15
                AnimationSpeedFactorRange    = 0.8 1.2
            End
            Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1
                AnimationName                = MUEastern_SKL.MUEastern_PNTA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        =    EMOTION_CELEBRATING
            Animation                        =    Celebrating
                AnimationName                =    MUEastern_SKL.MUEastern_CHRA
                AnimationMode                =    ONCE
            End

            Animation                        =    CelebratingB
                AnimationName                =    MUEastern_SKL.MUEastern_CHRB
                AnimationMode                =    ONCE
            End

            Flags                            =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        =    EMOTION_ALERT
            Animation                        =    ALERT
                AnimationName                =    MUEastern_SKL.MUEastern_IDLA
                AnimationMode                =    LOOP
            End
            Flags                            =    RANDOMSTART
        End

        AnimationState                        = RAISING_FLAG
            Animation                        = CHRB
                AnimationName                = MUEastern_SKL.MUEastern_CHRB
                AnimationMode                = ONCE
            End
            Flags                            =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = WAR_CHANT
            Animation = Chant
                AnimationName = MUEastern_SKL.MUEastern_CHRB
                AnimationMode = LOOP
            End
        End


        AnimationState                        =    HIT_REACTION HIT_LEVEL_1
            Animation                        =    HitReaction1
                AnimationName                =    MUEastern_SKL.MUEastern_HITA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        =    HIT_REACTION HIT_LEVEL_2
            Animation                        =    HitReaction2
                AnimationName                =    MUEastern_SKL.MUEastern_HITA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        =    HIT_REACTION HIT_LEVEL_3
            Animation                        =    HitReaction3
                AnimationName                =    MUEastern_SKL.MUEastern_HITA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        =    SELECTED
            ShareAnimation                    =    Yes
            Animation                        =    AtAttention
                AnimationName                =    MUEastern_SKL.MUEastern_ATNB
                AnimationMode                =    LOOP
            End

            StateName                        =    Selected

            BeginScript
                Prev =    CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TransitionToAttention") end
            EndScript
        End


        TransitionState                        =    TransitionToAttention
            Animation                        =    ToAttentionTransition
                AnimationName                =    MUEastern_SKL.MUEastern_ATNA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange    =    1.0 1.4
                AnimationBlendTime            =    10
            End
        End

        TransitionState                        =    TransitionFromAttention
            Animation                        =    FromAttentionTransition
                AnimationName                =    MUEastern_SKL.MUEastern_ATNC
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange    =    1.0 1.4
                AnimationBlendTime            =    10
            End
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side              = Isengard
    EditorSorting     = UNIT
    ThreatLevel       = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints     = 3
    BountyValue       = GONDOR_SOLDIER_BOUNTY_VALUE
    EmotionRange      = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions      = HIDDEN
    End

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    IsengardDeserteurePikeWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainPikemanArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE
        Armor            = EdainPikemanHeavyArmor
        DamageFX        = NormalDamageFX
    End


    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName = OBJECT:IsengardDeserteure
    CrushableLevel = 0
    CrushRevengeWeapon = AntiCavalryInfantryCrushRevenge
    CrusherLevel = 0
    CrushableLevel = 0

    CommandSet = IsengardDeserteureHordeCommandSet





    VoiceAttack                 = PeasantMaleVoiceAttack
    VoiceAttackCharge             = PeasantMaleVoiceAttackCharge
    VoiceAttackStructure             = PeasantMaleVoiceAttackBuilding
    VoiceAttackMachine             = PeasantMaleVoiceAttack
    VoiceCreated                 = PeasantMaleVoiceSalute
    VoiceFullyCreated             = PeasantMaleVoiceSalute
    VoiceGuard                = PeasantMaleVoiceMove
    VoiceMove                 = PeasantMaleVoiceMove
    VoiceMoveToCamp             = PeasantMaleVoiceMoveCamp
    VoiceMoveWhileAttacking         = PeasantMaleVoiceDisengage
    VoicePriority                = 30
    VoiceRetreatToCastle             = PeasantMaleVoiceRetreat
    VoiceSelect                 = PeasantMaleVoiceSelectMS
    VoiceSelectBattle              = PeasantMaleVoiceSelectBattle

    VoiceEnterStateAttack             = PeasantMaleVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = PeasantMaleVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove             = PeasantMaleVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = PeasantMaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking     = PeasantMaleVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle        = PeasantMaleVoiceEnterStateRetreat

    SoundImpact                = ImpactHorse

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
          MaxUpdateRangeCap = 800
            AnimationSound = Sound:BodyFallSoldier         Animation:MUEastern_SKL.MUEastern_LNDA     Frames:2
            AnimationSound = Sound:BodyFallGeneric1         Animation:MUEastern_SKL.MUEastern_DIEA     Frames:52
    End






    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE

    Body                          =    PorcupineFormationBodyModule ModuleTag_porcupineFormation
        CheerRadius               =    EMOTION_CHEER_RADIUS
        MaxHealth                 =    300
        MaxHealthDamaged          =    150
        DamageWeaponTemplate      =    PikemenPorcupineDamage
        CrushDamageWeaponTemplate =    PikemenPorcupineCrushDamage
        CrusherLevelResisted      =    1
        BurningDeathBehavior      =    Yes
        BurningDeathFX            =    FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_HeavyArmor

        ArmorSetFlag            = PLAYER_UPGRADE
    End





    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy        = Upgrade_HeavyArmor
        UpgradeTexture    = gumanatarmsea.tga 0 gumanatarmsea_ha.tga
        RecolorHouse    = Yes
        ExcludeSubobjects = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ModuleTag_Making
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects    = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 80
        AttackPriority                =     AttackPriority_Spearman
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End
    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 1233
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy = Upgrade_GondorFighterFearless
        AttributeModifier = FearlessForever
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL HumanVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object IsengardDeserteure4



    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    EquivalentTo = IsengardDeserteure

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes

        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = gurangerspr_skn
            Skeleton            = GUTwrGrd_SKL
        End

        ModelConditionState WEAPONSET_PLAYER_UPGRADE
            Model               = gurangerspr_skn
            Skeleton            = GUTwrGrd_SKL
        End

        AnimationState        = THROWN_PROJECTILE
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState                            = PASSENGER FREEFALL
            Animation                            = Grabbed
                AnimationName                    = GUTwrGrd_FLLA
                AnimationMode                    = LOOP
            End
        End

        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = GUTwrGrd_FLYA
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUTwrGrd_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                = DYING BURNINGDEATH
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEA
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEB
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
            Animation                = DIEA
                AnimationName         = GUTwrGrd_DIEC
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation           = DIEA
                AnimationName     = GUTwrGrd_DIEC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End


        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = GUTwrGrd_MFDA
                AnimationMode                = LOOP
                Distance                    = 60
            End
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUTwrGrd_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            ShareAnimation                = Yes
            Animation                    = TerrorFromTheSky
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            ShareAnimation                = Yes
            Animation                    = Terror
                AnimationName            = GUTwrGrd_RUNE
                AnimationMode            = LOOP
            End
        End


        AnimationState                =    MOVING BACKING_UP
            ShareAnimation = Yes
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKA
                AnimationMode        =    LOOP
            End
            Animation                =    BackingUp
                AnimationName        =    GUTwrGrd_BAKB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState        = MOVING ALTERNATE_FORMATION

            StateName            = STATE_EnrouteToPorcupine
            Animation
                AnimationName     = GUTwrGrd_RUNA
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUNB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        = MOVING
            ShareAnimation = Yes
            Animation           = RUNA
                AnimationName     = GUTwrGrd_RUNA
                AnimationMode     = LOOP
            End
            Animation
                AnimationName     = GUTwrGrd_RUNB
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART

        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKA
                AnimationName     = GUTwrGrd_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End

        End


        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = GUTwrGrd_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUTwrGrd_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUTwrGrd_LNDA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_Plant
            Animation           = PLTA
                AnimationName     = GUTwrGrd_PLTA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.2
            End
        End

        TransitionState       = TRANS_Unplant
            Animation           = PLTB
                AnimationName     = GUTwrGrd_PLTC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.5 1.2
            End
        End

        AnimationState                        = HIT_REACTION
            Animation                        = HIT REACTION
                AnimationName                = GUTwrGrd_HITA
                AnimationMode                = ONCE
            End
        End


        AnimationState                    = EMOTION_ALERT EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = Apprehensive
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End



        AnimationState                    = EMOTION_AFRAID
            ShareAnimation                = Yes
            Animation                    = FERA
                AnimationName            = GUTwrGrd_FERA
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End



        AnimationState                    = EMOTION_TAUNTING ALTERNATE_FORMATION
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = LOOP
            End
            Animation                    = TNTA
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUTwrGrd_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting2
                AnimationName            = GUTwrGrd_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTA
                AnimationMode            = LOOP
            End
            Animation                    = Pointing1
                AnimationName            = GUTwrGrd_PNTB
                AnimationMode            = LOOP
            End
            Flags                        = RANDOMSTART
        End



        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = LOOP
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = EMOTION_ALERT
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_IDLA
                AnimationMode            = LOOP
            End
        End




        AnimationState                    = SELECTED ALTERNATE_FORMATION PORCUPINE

            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        AnimationState                    = SELECTED ALTERNATE_FORMATION

            StateName                    = STATE_SelectedAlternateFormation
            Animation
                AnimationName            = GUTwrGrd_ATNB
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRA
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRB
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                    = CHRA
                AnimationName            = GUTwrGrd_CHRC
                AnimationMode            = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected

            ShareAnimation                = Yes
            Animation                    = ATNB
                AnimationName            = GUTwrGrd_ATNB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End



        AnimationState                    = ALTERNATE_FORMATION PORCUPINE
            StateName                    = STATE_Planted


            Animation                    = IDLB
                AnimationName            = GUTwrGrd_PLTB
                AnimationMode            = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev ~= "STATE_SelectedAlternateFormation" and Prev ~= "STATE_Planted" and Prev ~= "TRANS_Plant" then CurDrawableSetTransitionAnimState("TRANS_Plant") end
            EndScript
        End
        IdleAnimationState
            StateName                    = STATE_Idle
            Animation                    = IDLB
                AnimationName            = GUTwrGrd_IDLB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLC
                AnimationName            = GUTwrGrd_IDLC
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLD
                AnimationName            = GUTwrGrd_IDLD
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            Animation                    = IDLE
                AnimationName            = GUTwrGrd_IDLE
                AnimationMode            = ONCE
                AnimationBlendTime        = 9
                AnimationSpeedFactorRange = 0.8 1.2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted" then CurDrawableSetTransitionAnimState("TRANS_Unplant") end
            EndScript
        End


    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side              = Isengard
    EditorSorting     = UNIT
    ThreatLevel       = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints     = 3
    BountyValue       = GONDOR_SOLDIER_BOUNTY_VALUE
    EmotionRange      = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions      = HIDDEN
    End

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    IsengardDeserteurePikeWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainPikemanArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE
        Armor            = EdainPikemanHeavyArmor
        DamageFX        = NormalDamageFX
    End


    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName = OBJECT:IsengardDeserteure
    CrushableLevel = 0
    CrushRevengeWeapon = AntiCavalryInfantryCrushRevenge
    CrusherLevel = 0
    CrushableLevel = 0

    CommandSet = IsengardDeserteureHordeCommandSet





    VoiceAttack                 = PeasantMaleVoiceAttack
    VoiceAttackCharge             = PeasantMaleVoiceAttackCharge
    VoiceAttackStructure             = PeasantMaleVoiceAttackBuilding
    VoiceAttackMachine             = PeasantMaleVoiceAttack
    VoiceCreated                 = PeasantMaleVoiceSalute
    VoiceFullyCreated             = PeasantMaleVoiceSalute
    VoiceGuard                = PeasantMaleVoiceMove
    VoiceMove                 = PeasantMaleVoiceMove
    VoiceMoveToCamp             = PeasantMaleVoiceMoveCamp
    VoiceMoveWhileAttacking         = PeasantMaleVoiceDisengage
    VoicePriority                = 30
    VoiceRetreatToCastle             = PeasantMaleVoiceRetreat
    VoiceSelect                 = PeasantMaleVoiceSelectMS
    VoiceSelectBattle              = PeasantMaleVoiceSelectBattle

    VoiceEnterStateAttack             = PeasantMaleVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = PeasantMaleVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine         = PeasantMaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove             = PeasantMaleVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = PeasantMaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking     = PeasantMaleVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle        = PeasantMaleVoiceEnterStateRetreat

    SoundImpact                = ImpactHorse

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TauntHitShieldPitchShifted    Animation:GUTwrGrd_SKL.GUTwrGrd_TNTB    Frames: 23 43
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEA    Frames:30 51
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEB    Frames:57
        AnimationSound = Sound:BodyFallGeneric1        Animation:GUTWRGRD_SKL.GUTWRGRD_DIEC    Frames:38
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTWRGRD_SKL.GUTWRGRD_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:GUTwrGrd_SKL.GUTwrGrd_LNDB    Frames:2
    End






    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE

    Body                          =    PorcupineFormationBodyModule ModuleTag_porcupineFormation
        CheerRadius               =    EMOTION_CHEER_RADIUS
        MaxHealth                 =    400
        MaxHealthDamaged          =    200
        DamageWeaponTemplate      =    PikemenPorcupineDamage
        CrushDamageWeaponTemplate =    PikemenPorcupineCrushDamage
        CrusherLevelResisted      =    1
        BurningDeathBehavior      =    Yes
        BurningDeathFX            =    FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade1
        TriggeredBy        = Upgrade_IsengardFaction
        HideSubObjects    = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 80
        AttackPriority                =     AttackPriority_Spearman
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 1233
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy = Upgrade_GondorFighterFearless
        AttributeModifier = FearlessForever
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL HumanVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object IsengardDeserteure5



    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HSIsengardVerraeter

    EquivalentTo = IsengardDeserteure

   Draw = W3DHordeModelDraw ModuleTag_01

        OkToChangeModelColor    = Yes
        StaticModelLODMode        = Yes


        LodOptions                            = LOW
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_LOW
        End

        LodOptions                            = MEDIUM
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_MED
        End

        LodOptions                            = HIGH
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_HIGH
        End

        WadingParticleSys = WaterRipplesTrail

        DefaultModelConditionState
            Model = DUPhalanxl_SKN
            Skeleton = DUPhalanx_SKL
        End

        ModelConditionState = COMING_OUT_OF_FACTORY
            Model = DUPhalanxl_SKN
        End




        AnimationState                        = PASSENGER
            Animation                        = Grabbed
                AnimationName                = DUPhalanx_FLLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = THROWN_PROJECTILE
            Animation                       = FlyA
                AnimationName                   = DUPhalanx_FLYA
                AnimationMode               = LOOP
            End
            Animation                       = FlyB
                AnimationName                   = DUPhalanx_FLYB
                AnimationMode               = LOOP
            End
            Animation                       = FlyC
                AnimationName                   = DUPhalanx_FLYC
                AnimationMode               = LOOP
            End
            Flags                           = RANDOMSTART
        End

        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUPhalanx_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
            End
            Animation                       = FlyB
                AnimationName                   = DUPhalanx_FLYB
                AnimationMode               = LOOP
                AnimationBlendTime            = 10
            End
            Animation                       = FlyC
                AnimationName                   = DUPhalanx_FLYC
                AnimationMode               = LOOP
                AnimationBlendTime            = 10
            End
        End





    AnimationState = ALTERNATE_FORMATION FIRING_OR_PREATTACK_A
         Animation = ATKA
            AnimationName        = DUPhalanx_ATKA
            AnimationMode        = LOOP
            UseWeaponTiming        = Yes
        End
         Animation = ATKB
            AnimationName        = DUPhalanx_ATKB
            AnimationMode        = LOOP
            UseWeaponTiming        = Yes
        End
         Animation = ATKC
            AnimationName        = DUPhalanx_ATKC
            AnimationMode        = LOOP
            UseWeaponTiming        = Yes
        End
    End

    AnimationState = ALTERNATE_FORMATION FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
        Animation = ATKC
            AnimationName        = DUPhalanx_ATKA
            AnimationMode        = ONCE
            UseWeaponTiming        = Yes
        End
        Animation = ATKB
            AnimationName        = DUPhalanx_ATKB
            AnimationMode        = ONCE
            UseWeaponTiming        = Yes
        End
        Animation = ATKC
            AnimationName        = DUPhalanx_ATKC
            AnimationMode        = ONCE
            UseWeaponTiming        = Yes
        End
        StateName = PikeUp
    End

    AnimationState = ALTERNATE_FORMATION MOVING BACKING_UP
        Animation = Moving_BackA
            AnimationName = DUPhalanx_BAKA
            AnimationMode = LOOP
        End
        Animation = Moving_BackB
            AnimationName = DUPhalanx_BAKB
            AnimationMode = LOOP
        End
        Animation = Moving_BackC
            AnimationName = DUPhalanx_BAKC
            AnimationMode = LOOP
        End
    End

    AnimationState = ALTERNATE_FORMATION MOVING
         Animation = ATKC
            AnimationName        = DUPhalanx_RUNA
            AnimationMode        = LOOP
        End
    End

        AnimationState = ALTERNATE_FORMATION STUNNED_FLAILING
         Animation = Flying_1A
            AnimationName = DUPhalanx_FLYA
            AnimationMode = LOOP
        End
         Animation = Flying_1B
            AnimationName = DUPhalanx_FLYB
            AnimationMode = LOOP
        End
         Animation = Flying_1C
            AnimationName = DUPhalanx_FLYC
            AnimationMode = LOOP
        End
        Flags                            = MAINTAIN_FRAME_ACROSS_STATES2
    End


    AnimationState                        = DYING BURNINGDEATH
        Animation
            AnimationName                = DUPhalanx_DIEA
            AnimationMode                = ONCE
            AnimationBlendTime            = 10
        End
        Animation
            AnimationName                = DUPhalanx_DIEB
            AnimationMode                = ONCE
            AnimationBlendTime            = 10
        End
        Animation
            AnimationName                = DUPhalanx_DIEC
            AnimationMode                = ONCE
            AnimationBlendTime            = 10
        End
    End

    AnimationState                        = ALTERNATE_FORMATION DYING SPLATTED
         Animation                        = Splat
            AnimationName                = DUPhalanx_LNDA
            AnimationMode                = ONCE
        End
    End

     AnimationState = ALTERNATE_FORMATION DYING AFLAME
        Animation = Flaming_Death
            AnimationName = DUPhalanx_MFDA
            AnimationMode = ONCE
        End
    End

    AnimationState =  ALTERNATE_FORMATION DYING
        Animation = Dying_1A
            AnimationName = DUPhalanx_DIEA
            AnimationMode = ONCE
        End
        Animation = Dying_1B
            AnimationName = DUPhalanx_DIEB
            AnimationMode = ONCE
        End
        Animation = Dying_1C
            AnimationName = DUPhalanx_DIEC
            AnimationMode = ONCE
        End
    End


    AnimationState = ALTERNATE_FORMATION STUNNED_STANDING_UP
         Animation = Standing_Back_Up
            AnimationName = DUPhalanx_GTPA
            AnimationMode = ONCE
            AnimationSpeedFactorRange = 1.5 1.5
        End
    End


    AnimationState = ALTERNATE_FORMATION STUNNED
         Animation = Splattered_On_Ground
            AnimationName = DUPhalanx_LNDA
            AnimationMode = ONCE
        End
    End

     AnimationState = ALTERNATE_FORMATION PORCUPINE
         Animation = ATKC
            AnimationName        = DUPhalanx_PLTB
            AnimationMode        = LOOP
        End
        StateName = STATE_Planted
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            if Prev ~= "STATE_Planted"    and Prev ~= "Trans_Up_To_Down" then CurDrawableSetTransitionAnimState("Trans_Up_To_Down") return end
        EndScript
    End


     AnimationState = ALTERNATE_FORMATION
         Animation = ATKC
            AnimationName        = DUPhalanx_PLTB
            AnimationMode        = LOOP
        End
    End




        AnimationState                        = STUNNED_FLAILING
            Animation                       = FlyA
                AnimationName               = DUPhalanx_FLYA
                AnimationMode               = LOOP
            End
            Animation                       = FlyB
                AnimationName               = DUPhalanx_FLYB
                AnimationMode               = LOOP
            End
            Animation                       = FlyC
                AnimationName               = DUPhalanx_FLYC
                AnimationMode               = LOOP
            End
            Flags                           = RANDOMSTART
        End

        AnimationState                         = DYING SPLATTED
            Animation                         = Splatted_On_Ground
                AnimationName                 = DUPhalanx_LNDA
                AnimationMode                 = ONCE
            End
            EnteringStateFX                    = FX_OrcHitGround
        End

        AnimationState                        = DYING DEATH_2
            Animation
                AnimationName                = DUPhalanx_IDLB
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = DYING
            Animation                        = DIEB
                AnimationName                = DUPhalanx_DIEA
                AnimationMode                = ONCE
            End
            Animation                        = DIEB
                AnimationName                = DUPhalanx_DIEB
                AnimationMode                = ONCE
            End
            Animation                        = DIEB
                AnimationName                = DUPhalanx_DIEC
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUPhalanx_MFDA
                AnimationMode                = LOOP
                Distance                    = 35
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUPhalanx_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                        = STUNNED_STANDING_UP
            Animation                        = GTPA
                AnimationName                = DUPhalanx_GTPA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState            = STUNNED
            Animation            = Slatted_On_Ground
                AnimationName    = DUPhalanx_LNDA
                AnimationMode     = ONCE
            End
            EnteringStateFX        = FX_OrcHitGround
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = Stunned_Standing_Up
                AnimationName     = DUPhalanx_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End


        AnimationState                        = MOVING EMOTION_TERROR

            Animation                        = TerrorFromTheSky
                AnimationName                = DUPhalanx_MFDA
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                        = MOVING BACKING_UP

            Animation                        = BAKA
                AnimationName                = DUPhalanx_BAKA
                AnimationMode                = LOOP
            End
            Animation                        = BAKB
                AnimationName                = DUPhalanx_BAKB
                AnimationMode                = LOOP
            End
            Animation                        = BAKC
                AnimationName                = DUPhalanx_BAKC
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState                        = MOVING ATTACKING
            ShareAnimation                    = Yes
            Animation                        = RUNA
                AnimationName                = DUPhalanx_RUND
                AnimationMode                = LOOP
                Distance                    = 25
            End
            Flags                            = RANDOMSTART

        End

        AnimationState                        = MOVING

            ShareAnimation                    = Yes
            Animation                        = RUNB
                AnimationName                = DUPhalanx_RUNA
                AnimationMode                = LOOP
                Distance                    = 30
            End
            Flags                            = RANDOMSTART

        End


        AnimationState                        = EMOTION_UNCONTROLLABLY_AFRAID
            Animation                        = FERA
                AnimationName                = DUPhalanx_FERA
                AnimationMode                = LOOP
            End
            Animation                        = FERB
                AnimationName                = DUPhalanx_FERB
                AnimationMode                = LOOP
            End
            Animation                        = FERC
                AnimationName                = DUPhalanx_FERC
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATK1
                AnimationName                = DUPhalanx_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = ATK1
                AnimationName                = DUPhalanx_ATKB
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = ATK1
                AnimationName                = DUPhalanx_ATKC
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End

        End


        AnimationState                        = HIT_REACTION
            Animation                        = HITA
                AnimationName                = DUPhalanx_HITA
                AnimationMode                = ONCE
            End
        End





        AnimationState                        = EMOTION_AFRAID
            Animation                        = FERA
                AnimationName                = DUPhalanx_FERA
                AnimationMode                = LOOP
            End
            Animation                        = FERB
                AnimationName                = DUPhalanx_FERB
                AnimationMode                = LOOP
            End
            Animation                        = FERC
                AnimationName                = DUPhalanx_FERC
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End

        AnimationState                        = ATTACKING
            Animation                        = ALERT_1
                AnimationName                = DUPhalanx_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1A
                AnimationName                = DUPhalanx_PNTA
                AnimationMode                = LOOP
            End
            Animation                        = Pointing1B
                AnimationName                = DUPhalanx_PNTB
                AnimationMode                = LOOP
            End
            Animation                        = Pointing1C
                AnimationName                = DUPhalanx_PNTC
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
        End


        AnimationState                        = EMOTION_CELEBRATING
            Animation                        = CHRA
                AnimationName                = DUPhalanx_CHRA
                AnimationMode                = LOOP
                AnimationPriority            = 5
            End
            Animation                        = CHRB
                AnimationName                = DUPhalanx_CHRB
                AnimationMode                = LOOP
                AnimationPriority            = 5
            End
            Animation                        = CHRC
                AnimationName                = DUPhalanx_CHRC
                AnimationMode                = LOOP
                AnimationPriority            = 1
            End
            Flags                            = RANDOMSTART
        End


        AnimationState                    = EMOTION_TAUNTING
            Animation
                AnimationName            = DUPhalanx_TNTA
                AnimationMode            = LOOP
            End
            Animation
                AnimationName            = DUPhalanx_TNTB
                AnimationMode            = LOOP
            End
            Animation
                AnimationName            = DUPhalanx_TNTC
                AnimationMode            = LOOP
            End
            Flags                            = RANDOMSTART
        End




        AnimationState                        = EMOTION_ALERT
            Animation                        = ALERT_1
                AnimationName                = DUPhalanx_IDLA
                AnimationMode                = LOOP
                AnimationPriority            = 10
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = RAISING_FLAG
            Animation                        = CHRA
                AnimationName                = DUPhalanx_CHRA
                AnimationMode                = LOOP
                AnimationPriority            = 5
            End
            Animation                        = CHRB
                AnimationName                = DUPhalanx_CHRB
                AnimationMode                = LOOP
                AnimationPriority            = 5
            End
            Animation                        = CHRC
                AnimationName                = DUPhalanx_CHRC
                AnimationMode                = LOOP
                AnimationPriority            = 1
            End
        End


        AnimationState        = SELECTED
            StateName           = STATE_Selected
            Animation           = ATNB
                AnimationName     = DUPhalanx_ATNB
                AnimationMode     = LOOP
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
            EndScript
        End


        AnimationState                = WEAPONSET_PLAYER_UPGRADE
            StateName                = STATE_Idle
            Animation                = IDLB
                AnimationName       = DUPhalanx_IDLB
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                = IDLC
                AnimationName       = DUPhalanx_IDLC
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                = CHRA
                AnimationName       = DUPhalanx_CHRA
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
            EndScript
        End
        AnimationState                = USER_3
            StateName                = STATE_User_3
            Animation                = GUARD_STANCE
                AnimationName        = DUPhalanx_IDLA
                AnimationMode        = LOOP
            End
        End
        IdleAnimationState


            StateName                = STATE_Idle
            Animation                = IDLA
                AnimationName       = DUPhalanx_IDLA
                AnimationMode       = ONCE
                AnimationPriority   = 100
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            Animation                = IDLB
                AnimationName       = DUPhalanx_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 10
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            Animation                = IDLC
                AnimationName       = DUPhalanx_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 5
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            Animation                = IDLD
                AnimationName       = DUPhalanx_IDLD
                AnimationMode       = ONCE
                AnimationPriority   = 5
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 2
            End
            Animation                = IDLE
                AnimationName       = DUPhalanx_IDLE
                AnimationMode       = ONCE
                AnimationPriority   = 5
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Planted"    then CurDrawableSetTransitionAnimState("Trans_Down_To_Up") return end
                if Prev == "STATE_Selected" or Prev == "Trans_Down_To_Up" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
            EndScript
        End


        TransitionState = Trans_Down_To_Up
            Animation = Transition
                AnimationName = DUPhalanx_PLTC
                AnimationMode = ONCE
            End
        End

        TransitionState = Trans_Up_To_Down
            Animation = Transition
                AnimationName = DUPhalanx_PLTA
                AnimationMode = ONCE
            End
        End

        TransitionState       = TRANS_IdleToSelected
            Animation           = ATNA
                AnimationName     = DUPhalanx_ATNA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.8 1.0

            End
        End
        TransitionState        = TRANS_SelectedToIdle
            Animation            = ATNC
                AnimationName    = DUPhalanx_ATNC
                AnimationMode    = ONCE
                AnimationSpeedFactorRange = 0.8 1.0
            End
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side              = Isengard
    EditorSorting     = UNIT
    ThreatLevel       = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints     = 3
    BountyValue       = GONDOR_SOLDIER_BOUNTY_VALUE
    EmotionRange      = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    Scale             = 0.88


    WeaponSet
        Conditions      = HIDDEN
    End

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    IsengardDeserteurePikeWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainPikemanArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE
        Armor            = EdainPikemanHeavyArmor
        DamageFX        = NormalDamageFX
    End


    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName = OBJECT:IsengardDeserteure
    CrushableLevel = 0
    CrushRevengeWeapon = AntiCavalryInfantryCrushRevenge
    CrusherLevel = 0
    CrushableLevel = 0

    CommandSet = IsengardDeserteureHordeCommandSet





    VoiceAttack                                = DwarfPhalanxVoiceAttack
    VoiceAttackCharge                        = DwarfPhalanxVoiceAttackCharge
    VoiceAttackMachine                        = DwarfPhalanxVoiceAttack
    VoiceAttackStructure                    = DwarfPhalanxVoiceAttackBuilding
    VoiceCreated                            = DwarfPhalanxVoiceSalute
    VoiceFullyCreated                         = DwarfPhalanxVoiceSalute
    VoiceGuard                                = DwarfPhalanxVoiceMove
    VoiceMove                                = DwarfPhalanxVoiceMove
    VoiceMoveToCamp                            = DwarfPhalanxVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfPhalanxVoiceDisengage
    VoicePriority                            = 54
    VoiceRetreatToCastle                    = DwarfPhalanxVoiceRetreat
    VoiceSelect                                = DwarfPhalanxVoiceSelectMS
    VoiceSelectBattle                         = DwarfPhalanxVoiceSelectBattle

    VoiceEnterStateAttack                    = DwarfPhalanxVoiceEnterStateAttack
    VoiceEnterStateAttackCharge                = DwarfPhalanxVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine            = DwarfPhalanxVoiceEnterStateAttack
    VoiceEnterStateAttackStructure            = DwarfPhalanxVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                        = DwarfPhalanxVoiceEnterStateMove
    VoiceEnterStateMoveToCamp                = DwarfPhalanxVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking        = DwarfPhalanxVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle            = DwarfPhalanxVoiceEnterStateRetreat

    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfPhalanxVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfPhalanxVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfPhalanxVoiceCaptureBuilding
    End

    SoundImpact                = ImpactHorse

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800

        AnimationSound = Sound:BodyFallOrc            Animation:DUPHALANX_SKL.DUPHALANX_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUPHALANX_SKL.DUPHALANX_DIEA    Frames:13
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUPHALANX_SKL.DUPHALANX_DIEB    Frames:45
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUPHALANX_SKL.DUPHALANX_DIEC    Frames:22
    End






    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP PIKE

    Body                          =    PorcupineFormationBodyModule ModuleTag_porcupineFormation
        CheerRadius               =    EMOTION_CHEER_RADIUS
        MaxHealth                 =    500
        MaxHealthDamaged          =    250
        DamageWeaponTemplate      =    PikemenPorcupineDamage
        CrushDamageWeaponTemplate =    PikemenPorcupineCrushDamage
        CrusherLevelResisted      =    1
        BurningDeathBehavior      =    Yes
        BurningDeathFX            =    FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagGuardian
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = SubObjectsUpgrade ForgedBlade_UpgradeGuardian
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        UpgradeTexture    = DUPhalanx_01.tga 0 duphalanx_01HA.tga
        RecolorHouse      = Yes
        ExcludeSubobjects = Forged_Blade
    End


    Behavior = SubObjectsUpgrade ModuleTag_MakingTheFX
        TriggeredBy       = Upgrade_ObjectLevel1
        HideSubObjects    = FORGED_BLADE
    End



    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 80
        AttackPriority                =     AttackPriority_Spearman
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 1233
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy = Upgrade_GondorFighterFearless
        AttributeModifier = FearlessForever
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 10000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


