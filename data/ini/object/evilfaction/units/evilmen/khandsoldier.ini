Object EvilmenKhandSoldier


    ; ButtonImage            = HSKhandSoldier
    ; SelectPortrait         = UPKhandSoldier

    Draw = W3DHordeModelDraw ModuleTag_01



        DefaultModelConditionState
            Model               = hukhand_skn
            Skeleton            = RUElfWar_SKL
            WeaponLaunchBone    = PRIMARY ARROW
            WeaponLaunchBone    = SECONDARY ARROWNOCK
        End


        ModelConditionState     = WEAPONSET_TOGGLE_1
            Model               = hukhand_skn
            Skeleton            = RUElfWar_SKL
        End





        AnimationState                    = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName            = STATE_GetUp
            Animation                   = Sword
                AnimationName           = RUElfWar_GTPSX1
                AnimationMode           = ONCE
            End
            Animation                   = WantSword
                AnimationName           = RUElfWar_GTPB
                AnimationMode           = ONCE
            End
            Flags                = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED_STANDING_UP
            StateName            = STATE_GetUp
            Animation                   = Bow
                AnimationName           = RUElfWar_GTPB
                AnimationMode           = ONCE
            End
            Animation                   = WantBow
                AnimationName           = RUElfWar_GTPSX1
                AnimationMode           = ONCE
            End
            Flags                = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow"
                end
            EndScript
        End

        AnimationState                    = STUNNED WEAPONSET_TOGGLE_1
            StateName            = STATE_Land
            Animation                   = Sword
                AnimationName           = RUElfWar_LNDB
                AnimationMode           = ONCE
            End
            Animation                   = WantSword
                AnimationName           = RUElfWar_LNDA
                AnimationMode           = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantSword" or PrevAnim == "Bow"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                Flags            = MAINTAIN_FRAME_ACROSS_STATES3
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED
            StateName            = STATE_Land
            Animation                   = Bow
                AnimationName           = RUElfWar_LNDA
                AnimationMode           = ONCE
            End
            Animation                   = WantBow
                AnimationName           = RUElfWar_LNDB
                AnimationMode           = ONCE
            End
            Flags                = MAINTAIN_FRAME_ACROSS_STATES3
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                end

                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                return "Bow"
            EndScript
        End

        AnimationState                    = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName            = STATE_Fly
            Animation                   = Sword
                AnimationName           = RUElfWar_FLYB
                AnimationMode           = LOOP
            End
            Animation                   = WantSword
                AnimationName           = RUElfWar_FLYA
                AnimationMode           = LOOP
            End
            Flags                = MAINTAIN_FRAME_ACROSS_STATES2
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                elseif PrevState == "STATE_Fly"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED_FLAILING
            StateName            = STATE_Fly
            Animation                   = Bow
                AnimationName           = RUElfWar_FLYA
                AnimationMode           = LOOP
            End
            Animation                   = WantBow
                AnimationName           = RUElfWar_FLYB
                AnimationMode           = LOOP
            End
            Flags                = MAINTAIN_FRAME_ACROSS_STATES2
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "Ready_Sword" or PrevState == "Moving_Sword" or PrevState == "Bored_Sword"
                then
                    CurDrawableHideSubObject("ArrowNock")
                    CurDrawableHideSubObject("arrow")
                    return "WantBow"
                elseif PrevState == "STATE_Fly"
                then
                    if PrevAnim == "Sword" or PrevAnim == "WantBow"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                end

                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                return "Bow"
            EndScript
        End




        AnimationState                    = DYING WEAPONSET_TOGGLE_1
            Animation                   = Sword1
                AnimationName           = RUElfWar_DIESv5
                AnimationMode           = ONCE
            End
            Animation                   = Sword2
                AnimationName           = RUElfWar_DIESV4
                AnimationMode           = ONCE
            End
            Animation                   = WantSword
                AnimationName           = RUElfWar_LNDA
                AnimationMode           = ONCE
            End

            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if GetClientRandomNumberReal(0,2) < 1
                then
                    return "Sword1"
                else
                    return "Sword2"
                end
            EndScript
        End

        AnimationState                    = DYING
            Animation                   = Bow1
                AnimationName           = RUElfWar_DIEB
                AnimationMode           = ONCE
            End
            Animation                   = Bow2
                AnimationName           = RUElfWar_DIEBV5
                AnimationMode           = ONCE
            End
            Animation                   = WantBow
                AnimationName           = RUElfWar_LNDB
                AnimationMode           = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()

                if PrevState == "STATE_Fly"
                then
                    CurDrawableHideSubObject("ArrowNock")
                    CurDrawableHideSubObject("arrow")
                    return "WantBow"
                end

                if GetClientRandomNumberReal(0,2) < 1
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow1"
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow2"
                end
            EndScript
        End




        AnimationState                = MOVING EMOTION_TERROR WEAPONSET_TOGGLE_1
            StateName            = Moving_Sword
            Animation            = Terror
                AnimationName        = RUElfWar_RUNN
                AnimationMode        = LOOP
                Distance        = 40
            End
            Animation            = finishrun_b
                AnimationName           = RUElfWar_RUNB
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Animation            = runtrans_bs
                AnimationName           = RUElfWar_RUNC
                AnimationMode           = ONCE
                AnimationBlendTime    = 5
                Distance        = 70
            End
            Animation            = runtrans_sb_finish
                AnimationName           = RUElfWar_RUNT
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = runnoblend_s
                AnimationName           = RUElfWar_RUNN
                AnimationMode           = LOOP
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Flags                = RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
            BeginScript
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                if PrevState == "Moving_Bow"
                then
                    if PrevAnim == "runtrans_sb"
                    then
                        return "runtrans_sb_finish"
                    elseif PrevAnim == "finishrun_s"
                    then
                        return "runnoblend_s"
                    else
                        return "finishrun_b"
                    end
                elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish"
                then
                    return "runtrans_bs"
                elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
                then
                    return "runnoblend_s"
                else
                    return "Terror"
                end
            EndScript
        End
        AnimationState                = MOVING EMOTION_TERROR
            StateName            = Moving_Bow
            Animation            = RunAway_3
                AnimationName        = RUElfWar_RUNOT3
                AnimationMode        = ONCE
                Distance        = 40
            End
            Animation            = RunAway_2
                AnimationName        = RUElfWar_RUNOT4
                AnimationMode        = ONCE
                Distance        = 40
            End
            Animation            = RunAway
                AnimationName        = RUElfWar_RUNB
                AnimationMode        = ONCE
                Distance        = 40
            End
            Animation            = finishrun_s
                AnimationName           = RUElfWar_RUNN
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Animation            = runtrans_sb
                AnimationName           = RUElfWar_RUNT
                AnimationMode           = ONCE
                AnimationBlendTime    = 5
                Distance        = 70
            End
            Animation            = runtrans_bs_finish
                AnimationName           = RUElfWar_RUNC
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = RunAway_noblend
                AnimationName        = RUElfWar_RUNB
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Flags                = RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
            BeginScript
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "Moving_Sword"
                then
                    if PrevAnim == "runtrans_bs"
                    then
                        return "runtrans_bs_finish"
                    elseif PrevAnim == "finishrun_b"
                    then
                        return "RunAway_noblend"
                    else
                        return "finishrun_s"
                    end
                elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish"
                then
                    return "runtrans_sb"
                elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
                then
                    return "RunAway_noblend"
                else
                    Num = GetClientRandomNumberReal(0,7)
                    if Num < 1
                    then
                        return "RunAway_2"
                    elseif Num > 6
                    then
                        return "RunAway_3"
                    else
                        return "RunAway"
                    end
                end
            EndScript
        End




        AnimationState                    = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName            = Ready_Sword

            Animation                   = AttackWithSwordA
                AnimationName           = RUElfWar_ATKSV2
                AnimationMode           = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                   = AttackWithSwordB
                AnimationName           = RUElfWar_ATKS
                AnimationMode           = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                   = AttackWithSwordD
                AnimationName           = RUElfWar_ATKSV4
                AnimationMode           = ONCE
                UseWeaponTiming        = Yes
            End
            BeginScript
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                    = PREATTACK_A
            Animation                = ReadyToDrawn
                AnimationName            = RUElfWar_ATKA1
                AnimationMode            = ONCE
                AnimationBlendTime        = 20
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                    = FIRING_OR_RELOADING_A
            StateName                = STATE_Firing
            Animation                = OneFrameOfShooting
                AnimationName            = RUElfWar_ATKA2
                AnimationMode            = ONCE
                AnimationBlendTime        = 0
                AnimationSpeedFactorRange    = 1.5 1.5
            End
            Flags                    = START_FRAME_FIRST
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                    = PREATTACK_C WEAPONSET_TOGGLE_1
            Animation                = ReadyToDrawn
                AnimationName            = RUElfWar_ATKA1
                AnimationMode            = ONCE
                AnimationBlendTime        = 20
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                    = FIRING_OR_RELOADING_C WEAPONSET_TOGGLE_1
            StateName                = STATE_Firing
            Animation                = OneFrameOfShooting
                AnimationName            = RUElfWar_ATKA2
                AnimationMode            = ONCE
                AnimationBlendTime        = 0
                AnimationSpeedFactorRange    = 1.5 1.5
            End
            Flags                    = START_FRAME_FIRST
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End





        AnimationState                    = MOVING BACKING_UP WEAPONSET_TOGGLE_1
            StateName                = STATE_BackingUp
            Animation                = Sword
                AnimationName            = RUElfWar_BAKS
                AnimationMode            = LOOP
            End
            Animation                = WantSword
                AnimationName            = RUElfWar_BAKB
                AnimationMode            = LOOP
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        return "WantSword"
                    end
                end

                return "Sword"
            EndScript
        End
        AnimationState                    = MOVING BACKING_UP
            StateName                = STATE_BackingUp
            Animation                = Bow
                AnimationName            = RUElfWar_BAKB
                AnimationMode            = LOOP
            End
            Animation                = WantBow
                AnimationName            = RUElfWar_BAKS
                AnimationMode            = LOOP
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        return "WantBow"
                    end
                end

                return "Bow"
            EndScript
        End



        AnimationState                    = MOVING WEAPONSET_TOGGLE_1
            StateName            = Moving_Sword
            SimilarRestart            = Yes
            Animation                   = run_s
                AnimationName           = RUElfWar_RUNS
                AnimationMode           = LOOP
                Distance        = 40
            End
            Animation            = finishrun_b
                AnimationName           = RUElfWar_RUNB
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Animation            = runtrans_bs
                AnimationName           = RUElfWar_RUNC
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = runtrans_sb_finish
                AnimationName           = RUElfWar_RUNT
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = runnoblend_s
                AnimationName           = RUElfWar_RUNS
                AnimationMode           = LOOP
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                if PrevState == "Moving_Bow"
                then
                    if PrevAnim == "runtrans_sb"
                    then
                        return "runtrans_sb_finish"
                    elseif PrevAnim == "finishrun_s"
                    then
                        return "runnoblend_s"
                    else
                        return "finishrun_b"
                    end
                elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish" or PrevAnim == "WantSword"
                then
                    return "runtrans_bs"
                elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
                then
                    return "runnoblend_s"
                else
                    return "run_s"
                end
            EndScript
        End

        AnimationState                    = MOVING
            StateName            = Moving_Bow
            SimilarRestart            = Yes
            Animation                   = run_b
                AnimationName           = RUElfWar_RUNB
                AnimationMode           = LOOP
                Distance        = 40
            End
            Animation            = finishrun_s
                AnimationName           = RUElfWar_RUNS
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Animation            = runtrans_sb
                AnimationName           = RUElfWar_RUNT
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = runtrans_bs_finish
                AnimationName           = RUElfWar_RUNC
                AnimationMode           = ONCE
                AnimationBlendTime    = 0
                Distance        = 70
            End
            Animation            = runnoblend_b
                AnimationName           = RUElfWar_RUNB
                AnimationMode           = LOOP
                AnimationBlendTime    = 0
                Distance        = 40
            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()

                if PrevState == "Moving_Sword"
                then
                    if PrevAnim == "runtrans_bs"
                    then
                        return "runtrans_bs_finish"
                    elseif PrevAnim == "finishrun_b"
                    then
                        return "runnoblend_b"
                    else
                        return "finishrun_s"
                    end
                elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish" or PrevAnim == "WantBow"
                then
                    return "runtrans_sb"
                elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
                then
                    return "runnoblend_b"
                else
                    return "run_b"
                end
            EndScript
        End



























        AnimationState                    = CONTINUOUS_FIRE_MEAN
            Animation                = HangFrameWhileCoasting
                AnimationName            = RUElfWar_ATKA2
                AnimationMode            = MANUAL
                AnimationBlendTime        = 0
            End
            Flags                    = START_FRAME_LAST

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
                if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
            EndScript









        End

        AnimationState                    = CONTINUOUS_FIRE_SLOW
            StateName                = Ready_Bow
            Animation                = PutAwayArrow
                AnimationName            = RUElfWar_ATKA3
                AnimationMode            = ONCE
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
            EndScript
        End


        AnimationState                    = EMOTION_UNCONTROLLABLY_AFRAID WEAPONSET_TOGGLE_1
            StateName                = STATE_Emotion_Sword
            Animation                = Sword
                AnimationName            = RUElfWar_FERS
                AnimationMode            = ONCE
            End
            Animation                = Sword2
                AnimationName            = RUElfWar_FERS
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                end
            EndScript
        End
        AnimationState                    = EMOTION_UNCONTROLLABLY_AFRAID
            StateName                = STATE_Emotion_Bow
            Animation                = Bow
                AnimationName            = RUElfWar_FERB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
            End
            Animation                = Bow2
                AnimationName            = RUElfWar_FERB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                end
            EndScript
        End




        AnimationState                    = EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                = Ready_Sword

            Animation                = Alert_1
                AnimationName            = RUElfWar_IDLST1
                AnimationMode            = LOOP
            End

            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ENGAGED WEAPONSET_TOGGLE_1
            StateName                = Ready_Sword

            Animation                = Alert_1
                AnimationName            = RUElfWar_IDLST1
                AnimationMode            = LOOP
            End

            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING WEAPONSET_TOGGLE_1
            StateName                = Ready_Sword

            Animation                = Alert_1
                AnimationName            = RUElfWar_IDLST1
                AnimationMode            = LOOP
            End

            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End

        AnimationState                    = EMOTION_ALERT
            StateName                = Ready_Bow

            Animation                = IDLB
                AnimationName            = RUElfWar_IDLB
                AnimationMode            = LOOP
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                    = ENGAGED
            StateName                = Ready_Bow

            Animation                = IDLB
                AnimationName            = RUElfWar_IDLB
                AnimationMode            = LOOP
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING
            StateName                = Ready_Bow

            Animation                = IDLB
                AnimationName            = RUElfWar_IDLB
                AnimationMode            = LOOP
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End






        AnimationState                    = EMOTION_AFRAID WEAPONSET_TOGGLE_1
            StateName                = STATE_Emotion_Sword
            Animation                = Sword
                AnimationName            = RUElfWar_FERS
                AnimationMode            = ONCE
            End
            Animation                = Sword2
                AnimationName            = RUElfWar_FERS
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                end
            EndScript
        End
        AnimationState                    = EMOTION_AFRAID
            StateName                = STATE_Emotion_Bow
            Animation                = Bow
                AnimationName            = RUElfWar_FERB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
            End
            Animation                = Bow2
                AnimationName            = RUElfWar_FERB
                AnimationMode            = ONCE
                AnimationBlendTime        = 15
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                end
            EndScript
        End



        AnimationState                    = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            StateName                = STATE_Emotion_Sword
            Animation                = Sword
                AnimationName            = RUElfWar_CHRST2
                AnimationMode            = ONCE
            End
            Animation                = Sword2
                AnimationName            = RUElfWar_CHRST2
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_CELEBRATING
            StateName                = STATE_Emotion_Bow
            Animation                = Bow
                AnimationName            = RUElfWar_CHRB
                AnimationMode            = ONCE
            End
            Animation                = Bow2
                AnimationName            = RUElfWar_CHRB
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            StateName                = STATE_Emotion_Sword
            Animation                = Sword
                AnimationName            = RUElfWar_TNTSV1
                AnimationMode            = ONCE
            End
            Animation                = Sword2
                AnimationName            = RUElfWar_TNTSV1
                AnimationMode            = ONCE
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                    then
                        CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_TAUNTING
            StateName                = STATE_Emotion_Bow
            Animation                = Bow1
                AnimationName            = RUElfWar_TNTB
                AnimationMode            = ONCE
            End
            Animation                = Bow2
                AnimationName            = RUElfWar_TNTB
                AnimationMode            = ONCE
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_POINTING WEAPONSET_TOGGLE_1
            StateName                = STATE_Emotion_Sword
            Animation                = Sword
                AnimationName            = RUElfWar_PNTB
                AnimationMode            = ONCE
            End
            Animation                = Sword2
                AnimationName            = RUElfWar_PNTB
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_POINTING
            StateName                = STATE_Emotion_Bow
            Animation                = Bow
                AnimationName            = RUElfWar_PNTA
                AnimationMode            = ONCE
            End
            Animation                = Bow2
                AnimationName            = RUElfWar_PNTA
                AnimationMode            = ONCE
            End
            Flags                    = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                =    SELECTED WEAPONSET_TOGGLE_1
            StateName            =    Selected_Sword

            Animation            =    ATNA
                AnimationName        =    RUElfWar_ATNS
                AnimationMode        =    LOOP
            End

            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BS_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RS_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end

            EndScript
        End

        AnimationState                =    SELECTED
            StateName                   =    Selected_Bow

            Animation            =    ATNE
                AnimationName        =    RUElfWar_ATNE
                AnimationMode        =    LOOP
            End

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BS_Bow")                end
                if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




        AnimationState                        = HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
            StateName                    = Bored_Sword
            Animation                    = Hit_Level_1_a
                AnimationName                = RUElfWar_HITE
                AnimationMode                = ONCE
            End
        End

        AnimationState                         = HIT_REACTION HIT_LEVEL_1
            StateName                    = Bored_Bow
            Animation                     = Hit_Level_1_a
                AnimationName                = RUElfWar_HITB
                AnimationMode                 = ONCE
                AnimationSpeedFactorRange        = .9 .9
			End
		End
	End
	
    ButtonImage            = UIKhandMerchenary
    SelectPortrait         = _uKhandArcherPortrait

    Draw = W3DHordeModelDraw ModuleTag_011
        OkToChangeModelColor = Yes    
        StaticModelLODMode = Yes
        
        ; specify options for static LODs
        LodOptions                            = LOW
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_LOW
        End
        
        LodOptions                            = MEDIUM
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_MED
        End
        
        LodOptions                            = HIGH
            AllowMultipleModels                = ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures                = MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations                = MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta                = MAX_ANIM_FRAME_DELTA_HIGH
        End

        WadingParticleSys = WaterRipplesTrail  ; used when the unit is wading in shallow water.
;;================ MODELS =================================================================
    
DefaultModelConditionState
            Model               = mobatuhan
            WeaponLaunchBone    = PRIMARY arrow
            WeaponLaunchBone = SECONDARY arrow
        End
        
        ModelConditionState = WEAPONLOCK_SECONDARY
            Model               = mobatuhan
            WeaponLaunchBone    = PRIMARY arrow
            WeaponLaunchBone = SECONDARY arrow
            ParticleSysBone =   ARROW GondorFireArrowWww FollowBone:Yes
            ParticleSysBone =   ARROW TorchGlow FollowBone:Yes
        End
            ;;ARROW
        ;;----------- Captain of Gondor - Sword
        AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
            StateName         = CaptainPower
            Animation           = GUFaramir_CHRC
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End

;;----------- Captain of Gondor - Bow
        AnimationState        = PACKING_TYPE_2
            StateName         = STATE_CaptainBow
            Animation           = GUFaramir_CHRD
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.75 0.75
            End
        End


        ;;------------------  DYING -------------------------------------------------------------

; --- Flying through the air.
        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange   = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End
        
        AnimationState        = STUNNED_FLAILING 
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange   = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End
        
; --- Dying anims
        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End
        
        ; with sword
        AnimationState        = DYING WEAPONSET_TOGGLE_1    ;WEAPONSTATE_CLOSE_RANGE
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End
            
            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
        End
        
        ; with bow
        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState                      = PARALYZED
            Animation
                AnimationName               = GUFaramir_IDLC
                AnimationMode               = LOOP
            End
        End


; --- Stunned anims


        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        
        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED 
            StateName           = STATE_Bow
            
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End             

;;----------- pose      
        AnimationState        = USER_1
        ;*****************************************************************
            ;ParticleSysBone     = B_SWORDBONE AndruilEfxParent FollowBone:yes
        ;*****************************************************************
            Animation           = GUFaramir_POSA
                AnimationName     = GUFaramir_SKL.GUFaramir_POSA
                AnimationMode     = ONCE
            End
        End

        ;--------------------- Wound Arrow anim
                
        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End
        
;;------------------ ATTACKING --------------------------------------------------------------------
        ; Attacking Anims [Weapon_A]
        
        
        
        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End
        
        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming     = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            
            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming     = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End
            
            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.47 1.47
            End
            Flags               =   RESTART_ANIM_WHEN_COMPLETE
            ;   FrameForPristineBonePositions = 59
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End

;;------------------ MOVING -------------------------------------------------------------

        AnimationState        = MOVING USER_4                 ; Moving slaughter
            StateName           = Slaughter
            Flags               = RANDOMSTART
            ;ParticleSysBone     = None InfantryDustTrails
            Animation           = GUFaramir_ATKE
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = LOOP
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
        End

        ;--- Running with sword
        AnimationState          = MOVING WEAPONSET_TOGGLE_1     ;WEAPONSTATE_CLOSE_RANGE
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART
            ;ParticleSysBone    = None InfantryDustTrails
            
            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB
;               AnimationMode   = LOOP
                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
        End

;;------------------- ATTACKING IDLE with sword ------------------------------------------------------------

        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode     = MANUAL
            End         
        End


        ;--- Running with bow
        AnimationState          = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART
            ;ParticleSysBone    = None InfantryDustTrails
            
            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA
;               AnimationMode   = LOOP
                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
        End

        ;---------------------------------------------------
        ;New style firing with bow
        AnimationState                  =   PREATTACK_A 
            StateName                   =   STATE_Firing
            Animation                   =   ReadyToDrawn
                AnimationName           =   GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode           =   ONCE
;               UseWeaponTiming         =   Yes         ; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
                ;AnimationBlendTime     =   10
            End
        End

        AnimationState                  =   FIRING_OR_RELOADING_A 
            StateName                   =   STATE_Firing
            Animation                   =   LooseReloadDraw
                AnimationName           =   GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode           =   ONCE
;               UseWeaponTiming         =   Yes         ; UseWeaponTiming plus random weapon field equals desync.  Leaving as warning
                AnimationSpeedFactorRange = 1.1 1.1     ; Therefore, this is all you get.  A slight speed up so that the animation can always finish before any possible random value Design sets the range for
                ;AnimationBlendTime     =   10
            End
        End
        ;---------------------End New style firing

        AnimationState                  =   CONTINUOUS_FIRE_MEAN
            Animation                   =   HangFrameWhileCoasting
                AnimationName           =   GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode           =   MANUAL
            End
        End
        
        AnimationState                      = CONTINUOUS_FIRE_SLOW
            ;StateName                      = STATE_Idle_Bow
            Animation                       = PutAwayArrow
                AnimationName               = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode               = ONCE
            End
        End
                
        ;End New style firing
        ;---------------------------------------------------


        
;;-------------------- HIT REACTIONS -----------------------------------------------------------

; this hit animation attack stance
        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
        End

;;------------ EMOTIONS ------------------------------------------------------------------      


;;====== LEVELED
        AnimationState              = LEVELED WEAPONSET_TOGGLE_1    ; This state clears itself in 3 seconds
            Animation               = LevelUp
                AnimationName       = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode       = ONCE
            End
        End

        AnimationState              = LEVELED                       ; This state clears itself in 3 seconds
            Animation               = LevelUp
                AnimationName       = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode       = ONCE
            End
        End

;;====== CELEBRATING    

        AnimationState              =   EMOTION_CELEBRATING WEAPONSET_TOGGLE_1      ; sword cheer
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode       =   LOOP
            End
        End

        AnimationState              =   EMOTION_CELEBRATING                         ; bow cheer
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode       =   LOOP
            End
        End

;;====== TAUNTING

        AnimationState              =   EMOTION_TAUNTING WEAPONSET_TOGGLE_1     ; sword taunt
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_TNTC
                AnimationMode       =   ONCE
            End
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_TNTD
                AnimationMode       =   ONCE
            End
            Flags                       = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState              =   EMOTION_TAUNTING                            ; bow taunt
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode       =   LOOP
            End
        End





        AnimationState                = WEAPONSET_TOGGLE_1
            StateName            = Bored_Sword

            Animation                   = Idle_Sword1
                AnimationName           = RUElfWar_IDLG
                AnimationMode           = ONCE
            End
            Animation                   = Idle_Sword2
                AnimationName           = RUElfWar_IDLCT1
                AnimationMode           = ONCE
            End
            Animation                   = Idle_Sword3
                AnimationName           = RUElfWar_IDLCT3
                AnimationMode           = ONCE
            End
            Animation            = IdleNoFidget
                AnimationName        = RUElfWar_IDLF
                AnimationMode        = ONCE
                AnimationPriority    = 20
            End
            Animation            = IdleNoFidget2
                AnimationName        = RUElfWar_IDLF
                AnimationMode        = ONCE
                AnimationPriority    = 0
            End
            Flags                = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SB_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RB_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End

        IdleAnimationState
            StateName                = Bored_Bow

            Animation                = IdleBowB
                AnimationName            = RUElfWar_IDLDX1
                AnimationMode            = ONCE
            End
            Animation                = IdleBowD
                AnimationName            = RUElfWar_IDLD
                AnimationMode            = ONCE
            End
            Animation                = IdleNoFidget
                AnimationName            = RUElfWar_IDLE
                AnimationMode            = ONCE
                AnimationPriority        = 20
            End
            Animation                = IdleNoFidget2
                AnimationName            = RUElfWar_IDLE
                AnimationMode            = ONCE
                AnimationPriority        = 10
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Bow" or Prev == "TRANS_RB_Bow" then return "IdleNoFidget" end
                if Prev == "Selected_Bow"        then CurDrawableSetTransitionAnimState("TRANS_SB_Bow")        end
                if Prev == "Ready_Bow"            then CurDrawableSetTransitionAnimState("TRANS_RB_Bow")        end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




        TransitionState                   = TRANS_BS_Bow
            Animation                   = ATND
                AnimationName         = RUElfWar_ATND
                AnimationMode         = ONCE
                AnimationBlendTime    = 10
            End
        End

        TransitionState                   = TRANS_SR_Bow
            Animation                   = ATNE
                AnimationName         = RUElfWar_ATNF
                AnimationMode         = ONCE
            End
        End

        TransitionState                   = TRANS_SB_Bow
            Animation                   = ATND
                AnimationName         = RUElfWar_ATND
                AnimationMode         = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End

        TransitionState                   = TRANS_RS_Bow
            Animation                   = ATNF
                AnimationName         = RUElfWar_ATNF
                AnimationMode         = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End

        TransitionState                   = TRANS_BR_Bow
            Animation                   = IDLB
                AnimationName         = RUElfWar_IDLB
                AnimationMode         = ONCE
                AnimationBlendTime    = 20
            End
        End

        TransitionState                   = TRANS_RB_Bow
            Animation                   = IDLD
                AnimationName         = RUElfWar_IDLD
                AnimationMode         = ONCE
                AnimationBlendTime    = 20
            End
        End



        TransitionState                   = TRANS_BS_Sword
            Animation                   = ATNA
                AnimationName         = RUElfWar_ATNA
                AnimationMode         = ONCE
            End
            Animation                   = ATNAX1
                AnimationName         = RUElfWar_ATNX1
                AnimationMode         = ONCE
            End
        End

        TransitionState                   = TRANS_SR_Sword
            Animation                   = ATNC
                AnimationName         = RUElfWar_ATNC
                AnimationMode         = ONCE
            End
        End

        TransitionState                   = TRANS_SB_Sword
            Animation                   = ATNA
                AnimationName         = RUElfWar_ATNA
                AnimationMode         = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End

        TransitionState                   = TRANS_RS_Sword
            Animation                   = ATNC
                AnimationName         = RUElfWar_ATNC
                AnimationMode         = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End

        TransitionState                   = TRANS_BR_Sword
            Animation                   = ATNS
                AnimationName         = RUElfWar_ATNS
                AnimationMode         = ONCE
                AnimationBlendTime    = 20
            End
        End

        TransitionState                   = TRANS_RB_Sword
            Animation                   = IDLG
                AnimationName         = RUElfWar_IDLG
                AnimationMode         = ONCE
                AnimationBlendTime    = 20
            End
        End




        TransitionState                   = TRANS_BowToSword_Ready
            Animation                   = DrawSwords
                AnimationName           = RUElfWar_STHA
                AnimationMode           = ONCE
            End
        End

        TransitionState                   = TRANS_SwordToBow_Ready
            Animation                   = DrawBow
                AnimationName           = RUElfWar_STHB
                AnimationMode           = ONCE
            End
        End

        TransitionState                   = TRANS_BowToSword_Selected
            Animation                   = DrawSwords
                AnimationName           = RUElfWar_STHC
                AnimationMode           = ONCE
            End
        End

        TransitionState                   = TRANS_SwordToBow_Selected
            Animation                   = DrawBow
                AnimationName           = RUElfWar_STHD
                AnimationMode           = ONCE
            End
        End

;;------------------- SELECTED STATES ------------------------------------------------------------

        AnimationState                  = SELECTED WEAPONSET_TOGGLE_1
            StateName                   = STATE_Selected_Sword
            
            Animation                   = ATNE
                AnimationName           = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode           = LOOP
                AnimationBlendTime      = 15
            End
            Flags                       = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
        End
        
;;====== ALERT
        AnimationState              =   EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName               =   STATE_READY
            Animation               =   ready
                AnimationName       =   GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode       =   LOOP
                AnimationBlendTime  =   20
            End
        End
        
        AnimationState              =   RAISING_FLAG
            Animation
                AnimationName       =   GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode       =   LOOP
            End
        End

        AnimationState              =   SELECTED 
            StateName               =   STATE_Selected_Bow
            
            Animation               =   ATNB
                AnimationName       =   GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode       =   LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
        End
    


;;--------------- IDLE STATES ----------------------------------------------------------------- 
        
        AnimationState                  = WEAPONSET_TOGGLE_1
            StateName                   = STATE_Idle_Sword  

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority       = 20
                AnimationBlendTime  = 15
            End
            
            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority       = 1
            End

            Animation                   = IDLG
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLG
                AnimationMode           = LOOP
                AnimationPriority       = 1
            End
            
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End
        
        IdleAnimationState
            StateName           = STATE_Idle_Bow
            
            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End

    ;---transitions--------------------------------------------

        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName       = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode       = ONCE
            End     
        End
        
        TransitionState = TRANS_SelectedToBoredSword
            Animation           = ATNF
                AnimationName   = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode   = ONCE
            End     
        End 

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName       = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode       = ONCE
            End     
        End
        
        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName       = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode       = ONCE
                AnimationBlendTime  = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End     
        End
        
        TransitionState = TRANS_SelectedToBoredBow
            Animation           = ATNA
;               AnimationName   = GUFaramir_SKL.GUFaramir_ATNA
                AnimationName   = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode   = ONCE
            End     
        End 


        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA 
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB 
                AnimationMode     = ONCE
            End
        End 

        TransitionState             = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End
        
        TransitionState             = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End     


    End




    Side = Mordor
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 4

    TransportSlotCount = 1

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    KhandSoldierBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1
        Weapon            = PRIMARY    KhandSoldierSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End


    ArmorSet
        Conditions      = None
        Armor           = BodyguardArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = BodyguardArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = ROHAN_YEOMAN_VISION_RANGE
        ShroudClearingRange = SHROUD_CLEAR_STANDARD

    BountyValue = ROHAN_ELVENWARRIOR_BOUNTY_VALUE
    DisplayName = OBJECT:KhandSoldier
    CrushableLevel = 0

    CrushRevengeWeapon = RangedInfantryCrushRevenge
    CommandSet = EvilmenKhandSoldierCommandSet




    VoiceAttack                                = EasterlingVoiceAttack
    VoiceAttackCharge                        = EasterlingVoiceAttackCharge
    VoiceAttackMachine                        = EasterlingVoiceAttack
    VoiceAttackStructure                    = EasterlingVoiceAttackBuilding
    VoiceCreated                            = EVA:EasterlingCreated
    VoiceFullyCreated                        = EVA:EasterlingCreated
    VoiceGuard                                = EasterlingVoiceMove
    VoiceMove                                = EasterlingVoiceMove
    VoiceMoveToCamp                            = EasterlingVoiceMoveCamp
    VoiceMoveWhileAttacking                    = EasterlingVoiceDisengage
    VoicePriority                            = 52
    VoiceRetreatToCastle                    = EasterlingVoiceRetreat
    VoiceSelect                                = EasterlingVoiceSelectMS
    VoiceSelectBattle                         = EasterlingVoiceSelectBattle

    VoiceEnterStateAttack                    = EasterlingVoiceEnterStateAttack
    VoiceEnterStateAttackCharge                = EasterlingVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine            = EasterlingVoiceEnterStateAttack
    VoiceEnterStateAttackStructure            = EasterlingVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                        = EasterlingVoiceEnterStateMove
    VoiceEnterStateMoveToCamp                = EasterlingVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking        = EasterlingVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle            = EasterlingVoiceEnterStateRetreat

    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip    = EasterlingVoiceMoveShip
        VoiceEnterUnitMordorMumakil            = EasterlingVoiceMoveGarrison
        VoiceEnterUnitSlaughterHouse        = EasterlingVoiceMoveGarrison
        VoiceGarrison                        = EasterlingVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = EasterlingVoiceCaptureBuilding
    End

    CrowdResponseKey = EvilMen1

    EvaEventDamagedOwner = UnitUnderAttack

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Unit Infantry
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.RURoyalGrd_RUNB    Frames:4 12 20 27

        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End





    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ARCHER ATTACK_NEEDS_LINE_OF_SIGHT GRAB_AND_DROP

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 300
        MaxHealthDamaged  = 150

    End



    Behavior = WeaponSetUpgrade ModuleTag_WeaponSetUpgradeTag
        TriggeredBy    = Upgrade_FireArrows
    End

    Behavior = SubObjectsUpgrade FireArrows_Upgrade
        TriggeredBy    = Upgrade_FireArrows

    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy    = Upgrade_ForgedBlades
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy    = Upgrade_HeavyArmor
        ArmorSetFlag   = PLAYER_UPGRADE
    End





    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy        = Upgrade_HeavyArmor
        UpgradeTexture     = gucitadelguardnew.tga 0 gucitadelguardnew_ha.tga
        RecolorHouse       = Yes
        ExcludeSubobjects  = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlade_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects     = Forged_Blade
    End


    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        CanAttackWhileContained            = Yes
        AILuaEventsList                    = GondorWaechterderVesteFunctions
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End



    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End






    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.5
        DestructionDelay = 15000
        Sound = INITIAL ManEvilGenericVoiceDie
        DeathFlags = DEATH_1
    End

      Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 5000
        DestructionDelay = 5000
        DeathFlags = DEATH_2
        FX = INITIAL FX_UnSummonElvenAllies
    End

    Behavior = SquishCollide ModuleTag_06

    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End




    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 14
    ShadowSizeY = 14
    ShadowTexture = ShadowI
End


