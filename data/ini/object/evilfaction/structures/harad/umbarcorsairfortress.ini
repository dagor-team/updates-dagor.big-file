Object UmbarCorsairFortressCenterGeneric

	SelectPortrait = BPWFortress

	Draw = W3DScriptedModelDraw ModuleTag_01

    	DefaultModelConditionState
      		Model = None
    	End
    	
		ModelConditionState = WORLD_BUILDER
			Model = NBasePin
		End
	End
	
	Side		= Harad   
	EditorSorting	= STRUCTURE
	KindOf		= IMMOBILE BASE_FOUNDATION CASTLE_CENTER
  
	Behavior = CastleBehavior ModuleTag_castle
		
		FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER				
	End  
End

Object UmbarCorsairFortressExpansionPadCorner	

	SelectPortrait = BPHAFortress_BuildPlot

	Draw = W3DFloorDraw DrawFloorBase  
		ModelName = hafoundation
	End
	
	Draw = W3DScriptedModelDraw ModuleTag_DrawMain
		DefaultModelConditionState
			Model = WBFoundationP						
		End
		
		ModelConditionState = CONSTRUCTION_COMPLETE
			Model = None
		End
	End

	DisplayName	= OBJECT:HaradBuildingFoundation
	Side		= Harad   
	EditorSorting	= STRUCTURE
	ThreatLevel	= 1.0

	BuildCost           = 1
	BuildTime           = 5.0 
         
	VisionRange         = 0.0          
	ShroudClearingRange = 0

	CommandSet = UmbarCorsairFortressExpansionPadCornerCommandSet

	VoiceSelect = Gui_PlotSelect2

	KindOf = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY NO_COLLIDE DO_NOT_CLASSIFY EXPANSION_PAD

	Behavior	= FoundationAIUpdate ModuleTag_foundationAI
		BuildVariation	= 2 
	End

	Behavior = CastleMemberBehavior ModuleTag_CMB
	End 

	Body = ImmortalBody ModuleTag_05
		MaxHealth  = 15000.0
	End

	Geometry		= BOX
	GeometryMajorRadius	= 5.0
	GeometryMinorRadius	= 5.0
	GeometryHeight		= 0.8
	GeometryIsSmall		= No
	Shadow			= SHADOW_VOLUME
	BuildCompletion		= PLACED_BY_PLAYER
End


Object UmbarCorsairFortressExpansionPadback

	SelectPortrait = BPHAFortress_BuildPlot

	Draw = W3DFloorDraw DrawFloorBase  
		ModelName = hafoundation
	End
	
	Draw = W3DScriptedModelDraw ModuleTag_DrawMain
		DefaultModelConditionState
			Model = WBFoundationP						
		End
		
		ModelConditionState = CONSTRUCTION_COMPLETE
			Model = None
		End
	End

	DisplayName         = OBJECT:HaradBuildingFoundation
	Side                = Harad   
	EditorSorting       = STRUCTURE
	ThreatLevel	= 1.0

	BuildCost           = 1
	BuildTime           = 5.0          
	VisionRange         = 0.0          
	ShroudClearingRange = 0

	CommandSet = UmbarCorsairFortressExpansionPadbackCommandSet

	VoiceSelect = Gui_PlotSelect2

	KindOf	= STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY NO_COLLIDE DO_NOT_CLASSIFY EXPANSION_PAD

	Behavior		= FoundationAIUpdate ModuleTag_foundationAI
		BuildVariation	= 2 
	End

	Behavior = CastleMemberBehavior ModuleTag_CMB
	End 

	Body               = ImmortalBody ModuleTag_05
		MaxHealth  = 15000.0
	End

	Scale = 1.50	

	Geometry		= BOX
	GeometryMajorRadius	= 5.0
	GeometryMinorRadius	= 5.0
	GeometryHeight		= 0.8
	GeometryIsSmall		= No
	Shadow			= SHADOW_VOLUME
	BuildCompletion		= PLACED_BY_PLAYER
End


Object UmbarCorsairFortressCitadel

	SelectPortrait = SPUmbarCorsairFortress
 
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        ExtraPublicBone         = ARROW_01
        ExtraPublicBone         = ARROW_02
        ExtraPublicBone         = ARROW_03
        ExtraPublicBone         = ARROW_04
        ExtraPublicBone         = ARROW_05
        ExtraPublicBone         = ARROW_06
        ExtraPublicBone         = ARROW_07
        ExtraPublicBone         = ARROW_08
        ExtraPublicBone         = ARROW_09
        ExtraPublicBone         = ARROW_10
        ExtraPublicBone         = ARROW_11
        ExtraPublicBone         = ARROW_12
        ExtraPublicBone         = ARROW_13
        ExtraPublicBone         = ARROW_14
        ExtraPublicBone         = ARROW_15
        ExtraPublicBone         = ARROW_16
        ExtraPublicBone         = ARROW_17
        ExtraPublicBone         = ARROW_18
        ExtraPublicBone         = ARROW_19
        ExtraPublicBone         = ARROW_20
        ExtraPublicBone         = ARROW_21
        ExtraPublicBone         = ARROW_22
        ExtraPublicBone         = ARROW_23
        ExtraPublicBone         = ARROW_24
        ExtraPublicBone         = ARROW_25
        ExtraPublicBone         = ARROW_26
        ExtraPublicBone         = ARROW_27
        ExtraPublicBone         = ARROW_28
        ExtraPublicBone         = ARROW_29
        ExtraPublicBone         = ARROW_30
        ExtraPublicBone         = ARROW_31
        ExtraPublicBone         = ARROW_32

        OkToChangeModelColor    = Yes
        UseStandardModelNames   = Yes
        StaticModelLODMode      = Yes 
        
 	RandomTexture  = hbfortress.tga  0 hbfortress.tga
 	RandomTexture  = haftrskel.tga  0 haftrskel.tga
 	RandomTexture  = co_banr_b01.tga  0 haradrim_banr_b.tga
 	RandomTexture  = hbgate.tga  0 hbgate.tga
 	RandomTexture  = mbccenter.tga  0 mbccenter.tga
 	RandomTexture  = hbkingplcumbar.tga  0 mbkingplc.tga
 	RandomTexture  = mumumaskel02.tga  0 mumumaskel.tga
 	RandomTexture  = hamumakil01.tga  0 muwildmumakil.tga

        DefaultModelConditionState
            Model               = hbfortress
            WeaponLaunchBone    = PRIMARY ARROW_
        End
        
        AnimationState = BUILD_PLACEMENT_CURSOR
            BeginScript
                   CurDrawableHideSubObject("FIREGLOW")
                   CurDrawableHideSubObject("FLAMES")
                   CurDrawableHideSubObject("GBFFLAG")
                   CurDrawableHideSubObject("GBFFLAMING")
            EndScript
            BeginScript
                   CurDrawableHideSubObject("TUSKS")
                   CurDrawableHideSubObject("AWNING")
                   CurDrawableHideSubObject("BASE")
                   CurDrawableHideSubObject("FLAGPOLE")
                   CurDrawableHideSubObject("FLAG")
                   CurDrawableHideSubObject("SKELETON1")
                   CurDrawableHideSubObject("SKELETON2")
            EndScript
        End
        
        
        AnimationState = PHANTOM_STRUCTURE
            BeginScript
                   CurDrawableHideSubObject("FIREGLOW")
                   CurDrawableHideSubObject("FLAMES")
                   CurDrawableHideSubObject("GBFFLAG")
                   CurDrawableHideSubObject("GBFFLAMING")
            EndScript
            BeginScript
                   CurDrawableHideSubObject("TUSKS")
                   CurDrawableHideSubObject("AWNING")
                   CurDrawableHideSubObject("BASE")
                   CurDrawableHideSubObject("FLAGPOLE")
                   CurDrawableHideSubObject("FLAG")
                   CurDrawableHideSubObject("SKELETON1")
                   CurDrawableHideSubObject("SKELETON2")
            EndScript
        End

        ModelConditionState  = DAMAGED UPGRADE_NUMENOR_STONEWORK
            Model	= hbfortress
            Texture	= hbfortress.tga hbfortress_up_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
        End

        ModelConditionState  = DAMAGED
            Model	= hbfortress
            Texture	= hbfortress.tga hbfortress_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
        End

        AnimationState = DAMAGED
            EnteringStateFX    = FX_FortressDamaged
        End

        ModelConditionState  = REALLYDAMAGED UPGRADE_NUMENOR_STONEWORK
            Model         = hbfortress
            Texture	= hbfortress.tga hbfortress_up_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
        End

        ModelConditionState  = REALLYDAMAGED
            Model         = hbfortress
            Texture	= hbfortress.tga hbfortress_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
        End

        AnimationState = REALLYDAMAGED
            EnteringStateFX    = FX_FortressReallyDamaged
        End

        ModelConditionState  = RUBBLE UPGRADE_NUMENOR_STONEWORK
            Model         = hbfortress
            Texture	= hbfortress.tga hbfortress_up_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
            ParticleSysBone SmokeLarge01 SmokeBuildingLarge
        End

        ModelConditionState  = RUBBLE
            Model         = hbfortress
            Texture	= hbfortress.tga hbfortress_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
            ParticleSysBone SmokeLarge01 SmokeBuildingLarge
        End

        AnimationState = RUBBLE
            EnteringStateFX    = FX_FortressCollapse 
        End

        ModelConditionState  = POST_RUBBLE
            Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
            Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End  
        
        ModelConditionState = UPGRADE_NUMENOR_STONEWORK SNOW
            Model    = hbfortress
            Texture    = hbfortress.tga hbfortress_up_snow.tga
            Texture    = haradrim_banr_b.tga co_banr_b01.tga
            Texture    = mbkingplc.tga hbkingplcumbar.tga
            Texture    = mumumaskel.tga mumumaskel02.tga
            Texture    = muwildmumakil.tga hamumakil01.tga
            Texture    = hbgate.tga hbgate_up.tga
            Texture    = mbccenter.tga mbccenter.tga
            Texture    = haftrskel.tga haftrskel.tga
        End

        ModelConditionState = UPGRADE_NUMENOR_STONEWORK
            Model    = hbfortress
            Texture    = hbfortress.tga hbfortress_up.tga
            Texture    = haradrim_banr_b.tga co_banr_b01.tga
            Texture    = mbkingplc.tga hbkingplcumbar.tga
            Texture    = mumumaskel.tga mumumaskel02.tga
            Texture    = muwildmumakil.tga hamumakil01.tga
            Texture    = hbgate.tga hbgate_up.tga
            Texture    = mbccenter.tga mbccenter.tga
            Texture    = haftrskel.tga haftrskel.tga
        End

        ModelConditionState = SNOW
            Model = hbfortress
            Texture    = hbfortress.tga hbfortress_snow.tga
            Texture    = haradrim_banr_b.tga co_banr_b01.tga
            Texture    = mbkingplc.tga hbkingplcumbar.tga
            Texture    = mumumaskel.tga mumumaskel02.tga
            Texture    = muwildmumakil.tga hamumakil01.tga
            Texture    = hbgate.tga hbgate_up.tga
            Texture    = mbccenter.tga mbccenter.tga
            Texture    = haftrskel.tga haftrskel.tga
        End

        AnimationState = SPECIAL_POWER_1
            Animation 
                AnimationName = none.none
                AnimationMode = ONCE
            End
            EnteringStateFX = FX_TotemIntimidation
        End
    End



	Draw = W3DScriptedModelDraw Draw_FortTop
		OkToChangeModelColor	= No
		StaticModelLODMode	= Yes

    DefaultModelConditionState
      Model = none
    End

	ModelConditionState	  = FORTRESS_IMPROVEMENT_5 USER_5 DAMAGED
		Model	= hbforttop
            	Texture = mbtavern.tga mbtavern_d1.tga
            	Texture = mbtavernwd.tga mbtavernwd_d.tga
	End

	ModelConditionState	  = FORTRESS_IMPROVEMENT_5 USER_5 REALLYDAMAGED
		Model	= hbforttop
            	Texture = mbtavern.tga mbtavern_d1.tga
            	Texture = mbtavernwd.tga mbtavernwd_d.tga
	End

	ModelConditionState = FORTRESS_IMPROVEMENT_5 USER_5 SNOW
		Model	= hbforttop
            	Texture = mbtavern.tga mbtavern_snow.tga
            	Texture = mbtavernwd.tga mbtavernwd_snow.tga
	End

	ModelConditionState = FORTRESS_IMPROVEMENT_5 USER_5
		Model    = hbforttop
	End

		AnimationState = FORTRESS_IMPROVEMENT_5	USER_5
			Animation		= hbforttop
				AnimationName	= hbforttop.hbforttop
				AnimationMode	= ONCE
			End
			BeginScript
			EndScript
		End

	ModelConditionState = FORTRESS_IMPROVEMENT_5 DAMAGED
		Model = hbforttop
            	Texture = mbtavern.tga mbtavern_d1.tga
            	Texture = mbtavernwd.tga mbtavernwd_d.tga
	End

	ModelConditionState = FORTRESS_IMPROVEMENT_5 REALLYDAMAGED
		Model = hbforttop
            	Texture = mbtavern.tga mbtavern_d1.tga
            	Texture = mbtavernwd.tga mbtavernwd_d.tga
	End

	ModelConditionState = FORTRESS_IMPROVEMENT_5 RUBBLE
		Model = hbforttop
            	Texture = mbtavern.tga mbtavern_d1.tga
            	Texture = mbtavernwd.tga mbtavernwd_d.tga
	End

	ModelConditionState = SNOW FORTRESS_IMPROVEMENT_5
		Model = hbforttop
            	Texture = mbtavern.tga mbtavern_snow.tga
            	Texture = mbtavernwd.tga mbtavernwd_snow.tga
	End

	ModelConditionState = FORTRESS_IMPROVEMENT_5
		Model = hbforttop
	End
  End

    Draw = W3DFloorDraw DrawFloorBase  
        StaticModelLODMode    = Yes    
        ModelName             = wbmote_bib
        WeatherTexture        = SNOWY wbmote_bib_Snow.tga
        ForceToBack           = Yes
        HideIfModelConditions = AWAITING_CONSTRUCTION
        HideIfModelConditions = PARTIALLY_CONSTRUCTED
    End

	DisplayName        = OBJECT:UmbarCorsairFortress
	Description        = OBJECT:UmbarCorsairFortressDescription
	Side               = Harad		
	EditorSorting		= STRUCTURE
	ThreatLevel		= 1.0
	PlacementViewAngle	= -45
	CommandPointBonus	= GENERIC_FORTRESS_COMMAND_POINT_BONUS
	
        BuildCost           = MORDOR_FORTRESS_BUILDCOST
        BuildTime           = 50	
	BountyValue         = ISENGARD_FORTRESS_BOUNTY_VALUE
	VisionRange         = ISENGARD_FORTRESS_VISION_RANGE      
	ShroudClearingRange = ISENGARD_FORTRESS_SHROUD_CLEAR
        MaxSimultaneousOfType = NEW_FORTRESS_RATIO

	CommandSet          = UmbarCorsairFortressCommandSet

	WeaponSet
		Weapon			= PRIMARY EvilFortressArrowTowerBow
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End

	ArmorSet
		Conditions    = None
		Armor         = FortressArmor
	End

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	EvaEventDieOwner 		= EvaFortressDie

	VoiceSelect			= IsengardFortressSelect
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged			= BuildingLightDamageStone
	SoundOnReallyDamaged		= BuildingHeavyDamageStone

	UnitSpecificSounds
		UnderConstruction	= BuildingConstructionLoop  
		UnderRepairFromRubble	= BuildingConstructionLoop	
	End

	CampnessValue = CAMPNESS_FORTRESS

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:UpgradeIsengardFortressWizardTower	Animation:IBFWTower_AS.IBFWTower_AN	Frames:980
	End

	RadarPriority       = STRUCTURE
	KindOf  = PRELOAD COMMANDCENTER VITAL_FOR_BASE_SURVIVAL STRUCTURE IMMOBILE CASTLE_KEEP MP_COUNT_FOR_VICTORY SELECTABLE FS_FACTORY AUTO_RALLYPOINT MADE_OF_WOOD SCORE DOZER_FACTORY
	 
	Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
		WorkerName	= HaradWorkerNoSelect	
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
	End

	Behavior = CastleMemberBehavior ModuleTag_CMB
	End 

	Body = StructureBody ModuleTag_05
		MaxHealth		= ISENGARD_FORTRESS_HEALTH
		MaxHealthDamaged	= ISENGARD_FORTRESS_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= ISENGARD_FORTRESS_HEALTH_REALLY_DAMAGED
	End

	Behavior                  = StructureCollapseUpdate ModuleTag_06
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_FortressCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight		= 120
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag	
	End

    Behavior = AIUpdateInterface ModuleTag_AI
        AILuaEventsList                = FortressFunctions
        AutoAcquireEnemiesWhenIdle     = Yes
        MoodAttackCheckRate            = 250
    End

	Behavior = QueueProductionExitUpdate QueueProductionModuleTag
		UnitCreatePoint		= X:40.0 Y:0.0 Z:0.0
		NaturalRallyPoint	= X:106.0 Y:0.0 Z:0.0
		ExitDelay		= 50
	End

    Behavior = CitadelSlaughterHordeContain ModuleTag_SlaughterMe
	PassengerFilter			= GENERIC_FACTION_SLAUGHTERABLE
	ObjectStatusOfContained		= UNSELECTABLE ENCLOSED
	CashBackPercent			= 200%
	ContainMax			= 99
	AllowEnemiesInside		= No
	AllowAlliesInside		= No
 	AllowNeutralInside		= No
 	AllowOwnPlayerInsideOverride	= Yes
	EnterSound			= GUI_RingReturned
	EntryOffset			= X:125.0 Y:0.0 Z:0.0
	EntryPosition			= X:30.0 Y:0.0 Z:0.0
	ExitOffset			= X:125.0 Y:0.0 Z:0.0
     End

	#include "..\..\..\FortressRingFunc.inc"
	
    Behavior = SubObjectsUpgrade Fortress_ModuleTag_HideAll
        TriggeredBy     = Upgrade_StructureLevel1 Upgrade_AllFactionUpgrade
        HideSubObjects  = BASE FLAG FLAGPOLE AWNING SKELETON1 SKELETON2 FLAGPOLE SKELETON TUSKS		
    End

    Behavior = GrantUpgradeCreate ModuleTag_GrantForgedBlades
        UpgradeToGrant = Upgrade_StructureLevel1
    End

    
    Behavior = CastleUpgrade ModuleTag_PassOutFlamingMunitionsUpgrade
        TriggeredBy    = Upgrade_MordorFortressFireArrowsTrigger
        Upgrade        = Upgrade_EvilFortressFlamingMunitions
    End
    
    Behavior = StatusBitsUpgrade ModuleTag_FakeOut 
        TriggeredBy    = Upgrade_EvilFortressFlamingMunitions
    End

    Behavior = AudioLoopUpgrade ModuleTag_OrcFireMunitionsBuildLoop
        TriggeredBy  = Upgrade_EvilFortressFlamingMunitions
        SoundToPlay  = BuildingConstructionLoop
        KillOnDeath  = Yes
        KillAfterMS  = 1800
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTagBanners
        ProductionModifier 
            RequiredUpgrade 	= Upgrade_AngmarFortressBanners 
            CostMultiplier 	= 0.80
            ModifierFilter 	= NONE 
        End

        ProductionModifier        
            RequiredUpgrade 	= Upgrade_AngmarFortressBanners 
            CostMultiplier 	= 0.90
            TimeMultiplier 	= 0.90
            HeroPurchase 	= Yes    
            ModifierFilter 	= NONE +HERO
        End
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BannerLeadership
        StartsActive    = No 
        BonusName       = MenFortressBannersLeadership
        TriggeredBy     = Upgrade_AngmarFortressBanners
        RefreshDelay    = 2000
        Range           = 300
        ObjectFilter    = ANY +INFANTRY +CAVALRY -MACHINE -IMMOBILE -DOZER -HERO -STRUCTURE -BASE_FOUNDATION -HORDE  
		
    End    

    Behavior = SubObjectsUpgrade ModuleTag_ShowBanners
        TriggeredBy       = Upgrade_AngmarFortressBanners
        ShowSubObjects    = BASE FLAG FLAGPOLE
    End

	
    Behavior = PassiveAreaEffectBehavior ModuleTag_HouseOfHealingHealer
        UpgradeRequired         = Upgrade_AngmarFortressSpikes
        EffectRadius            = 250 
        PingDelay               = 2000
        HealPercentPerSecond    = 3%
        AllowFilter             = ANY +INFANTRY +CAVALRY +HERO +MACHINE +MONSTER -IMMOBILE +DOZER
        NonStackable            = Yes
        HealFX                  = FX_SpellHealUnitHealBuff
    End
    
    Behavior = SubObjectsUpgrade ModuleTag_ShowAwniung
        TriggeredBy       = Upgrade_AngmarFortressSpikes
        ShowSubObjects    = AWNING
    End

    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        UpgradeRequired     = Upgrade_AngmarFortressSpikes
        IdleSpawnRate       = 5000                            
        UnitSpawnFX         = FX_BannerCarrierSpawnUnit
        ReplenishNearbyHorde    = Yes
        ScanHordeDistance       = 250
    End

    Behavior = CastleUpgrade ModuleTag_PassOutNumenorStoneworkUpgrade
        TriggeredBy    = Upgrade_MordorFortressMagmaCauldrons
        Upgrade        = Upgrade_MordorFortressMagmaCauldrons
        WallUpgradeRadius = MEN_FORTRESS_WALL_EFFECTIVE_RADIUS
    End
    
    Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
        TriggeredBy          = Upgrade_MordorFortressMagmaCauldrons
        AttributeModifier    = NumenorStoneworkKeep_Bonus
    End

    Behavior = ModelConditionUpgrade ModuleTag_ShowTheVines
        TriggeredBy          = Upgrade_MordorFortressMagmaCauldrons
        AddConditionFlags    = UPGRADE_NUMENOR_STONEWORK
        Permanent            = Yes
    End

    Behavior = SubObjectsUpgrade ModuleTag_Showtusks
        TriggeredBy      = Upgrade_AngmarFortressHouseOfLamentation
        ShowSubObjects   = TUSKS SKELETON
    End

    Behavior = ObjectCreationUpgrade CreateTheMoat
        TriggeredBy     = Upgrade_AngmarFortressHouseOfLamentation
        Delay           = 0.0                
        ThingToSpawn    = HaradFortressTusks
        DestroyWhenSold = Yes
        FadeInTime      = 600
    End


	Behavior = ModelConditionUpgrade ModuleTag_ShowTop
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		AddConditionFlags	= FORTRESS_IMPROVEMENT_5
		AddTempConditionFlag	= ModelConditionState:USER_5
		TempConditionTime	= 28
		Permanent		= Yes
	End
	Behavior = AudioLoopUpgrade ModuleTag_TopBuildLoop
		TriggeredBy	= Upgrade_IsengardFortressBurningForges
		SoundToPlay	= BuildingConstructionLoop
		KillOnDeath	= Yes
		KillAfterMS	= 3500
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherAboveEntranceL1
		TriggeredBy		= Upgrade_IsengardFortressBurningForges	
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:37.00 Y:-23.00 Z:42
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherAboveEntranceR1
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:37.00 Y:29.00 Z:42
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherAboveEntranceL2
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:37.00 Y:-13.00 Z:42
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherAboveEntranceR2
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:37.00 Y:19.00 Z:42
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherTowerBL
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:-49.00 Y:-40.00 Z:61
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherTowerBR
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:-49.00 Y:50.00 Z:61
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherTowerFL
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:46.00 Y:-40.00 Z:61
		FadeInTime	= 1000
	End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcherTowerFR
		TriggeredBy		= Upgrade_IsengardFortressBurningForges
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset		= X:46.00 Y:50.00 Z:61
		FadeInTime	= 1000
	End

	Behavior = AutoDepositUpdate AutoDepositModuleTag
		DepositTiming       	= GENERIC_KEEP_MONEY_TIME
		DepositAmount       	= GENERIC_KEEP_MONEY_AMOUNT 
		InitialCaptureBonus 	= 0  
	End

	Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
		Radius		= GENERIC_KEEP_MONEY_RANGE	
		MaxIncome	= 0				
		IncomeInterval	= 999999			
		HighPriority	= Yes
	End

    GeometryIsSmall       = No
    
    Geometry              = BOX            
    GeometryMajorRadius   = 49
    GeometryMinorRadius   = 49
    GeometryHeight        = 50
    
    AdditionalGeometry    = BOX            
    GeometryMajorRadius    = 12.0
    GeometryMinorRadius    = 12.0
    GeometryHeight        = 100.0
    GeometryOffset        = X:-40 Y:-40 Z:0
    
    AdditionalGeometry    = BOX
    GeometryMajorRadius    = 12.0
    GeometryMinorRadius    = 12.0
    GeometryHeight        = 100.0
    GeometryOffset        = X:-40 Y:40 Z:0
    
    AdditionalGeometry    = BOX
    GeometryMajorRadius    = 12.0
    GeometryMinorRadius    = 12.0
    GeometryHeight        = 100.0
    GeometryOffset        = X:40 Y:-40 Z:0    
    
    AdditionalGeometry    = BOX
    GeometryMajorRadius    = 12.0
    GeometryMinorRadius    = 12.0
    GeometryHeight        = 100.0
    GeometryOffset        = X:40 Y:40 Z:0
    
    AdditionalGeometry        = BOX
    GeometryName            = HighTowerGeom
    GeometryMajorRadius       = 12
    GeometryMinorRadius       = 12
    GeometryHeight            = 175
    GeometryOffset            = X:0 Y:0 Z:0
    GeometryUsedForHealthBox = No
    
    GeometryContactPoint = X:-57        Y:57        Z:0          Repair
    GeometryContactPoint = X:57         Y:-57       Z:0          Repair
    GeometryContactPoint = X:49         Y:36.435    Z:0
    GeometryContactPoint = X:-32.763    Y:-46.121   Z:0
    GeometryContactPoint = X:0          Y:0         Z:180        Swoop
    
    Shadow                = SHADOW_VOLUME
    BuildCompletion     = PLACED_BY_PLAYER
End

Object UmbarCorsairFortress

	SelectPortrait = SPUmbarCorsairFortress

	Draw	= W3DScriptedModelDraw ModuleTag_01
		
	OkToChangeModelColor	= Yes
	StaticModelLODMode	= Yes 

 	RandomTexture  = hbfortress.tga  0 hbfortress.tga
 	RandomTexture  = haftrskel.tga  0 haftrskel.tga
 	RandomTexture  = co_banr_b01.tga  0 haradrim_banr_b.tga
 	RandomTexture  = hbgate.tga  0 hbgate.tga
 	RandomTexture  = mbccenter.tga  0 mbccenter.tga
 	RandomTexture  = hbkingplcumbar.tga  0 mbkingplc.tga
 	RandomTexture  = mumumaskel02.tga  0 mumumaskel.tga
 	RandomTexture  = hamumakil01.tga  0 muwildmumakil.tga

        DefaultModelConditionState
            Model	= None
        End

        IdleAnimationState    
        End

        ModelConditionState = WORLD_BUILDER
            Model    = hbfortress
        End

        ModelConditionState = BUILD_PLACEMENT_CURSOR
            Model    = None    
        End

        ModelConditionState =  PHANTOM_STRUCTURE
            Model    = hbfortress
        End

        AnimationState = BUILD_PLACEMENT_CURSOR
            BeginScript
                   CurDrawableHideSubObject("FIREGLOW")
                   CurDrawableHideSubObject("FLAMES")
                   CurDrawableHideSubObject("GBFFLAG")
                   CurDrawableHideSubObject("GBFFLAMING")
            EndScript
            BeginScript
                   CurDrawableHideSubObject("TUSKS")
                   CurDrawableHideSubObject("AWNING")
                   CurDrawableHideSubObject("BASE")
                   CurDrawableHideSubObject("FLAGPOLE")
                   CurDrawableHideSubObject("FLAG")
                   CurDrawableHideSubObject("SKELETON1")
                   CurDrawableHideSubObject("SKELETON2")
            EndScript
        End
        
        AnimationState = PHANTOM_STRUCTURE
            BeginScript
                   CurDrawableHideSubObject("FIREGLOW")
                   CurDrawableHideSubObject("FLAMES")
                   CurDrawableHideSubObject("GBFFLAG")
                   CurDrawableHideSubObject("GBFFLAMING")
            EndScript
            BeginScript
                   CurDrawableHideSubObject("TUSKS")
                   CurDrawableHideSubObject("AWNING")
                   CurDrawableHideSubObject("BASE")
                   CurDrawableHideSubObject("FLAGPOLE")
                   CurDrawableHideSubObject("FLAG")
                   CurDrawableHideSubObject("SKELETON1")
                   CurDrawableHideSubObject("SKELETON2")
            EndScript
        End

        ModelConditionState  = RUBBLE
            Model	= hbfortress
            Texture	= hbfortress.tga hbfortress_d.tga
            Texture	= haradrim_banr_b.tga co_banr_b01.tga
            Texture	= mbkingplc.tga hbkingplcumbar.tga
            Texture	= mumumaskel.tga mumumaskel02.tga
            Texture	= muwildmumakil.tga hamumakil01.tga
            Texture	= hbgate.tga hbgate.tga
            Texture	= mbccenter.tga mbccenter_d.tga
            Texture	= haftrskel.tga haftrskel.tga
            ParticleSysBone SmokeLarge01 SmokeBuildingLarge
        End
        AnimationState = RUBBLE
            EnteringStateFX    = FX_FortressCollapse 
        End

        
        ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED SNOW
            Model               = hbfortress_b
            
        End
        ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Model               = hbfortress_b
        End
        AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Animation           = hbfortress
                AnimationName     = hbfortress_b.hbfortress_b
                AnimationMode     = MANUAL
            End
            ParticleSysBone = NONE BuildingContructDustCastlesB FollowBone:Yes
            ParticleSysBone = NONE FortressIsengard FollowBone:Yes
            Flags                = START_FRAME_FIRST
            StateName            = BeingConstructed 
            BeginScript
                   CurDrawableHideSubObject("FIREGLOW")
                   CurDrawableHideSubObject("FLAMES")
                   CurDrawableHideSubObject("GBFFLAG")
                   CurDrawableHideSubObject("GBFFLAMING")
            EndScript
            BeginScript
                   CurDrawableHideSubObject("TUSKS")
                   CurDrawableHideSubObject("AWNING")
                   CurDrawableHideSubObject("BASE")
                   CurDrawableHideSubObject("FLAGPOLE")
                   CurDrawableHideSubObject("FLAG")
                   CurDrawableHideSubObject("SKELETON1")
                   CurDrawableHideSubObject("SKELETON2")
            EndScript           
            BeginScript
                CurDrawablePlaySound("GondorBarracksBeginConstruction")
            EndScript
        End
    End

  	ArmorSet
		Conditions        = None
  		Armor             = FortressArmor
  	End

	Side                = Harad	
	EditorSorting       = STRUCTURE

	PlacementViewAngle = -45 
	
	BuildCost           = ISENGARD_FORTRESS_BUILDCOST
	BuildTime           = 5		

	DisplayName         = OBJECT:UmbarCorsairFortress

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceFullyCreated		= EVA:FortressComplete-Builder
	VoiceSelect			= IsengardFortressSelect
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged		= BuildingLightDamageStone
	SoundOnReallyDamaged	= BuildingHeavyDamageStone

	UnitSpecificSounds
	UnderConstruction	= BuildingBigConstructionLoop  
		
	UnderRepairFromRubble	= BuildingBigConstructionLoop	
    End

	ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
		ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
	End

	AutoResolveUnitType = AutoResolveUnit_Fortress
    
    	AutoResolveBody = AutoResolve_IsengardFortressBody
    
    	AutoResolveArmor
    		Armor = AutoResolve_IsengardFortressArmor
    	End

    	AutoResolveWeapon
    		Weapon = AutoResolve_IsengardFortressWeapon
    	End

	RadarPriority = STRUCTURE
	KindOf        = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION MP_COUNT_FOR_VICTORY BASE_SITE CAN_SEE_THROUGH_STRUCTURE LIVING_WORLD_BUILDING_MIRROR

	Body       = StructureBody ModuleTag_05
		MaxHealth     = ISENGARD_FORTRESS_HEALTH	
	End
	  
	Behavior = CastleBehavior ModuleTag_castle
        CastleToUnpackForFaction    = Evilmen Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Mordor  Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Men     Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Arnor   Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Rohan   Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Elves   Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Imladris Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Dwarves Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Isengard Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Wild    Fortress_Umbarcorsair
        CastleToUnpackForFaction    = Angmar  Fortress_Umbarcorsair

	FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER		

	MaxCastleRadius 	= 130.0
		InstantUnpack	= Yes		
		KeepDeathKillsEverything	= Yes

		EvaEnemyCastleSightedEvent = EnemyFortressSighted
	End 

	Behavior                  = StructureCollapseUpdate ModuleTag_06
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_FortressCollapse
		
		DestroyObjectWhenDone	= Yes
		CollapseHeight			= 120
	End

	Behavior	= GettingBuiltBehavior ModuleTag_GettingBuiltBehavior
		WorkerName	= HaradWorkerNoSelect
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
	End

	Behavior = AIUpdateInterface ModuleTag_AI
		AILuaEventsList		= FortressFunctions	
	End
	
    Geometry            = BOX
    GeometryMajorRadius = 64
    GeometryMinorRadius = 64
    GeometryHeight      = 50

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:64.0 Y:-64.0 Z:0    

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:00 Y:-62.0 Z:0    

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:-64.0 Y:-64.0 Z:0    

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:-64.0 Y:64.0 Z:0

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:0 Y:62.0 Z:0

    AdditionalGeometry      = BOX
    GeometryName            = Plots
    GeometryMajorRadius     = 10.0
    GeometryMinorRadius     = 10.0
    GeometryHeight          = 0.8
    GeometryOffset          = X:64.0 Y:64.0 Z:0

    GeometryIsSmall         = No
    Shadow                  = SHADOW_VOLUME

    GeometryContactPoint = X:-90       Y:82        Z:0            Repair
    GeometryContactPoint = X:84        Y:-79       Z:0            Repair
    GeometryContactPoint = X:5.576     Y:44.987    Z:0
    GeometryContactPoint = X:-38.348   Y:-42.113   Z:0
    GeometryContactPoint = X:-28.448   Y:-0.003    Z:75.14        Swoop
End

Object HaradFortressTusks

    Draw    = W3DScriptedModelDraw ModuleTag_01        
        OkToChangeModelColor    = No
        
        DefaultModelConditionState
            Model     = None
        End        
    End

    ArmorSet
        Conditions	= None
          Armor	= NoArmor 
      End

    Side             = Harad
    EditorSorting    = STRUCTURE
    BuildTime        = 10.0
   
    
    #include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
    CampnessValue = 0

    RadarPriority       = STRUCTURE
    KindOf              = STRUCTURE IMMOBILE NOT_AUTOACQUIRABLE UNATTACKABLE BASE_SITE CAN_SEE_THROUGH_STRUCTURE
    
    Body = HighlanderBody ModuleTag_02 
        MaxHealth      = 1.0
    End

    Behavior = SlavedUpdate ModuleTag_Slave
        DieOnMastersDeath = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = SpikeMoatRadiusWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Geometry              = CYLINDER
    GeometryMajorRadius   = 50    
    GeometryHeight        = 5

    GeometryIsSmall       = No
    Shadow                = SHADOW_VOLUME
End


Object UmbarCorsairSentryTowerExpansion

	SelectPortrait	= SPUmbarCorsairSentryTowerExpansion
	ButtonImage	= BIUmbarCorsairSentryTowerExpansion
	
	Draw = W3DScriptedModelDraw ModuleTag_Draw
	OkToChangeModelColor	= Yes
	UseStandardModelNames	= Yes
		
	ExtraPublicBone	= ARROW_01
	ExtraPublicBone	= ARROW_02
	ExtraPublicBone	= ARROW_03
	ExtraPublicBone	= ARROW_04
	ExtraPublicBone	= ARROW_05
	ExtraPublicBone	= ARROW_06
	ExtraPublicBone	= ARROW_07
	ExtraPublicBone	= ARROW_08
		
	DefaultModelConditionState
		Model = CBUmbarHouse01	 
		WeaponLaunchBone = PRIMARY ARROW_
	End

	ModelConditionState   = AWAITING_CONSTRUCTION UPGRADE_NUMENOR_STONEWORK SNOW
		Model	= cbumbarhouse01_a
		Texture	= mbtavern.tga mbtavern_up_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_snow.tga
	End

	ModelConditionState   = AWAITING_CONSTRUCTION UPGRADE_NUMENOR_STONEWORK
		Model	= cbumbarhouse01_a
		Texture	= mbtavern.tga mbtavern_up.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up.tga
	End

	ModelConditionState   = AWAITING_CONSTRUCTION SNOW
		Model	= cbumbarhouse01_a
		Texture	= mbtavern.tga mbtavern_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_snow.tga
	End

	ModelConditionState   = AWAITING_CONSTRUCTION 
		Model	= cbumbarhouse01_a
	End

    AnimationState        = AWAITING_CONSTRUCTION
      Animation           = cbumbarhouse01_a	
        AnimationName     = cbumbarhouse01_a.cbumbarhouse01_a
        AnimationMode     = MANUAL
        AnimationBlendTime = 0
      End
	  Flags	= START_FRAME_FIRST  
    End


	ModelConditionState	= ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED UPGRADE_NUMENOR_STONEWORK SNOW
		Model	= cbumbarhouse01_a	
		Texture	= mbtavern.tga mbtavern_up_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_snow.tga
	End

	ModelConditionState	= ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED UPGRADE_NUMENOR_STONEWORK 
		Model	= cbumbarhouse01_a	
		Texture	= mbtavern.tga mbtavern_up.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up.tga
	End

	ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED SNOW
		Model = cbumbarhouse01_a	
		Texture	= mbtavern.tga mbtavern_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_snow.tga
	End

	ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
		Model	= cbumbarhouse01_a	
		ParticleSysBone   = DUSTBONE BuildingContructDust
	End

	AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
		Animation           = cbumbarhouse01_a	
			AnimationName     = cbumbarhouse01_a.cbumbarhouse01_a
			AnimationMode     = MANUAL
		End
		Flags		= START_FRAME_FIRST
		StateName	= BeingConstructed
		ParticleSysBone   = NONE BuildingContructDustExpB
		ParticleSysBone   = NONE ExpIsengard
		BeginScript
			CurDrawablePlaySound("GondorBarracksBeginConstruction")
		EndScript	
	End

	ModelConditionState = DAMAGED UPGRADE_NUMENOR_STONEWORK
		Model	= CBUmbarHouse01	
		Texture	= mbtavern.tga mbtavern_up_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_d.tga
	End

	ModelConditionState = DAMAGED
		Model	= CBUmbarHouse01	
		Texture	= mbtavern.tga mbtavern_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_d.tga
	End

		AnimationState = DAMAGED
			EnteringStateFX	= FX_BuildingDamaged
		End	    

	ModelConditionState = REALLYDAMAGED UPGRADE_NUMENOR_STONEWORK
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_up_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_d.tga	
	End

	ModelConditionState = REALLYDAMAGED
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_d.tga	
	End

		AnimationState	= REALLYDAMAGED
			Animation	= IBFWTower_ReallyDamaged
				AnimationName		= IBFITower_D2SK.IBFITower_D2AN
				AnimationMode		= ONCE				
			End			
			EnteringStateFX	= FX_BuildingReallyDamaged	
		End

	ModelConditionState = RUBBLE UPGRADE_NUMENOR_STONEWORK
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_up_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_d.tga	
	End

	ModelConditionState = RUBBLE
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_d1.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_d.tga	
	End

		AnimationState	= RUBBLE
			Animation	= IBFWTower_ReallyDamaged
				AnimationName		= IBFITower_D3SK.IBFITower_D3AN
				AnimationMode		= ONCE				
			End	
			EnteringStateFX	= FX_StructureMediumCollapseNoSound
		End

	ModelConditionState = SNOW UPGRADE_NUMENOR_STONEWORK
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_up_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up_snow.tga
	End

	ModelConditionState = UPGRADE_NUMENOR_STONEWORK
		Model	= CBUmbarHouse01	
		Texture	= mbtavern.tga mbtavern_up.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_up.tga
	End

	ModelConditionState = SNOW
		Model	= CBUmbarHouse01
		Texture	= mbtavern.tga mbtavern_snow.tga
		Texture	= mbtavern_nrm.tga mbtavern_nrm.tga
		Texture	= mbtavernwd.tga mbtavernwd_snow.tga
	End
End

	Draw = W3DFloorDraw ModuleTag_DrawFloor    
    	StaticModelLODMode	= no 
		ModelName	= GBFARTOWB_Bib
		WeatherTexture     = SNOWY gbfortress1_snow.tga
	End

	DisplayName     = OBJECT:UmbarCorsairSentryTowerExpansion
	Side            = Harad
	EditorSorting   = STRUCTURE
	ThreatLevel 	= 11.0
	IsTrainable	= No
	 
	BuildCost           = ISENGARD_TOWEREXPANSION_BUILDCOST
	BuildTime           = ISENGARD_TOWEREXPANSION_BUILDTIME	
	VisionRange         = VISION_BASE_DEFENSE
 	ShroudClearingRange = SHROUD_CLEAR_BASE_DEFENSE

	CommandSet	= SellableCommandSet

	ArmorSet
		Conditions	= None
		Armor           = FortressExpansionArmor
	End

	WeaponSet
		Conditions	= NONE
		Weapon		= PRIMARY EvilFortressArrowTowerBow
	End 

	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect			= NeutralArrowTowerSelect
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction

	SoundOnDamaged			= BuildingLightDamageStone
	SoundOnReallyDamaged		= BuildingHeavyDamageStone

	UnitSpecificSounds
		UnderConstruction	= BuildingConstructionLoop  
		
		UnderRepairFromRubble	= BuildingConstructionLoop	
	End

	CampnessValue = CAMPNESS_FORTRESS_EXPANSION

	RadarPriority  = STRUCTURE
	KindOf = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CAN_ATTACK FS_BASE_DEFENSE MADE_OF_STONE
	 
	Behavior            = GettingBuiltBehavior ModuleTag_04
		WorkerName = HaradWorkerNoSelect
		SpawnTimer = DEFAULT_STRUCTURE_HEALDELAY
	End

	Body	= StructureBody ModuleTag_05
		MaxHealth               = ISENGARD_TOWEREXPANSION_HEALTH
		MaxHealthDamaged        = ISENGARD_TOWEREXPANSION_HEALTH_DAMAGED
		MaxHealthReallyDamaged  = ISENGARD_TOWEREXPANSION_HEALTH_REALLY_DAMAGED
	End

	Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
		DestructionDelay  = 4000
	End
	  
	Behavior = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate 
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight		= 89
	End
	
	Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
		Radius		= 100		
		MaxIncome	= 0			
		IncomeInterval	= 999999	
		HighPriority	= Yes		
		Visible = No 		
	End

	Behavior        = BuildingBehavior BuildingModuleTag
		NightWindowName	= WINDOW_N01
	End

	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
		AutoAcquireEnemiesWhenIdle	= Yes
		MoodAttackCheckRate		= 250
	End

    Behavior = CastleMemberBehavior ModuleTag_CMB
    End 

	Behavior = WeaponSetUpgrade ModuleTag_FlamingAttack 
		TriggeredBy	= Upgrade_EvilFortressFlamingMunitions
	End

	
	Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy		= Upgrade_MordorFortressMagmaCauldrons		
		AttributeModifier	= IvoryPlatingExpansion_Bonus
	End

	Behavior = ModelConditionUpgrade ModuleTag_ShowThePlating
		TriggeredBy		= Upgrade_MordorFortressMagmaCauldrons	
		AddConditionFlags	= UPGRADE_NUMENOR_STONEWORK
		Permanent		= Yes
	End

    Behavior = GrantUpgradeCreate ModuleTag_GrantMumakpenLevel1
        UpgradeToGrant          = Upgrade_StructureLevel1 
    End

	Behavior = ObjectCreationUpgrade MakeTheFreeArcher1
		TriggeredBy		= Upgrade_StructureLevel1 
		Delay			= 0.0
		DestroyWhenSold 	= Yes
		DeathAnimAndDuration 	= AnimState:DEATH_2 AnimTime:999999
		ThingToSpawn		= UmbarCorsairarcherFloatingBuilding_Slaved
		Offset			= X:20.00 Y:-12.00 Z:51
		FadeInTime		= 1000
	End
  
  Scale = 0.70	

  Geometry              = BOX
  GeometryMajorRadius   = 16.0
  GeometryMinorRadius   = 16.0
  GeometryHeight        = 73
  GeometryOffset	= X:0 Y:0 Z:0  
  
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
End