Object GoblinFighterHorde

    ButtonImage        = UPWild_GoblinWarrior2
    SelectPortrait     = UPWild_GoblinWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side                   = Wild
    EditorSorting          = UNIT
    EmotionRange           = 240
    DisplayName            = OBJECT:HordeGoblinFighters
    DisplayNameStrategic   = CONTROLBAR:LW_Unit_GoblinFighterHorde
    DescriptionStrategic   = CONTROLBAR:LW_ToolTip_GoblinFighterHorde
    IsAutoBuilt            = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End



    BuildCost           = LOW_TIER_COST_1
    BuildTime           = VERYWEAK_BUILDTIME

    VisionRange         = GOBLIN_FIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange = GOBLIN_FIGHTER_SHROUD_RANGE

    VisionSide          = 50%
    VisionRear          = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0
    CommandPoints     = 30
    CommandSet        = GoblinFighterCommandSetMod
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        AILuaEventsList             = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority              = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighter 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY +WildBannerGoblin
        ShowPips        = No
        RandomOffset    = X:5 Y:5

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter    Pos:X:70.0 Y:0.0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinFighter Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighter Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighter Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = GoblinFighterHordeFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
        End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate        = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused                  = No
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_TestBuilding
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PlunderKeulen
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
        RequiresAllTriggers         = Yes
        GetUpgradeCommandButtonName = Command_ToggleFormationOrksNebelberge
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding_2
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = WildGundabadMarauderSwordHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade2
        TriggeredBy                 = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End





    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedBlades
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_WildOrcVenomSacks
End

ChildObject GoblinFighterGroﬂork_SummonedHorde GoblinFighterHorde
    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighterGroﬂork_Summoned 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY +WildBannerGoblin
        ShowPips        = No
        RandomOffset    = X:5 Y:5

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter    Pos:X:70.0 Y:0.0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinFighterGroﬂork_Summoned Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighterGroﬂork_Summoned Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighterGroﬂork_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End
End

ChildObject GoblinFighterHordeFormation GoblinFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GoblinFighter 15
        Slots                             = 15
        PassengerFilter                   = NONE +INFANTRY +WildBannerGoblin
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        AttributeModifiers                = OrksFormationModifier
        RandomOffset                      = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinFighter Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = GoblinFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


Object GoblinFighteGroﬂorkHorde

    ButtonImage        = WOR_GoblinFighters
    SelectPortrait     = UPWild_GoblinWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeGoblinFighters
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GoblinFighterHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinFighterHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End



    BuildCost        = 10
    BuildTime        = VERYWEAK_BUILDTIME

    VisionRange         = GOBLIN_FIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange     = GOBLIN_FIGHTER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel    = 0
    CommandPoints    = WILD_GOBLINFIGHTER_HORDE_MOD_COMMANDPOINTS
    CommandSet    = ThalEliteHorde_SummonedCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GOBLIN_FIGHTER_HORDE_THREAT
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority                =  AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighterGroﬂork 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY
        ShowPips        = No

        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighterGroﬂork    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinFighterGroﬂork Position:X:60 Y:0              Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighterGroﬂork Position:X:35 Y:10 Leader 1 0  Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighterGroﬂork Position:X:10 Y:0 Leader 2 0   Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            = 150
        FearScanDistance            = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
        End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate        = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused                  = No
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PlunderKeulen
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = GrantUpgradeCreate ModuleTag_GrantIsengardForgedBlades
        UpgradeToGrant = Upgrade_HeavyArmor
    End
    Behavior = GrantUpgradeCreate ModuleTag_GrantHeavyArmor
        UpgradeToGrant = Upgrade_PlunderKeulen
    End







    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedBlades
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object GorkilEliteHorde 

    ButtonImage        = WOR_GoblinFighters
    SelectPortrait     = UPGoblinArmy

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
	DisplayName        = OBJECT:HordeGorkilsElite
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GoblinGorkilEliteHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinGorkilEliteHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    IsAutoBuilt        = No
	
	CrushableLevel    	= 1
	BuildCost        = 80
    BuildTime        = VERYWEAK_BUILDTIME
	CommandPoints    = 40
    CommandSet    	 = GorkilEliteHordeCommandset
    FormationWidth    = 5
    FormationDepth    = 4

    VisionRange         = GOBLIN_FIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange     = GOBLIN_FIGHTER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GOBLIN_FIGHTER_HORDE_THREAT
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority                =  AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighter 10
		InitialPayload    = WildMiniScorpion 10
        Slots            = 20
        PassengerFilter = ANY +INFANTRY +WildBannerGoblin
        ShowPips        = No
        RandomOffset    = X:5 Y:5

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter    Pos:X:70.0 Y:0.0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinFighter 		  Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:WildMiniScorpion 	  Position:X:30 Y:10 Leader 1 0    Position:X:30 Y:30 Leader 1 1    Position:X:30 Y:-30 Leader 1 2    Position:X:30 Y:50 Leader 1 3    Position:X:30 Y:-50 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighter		  Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
		RankInfo = RankNumber:4 UnitType:WildMiniScorpion 	  Position:X:-10 Y:10 Leader 3 0    Position:X:-10 Y:30 Leader 3 1    Position:X:-10 Y:-30 Leader 3 2    Position:X:-10 Y:50 Leader 3 3    Position:X:-10 Y:-50 Leader 3 4
		RankInfo = RankNumber:5 UnitType:GoblinFighter		  Position:X:-30 Y:0 Leader 2 0    Position:X:-30 Y:20 Leader 2 1    Position:X:-30 Y:-20 Leader 2 2    Position:X:-30 Y:40 Leader 2 3    Position:X:-30 Y:-40 Leader 2 4
		
        RanksToReleaseWhenAttacking = 1 2 3 4 5
		
		AttributeModifiers         = FighterScorpionComboHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End
   
    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            = 150
        FearScanDistance            = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
        End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End
	
    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 200
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = ScorpionPresenceDebuff
        ObjectFilter      = ANY +CAVALRY
    End
	
    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedBlades
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildFighterHordeBody

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorArmor
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining 
End



ChildObject GoblinFighterHorde_FromDefectedLair GoblinFighterHorde

    BuildCost = 10
    BuildTime = VERYWEAK_BUILDTIME

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighter 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY +WildBannerGoblin
        ShowPips        = No
        RandomOffset    = X:5 Y:5

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter    Pos:X:70.0 Y:0.0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinFighter Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighter Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighter Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
		
		ComboHorde = Target:WildMiniScorpionHorde		Result:GorkilEliteHorde			InitiateVoice:GoblinWarriorVoiceCheerLoop

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End
End



ChildObject GoblinMiniHorde GoblinFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinFighter 6
        Slots            = 6
        PassengerFilter = ANY +INFANTRY
        ShowPips        = No


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinFighter    Pos:X:60.0 Y:0.0

        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinFighter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20
        RankInfo = RankNumber:2 UnitType:GoblinFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2

        RanksToReleaseWhenAttacking = 2
    End
End


ChildObject GoblinFighterHordeUpgraded GoblinFighterHorde

    ButtonImage    = BIDurbagashWarrior
    SelectPortrait = UPDurbagashWarrior

    BuildCost      = 170
    IsTrainable    = Yes
    CommandSet     = WildAzogsEliteCommandSet
    EquivalentTo   = GoblinFighterHorde

    DisplayName             = OBJECT:HordeGoblinFightersUpgraded
    DisplayNameStrategic    = CONTROLBAR:LW_Unit_GoblinFighterHordeUpgraded
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinFighterHordeUpgraded

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay       = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GoblinFighterUpgraded 15
        Slots              = 15
        AttributeModifiers = OrksFormationModifier2
        PassengerFilter    = ANY +INFANTRY +WildBannerGoblin
        ShowPips           = No
        RandomOffset       = X:5 Y:5

        MeleeBehavior      = Amoeba
        End

        BannerCarriersAllowed    = WildBannerGoblinBolg
        BannerCarrierPosition    = UnitType:GoblinFighterUpgraded    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinFighterUpgraded Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinFighterUpgraded Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinFighterUpgraded Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

   Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate        = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused                = No
   End

   Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorPoisonedBlades
        SpecialAbility = SpecialAbilityGoblinFighterPoisonedBlades
        Query 	       = 1 ANY +HERO +MONSTER +INFANTRY +CAVALRY +DOZER -STRUCTURE ENEMIES
   End
End



Object GoblinArcherHorde

    ButtonImage       = WOR_GoblinArcher
    SelectPortrait    = UPWild_GoblinArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGAr
        End
    End

    Side                 = Wild
    EditorSorting        = UNIT
    EmotionRange         = 240
    TransportSlotCount   = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName          = OBJECT:HordeGoblinArchers
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GoblinArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinArcherHorde

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY  GoblinArcherMissileHordeRangefinderEdain
        Weapon            = TERTIARY GoblinArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        	= LOW_TIER_COST_2
    BuildTime        	= VERYWEAK_BUILDTIME

    VisionRange 	= GOBLIN_ARCHER_HORDE_VISION_RANGE
    ShroudClearingRange = GOBLIN_ARCHER_SHROUD_RANGE

    VisionSide 		= 50%
    VisionRear 		= 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    	= 0
    CrusherLevel    	= 0
    UseCrushAttack  	= No
    CommandPoints    	= 30
    CommandSet    	= GoblinArcherHordeCommandSet

    FormationWidth     = 2
    FormationDepth     = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel     = 100
    ThreatBreakdown GoblinArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = SpecialPowerModule ModuleTag_PoisonArrowsStarter
        SpecialPowerTemplate        = SpecialAbilityPoisonArrows
        UpdateModuleStartsAttack    = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_PoisonArrowsWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityPoisonArrows
        PackTime                    = 2000
        StartAbilityRange           = #SUBTRACT( GOBLIN_ARCHER_RANGE 100 )
        SpecialWeapon               = GoblinArcherPoisonArrowsRangeFinder
        ApproachUntilMembersInRange = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = WildInfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinArcher 15
        Slots            = 15
        PassengerFilter = NONE +INFANTRY +WildBannerGoblin
        ShowPips        = No


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinArcher        Pos:X:70.0 Y:0.0

        RandomOffset = X:5 Y:5

        RankInfo = RankNumber:1 UnitType:GoblinArcher Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinArcher Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinArcher Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3 4

        AlternateFormation = GoblinArcherHordeFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER +CloudBreakSunbeam +SunflareSunbeam
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            = 150
        FearScanDistance            = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining2
        TriggeredBy         = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_PoisonArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_TestBuilding
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
        RequiresAllTriggers         = Yes
        GetUpgradeCommandButtonName = Command_ToggleFormationOrksNebelberge
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding_2
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = WildGundabadArcherHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade2
        TriggeredBy                 = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End



    Behavior = AISpecialPowerUpdate GoblinArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonArrowAI
        CommandButtonName = Command_GoblinArcherPoisonArrows
        SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_WildArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_PoisonArrows
        Weapon = AutoResolve_GoblinArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_PoisonArrows
        Weapon = AutoResolve_GoblinArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_PoisonArrows Upgrade_HeavyArmor
End



ChildObject GoblinArcherHordeFormation GoblinArcherHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GoblinArcher 15
        Slots                             = 15
        PassengerFilter                   = NONE +INFANTRY +WildBannerGoblin
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        AttributeModifiers                = OrksFormationModifier
        RandomOffset                      = X:5 Y:5
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinArcher Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinArcher Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinArcher Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = GoblinArcherHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

ChildObject GoblinArcherHordeInn GoblinArcherHorde
    BuildCost = 40
End

ChildObject GoblinArcherHorde_FromDefectedLair GoblinArcherHorde
    BuildCost = 15
    BuildTime = VERYWEAK_BUILDTIME
End


ChildObject GoblinArcherMiniHorde GoblinArcherHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinArcher 6
        Slots            = 6
        PassengerFilter = ANY +INFANTRY
        ShowPips        = No

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinArcher    Pos:X:60.0 Y:0.0

        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinArcher Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20
        RankInfo = RankNumber:2 UnitType:GoblinArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2

        RanksToReleaseWhenAttacking = 2
    End
End

ChildObject GoblinArcherBolgHorde GoblinArcherHorde

    BuildCost	   = 130
    IsTrainable    = Yes
    CommandSet     = GoblinArcherBolgCommandSet
    EquivalentTo   = GoblinArcherHorde

    DisplayName        = OBJECT:GoblinArcherBolgHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GoblinArcherBolgHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinArcherBolgHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GoblinArcherBolg 15
        Slots                             = 15
        PassengerFilter                   = NONE +INFANTRY +GoblinArcherBolg
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        AttributeModifiers                = OrksFormationModifier2
        RandomOffset                      = X:5 Y:5
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblinBolg
        BannerCarrierPosition    = UnitType:GoblinArcherBolg Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinArcherBolg Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinArcherBolg Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinArcherBolg Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate        = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused                = No
    End

   Behavior = AutoAbilityBehavior ModuleTag_PoisonArrowAutoAbility
        SpecialAbility	= SpecialAbilityGoblinFighterPoisonedBlades
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 200
        Query		= 1 ANY ENEMIES +HERO +MONSTER +INFANTRY +CAVALRY -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
   End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedArrowsSpell
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End
End



Object WildSpiderlingHorde

    SelectPortrait = UPWild_Spiderlings
    ButtonImage    = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side                 = Wild
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:WildSpiderlingHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildSpiderlingHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildSpiderlingHorde
    IsAutoBuilt          = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost           = 300
    BuildTime           = WEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange         = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0

    CommandPoints     = 30
    CommandSet        = WildSpiderlingHordeCommandSetMod
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime               = 7500
        MinCowerTime               = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay              = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained   =
        InitialPayload            = WildSpiderlingHordeMember 10
        Slots                     = 10
        PassengerFilter           = ANY +WildSpiderlingHordeMember +WildBannerSpiderling
        ShowPips                  = No
        RandomOffset              = X:2 Y:2

        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = WildBannerSpiderling
        BannerCarrierPosition    = UnitType:WildSpiderlingHordeMember    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:WildSpiderlingHordeMember Position:X:40 Y:0        Position:X:40 Y:25        Position:X:40 Y:-25        Position:X:40 Y:50        Position:X:40 Y:-50
        RankInfo = RankNumber:2 UnitType:WildSpiderlingHordeMember Position:X:10 Y:0        Position:X:10 Y:25        Position:X:10 Y:-25        Position:X:10 Y:50        Position:X:10 Y:-50 
        RanksToReleaseWhenAttacking     = 2

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance    = 50
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End

    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy         = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32
        Height  = 32
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = ANY +CAVALRY
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 40
    GeometryMinorRadius = 50
    GeometryHeight      = 8.0
    GeometryIsSmall     = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End


Object GoblinSpiderRiderHorde

    SelectPortrait  = UPWild_SpiderRider
    ButtonImage     = WOR_SpiderRider

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:WildSpiderRiderHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GoblinSpiderRiderHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinSpiderRiderHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = 500
    BuildTime        = STRONG_BUILDTIME

    ShroudClearingRange = WILD_SPIDERRIDER_SHROUD_RANGE
    VisionRange         = WILD_SPIDERRIDER_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints        = 60
    CommandSet           = WildSpiderRiderHordeModCommandSet
    FormationWidth       = 2
    FormationDepth       = 2
    CrushableLevel       = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback            = 40
    CrushZFactor              = 1.0
	MaxSimultaneousOfType  = 5

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUPPORT

    ThreatLevel = 150
    ThreatBreakdown GoblinSpiderRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = CavalryFunctions
        MaxCowerTime                = 7500
        MinCowerTime                = 5000
        AttackPriority                = AttackPriority_Cavalry
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload                = GoblinSpiderRider 6
        Slots                        = 6
        PassengerFilter                = ANY +CAVALRY +WildBannerSpiderRider
        ShowPips                    = No


        BannerCarriersAllowed    = WildBannerSpiderRider
        BannerCarrierPosition    = UnitType:GoblinSpiderRider    Pos:X:60.0 Y:30.0

        RandomOffset    = X:2 Y:2

        MeleeBehavior = Amoeba
        End

        RankInfo        = RankNumber:1 UnitType:GoblinSpiderRider        Position:X:30 Y:0               Position:X:11 Y:28                Position:X:21 Y:-21
        RankInfo        = RankNumber:2 UnitType:GoblinSpiderRider        Position:X:-8 Y:-7 Leader 1 0   Position:X:-32 Y:-30 Leader 1 1   Position:X:-13 Y:17 Leader 1 2

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_MOUNTED_MED_HORDE_SPEED
    End







    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_COMBO
        Speed     = NORMAL_MOUNTED_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining2
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap        = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_PoisonArrows
    End





    Behavior = AISpecialPowerUpdate GoblinSpiderRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate GoblinSpiderRiderHordeToggleWeapon
        CommandButtonName = Command_ToggleSpiderRiderWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End


    Geometry            = BOX
    GeometryMajorRadius = 25
    GeometryMinorRadius = 40
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_WildSpiderRiderHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildSpiderRiderForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderWeapon
    End

    FormationPreviewItemDecal
            Texture = FPspiderCavalryDecal
            Width=64
               Height=64
        End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_PoisonArrows Upgrade_WildSpiderVenomSacks
End


Object WildMarauderHorde

    ButtonImage        = WOR_Marauder
    SelectPortrait    = UPWild_HalfTrollMarauders

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side            = Wild
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:WildMarauderHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildMarauderHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildMarauderHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost        = 450
    BuildTime        = MEDIUM_BUILDTIME

    ShroudClearingRange = WILD_MARAUDER_SHROUD_RANGE
    VisionRange = WILD_MARAUDER_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel    = 0
    CrusherLevel    = 0
    CommandPoints    = 50

    CommandSet  = WildMarauderHordeCommandSetMod

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount    = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf                = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 125
    ThreatBreakdown WildMauraderHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained   =
        InitialPayload            = WildMarauder 10
        PassengerFilter           = NONE +INFANTRY +WildBannerMarauder
        Slots                     = 10
        ShowPips                  = No

        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerMarauder
        BannerCarrierPosition    = UnitType:WildMarauder    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:WildMarauder Position:X:25 Y:-27 Position:X:27 Y:0 Position:X:25 Y:28
        RankInfo = RankNumber:2 UnitType:WildMarauder Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:38
        RankInfo = RankNumber:3 UnitType:WildMarauder Position:X:-29 Y:-24 Position:X:-25 Y:0 Position:X:-30 Y:25


        RanksToReleaseWhenAttacking = 1
        AlternateFormation       = WildMarauderHordeFormation
        UseSlowHordeMovement     = Yes
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_TestBuilding
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
        GetUpgradeCommandButtonName = Command_ToggleFormationOrksNebelberge
    End


    Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry            = BOX
    GeometryMajorRadius = 25
    GeometryMinorRadius = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_WildMarauderHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject WildMarauderHordeFormation WildMarauderHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = WildMarauder 10
        Slots                             = 10
        PassengerFilter                   = NONE +INFANTRY
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        AttributeModifiers                = OrksFormationModifier
        RandomOffset                      = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerMarauder
        BannerCarrierPosition    = UnitType:WildMarauder Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:WildMarauder Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:WildMarauder Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        AlternateFormation                = WildMarauderHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

End

ChildObject WildMarauderHordePorcupine WildMarauderHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = WildMarauder 8
        Slots                            = 8
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = WildMarauderHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 4

        AlternateFormation                = WildMarauderHorde
        NotComboFormation                = Yes


        BannerCarriersAllowed            = WildBannerMarauder
        BannerCarrierPosition            = UnitType:WildMarauder    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:WildMarauder Position:X:30 Y:0    Position:X:-30 Y:0        Position:X:0 Y:30    Position:X:0 Y:-30    Position:X:21.21 Y:21.21    Position:X:-21.21 Y:-21.21    Position:X:-21.21 Y:21.21    Position:X:21.21 Y:-21.21
    End
End


Object WildMarauderSwordHorde

    ButtonImage        = WOR_HalfTrollSwordIcon
    SelectPortrait     = KUHalfTrollSwordPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkIUPik
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:WildMarauderSwordHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_WildMarauderSwordHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_WildMarauderSwordHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost        = 650
    BuildTime        = MEDIUM_BUILDTIME

    ShroudClearingRange     = WILD_MARAUDERSWORDS_SHROUD_RANGE
    VisionRange         = WILD_MARAUDERSWORDS_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel   = 0
    CrusherLevel     = 0
    CommandPoints    = 50

    CommandSet       = WildMarauderSwordsHordeCommandSetMod

    FormationWidth   = 2
    FormationDepth   = 2

    TransportSlotCount    = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel         = 150
    ThreatBreakdown WildMauraderHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload        = WildMarauderSwords 10
        PassengerFilter        = NONE +INFANTRY +WildMarauderSwordBanner
        Slots            = 10
        ShowPips        = No
        AttributeModifiers                = OrksFormationModifier
        RandomOffset    = X:2 Y:2

        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildMarauderSwordBanner
        BannerCarrierPosition    = UnitType:WildMarauderSwords    Pos:X:70.0 Y:0

        RankInfo = RankNumber:1 UnitType:WildMarauderSwords Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:WildMarauderSwords Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking = 1 2

        UseSlowHordeMovement        = Yes
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        AlternateFormation          = WildMarauderSwordsHordePorcupine
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf           	     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 50
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy    = Upgrade_BasicTraining
        LevelsToGain    = 1
        LevelCap    = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy               = Upgrade_ObjectLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        InitiateSound             = MarauderVoiceEnterStateAttackCharge
    End

    #include "..\..\..\includes\AngmarChargeUpdate.inc"


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry        = BOX
    GeometryMajorRadius     = 25
    GeometryMinorRadius     = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_WildMarauderHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderSwordHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderSwordArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderSwordUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderSwordWeapon
	End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_WildSpiderVenomSacks
End


ChildObject WildMarauderSwordsHordePorcupine WildMarauderSwordHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                   = WildMarauderSwords 10
        Slots                            = 10
        PassengerFilter                  = NONE +INFANTRY
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = No
        RandomOffset                     = X:2 Y:1
        RanksToReleaseWhenAttacking      = 0
        RanksToJustFreeWhenAttacking     = 0
        AttributeModifiers               = WildMarauderHordePorcupine
        IsPorcupineFormation             = Yes
        MinimumHordeSize                 = 4
        AlternateFormation               = WildMarauderSwordsHorde
        NotComboFormation                = Yes
        BannerCarriersAllowed            = WildMarauderSwordBanner
        BannerCarrierPosition            = UnitType:WildMarauderSwordBanner    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:WildMarauderSwords Position:X:30 Y:0    Position:X:-30 Y:0        Position:X:0 Y:30    Position:X:0 Y:-30    Position:X:21.21 Y:21.21    Position:X:-21.21 Y:-21.21    Position:X:-21.21 Y:21.21    Position:X:21.21 Y:-21.21    Position:X:30 Y:30    Position:X:-30 Y:-30
    End
End


ChildObject WildMarauderSwordHorde_Summoned WildMarauderSwordHorde
    IsTrainable    = No
    CommandPoints     = 0
    CommandSet    = WildMarauderSwordsHordeCommandSet_Summoned
    EquivalentTo      = WildMarauderSwordHorde
    DisplayName  =  OBJECT:WildMarauderSwordHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload        = WildMarauderSwords_Summoned 10
        PassengerFilter        = NONE +INFANTRY
        Slots            = 10
        ShowPips        = No
        AttributeModifiers                = OrksFormationModifier
        RandomOffset    = X:2 Y:2

        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = WildMarauderSwordBanner_Summoned
        BannerCarrierPosition    = UnitType:WildMarauderSwordBanner_Summoned    Pos:X:70.0 Y:0

        RankInfo = RankNumber:1 UnitType:WildMarauderSwords_Summoned Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:WildMarauderSwords_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 160000
        MaxLifetime        = 160000
        DeathType        = FADED
    End
End




Object WildBabyDrakeHorde

    ButtonImage        = HIFireDrakeBroodIcon
    SelectPortrait  =  HPFireDrakeBrood

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeWildBabyDrake
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_WildBabyDrakeHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_WildBabyDrakeHorde
    MaxSimultaneousOfType        = 3
    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End






    BuildCost        = BABYDRAKE_BUILDCOST
    BuildTime        = HEROIC_BUILDTIME 

    VisionRange         = VISION_STANDARD_LARGE_ANIMAL
    ShroudClearingRange     = SHROUD_CLEAR_HERO

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    =       2
    CrusherLevel        = 2
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushRevengeWeapon    = RangedInfantryCrushRevenge
    CommandPoints    = 60
    CommandSet    = WildBabyDrakeHordeCommandSet
    FormationWidth    = 1
    FormationDepth    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_CAST_REFLECTIONS MONSTER CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = FIRE_DRAKE_THREAT_LEVEL
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority                =  AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload        = WildBabyDrake 3
        Slots            = 3
        PassengerFilter     = ANY +MONSTER
        ShowPips        = No
        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildBabyDrake Position:X:10 Y:0        Position:X:0 Y:15        Position:X:0 Y:-15

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End



    LocomotorSet
        Locomotor = FiredrakeLocomotor
        Condition = SET_NORMAL
        Speed     = 120
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 120
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = No
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes
        TriggeredBy            = Upgrade_MiniHordeLvl3
        HealingAmount            = 30
        Radius                = 100
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_InfernoEnabler
        SpecialPowerTemplate = SpecialAbilityFireDrakeInferno
        TriggeredBy = Upgrade_MiniHordeLvl7
    End


    Behavior = SpecialPowerModule ModuleTag_InfernoStarter
        SpecialPowerTemplate        = SpecialAbilityFireDrakeInferno
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes
        InitiateSound            = FireDrakeVoxInferno
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_InfernoUpdate
        SpecialPowerTemplate    = SpecialAbilityFireDrakeInferno

        UnpackTime              = 1300
        PackTime                = 3700

        AwardXPForTriggering    = 0

        StartAbilityRange = 90.0

        SpecialWeapon = BabyDrakeInferno
        WhichSpecialWeapon = 1
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BabyDrakeInfernoAI
        CommandButtonName = Command_FireDrakeBroodInferno
        SpecialPowerAIType = AI_SPECIAL_POWER_GANDALF_WIZARD_BLAST
        SpecialPowerRadius = 100
    End



    Geometry         = BOX
    GeometryMajorRadius     = 15.0
    GeometryMinorRadius     = 20.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No


End



Object GoblinRiderHorde

    SelectPortrait      = UPGoblinWargrider
    ButtonImage         = HIGoblinWargrider_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Wild
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GoblinRiderHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GoblinRiderHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinRiderHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY      NormalMeleeHordeRangefinder
        Weapon     = SECONDARY   NormalMeleeHordeRangefinder
        AutoChooseSources     = SECONDARY NONE
        ShareWeaponReloadTime = Yes
    End







    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ISENGARD_WARGRIDER_HORDE_VISION_RANGE

    ShroudClearingRange     = ISENGARD_WARGRIDER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 40

    CommandSet         = WildWargRiderHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GoblinRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +WildGoblinRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End


        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = WildGoblinRiderBanner
        BannerCarrierPosition    = UnitType:GoblinRider    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinRider Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:GoblinRider Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:GoblinRider Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation = GoblinRiderHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        AttributeModifiers          = IsengardWargSkirmish
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl

        AttributeModifierAffectsSelf = Yes

        AttributeModifierFX = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = WargCavalryHordeLocomotorEdain
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HauptmannPowerUnpause
        SpecialPowerTemplate = SpecialAbilitySalemeGiftfalleauslegen
        TriggeredBy          = Upgrade_GreatGoblinCrown
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilitySalemeGiftfalleauslegen
        Duration             = 20000
        AttributeModifier    = UrukHauptmannSchwertkampferBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding_2
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = GundabadWargRiderHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PlunderKeulen
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

	Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
		UpdateRate		= 1000
		HordeMemberFilter	= NONE +GoblinRider
		Count			= 31
		Radius			= 200
		RubOffRadius		= 200
		AlliesOnly		= Yes
		AttributeModifier	= CavLargeGroupBonus
    End
	
	Behavior = ObjectCreationUpgrade ModuleTag_UpgradeGaben
		TriggeredBy	= Upgrade_TestBuilding
		Delay		= 0.0
		ThingToSpawn	= GoblinRidersDebuffEgg
	End



    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody


    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_WildOrcVenomSacks
End



ChildObject GoblinRiderHordeWedgeFormation GoblinRiderHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = GoblinRider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +WildGoblinRiderBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildGoblinRiderBanner
        BannerCarrierPosition    = UnitType:GoblinRider    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinRider Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinRider Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = GoblinRiderHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

ChildObject GoblinRiderHorde_FromDefectedLair GoblinRiderHorde

    BuildCost = 50
    BuildTime = WEAK_BUILDTIME

End


Object GoblinSpearHorde

  ButtonImage    = HIGoblinSpear_Wotr
  SelectPortrait = UPGoblinSpear

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Wild
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GoblinPikemanHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GoblinPikemanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinPikemanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost        = LOW_TIER_COST_1
    BuildTime        = WEAK_BUILDTIME

    VisionRange = ISENGARD_URUKPIKEMAN_HORDE_VISION_RANGE
    ShroudClearingRange = ISENGARD_URUKPIKEMAN_SHROUD_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 30

    CommandSet  = GoblinSpearHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 100
    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GoblinSpear 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY +WildBannerGoblin
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinSpear    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinSpear Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinSpear Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinSpear Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
        AlternateFormation = GoblinSpearHordeFormation
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PlunderKeulen
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange            = 15.0
        UnpackTime                    = 1
        PreparationTime                = 15000
        PackTime                    = 1
        DoCaptureFX                    = Yes
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_TestBuilding
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
        RequiresAllTriggers         = Yes
        GetUpgradeCommandButtonName = Command_ToggleFormationOrksNebelberge
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding_2
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = WildGundabadPikesHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade2
        TriggeredBy                 = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End



    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_IsengardPikemanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_WildOrcVenomSacks
End


ChildObject GoblinSpearHordeFormation GoblinSpearHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GoblinSpear 15
        Slots                             = 15
        PassengerFilter                   = NONE +INFANTRY +WildBannerGoblin
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        AttributeModifiers                = GoblinFormationModifier
        RandomOffset                      = X:5 Y:5
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinSpear Pos:X:0.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinSpear Position:X:0 Y:50               Position:X:20 Y:50               Position:X:-20 Y:50               Position:X:40 Y:50               Position:X:-40 Y:50
        RankInfo = RankNumber:2 UnitType:GoblinSpear Position:X:0 Y:30 Leader 1 0    Position:X:20 Y:30 Leader 1 1    Position:X:-20 Y:30 Leader 1 2    Position:X:40 Y:30 Leader 1 3    Position:X:-40 Y:30 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinSpear Position:X:0 Y:10 Leader 2 0    Position:X:20 Y:10 Leader 2 1    Position:X:-20 Y:10 Leader 2 2    Position:X:40 Y:10 Leader 2 3    Position:X:-40 Y:10 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = GoblinSpearHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


ChildObject GoblinSpearHordePorcupine GoblinSpearHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = GoblinSpear 15
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY +WildBannerGoblin
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers                = IsengardPikemanHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = GoblinSpearHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = WildBannerGoblin
        BannerCarrierPosition            = UnitType:GoblinSpear    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:GoblinSpear Position:X:20 Y:0      Position:X:-20 Y:0     Position:X:7 Y:0     Position:X:-7 Y:0    Position:X:7 Y:28     Position:X:-7 Y:28    Position:X:-16.18 Y:11.76     Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


ChildObject GoblinSpearHorde_FromDefectedLair GoblinSpearHorde
    BuildCost = 15
    BuildTime = WEAK_BUILDTIME
End


Object WildMiniScorpionHorde

    SelectPortrait                  = UPWildScorpion
    ButtonImage                     = HSGiftWustenscorpioneng

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side                 = Wild
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:WildMiniScorpionHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildMiniScorpionHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildSpiderlingHorde

    IsAutoBuilt          = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 100
    BuildTime        = VERYWEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0


    CommandPoints     = 20
    CommandSet        = WildMiniScorpionHordeCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime               = 7500
        MinCowerTime               = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload           = WildMiniScorpion 10
        Slots                    = 10
        PassengerFilter          = ANY +WildMiniScorpion +WildMiniScorpionHordeMember +WildMiniScorpionBanner
        ShowPips                 = No
        RandomOffset             = X:2 Y:2
        MeleeBehavior            = Amoeba
        End


        BannerCarriersAllowed    = WildMiniScorpionBanner
        BannerCarrierPosition    = UnitType:WildMiniScorpion    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:WildMiniScorpion Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:WildMiniScorpion Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:WildMiniScorpion Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
		
		ComboHorde = Target:GoblinFighterHorde_FromDefectedLair		Result:GorkilEliteHorde			InitiateVoice:GoblinWarriorVoiceCheerLoop

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End

    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP     = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy  = Upgrade_WildSpiderVenomSacks
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32s
        Height  = 32
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 40
    GeometryMinorRadius = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End



Object WildMiniSpiderHorde

    SelectPortrait = BWSpiderPit_Spiderling
    ButtonImage = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side                 = Wild
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:WildSpiderlingHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildSpiderlingHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildSpiderlingHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 50
    BuildTime        = WEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel  = 0
    CrusherLevel    = 0


    CommandPoints     = 20
    CommandSet        = WildSpiderlingCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime            = 7500
        MinCowerTime            = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload        = WildMiniSpider 10
        Slots            = 10
        PassengerFilter        = ANY +WildMiniSpider
        ShowPips        = No

        RandomOffset        = X:2 Y:2

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildMiniSpider Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:WildMiniSpider Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:WildMiniSpider Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End







    LocomotorSet
        Locomotor     = NormalSpiderlingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32s
        Height  = 32
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 20
    GeometryMinorRadius = 40
    GeometryHeight      = 8.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End


Object WildZuchtspinnenHorde

    SelectPortrait     = HPShelob
    ButtonImage        = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:WildZuchtspinnenHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildZuchtspinnenHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinSpiderRiderHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 500
    BuildTime        = MEDIUM_BUILDTIME

    ShroudClearingRange     = WILD_SPIDERRIDER_SHROUD_RANGE
    VisionRange         = WILD_SPIDERRIDER_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints        = 30
    CommandSet        = WildZuchtspinneHordeCommandSet
    FormationWidth        = 2
    FormationDepth        = 2

    CrushableLevel            = 2
    CrusherLevel            = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback            = 40
    CrushZFactor            = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GOBLIN_SPIDERRIDER_HORDE_THREAT
    ThreatBreakdown GoblinSpiderRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = CavalryFunctions
        MaxCowerTime                = 7500
        MinCowerTime                = 5000
        AttackPriority                = AttackPriority_Cavalry
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload                = WildZuchtspinnen 6
        Slots                        = 6
        PassengerFilter                = ANY +CAVALRY +WildZuchtspinnenBanner
        ShowPips                    = No


        BannerCarriersAllowed    = WildZuchtspinnenBanner
        BannerCarrierPosition    = UnitType:WildZuchtspinnen    Pos:X:60.0 Y:30.0

        RandomOffset    = X:2 Y:2

        MeleeBehavior = Amoeba
        End

        RankInfo        = RankNumber:1 UnitType:WildZuchtspinnen        Position:X:30 Y:0               Position:X:11 Y:28                Position:X:21 Y:-21
        RankInfo        = RankNumber:2 UnitType:WildZuchtspinnen        Position:X:-8 Y:-7 Leader 1 0   Position:X:-32 Y:-30 Leader 1 1   Position:X:-13 Y:17 Leader 1 2

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_MOUNTED_MED_HORDE_SPEED
    End







    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_COMBO
        Speed     = NORMAL_MOUNTED_MED_HORDE_SPEED
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining2
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap        = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End


    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End






    Behavior = AISpecialPowerUpdate GoblinSpiderRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate GoblinSpiderRiderHordeToggleWeapon
        CommandButtonName = Command_ToggleSpiderRiderWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry            = BOX
    GeometryMajorRadius = 25
    GeometryMinorRadius = 40
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_WildSpiderRiderHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildSpiderRiderForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades Upgrade_PoisonArrows
        Weapon = AutoResolve_WildSpiderRiderWeapon
    End

    FormationPreviewItemDecal
            Texture = FPspiderCavalryDecal
            Width=64
               Height=64
        End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_PoisonArrows
End


Object WildSpiderlingHordeForShelobh

    SelectPortrait = BWSpiderPit_Spiderling
    ButtonImage = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:WildSpiderlingHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildSpiderlingHordeForShelobh
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildSpiderlingHorde

    IsAutoBuilt        = No

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 20
    BuildTime        = WEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel    = 0


    CommandPoints    = 10
    CommandSet    = WildSpiderlingHordeForShelobhCommandSet
    FormationWidth    = 1
    FormationDepth    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime            = 7500
        MinCowerTime            = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload        = WildSpiderlingForShelobh 1
        Slots            = 1
        PassengerFilter        = ANY +WildSpiderlingForShelobh
        ShowPips        = No

        RandomOffset        = X:1 Y:1

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildSpiderlingForShelobh Position:X:0 Y:0

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End







    LocomotorSet
        Locomotor     = NormalSpiderlingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32s
        Height  = 32
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 40
    GeometryMinorRadius = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End

ChildObject WildSpiderlingHordeForShelobhFast WildSpiderlingHordeForShelobh
    BuildTime        = WEAK_BUILDTIME
End

Object WildMiniSpiderHordeForShelobh

    SelectPortrait = BWSpiderPit_Spiderling
    ButtonImage = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side                 = Wild
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:WildTodesbissSpionne
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildTodesbissSpionne
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildTodesbissSpionne

    IsAutoBuilt        = No

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 50
    BuildTime        = WEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel  = 0
    CrusherLevel    = 0


    CommandPoints     = 5
    CommandSet        = WildTodesbissspinneCommandSet
    FormationWidth    = 1
    FormationDepth    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime            = 7500
        MinCowerTime            = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload        = WildMiniSpiderForShelobh 1
        Slots            = 1
        PassengerFilter        = ANY +WildMiniSpiderForShelobh
        ShowPips        = No

        RandomOffset        = X:1 Y:1

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildMiniSpiderForShelobh Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End



    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_CAVALRY_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32s
        Height  = 32
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 20
    GeometryMinorRadius = 40
    GeometryHeight      = 8.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End

ChildObject WildMiniSpiderHordeForShelobhFast WildMiniSpiderHordeForShelobh
    BuildTime        = WEAK_BUILDTIME
End

Object WildSpiderlingHordeMemberForCreepHorde

    SelectPortrait = BWSpiderPit_Spiderling
    ButtonImage = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:WildSpiderlingHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WildSpiderlingHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WildSpiderlingHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 100
    BuildTime        = WEAK_BUILDTIME

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel    = 0


    CommandPoints    = 30
    CommandSet    = WildSpiderlingHordeCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = WILD_SPIDERLING_HORDE_THREAT
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime            = 7500
        MinCowerTime            = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload        = WildSpiderlingHordeMemberForCreep 10
        Slots            = 10
        PassengerFilter        = ANY +WildSpiderlingHordeMemberForCreep +WildBannerSpiderling
        ShowPips        = No

        RandomOffset        = X:2 Y:2

        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = WildBannerSpiderling
        BannerCarrierPosition    = UnitType:WildSpiderlingHordeMemberForCreep    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:WildSpiderlingHordeMemberForCreep Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:WildSpiderlingHordeMemberForCreep Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:WildSpiderlingHordeMemberForCreep Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End







    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_WildSpiderVenomSacks
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
        Texture = FPspiderCavalrySingle
        Width   = 32s
        Height  = 32
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = NONE +CAVALRY
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 40
    GeometryMinorRadius = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_WildSpiderVenomSacks
End


Object WildWargPackHorde

    ButtonImage       = WOR_WargPack
    SelectPortrait    = UPWargPackPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             = Wild
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:WildWargPackHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_WildWargPackHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_WildWargPackHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = ISENGARD_WARGPACK_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    VisionRange         = 250
    ShroudClearingRange     = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 40

    CommandSet         = WildWargPackHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGPACK_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargPack  10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY +IsengardWargPack
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:IsengardWargPack Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargPack Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargPack Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        AttributeModifiers          = IsengardWargSkirmish
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End







    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorKnightWeapon
    End
End

Object GoblinTunnelHorde

    ButtonImage        = WOR_GoblinFighters
    SelectPortrait        = UPWild_GoblinWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeGoblinFightersTunnel
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GoblinFighterHordeTunnel
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinFighterHordeTunnel

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End






    BuildCost        = 50
    BuildTime        = VERYWEAK_BUILDTIME

    VisionRange         = GOBLIN_FIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange     = GOBLIN_FIGHTER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0
    CommandPoints     = WILD_GOBLINFIGHTER_HORDE_MOD_COMMANDPOINTS
    CommandSet        = GoblinTunnelHordeCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = GOBLIN_FIGHTER_HORDE_THREAT
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        AILuaEventsList             = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority              = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = GoblinTunnel 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY
        ShowPips        = No


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinTunnel    Pos:X:70.0 Y:0.0

        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GoblinTunnel Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinTunnel Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinTunnel Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_ObjectLevel1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = No
    End







    Behavior = SpecialPowerModule ModuleTag_TunnelDummy
        SpecialPowerTemplate            = SpecialAbilityTunnelausheben
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityTunnelausheben
        StartAbilityRange               = 10
        TriggerSpecialPower             = ModuleTag_TunnelSpecialPower    TARGETPOS
    End

    Behavior                            = OCLSpecialPower ModuleTag_TunnelSpecialPower
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        OCL                             = OCL_SklavenTunnelausheben
        TriggerFX                       = FX_Tunnelausheben
        CreateLocation                  = CREATE_AT_LOCATION
        StartsPaused                    = No
    End







    Behavior = SpecialPowerModule ModuleTag_TunnelausbauenDummy
        SpecialPowerTemplate            = SpecialAbilityTunnelbesetzen2
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_TunnelausbauenCloseTheGap
        SpecialPowerTemplate            = SpecialAbilityTunnelbesetzen2
        StartAbilityRange               = 30
        TriggerSpecialPower             = ModuleTag_TunnelausbauenKingsFavor     TARGETPOS
        TriggerSpecialPower             = ModuleTag_TunnelausbauenStarter        TARGETPOS
    End

    Behavior = LevelGrantSpecialPower ModuleTag_TunnelausbauenKingsFavor
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        UnpackingVariation              = 2
        StartAbilityRange               = 30.0
        LevelFX                         = FX_LevelUp
        Experience                      = 60
        RadiusEffect                    = 100
        AcceptanceFilter                = ANY +WildMineShaft +WildMineShaft_AI  +WildMineShaft_Independant ALLIES
        UnpackTime                      = 0
        PreparationTime                 = 0
        FreezeAfterTriggerDuration      = 0
    End

    Behavior = SpecialPowerModule ModuleTag_TunnelausbauenStarter
        SpecialPowerTemplate            = SpecialAbilitySauronMachtbereicherungBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_TunnelausbauenWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilitySauronMachtbereicherungBlast
        WhichSpecialWeapon              = 5
        SkipContinue                    = Yes
        FreezeAfterTriggerDuration      = 100
        UnpackTime                      = 500
        PreparationTime                 = 1
        PackTime                        = 100
        AwardXPForTriggering            = 50
        StartAbilityRange               = 30
        SpecialWeapon                   = TunnelausbauenWeapon
    End




    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End







    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedBlades
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object WildPlunderorkHorde

    ButtonImage           = WOR_GoblinFighters
    SelectPortrait        = UPWild_GoblinWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeWildPlunderork
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_WildPlunderorkHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_WildPlunderorkHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End






    BuildCost        = 20
    BuildTime        = WEAK_BUILDTIME

    VisionRange         = GOBLIN_FIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange     = GOBLIN_FIGHTER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel    = 0
    CommandPoints    = WILD_GOBLINFIGHTER_HORDE_MOD_COMMANDPOINTS
    CommandSet    = PlunderorkHordeCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = GOBLIN_FIGHTER_HORDE_THREAT
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority                =  AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload    = WildPlunderork 15
        Slots            = 15
        PassengerFilter = ANY +INFANTRY
        ShowPips        = No


        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:WildPlunderork    Pos:X:70.0 Y:0.0

        RandomOffset = X:5 Y:5

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildPlunderork Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35               Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:WildPlunderork Position:X:35 Y:10 Leader 1 0    Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3    Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:WildPlunderork Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End









    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_WILD_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_PlundernLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_ObjectLevel1
    End

    Behavior = SpecialPowerModule ModuleTag_PlundernLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = No
    End



    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate        = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused                  = No
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_WildOrcVenomSacks
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_TestBuilding
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PlunderKeulen
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate GoblinFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate PoisonBladeAI
        CommandButtonName = Command_PoisonedBlades
        SpecialPowerAIType = AI_SPECIAL_POWER_GOBLIN_POISON
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GoblinWarriorArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GoblinWarriorWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object GundabadWargPackHorde

    ButtonImage        = HIGundabadWargPack_Wotr
    SelectPortrait      = UPGundabadWargPack

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             = Wild
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:GundabadWargPack
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GundabadWargPack
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_GundabadWargPack

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End

    BuildCost         = 350
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ISENGARD_WARGPACK_HORDE_VISION_RANGE

    ShroudClearingRange     = ISENGARD_WARGPACK_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

        MaxSimultaneousOfType = 3

    CommandPoints         = 40

    CommandSet         = GundabadWargPackCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 120
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GundabadWargPack  10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY +GundabadWargPack
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:GundabadWargPack Position:X:40 Y:0       Position:X:40 Y:20               Position:X:40 Y:-20
        RankInfo = RankNumber:2 UnitType:GundabadWargPack Position:X:15 Y:10 Leader 1 0   Position:X:15 Y:-10 Leader 1 1   Position:X:15 Y:30 Leader 1 2   Position:X:15 Y:-30
        RankInfo = RankNumber:3 UnitType:GundabadWargPack Position:X:-10 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1   Position:X:-10 Y:-20 Leader 2 2
        RanksToReleaseWhenAttacking     = 1 2 3
        MeleeAttackLeashDistance = 25
        AttributeModifiers = IsengardWargSkirmish
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DreadVisageLeadership2
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        TriggeredBy                        = Upgrade_ObjectLevel3
    End

    Behavior = SpecialPowerModule ModuleTag_DreadVisageUpdate
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack           = No
        StartsPaused                       = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_ObjectLevel3
        ArmorSetFlag = PLAYER_UPGRADE
    End






    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

End

Object GundabadWargRiderHorde

    ButtonImage        = HIGundabadWargRider_Wotr
    SelectPortrait      = UPGundabadWargRider

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Wild
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GundabadWargRider
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GundabadWargRider
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GundabadWargRider

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = 600
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ISENGARD_WARGRIDER_HORDE_VISION_RANGE

    ShroudClearingRange     = ISENGARD_WARGRIDER_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

        MaxSimultaneousOfType = 3

    CommandPoints         = 50

    CommandSet         = GundabadWargRiderCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 125
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GundabadWargRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner_Sharkuswargreiter
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed    = IsengardWargRiderBanner_Sharkuswargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Sharkuswargreiter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GundabadWargRider Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:GundabadWargRider Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
        AttributeModifiers = IsengardWargSkirmish
        AlternateFormation     = GundabadWargRiderHordeWedgeFormation
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl

        AttributeModifierAffectsSelf = Yes

        AttributeModifierFX = FX_WargHowl
    End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy	= Upgrade_BasicTraining
		LevelsToGain	= 1
		LevelCap	= 2
	End


	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_ForgedBlades
	End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Leadership2
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership2
        TriggeredBy                        = Upgrade_ObjectLevel3
    End

    Behavior = SpecialPowerModule ModuleTag_LeadershipUpdate
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack           = No
        StartsPaused                       = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_ObjectLevel3
        ArmorSetFlag = PLAYER_UPGRADE
    End





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorKnightWeapon
    End
End


ChildObject GundabadWargRiderHordeWedgeFormation GundabadWargRiderHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        AttributeModifiers              = MenegrothCavalarySkirmishFormation
        ObjectStatusOfContained         =
        InitialPayload                  = GundabadWargRider 10
        Slots                           = 10
        PassengerFilter                 = NONE +CAVALRY +IsengardWargRiderBanner_Sharkuswargreiter
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:0 Y:0
        MeleeBehavior                   = Amoeba
        End

        BannerCarriersAllowed    = IsengardWargRiderBanner_Sharkuswargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Sharkuswargreiter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GundabadWargRider Position:X:40 Y:0       Position:X:40 Y:20               Position:X:40 Y:-20
        RankInfo = RankNumber:2 UnitType:GundabadWargRider Position:X:15 Y:10 Leader 1 0   Position:X:15 Y:-10 Leader 1 1   Position:X:15 Y:30 Leader 1 2   Position:X:15 Y:-30
        RankInfo = RankNumber:3 UnitType:GundabadWargRider Position:X:-10 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1   Position:X:-10 Y:-20 Leader 2 2
        RanksToReleaseWhenAttacking     = 1 2 3
        AlternateFormation              = GundabadWargRiderHorde
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End
End

Object WildGundabadArcherHorde

	ButtonImage     = UIMMGundabadArcher
	SelectPortrait  = UPMMGundabadArcher

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkMUHLa
		End
	End

	Side			= Wild
	EditorSorting		= UNIT
	EmotionRange		= EMOTION_CHEER_RADIUS
	DisplayName		= OBJECT:HordeWildGundabadArcher
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildGundabadArcherHordePlural
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_WildGundabadArcherHorde

	WeaponSet
		Conditions	  = None
		Weapon		  = PRIMARY    HaradrimArcherMissileHordeRangefinder
		Weapon		  = TERTIARY   HaradrimArcherMissileHordeRangefinderBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
	End

	BuildCost 		= 500
	BuildTime 		= MEDIUM_BUILDTIME

	ShroudClearingRange 	= MORDOR_HARADRIM_SHROUD_RANGE

	VisionRange 		= MORDOR_HARADRIM_HORDE_VISION_RANGE
	VisionSide 		= 50%
	VisionRear 		= 25%
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%

	CrushableLevel		= 0
	CrusherLevel		= 0
	UseCrushAttack 		= No

	CommandPoints		= 40
	CommandSet		= WildGundabadArcherHordeCommandSet

	FormationWidth		= 2
	FormationDepth		= 1

	TransportSlotCount	= TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER 

	ThreatLevel = MORDOR_HARADRIM_ARCHER_HORDE_THREAT
	ThreatBreakdown MordorHaradrimArcherHorde_DetailedThreat
		AIKindOf = ARCHER
	End

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate	= ArcherHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AILuaEventsList			= InfantryFunctions
		AttackPriority			= AttackPriority_Archer
		CanAttackWhileContained		= Yes
	End

	Behavior = HordeContain ModuleTag_HordeContainOverride
        	FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        	FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
		ObjectStatusOfContained 	=
		InitialPayload			= WildGundabadArcher 10
		Slots				= 10
		PassengerFilter			= NONE +INFANTRY
		ShowPips			= No
		ThisFormationIsTheMainFormation = Yes
		RandomOffset			= X:2 Y:2
		MeleeBehavior 			= Amoeba
		End


		BannerCarriersAllowed	= WildGundabadBanner
		BannerCarrierPosition	= UnitType:WildMarauder		Pos:X:30.0 Y:0.0

		RankInfo = RankNumber:1 UnitType:WildGundabadArcher Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:1 UnitType:WildGundabadArcher Position:X:-30 Y:0    Position:X:-30 Y:25    Position:X:-30 Y:-25    Position:X:-30 Y:50    Position:X:-30 Y:-50

		MeleeAttackLeashDistance	= 25
		RanksToReleaseWhenAttacking 	= 1 2
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	ARCHER_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End

	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_WILD_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy		= Upgrade_BasicTraining
		LevelsToGain		= 1
		LevelCap		= 2
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy		= Upgrade_FireArrows
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy		= Upgrade_HeavyArmor
	End




	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BarbedArrowsEnable
		SpecialPowerTemplate		= SpecialAbilityHaradrimArcherBarbedArrow
		TriggeredBy			= Upgrade_ObjectLevel2
	End

	Behavior = SpecialPowerModule ModuleTag_LongShot
		SpecialPowerTemplate		= SpecialAbilityHaradrimArcherBarbedArrow
		UpdateModuleStartsAttack	= Yes
		StartsPaused		  	= Yes
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
		SpecialPowerTemplate    	= SpecialAbilityHaradrimArcherBarbedArrow
		PackTime			= 1200
		StartAbilityRange		= #ADD( MORDOR_HARADRIM_BOW_RANGE 50 )
		SpecialWeapon			= HaradrimBarbedArrowRangeFinder
		ApproachUntilMembersInRange	= Yes
	End

	Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorBarbedArrow
		SpecialAbility  		= SpecialAbilityHaradrimArcherBarbedArrow
		ForbiddenStatus 		= INSIDE_GARRISON
		MaxScanRange    		= MORDOR_HARADRIM_BOW_RANGE
		Query				= 1 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	End

	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = ANY +CRATE -TheDroppedRing
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End






	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate MordorHaradrimArcherHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate BarbedArrowsAI
		CommandButtonName = Command_HaradrimArcherBarbedArrowAbility
		SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
	End

	Geometry		= BOX
	GeometryMajorRadius 	= 15.0
	GeometryMinorRadius 	= 65.0
	GeometryHeight		= 12.0
	GeometryIsSmall		= No

    	Shadow			= SHADOW_DECAL
    	ShadowSizeX		= 23
    	ShadowSizeY		= 23
   	ShadowTexture		= ShadowI



	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_ArcherCombatChain

	AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_MordorHaradrimArcherArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_FireArrows
		Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_FireArrows
		Weapon = AutoResolve_MordorHaradrimArcherWeapon
	End

	WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

Object WildGundabadMarauderSwordHorde

    SelectPortrait = UPGundabadOrcSwordsman
    ButtonImage    = BDGundabadOrcSwordsman

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model 	= None
		End
		ModelConditionState = HORDE_EMPTY
			Model 	= None
		End
		ModelConditionState = WORLD_BUILDER
			Model 	= HordeMarkIUPik
		End
	End

	Side			= Wild
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:WildGundabadMarauderSwordHorde
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildGundabadMarauderSwordHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_WildGundabadMarauderSwordHorde

	WeaponSet
		Conditions	= None
		Weapon		= PRIMARY    TowerGuardHordeRangefinder
	End

	BuildCost		= 450
	BuildTime		= STRONG_BUILDTIME

	ShroudClearingRange 	= WILD_MARAUDERSWORDS_SHROUD_RANGE
	VisionRange 		= WILD_MARAUDERSWORDS_HORDE_VISION_RANGE

	VisionSide = 50%
	VisionRear = 25%

	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%

	CrushableLevel	= 0
	CrusherLevel	= 0
	CommandPoints	= 40

	CommandSet  	= WildGundabadMarauderSwordsHordeCommandSet

	FormationWidth 	= 2
	FormationDepth 	= 2

	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	ThreatLevel 		= WILD_MARAUDERSWORDS_HORDE_THREAT
	ThreatBreakdown WildMauraderHorde_DetailedThreat
		AIKindOf = INFANTRY
	End

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Spearman
	End

	Behavior = HordeContain ModuleTag_HordeContain
        	FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        	FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
		ObjectStatusOfContained =
		InitialPayload		= WildGundabadMarauderSwords 10
		PassengerFilter		= NONE +INFANTRY
		Slots			= 10
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes

		MeleeBehavior = Amoeba
		End

		BannerCarriersAllowed	= WildGundabadBanner
		BannerCarrierPosition	= UnitType:WildGundabadMarauderSwords	Pos:X:60.0 Y:0.0

		RankInfo		= RankNumber:1 UnitType:WildGundabadMarauderSwords Position:X:30 Y:-50	Position:X:30 Y:-25	Position:X:30 Y:0	Position:X:30 Y:25	Position:X:30 Y:50
		RankInfo		= RankNumber:2 UnitType:WildGundabadMarauderSwords Position:X:0  Y:-50	Position:X:0 Y:-25 Position:X:0 Y:0	Position:X:0 Y:25 Position:X:0 Y:50 

		RanksToReleaseWhenAttacking = 1 2

		UseSlowHordeMovement     = Yes
		MeleeAttackLeashDistance = 50
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base

		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End

	#include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TriggerButton
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership
    End

    Behavior = SpecialPowerModule ModuleTag_TriggerButtonUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
	UpdateRate		= 1000
	HordeMemberFilter	= NONE +WildGundabadPike +WildGundabadMarauderSwords
	Count			= 40
	Radius			= 300
	RubOffRadius		= 300
	AlliesOnly		= Yes
	AttributeModifier	= WildGundabadLargeGroupBonus
    End

	LocomotorSet
		Locomotor     = NormalChargeMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_WILD_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy	= Upgrade_BasicTraining
		LevelsToGain	= 1
		LevelCap	= 2
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_HeavyArmor
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_ForgedBlades
	End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		TriggeredBy		  = Upgrade_ObjectLevel2
	End

  	Behavior = SpecialPowerModule ModuleTag_ChargeStarter
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		UpdateModuleStartsAttack  = Yes
		StartsPaused		  = Yes
		InitiateSound		  = MarauderVoiceEnterStateAttackCharge
	End

	#include "..\..\..\includes\AngmarChargeUpdate.inc"


	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly 	= Yes
		StuffToPickUp 	= ANY +CRATE -TheDroppedRing
		ScanRange 	= 200
		ScanIntervalSeconds = 0.5
	End





	Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate DwarfGuardianCharge
		CommandButtonName = Command_GundabadChargeAttack
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
	End

	Geometry		= BOX
	GeometryMajorRadius 	= 25
	GeometryMinorRadius 	= 50
	GeometryHeight		= 8.0
	GeometryIsSmall		= No


	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_WildMarauderHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderSwordHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderSwordArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderSwordUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderSwordWeapon
	End

	WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GoblinSpearHordeUpgraded GoblinSpearHorde

   ButtonImage    = BIDurbagashWarriorSpear
   SelectPortrait = UPDurbagashWarriorSpear

   BuildCost      = 130
   IsTrainable    = Yes
   CommandSet     = WildAzogsEliteCommandSet
   EquivalentTo   = GoblinSpearHorde

   DisplayName             = OBJECT:HordeGoblinFightersUpgradedSpear
   DisplayNameStrategic    = CONTROLBAR:LW_Unit_GoblinFighterHordeUpgradedSpear
   DescriptionStrategic    = CONTROLBAR:LW_ToolTip_GoblinFighterHordeUpgradedSpear

   Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GoblinSpearUpgraded 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY +WildBannerGoblin
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = WildBannerGoblin
        BannerCarrierPosition    = UnitType:GoblinSpearUpgraded    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GoblinSpearUpgraded Position:X:60 Y:0               Position:X:45 Y:15               Position:X:50 Y:-20               Position:X:40 Y:35              Position:X:60 Y:-40
        RankInfo = RankNumber:2 UnitType:GoblinSpearUpgraded Position:X:35 Y:10 Leader 1 0   Position:X:30 Y:25 Leader 1 1    Position:X:35 Y:-20 Leader 1 2    Position:X:25 Y:50 Leader 1 3   Position:X:30 Y:-52 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GoblinSpearUpgraded Position:X:10 Y:0 Leader 2 0    Position:X:15 Y:15 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:5 Y:45 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
   End

   Behavior = HordeDispatchSpecialPower ModuleTag_PoisonedBladeDispatch
        SpecialPowerTemplate    = SpecialAbilityGoblinFighterPoisonedBlades
        StartsPaused            = No
   End

   Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorPoisonedBlades
        SpecialAbility 		= SpecialAbilityGoblinFighterPoisonedBlades
        Query 	       		= 1 ANY +HERO +MONSTER +INFANTRY +CAVALRY +DOZER -STRUCTURE ENEMIES
   End
End

Object WildGundabadPikesHorde

  ButtonImage    = BDGundabadOrcPikeman
  SelectPortrait = UPGundabadOrcPikeman

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUPik
		End
	End

	Side			= Wild
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:WildGundabadPikesHorde
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildGundabadPikesHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_WildGundabadPikesHorde

	WeaponSet
		Conditions	= None
		Weapon		= PRIMARY    TowerGuardHordeRangefinder
	End

	BuildCost		= 600
	BuildTime		= MEDIUM_BUILDTIME

	ShroudClearingRange     = WILD_MARAUDER_SHROUD_RANGE
	VisionRange 	        = WILD_MARAUDER_HORDE_VISION_RANGE

	VisionSide = 50%
	VisionRear = 25%

	MaxVisionBonusPercent     = 300%
	VisionBonusTestRadius     = 200
	VisionBonusPercentPerFoot = 1.0%

	CrushableLevel = 0
	CrusherLevel   = 0
	CommandPoints  = 40

	CommandSet     = WildGundabadPikeHordeCommandSet

	FormationWidth = 2
	FormationDepth = 2

	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	ThreatLevel = WILD_MAURADER_HORDE_THREAT
	ThreatBreakdown WildMauraderHorde_DetailedThreat
		AIKindOf = PIKEMAN
	End

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Spearman
	End

	Behavior = HordeContain ModuleTag_HordeContain
        	FrontAngle 			= STANDARD_PIKEMAN_FRONTANGLE
        	FlankedDelay 			= STANDARD_PIKEMAN_FLANKEDDELAY
		ObjectStatusOfContained 	=
		InitialPayload			= WildGundabadPike 10
		PassengerFilter			= NONE +INFANTRY
		Slots				= 10
		ShowPips			= No

		ThisFormationIsTheMainFormation = Yes

		MeleeBehavior = Amoeba
		End

		BannerCarriersAllowed	= WildGundabadBanner
		BannerCarrierPosition	= UnitType:WildGundabadPike	Pos:X:60.0 Y:0.0

		RankInfo		= RankNumber:1 UnitType:WildGundabadPike Position:X:30 Y:-50	Position:X:30 Y:-25	Position:X:30 Y:0	Position:X:30 Y:25	Position:X:30 Y:50
		RankInfo		= RankNumber:2 UnitType:WildGundabadPike Position:X:0  Y:-50	Position:X:0 Y:-25 Position:X:0 Y:0	Position:X:0 Y:25 Position:X:0 Y:50 

		RanksToReleaseWhenAttacking = 1 2

		UseSlowHordeMovement 	 = Yes
		MeleeAttackLeashDistance = 50

		AlternateFormation 	 = WildGundabadPikesHordePorcupine
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base

		AddEmotion	=	Taunt_Base
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TriggerButton
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership
    End

    Behavior = SpecialPowerModule ModuleTag_TriggerButtonUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
	UpdateRate		= 1000
	HordeMemberFilter	= NONE +WildGundabadPike +WildGundabadMarauderSwords
	Count			= 40
	Radius			= 250
	RubOffRadius		= 250
	AlliesOnly		= Yes
	AttributeModifier	= WildGundabadLargeGroupBonus
    End

	#include "..\..\..\includes\CaptureBuilding.inc"

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy		= Upgrade_BasicTraining
		LevelsToGain		= 1
		LevelCap		= 2
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_HeavyArmor
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_ForgedBlades
	End

	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly 		= Yes
		StuffToPickUp 		= NONE +CRATE -TheDroppedRing
		ScanRange 		= 200
		ScanIntervalSeconds 	= 0.5
	End





	Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Geometry		= BOX
	GeometryMajorRadius 	= 25
	GeometryMinorRadius 	= 50
	GeometryHeight		= 8.0
	GeometryIsSmall		= No



	AutoResolveUnitType = AutoResolveUnit_Pikemen
	AutoResolveCombatChain = AutoResolve_PikemenCombatChain

	AutoResolveBody = AutoResolve_WildMarauderHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_WildMarauderArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_ForgedBlades
		Weapon = AutoResolve_WildMarauderWeapon
	End

	WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject WildGundabadPikesHordePorcupine WildGundabadPikesHorde

	Behavior = HordeContain ModuleTag_HordeContain
        	FrontAngle 				= STANDARD_PIKEMAN_FRONTANGLE
        	FlankedDelay 				= STANDARD_PIKEMAN_FLANKEDDELAY
		ObjectStatusOfContained 		=
		InitialPayload				= WildGundabadPike 10
		Slots					= 10
		PassengerFilter				= NONE +INFANTRY
		ShowPips				= No
		ThisFormationIsTheMainFormation 	= No
		RandomOffset				= X:2 Y:1
		RanksToReleaseWhenAttacking		= 0
		RanksToJustFreeWhenAttacking   		= 0
		AttributeModifiers			= GondorPikeHordePorcupine
		IsPorcupineFormation			= Yes
		MinimumHordeSize			= 4

		AlternateFormation			= WildGundabadPikesHorde
		VisionRearOverride			= 100%
		VisionSideOverride			= 100%
		NotComboFormation			= Yes

		BannerCarriersAllowed			= WildGundabadBanner
		BannerCarrierPosition			= UnitType:WildGundabadPike	Pos:X:0.0 Y:0.0

		RankInfo	= RankNumber:1 UnitType:WildGundabadPike Position:X:0 Y:30	Position:X:0 Y:-30	Position:X:12 Y:25	Position:X:12 Y:-25	Position:X:25 Y:12	Position:X:25 Y:-12 Position:X:-12 Y:-25 Position:X:-12 Y:25 Position:X:-25 Y:-12 Position:X:-25 Y:12
	End
End

Object WildGundabadBodyGuardHorde

	ButtonImage		= UIMMBodyGuard
	SelectPortrait		= UPMMGundabadGuard

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUHai
		End
	End

	Side 			= Wild
	EditorSorting 		= UNIT
	EmotionRange 		= 240
	DisplayName 		= OBJECT:HordeWildBodyGuard
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_WildBodyGuardHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_IsengardFanaticHorde

	WeaponSet
		Conditions 		= None
		Weapon     		= PRIMARY  NormalMeleeHordeRangefinder
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
		Weapon			= TERTIARY DwarvenZealotBoomAxeRangeFinder
		AutoChooseSources	= TERTIARY FROM_PLAYER FROM_SCRIPT
		ShareWeaponReloadTime	= Yes
		Weapon 			= SECONDARY ZerkerSlayerHordeRangefinder
		AutoChooseSources	= SECONDARY NONE
	End
	
	MaxSimultaneousOfType        = 3

	BuildCost 		= 1500
	BuildTime 		= HEROIC_BUILDTIME
	VisionRange 		= DWARVEN_ZERKER_HORDE_VISION_RANGE
	ShroudClearingRange 	= DWARVEN_ZERKER_SHROUD_RANGE

	VisionSide 		= 50%
	VisionRear 		= 25%

	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%

	CommandPoints 		= 50
	CrushableLevel 		= 0
	CrusherLevel 		= 0

	CommandSet 		= WildBodyGuardHordeCommandSet

	TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE URUK LARGE_RECTANGLE_PATHFIND ARMY_SUMMARY

	ThreatLevel = ISENGARD_BERSERKER_HORDE_THREAT
	ThreatBreakdown IsengardFighterHorde_DetailedThreat
		AIKindOf = INFANTRY
	End

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
		SpecialPowerTemplate = SpecialAbilitySiegeDeploy
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        	StanceTemplate = FighterHorde
        End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
        	AILuaEventsList			= InfantryFunctions
       	 	AttackPriority			= AttackPriority_Infantry
	End

	Behavior = HordeContain ModuleTag_HordeContain
        	FrontAngle              	= STANDARD_INFANTRY_FRONTANGLE
        	FlankedDelay            	= STANDARD_INFANTRY_FLANKEDDELAY
		ObjectStatusOfContained 	=
		InitialPayload 			= WildTribeLeaderBodyGuard 5
		Slots 				= 5
		PassengerFilter			= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes
		RandomOffset			= X:3 Y:3
		MeleeBehavior 			= Amoeba
		End

		RankInfo = RankNumber:1 UnitType:WildTribeLeaderBodyGuard Position:X:50 Y:0	Position:X:50 Y:20	Position:X:50 Y:-20	Position:X:50 Y:40	Position:X:50 Y:-40

		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance = 50
		BackUpMinDelayTime	 = 1
		BackUpMaxDelayTime	 = 3000
		BackUpMinDistance	 = 1
		BackUpMaxDistance	 = 3
		BackupPercentage	 = 80%

	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base_Evil
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base

		AddEmotion			=	OVERRIDE Taunt_Base
 		End

		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = 60
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
		UpgradeRequired			= Upgrade_MiniHordeLvl2
		IdleSpawnRate			= 45000
		UnitSpawnFX			= FX_BannerCarrierSpawnUnit
		ReplenishNearbyHorde		= Yes
		ScanHordeDistance		= 0
	End

	Behavior = AutoHealBehavior ModuleTag_MHHHealing
		StartsActive 			= No
		TriggeredBy 			= Upgrade_MiniHordeLvl2
		HealingAmount 			= 15
		HealingDelay 			= 1000
		StartHealingDelay 		= 20000
		UnitHealPulseFX			= FX_SpellHealUnitHealBuff
		NonStackable			= Yes
		HealOnlyIfNotInCombat 		= Yes
		HealOnlyIfNotUnderAttack	= Yes
		AffectsContained		= Yes
	End

	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly 		= Yes
		StuffToPickUp 		= NONE +CRATE -TheDroppedRing
		ScanRange 		= 200
		ScanIntervalSeconds 	= 0.5
	End





	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ZealotBoomAxeEnabler
		SpecialPowerTemplate		= SpecialAbilityBodyguardHeadthrow
		TriggeredBy 			= Upgrade_MiniHordeLvl3
	End

	Behavior = SpecialPowerModule ModuleTag_ZealotBoomAxeStarter
		SpecialPowerTemplate		= SpecialAbilityBodyguardHeadthrow
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= Yes
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ZealotBoomAxeWeaponFireUpdate
		SpecialPowerTemplate		= SpecialAbilityBodyguardHeadthrow
		WhichSpecialWeapon		= 1
		PackTime			= 2500
		StartAbilityRange		= 275
		SpecialWeapon			= DwarvenZealotBoomAxeRangeFinder
		ApproachUntilMembersInRange	= Yes
	End

	Behavior = AutoAbilityBehavior ModuleTag_AxeThrowAutoAbility
		SpecialAbility		= SpecialAbilityBodyguardHeadthrow
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= 175
		Query			= 45 ALL ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE -HERO
	End




	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
		SpecialPowerTemplate 	= SpecialAbilityFanaticHeroMode
		TriggeredBy 		= Upgrade_MiniHordeLvl7
	End

	Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
		SpecialPowerTemplate	= SpecialAbilityFanaticHeroMode
		Duration		= 20000
		AttributeModifier	= BodyGuardDeathWish
		StartsPaused		= Yes
	End






	Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_AttackMove
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate GimliSlayerAI
		CommandButtonName = Command_SpecialAbilityDeathWishBodyguard
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
	End

	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 45.0
	GeometryHeight = 20.0
	GeometryIsSmall = No



	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardFanaticHordeBody

	AutoResolveArmor
		Armor = AutoResolve_IsengardFanaticArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardFanaticWeapon
	End
End

ChildObject WildGundabadBodyGuardHorde_Summoned WildGundabadBodyGuardHorde

	IsTrainable	= No
	CommandPoints 	= 0
	KindOf 		= SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

	Behavior = HordeContain ModuleTag_HordeContain
        	FrontAngle              	= STANDARD_INFANTRY_FRONTANGLE
        	FlankedDelay            	= STANDARD_INFANTRY_FLANKEDDELAY
		ObjectStatusOfContained 	=
		InitialPayload 			= WildTribeLeaderBodyGuard_Summoned 5
		Slots 				= 5
		PassengerFilter			= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes
		RandomOffset			= X:3 Y:3
		MeleeBehavior 			= Amoeba
		End

		RankInfo = RankNumber:1 UnitType:WildTribeLeaderBodyGuard_Summoned Position:X:50 Y:0	Position:X:50 Y:20	Position:X:50 Y:-20	Position:X:50 Y:40	Position:X:50 Y:-40

		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance    = 50
		BackUpMinDelayTime	    = 1
		BackUpMaxDelayTime	    = 3000
		BackUpMinDistance	    = 1
		BackUpMaxDistance	    = 3
		BackupPercentage	    = 80%
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 80000
		MaxLifetime		= 80000
		DeathType		= FADED
	End
End

Object GundabadPikemanHorde

  ButtonImage    = BDGundabadOrcPikeman
  SelectPortrait = UPGundabadOrcPikeman

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Wild
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GundabadPikemanHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GundabadPikemanHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME

    VisionRange         = 200
    ShroudClearingRange     = 325

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0

    IsTrainable = No
    CommandPoints = 0

    CommandSet          = GundabadOrcHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE URUK PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER SUMMONED

    ThreatLevel = ISENGARD_PIKEMAN_HORDE_THREAT
    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GundabadPikeman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GundabadGeneral
        BannerCarrierPosition    = UnitType:GundabadPikeman    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:GundabadPikeman Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:GundabadPikeman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GundabadPikeman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 1                .
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 55
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                   = Upgrade_EliteHordeLvl5
        AttributeModifier             = FearlessForever
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType          = FADED
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End

Object GundabadOrcSwordsmenHorde

    SelectPortrait = UPGundabadOrcSwordsman
    ButtonImage    = BDGundabadOrcSwordsman

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Wild
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GundabadOrcSwordsmanHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GundabadOrcSwordsmanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = QUATERNARY NONE
    End

    BuildCost         = ISENGARD_URUKFIGHTER_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    IsTrainable = No
    CommandPoints = 0

    ShroudClearingRange     = 325
    VisionRange         = 200

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandSet         = GundabadOrcHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE URUK LARGE_RECTANGLE_PATHFIND SUMMONED

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End



    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GundabadOrcSwordsmen 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = GundabadGeneral
        BannerCarrierPosition    = UnitType:GundabadOrcSwordsmen        Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GundabadOrcSwordsmen Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:GundabadOrcSwordsmen Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GundabadOrcSwordsmen Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 55
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                   = Upgrade_EliteHordeLvl5
        AttributeModifier             = FearlessForever
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType          = FADED
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End

Object HeideMiniDragonHorde

    ButtonImage    = HSMiniDragon
    SelectPortrait = UPMiniDragon

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Wild
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeMiniBabyDrake
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_BabyDracheHorde
    DescriptionStrategic    = CONTROLBAR:LW_ToolTip_BabyDracheHorde
    MaxSimultaneousOfType        = 3
    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End






    BuildCost        = BABYDRAKE_BUILDCOST
    BuildTime        = ELITE_BUILDTIME

    VisionRange         = VISION_STANDARD_LARGE_ANIMAL
    ShroudClearingRange     = SHROUD_CLEAR_HERO

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel    =       2
    CrusherLevel        = 2
    RamPower              = 30
    RamZMult              = 0.5
    CrushKnockback        = 40
    CrushZFactor          = 1.0
    CommandPoints    = 30
    CommandSet    = MiniDragonHordeCommandSet
    FormationWidth    = 1
    FormationDepth    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_CAST_REFLECTIONS MONSTER CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND GIANT_BIRD

    ThreatLevel = FIRE_DRAKE_THREAT_LEVEL
    ThreatBreakdown GoblinFighterHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

     Behavior = GiantBirdAIUpdate ModuleTag_GiantBirdAI
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                = FellBeastFunctions
        FollowThroughDistance        = 200
        FollowThroughCheckStep        = 50
        FollowThroughGradient        = 1.0
        GrabTossTimeTrigger            = 2.5
        GrabTossHeightTrigger        = 100.0
        TossFX                        = FX_DiebyFalling
        SpecialContactPoints        = Swoop
        AttackPriority = AttackPriority_FellBeast
      End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload        = HeideMiniDragon 3
        Slots            = 3
        PassengerFilter     = ANY +GIANT_BIRD
        ShowPips        = No
        RandomOffset = X:5 Y:5
        MeleeBehavior = Amoeba
        End
        RankInfo = RankNumber:1 UnitType:HeideMiniDragon Position:X:30 Y:0        Position:X:0 Y:30        Position:X:0 Y:-30
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 1
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
        UpdateRate        = 1000
        HordeMemberFilter    = NONE +HeideMiniDragon
        Count            = 100
        Radius            = 160.0
        RubOffRadius        = 160.0
        AlliesOnly        = Yes
        AttributeModifier    = MordorLargeGroupBonus
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion            =    Terror_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End



    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_NORMAL
        Speed     = 70
    End

    LocomotorSet
        Locomotor = FellBeastLocomotor
        Condition = SET_WANDER
        Speed     = 70
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = No
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes
        TriggeredBy            = Upgrade_MiniHordeLvl3
        HealingAmount            = 30
        Radius                = 100
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End









    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BabyDrakeInfernoAI
        CommandButtonName = Command_FireDrakeBroodInferno
        SpecialPowerAIType = AI_SPECIAL_POWER_GANDALF_WIZARD_BLAST
        SpecialPowerRadius = 100
    End

    Geometry         		= BOX
    GeometryMajorRadius     	= 15.0
    GeometryMinorRadius     	= 20.0
    GeometryHeight        	= 20.0
    GeometryIsSmall     	= No
End

Object OgreHorde

    ButtonImage	= BIOgre
	SelectPortrait	= SPOgre

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN

        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End
    End

    Side                          = Wild
    EditorSorting                 = UNIT
    EmotionRange                  = 240
    DisplayName                   = OBJECT:OgreHorde
    DisplayNameStrategic          = CONTROLBAR:LW_Unit_OgreHorde
    DescriptionStrategic          = CONTROLBAR:LW_ToolTip_OgreHorde
    ThreatLevel                   = 40
    TransportSlotCount            = TRANSPORTSLOTCOUNT_LARGE_HORDE
	
    BuildCost                     = 500
    BuildTime                     = MEDIUM_BUILDTIME

    VisionRange					  = VISION_STANDARD_MELEE
	ShroudClearingRange 		  = SHROUD_CLEAR_TROLL
    VisionSide                    = 50%
    VisionRear                    = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
	ShowHealthInSelectionDecal    = Yes
    CommandPoints         		  = 30
    CrushableLevel                = 2
    CrusherLevel                  = 0

    CommandSet                    = OgreCommandSet

    WeaponSet
       Conditions                 = None
       Weapon                     = PRIMARY  NormalMeleeHordeRangefinder
    End

    FormationWidth = 1
    FormationDepth = 1

    KindOf = PRELOAD SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND TROLL HAS_HEALTH_BAR

    ThreatBreakdown GoblinFighterHorde_DetailedThreat
		AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        AILuaEventsList               = InfantryFunctions
        MaxCowerTime                   = 5000
        MinCowerTime                   = 3000
        AttackPriority               = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload               = Ogre 3
        Slots                       = 3
        PassengerFilter                = NONE +Ogre
        ShowPips                   = No
        RandomOffset                = X:5 Y:5
        MeleeBehavior                = Amoeba
    End

    RankInfo = RankNumber:1 UnitType:Ogre Position:X:10 Y:0 Position:X:0 Y:15        Position:X:0 Y:-15

		RanksToReleaseWhenAttacking     = 1
        MeleeAttackLeashDistance        = 1
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult             = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    NONE +GondorGwaihir +MordorBalrog +MordorFellBeast +AngmarWitchking +MordorWitchKingOnFellBeast +MordorMumakil +MordorGateWatchersExpansion +SpellBookArrowVolley +TomBombadil +TomBombadil_Summoned +EvilMenBlackRider +CreateAHero
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 60
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat             = Yes
        HealOnlyIfNotUnderAttack        = Yes
        HealingAmount                = 150
        Radius                        = 100
        StartHealingDelay             = 7000
        HealingDelay                = 5000
        UnitHealPulseFX                = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers         = Yes
        RespawnFXList                = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay            = 200
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End



    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate BabyDrakeInfernoAI
        CommandButtonName  = Command_FireDrakeBroodInferno
        SpecialPowerAIType = AI_SPECIAL_POWER_GANDALF_WIZARD_BLAST
        SpecialPowerRadius = 100
    End

    Geometry             = BOX
    GeometryMajorRadius  = 15.0
    GeometryMinorRadius  = 20.0
    GeometryHeight       = 20.0
    GeometryIsSmall      = No





    AutoResolveUnitType               = AutoResolveUnit_Cavalry
    AutoResolveCombatChain            = AutoResolve_CavalryCombatChain

    AutoResolveBody                   = AutoResolve_EliteLegndaryHordeBody

    AutoResolveArmor
        Armor                         = AutoResolve_EliteLegndaryCavalaryArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_EliteLegndaryCavalaryWeapon
    End
End