Object MordorFighterHorde

    ButtonImage        = WOR_OrcWarrior
    SelectPortrait     = UPMordor_OrcHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             	= Mordor
    EditorSorting       = UNIT
    EmotionRange        = 240
    DisplayName         = OBJECT:HordeMordorOrcs
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorFighterHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorFighterHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 0
    BuildTime             = 20
    ShroudClearingRange   = 250
    VisionRange           = 200
    VisionSide            = 50%
    VisionRear            = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel        = 0
    CrusherLevel          = 0
    CommandPoints         = 30
    CommandSet            = MordorFighterHordeCommandSet
    FormationWidth        = 2
    FormationDepth        = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        AILuaEventsList              = InfantryFunctions
        MaxCowerTime                 = 5000
        MinCowerTime                 = 3000
        AttackPriority               = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorFighter 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorBannerOrc
        BannerCarrierPosition = UnitType:MordorFighter Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorFighter Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorFighter Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorFighter Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4


        ComboHorde = Target:MordorAufseherHorde             Result:MordorAufseherFighterHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base
         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        QuarrelProbability    =  0.5%
        AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseherFighterHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseMordorAufseher
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMordorAufseherHorde
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject MordorFighterHorde_Summoned MordorFighterHorde
    IsTrainable    = No
    CommandPoints     = 0
    CommandSet    = MordorFighterHordeCommandSet_Summoned
    EquivalentTo      = MordorFighterHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    DisplayName     = OBJECT:HordeMordorOrcs

    Behavior     = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = MordorFighter_Summoned 15
        Slots         = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips     = No

        RandomOffset    = X:3 Y:3

        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorFighter_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorFighter_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorFighter_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

End

ChildObject MordorFighterHordeGorthaur_Summoned MordorFighterHorde
    IsTrainable    = No
    CommandPoints     = 0
    CommandSet    = MordorFighterHordeCommandSet_Summoned
    EquivalentTo      = MordorFighterHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    DisplayName     = OBJECT:HordeMordorOrcs

    Behavior     = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = MordorFighter_Gorthaur 15
        Slots         = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips     = No

        RandomOffset    = X:3 Y:3

        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorFighter_Gorthaur Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorFighter_Gorthaur Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorFighter_Gorthaur Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object MordorArcherHorde

    ButtonImage       = WOR_OrcArcher
    SelectPortrait    = UPMordor_OrcArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:HordeMordorArchers
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     MordorArcherMissileHordeRangefinderEdain_New
        Weapon = TERTIARY    MordorArcherMissileHordeRangefinderBombard_New
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 180
    BuildTime         = WEAK_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0
    UseCrushAttack    = No
    CommandPoints     = 30
    CommandSet        = MordorArcherHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload      = MordorArcher 15
        Slots               = 15
        PassengerFilter     = NONE +INFANTRY
        ShowPips            = No


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorArcher        Pos:X:45.0 Y:0.0

        RandomOffset        = X:3 Y:3
        MeleeBehavior       = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorArcher Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorArcher Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorArcher Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        ComboHorde = Target:MordorAufseher02Horde  Result:MordorAufseher02ArcherHordeComboHorde InitiateVoice:OrcArcherVoiceJoinAnybody

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End




    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseher02ArcherHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_PurchaseMordorAufseher
     	ConflictsWith		= Upgrade_FireArrows
        GetUpgradeCommandButtonName = Command_SpecialAbilityToggleMordorAufseherHorde
    End




    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter_Fire
        SpecialPowerTemplate        = SpecialAbilityToggleSauronGestaltenSauron
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle_Fire
         SpecialPowerTemplate       = SpecialAbilityToggleSauronGestaltenSauron
         MountedTemplate            = MordorAufseher02ArcherHordeComboHorde_Fire
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Fire
        TriggeredBy                      = Upgrade_PurchaseMordorAufseher Upgrade_FireArrows
	    RequiresAllTriggers		= Yes
        GetUpgradeCommandButtonName  = Command_SpecialAbilityMordorAufSeherFireArrows
    End





    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 40.0
    GeometryMinorRadius     = 50.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject MordorArcherHordeForBlackGate MordorArcherHorde
  Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorArcherForBlackGate 12
        Slots = 12
        PassengerFilter = NONE +INFANTRY +MordorBannerOrc
        ShowPips = No


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorArcherForBlackGate    Pos:X:60.0 Y:0.0

        RandomOffset=X:9 Y:9
        RankInfo = RankNumber:1 UnitType:MordorArcherForBlackGate Position:X:45 Y:0 Position:X:45 Y:17 Position:X:45 Y:-17 Position:X:45 Y:50
        RankInfo = RankNumber:2 UnitType:MordorArcherForBlackGate Position:X:17 Y:0 Position:X:17 Y:35 Position:X:17 Y:-35 Position:X:17 Y:55
        RankInfo = RankNumber:3 UnitType:MordorArcherForBlackGate Position:X:-17 Y:0 Position:X:-17 Y:35 Position:X:-17 Y:-35 Position:X:-17 Y:55

        RanksToReleaseWhenAttacking = 1 2 3
    End
End

ChildObject MordorArcherHordeForGrond MordorArcherHorde

    CommandPoints     = 0
	CommandSet        = MordorArcherForGrondHordeCommandSet
	
  Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorArcherForGrond 6
        Slots = 6
        PassengerFilter = NONE +INFANTRY
        ShowPips = No

        RandomOffset = X:9 Y:9
        RankInfo = RankNumber:1 UnitType:MordorArcherForGrond Position:X:45 Y:0 Position:X:45 Y:17 Position:X:45 Y:-17
        RankInfo = RankNumber:2 UnitType:MordorArcherForGrond Position:X:17 Y:0 Position:X:17 Y:35 Position:X:17 Y:-35
		
        RanksToReleaseWhenAttacking = 1 2
    End
End




Object MordorOrcScout_Horde

    SelectPortrait = UPMordor_OrcHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side         = Mordor
    EditorSorting     = UNIT

    EmotionRange     = 240
    DisplayName     = OBJECT:Horde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    None
    End

    BuildCost     = 450
    BuildTime     = VERYWEAK_BUILDTIME
    VisionRange     = 121
    CrushableLevel     = 0
    CrusherLevel     = 0
    CommandPoints     = 2
    CommandSet     = MordorOrcScout_HordeCommandSet

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_ORC_SCOUT_HORDE_THREAT
    ThreatBreakdown MordorOrcScoutHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000

    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorOrcScout_Unit 2
        Slots = 2
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        RandomOffset=X:4 Y:4
        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:MordorOrcScout_Unit Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38        Position:X:30 Y:-37
        RankInfo = RankNumber:2 UnitType:MordorOrcScout_Unit Position:X:9 Y:2        Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39        Position:X:10 Y:-39
        RankInfo = RankNumber:3 UnitType:MordorOrcScout_Unit Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18    Position:X:-11 Y:40        Position:X:-8 Y:-40
        RankInfo = RankNumber:4 UnitType:MordorOrcScout_Unit Position:X:-28 Y:0    Position:X:-30 Y:21        Position:X:-29 Y:-20    Position:X:-30 Y:39        Position:X:-30 Y:-38


        RanksToReleaseWhenAttacking = 1 2 3 4
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Geometry = BOX
    GeometryMajorRadius = 30.4
    GeometryMinorRadius = 30.4
    GeometryHeight = 8.0
    GeometryIsSmall = No
End


ChildObject MordorGoblinArcherHorde MordorArcherHorde
 Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorGoblinArcher ORC_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        RandomOffset=X:9 Y:9

        RankInfo = RankNumber:1 UnitType:MordorGoblinArcher Position:X:40 Y:0 Position:X:40 Y:12            Position:X:40 Y:-12    Position:X:40 Y:45        Position:X:40 Y:-45
        RankInfo = RankNumber:2 UnitType:MordorGoblinArcher Position:X:12 Y:0    Position:X:12 Y:30        Position:X:12 Y:-30    Position:X:12 Y:50        Position:X:12 Y:-50

        RanksToReleaseWhenAttacking = 1 2

    End
End

Object MordorGoblinFighterHorde

    ButtonImage = BMOrcPit_Horde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side              = Mordor
    IsTrainable    = No
    EditorSorting     = UNIT
    EmotionRange      = 240
    DisplayName      = OBJECT:HordeMoriaGoblin

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc

    BuildCost        = 0
    BuildTime        = VERYWEAK_BUILDTIME
    VisionRange        = 250
    CrushableLevel        = 0
    CrusherLevel        = 0
    CommandPoints        = 10
    CommandSet        = MordorGoblinFighterHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_GOBLINFIGHTER_HORDE_THREAT
    ThreatBreakdown MordorGoblinFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained     =
        InitialPayload            = MordorGoblinSwordsman 10
        Slots                = 10
        PassengerFilter         = ANY +INFANTRY +MONSTER
        ShowPips            = No
        RandomOffset            = X:5 Y:5

        RankInfo = RankNumber:1 UnitType:MordorGoblinSwordsman Position:X:20 Y:-23  Position:X:20 Y:0  Position:X:20 Y:24
        RankInfo = RankNumber:2 UnitType:MordorGoblinSwordsman Position:X:0 Y:-20  Position:X:0 Y:0  Position:X:0 Y:20
        RankInfo = RankNumber:3 UnitType:MordorGoblinSwordsman Position:X:-20 Y:-26  Position:X:-20 Y:-10  Position:X:-20 Y:10  Position:X:-20 Y:21
        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 50

    End
    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Geometry = BOX
    GeometryMajorRadius = 25.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End



Object MordorCorsairsOfUmbarHorde

   ButtonImage     = WOR_Corsair
   SelectPortrait  = UPMordor_Corsair

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUCor
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeCorsairsOfUmbar
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorCorsairsOfUmbarHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorCorsairsOfUmbarHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions     = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    CorsairFireBombMissileHordeRangefinder
        Weapon         = TERTIARY    CorsairFireBombMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 250
    BuildTime         = VERYWEAK_BUILDTIME

    ShroudClearingRange = 300
    VisionRange         = 300
    VisionSide          = 50%
    VisionRear          = 25%
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel       = 0
    CrusherLevel         = 0
    CommandPoints        = 45
    CommandSet           = MordorCorsairsOfUmbarHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorCorsairsOfUmbarHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = MordorCorsairsOfUmbar 15
        Slots             = 15
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MordorCorsairBanner
        BannerCarrierPosition    = UnitType:MordorCorsairsOfUmbar    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorCorsairsOfUmbar Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCorsairsOfUmbar Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCorsairsOfUmbar Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = WallScalingMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = MonitorConditionUpdate MonitorConditionUpdateModuleTag
        WeaponSetFlags        = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorCorsairsOfUmbarHordeFireBombCommandSet
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MordorCorsairsOfUmbarHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius    = 50.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorCorsairsOfUmbarHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorCorsairsOfUmbarArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorCorsairsOfUmbarUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorCorsairsOfUmbarWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades
End


ChildObject MordorCorsairsOfUmbarHordeInn MordorCorsairsOfUmbarHorde
    BuildCost = 250
    BuildTime = VERYWEAK_BUILDTIME
End


ChildObject MordorCorsairsOfUmbarHordeFree MordorCorsairsOfUmbarHorde
    BuildCost = 0
    BuildTime = VERYWEAK_BUILDTIME
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
End


ChildObject WildCorsairsOfUmbarHordeInn MordorCorsairsOfUmbarHorde
    BuildCost = INN_UNIT_BUILDCOST_WILD
    BuildTime = VERYWEAK_BUILDTIME

    CommandSet    = WildCorsairsOfUmbarHordeCommandSet

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy    = Upgrade_BasicTraining
        LevelsToGain    = 1
        LevelCap    = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = MonitorConditionUpdate MonitorConditionUpdateModuleTag
        WeaponSetFlags        = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = WildCorsairsOfUmbarHordeFireBombCommandSet
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades
End


ChildObject WildCorsairsOfUmbarHordeFree MordorCorsairsOfUmbarHorde
    BuildCost = 0
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    CommandSet    = WildCorsairsOfUmbarHordeCommandSet

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy    = Upgrade_BasicTraining
        LevelsToGain    = 1
        LevelCap    = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = MonitorConditionUpdate MonitorConditionUpdateModuleTag
        WeaponSetFlags        = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = WildCorsairsOfUmbarHordeFireBombCommandSet
    End
End

ChildObject MordorCorsairsOfUmbarHorde_Summoned MordorCorsairsOfUmbarHorde
    IsTrainable		= No
    CommandPoints	= 0
    EquivalentTo	= MordorCorsairsOfUmbarHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior	= HordeContain ModuleTag_HordeContain
        FrontAngle		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload		= MordorCorsairsOfUmbar_Summoned 15
        Slots			= 15
        PassengerFilter		= ANY +INFANTRY
        ShowPips		= No
        RandomOffset		= X:1 Y:1
        MeleeBehavior		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorCorsairsOfUmbar_Summoned Position:X:50 Y:0        	Position:X:50 Y:20        	Position:X:50 Y:-20        	Position:X:50 Y:40        	Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCorsairsOfUmbar_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1   Position:X:30 Y:-20 Leader 1 2  Position:X:30 Y:40 Leader 1 3   Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCorsairsOfUmbar_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1   Position:X:10 Y:-20 Leader 2 2  Position:X:10 Y:40 Leader 2 3   Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End



Object MordorHaradrimArcherHorde

    ButtonImage       = WOR_HaradrimArcher
    SelectPortrait    = UPMordor_Haradrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side            = Mordor
    EditorSorting        = UNIT
    EmotionRange        = EMOTION_CHEER_RADIUS
    DisplayName        = OBJECT:HordeMordorHaradrimArcher
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimArcherHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimArcherHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    HaradrimArcherMissileHordeRangefinder
        Weapon        = TERTIARY   HaradrimArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = MORDOR_HARADRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_HARADRIM_SHROUD_RANGE

    VisionRange         = MORDOR_HARADRIM_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel        = 0
    CrusherLevel        = 0
    UseCrushAttack         = No

    CommandPoints        = 50
    CommandSet        = MordorHaradrimArcherHordeCommandSet

    FormationWidth        = 2
    FormationDepth        = 1

    TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = MORDOR_HARADRIM_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorHaradrimArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate    = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Archer
        CanAttackWhileContained        = Yes
    End

    Behavior = HordeContain ModuleTag_HordeContainOverride
        ObjectStatusOfContained     =
        InitialPayload            = MordorHaradrimArcher 12
        Slots                = 12
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:2 Y:2
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorHaradrimArcher        Pos:X:40.0 Y:0.0


        RandomOffset = X:0 Y:-12

        RankInfo = RankNumber:1 UnitType:MordorHaradrimArcher Position:X:0 Y:12    Position:X:0 Y:-12    Position:X:0 Y:-36    Position:X:0 Y:36    Position:X:0 Y:-60     Position:X:0 Y:60
        RankInfo = RankNumber:2 UnitType:MordorHaradrimArcher Position:X:20 Y:12    Position:X:15 Y:-12    Position:X:20 Y:-36    Position:X:20 Y:36    Position:X:20 Y:-60    Position:X:20 Y:60

        MeleeAttackLeashDistance    = 25
        RanksToReleaseWhenAttacking     = 1 2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain       = 1
        LevelCap           = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy        = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy        = Upgrade_HeavyArmor
    End


    Behavior = SpecialPowerModule ModuleTag_LongShot
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        PackTime                    = 3000
        StartAbilityRange           = #SUBTRACT( MORDOR_HARADRIM_BOW_RANGE 100 )
        SpecialWeapon               = HaradrimBarbedArrowRangeFinder
        ApproachUntilMembersInRange = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorBarbedArrow
        SpecialAbility      = SpecialAbilityHaradrimArcherBarbedArrow
		ForbiddenStatus     = INSIDE_GARRISON
		MaxScanRange	    = 250.0
		Query		    	= 1 ANY ENEMIES +HERO +MONSTER
		Query		    	= 10 ALL ENEMIES -STRUCTURE
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorHaradrimArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BarbedArrowsAI
        CommandButtonName = Command_HaradrimArcherBarbedArrowAbility
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry                = BOX
    GeometryMajorRadius     = 15.0
    GeometryMinorRadius     = 65.0
    GeometryHeight          = 12.0
    GeometryIsSmall         = No

    Shadow                  = SHADOW_DECAL
    ShadowSizeX             = 23
    ShadowSizeY             = 23
    ShadowTexture           = ShadowI


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End



ChildObject MordorHaradrimArcherHordeOnMumakil MordorHaradrimArcherHorde
    Behavior = HordeContain ModuleTag_HordeContainOverride
        ObjectStatusOfContained =
        InitialPayload = MordorHaradrimArcherMumakil 6
        Slots = 6
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorHaradrimArcherMumakil    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorHaradrimArcherMumakil Position:X:34 Y:8        Position:X:34 Y:-7        Position:X:34 Y:23        Position:X:34 Y:-22        Position:X:34 Y:38        Position:X:34 Y:-37

        MeleeAttackLeashDistance    = 25
        RanksToReleaseWhenAttacking = 1
    End

    Behavior = LevelUpUpgrade ModuleTag_MumakilLevelUp
        TriggeredBy          = Upgrade_MumakilLevel2
        LevelsToGain         = 1
        LevelCap             = 2
    End
End

ChildObject MordorHaradrimArcherHorde_Summoned MordorHaradrimArcherHorde
    IsTrainable		= No
    CommandPoints	= 0
    CommandSet		= EmptyCommandSet
    EquivalentTo	= MordorHaradrimArcherHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior	= HordeContain ModuleTag_HordeContain
        FrontAngle		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload		= MordorHaradrimArcher_Summoned 15
        Slots			= 15
        PassengerFilter		= ANY +INFANTRY
        ShowPips		= No
        RandomOffset		= X:1 Y:1
        MeleeBehavior		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorHaradrimArcher_Summoned Position:X:50 Y:0        	Position:X:50 Y:20        	Position:X:50 Y:-20        	Position:X:50 Y:40        	Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorHaradrimArcher_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1   Position:X:30 Y:-20 Leader 1 2  Position:X:30 Y:40 Leader 1 3   Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorHaradrimArcher_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1   Position:X:10 Y:-20 Leader 2 2  Position:X:10 Y:40 Leader 2 3   Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object MordorEasterlingHorde

    ButtonImage      = WOR_Easterling
    SelectPortrait   = UPMordor_Eastering

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side                  = Mordor
    EditorSorting         = UNIT
    EmotionRange          = 240
    TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName           = OBJECT:HordeMordorEasterlings
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_MordorEasterlingHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_MordorEasterlingHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost = MORDOR_SOLDIERRHUN_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME

    ShroudClearingRange    = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange            = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel           = 0
    CommandPoints          = 45
    CommandSet             = MordorEasterlingHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                 = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND PIKE

    ThreatLevel     = MORDOR_EASTERLING_HORDE_THREAT
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AttackPriority             = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorEasterling 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:2 Y:2
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:MordorEasterling    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorEasterling Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorEasterling Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorEasterling Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation          = MordorEasterlingHordePorcupine
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base
        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base
         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End



ChildObject MordorEasterlingHordePorcupine MordorEasterlingHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload            = MordorEasterling 15
        Slots                = 15
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        RandomOffset            = X:2 Y:1
        MeleeBehavior             = Amoeba
        End

        RanksToReleaseWhenAttacking    = 0
        RanksToJustFreeWhenAttacking       = 0
        AttributeModifiers        = MordorEasterlingHordePorcupine
        IsPorcupineFormation        = Yes
        MinimumHordeSize        = 5

        AlternateFormation        = MordorEasterlingHorde
        VisionRearOverride        = 100%
        VisionSideOverride        = 100%
        NotComboFormation        = Yes


        BannerCarriersAllowed        = HaradHaradrimBanner
        BannerCarrierPosition        = UnitType:MordorEasterling    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:MordorEasterling Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


Object MordorWargHorde


    ButtonImage = BIWargSentry_Warg
    SelectPortrait         = UPLoneWarg

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeMordorWarg
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorWargHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorWargHorde

    WeaponSet
        Conditions     = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost = ANGMAR_DIREWOLF_BUILDCOST
    BuildTime = WEAK_BUILDTIME
    VisionRange = ANGMAR_DIREWOLF_VISION_RANGE

    ShroudClearingRange = ANGMAR_DIREWOLF_SHROUD_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints = 60

    CommandSet = MordorWargHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel             = 2
    CrusherLevel             = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback             = 40
    CrushZFactor             = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorWarg  8
        Slots             = 8
        PassengerFilter     = NONE +CAVALRY +AngmarDireWolf
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End


        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MordorWarg
        BannerCarrierPosition    = UnitType:MordorWarg    Pos:X:-35.0 Y:0.0



        RankInfo = RankNumber:1 UnitType:AngmarDireWolf Position:X:30 Y:-35            Position:X:42 Y:-15        Position:X:50 Y:15        Position:X:30 Y:-35
        RankInfo = RankNumber:2 UnitType:AngmarDireWolf Position:X:-5 Y:-25 Leader 1 0    Position:X:-20 Y:0 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:5 Y:5 Leader 1 3

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
        AttributeModifiers = IsengardWargSkirmish
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange        = 200
        ScanIntervalSeconds     = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius     = 40.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

End








Object MordorBlackRiderHorde


    ButtonImage = HIBlackRider
    SelectPortrait         = HPBlackRider

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side            = Mordor

    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeBlackRiders
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackRiderHorde
    CommandSet        = EvilMenBlackRiderCommandSet

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = EVILMEN_BLACKRIDER_BUILDCOST
    BuildTime            = HEROIC_BUILDTIME
    ShockwaveResistance         = SHOCKWAVE_RESISTANCE_STRONG
    ShroudClearingRange        = EVILMEN_BLACKRIDER_SHROUD_RANGE
    VisionRange            = EVILMEN_BLACKRIDER_VISION_RANGE
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot    = 2.0%
    MaxSimultaneousOfType        = 1

    CommandPoints             = 30

    CrushableLevel            = 2

    MountedCrusherLevel        = 1
    MountedCrushableLevel        = 3
    CrushWeapon            = KnightCrush

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    RamPower            = 30
    RamZMult            = 0.5

        TransportSlotCount            = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                    = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = BLACKRIDER_THREAT_LEVEL
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = EvilMenBlackRiderFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackRider  6
        Slots             = 6
        PassengerFilter     = NONE +CAVALRY +MordorBlackRider
        ShowPips         = No
        RandomOffset         = X:1 y:1
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo    = RankNumber:1 UnitType:MordorBlackRider Position:X:20 Y:0    Position:X:-16.18 Y:11.76    Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02        Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = No
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes
        TriggeredBy            = Upgrade_MiniHordeLvl3
        HealingAmount            = 30
        Radius                = 100
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


     Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderScreechEnabler
        SpecialPowerTemplate = SpecialAbilityScreech
        TriggeredBy = Upgrade_MiniHordeLvl10
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes
        TriggerFX                = FX_FearBlast
    End
    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 0
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        Instant                        = Yes
        EffectRange                    = 180
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_MiniHordeLvl2
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_MiniHordeLvl2
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory    = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
    Behavior = ModelConditionUpgrade ModuleTag_DreadVisageModelCondition
        TriggeredBy            = Upgrade_MiniHordeLvl2
        AddConditionFlags    = USER_3
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_MiniHordeLvl2
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_MiniHordeLvl4
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = FellBeastVoiceAttack
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = EvilMenBlackRiderMorgulBlade
        WhichSpecialWeapon        = 1
    End
    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End


     Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate    = Yes
         UnpackTime                    = MORDOR_MOUNT_TIME
         PreparationTime                = 1
         PersistentPrepTime            = 250
         PackTime                    = MORDOR_MOUNT_TIME
         OpacityTarget                = .3
         AwardXPForTriggering        = 0
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End







    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreechBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate MorgulBladeAI
        CommandButtonName = Command_BlackRiderMorgulBlade
        SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

















End







Object MordorBlackOrcHorde


    ButtonImage        = WOR_BlackOrc
    SelectPortrait     = UPBlackOrcPortrait



    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeMordorBlackOrcs
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackOrcHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackOrcHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = MORDOR_BLACKORC_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = MORDOR_BLACKORC_HORDE_SHROUDCLEAR_RANGE
    VisionRange         = MORDOR_BLACKORC_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 50
    CommandSet         = MordorBlackOrcHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_BLACKORC_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackOrc 12
        Slots             = 12
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorFighter    Pos:X:70.0 Y:0.0

        RandomOffset        = X:5 Y:3

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackOrc Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40
        RankInfo = RankNumber:2 UnitType:MordorBlackOrc Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3
        RankInfo = RankNumber:3 UnitType:MordorBlackOrc Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3


        RanksToReleaseWhenAttacking     = 1 2

        MeleeAttackLeashDistance     = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =    0.0002%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object MordorHaradrimRiderHorde


    ButtonImage        = WOR_HaradCalvary
    SelectPortrait        = UPHarradrimCavalryPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEURIL
        End
    End

    Side            = Mordor
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeMordorHaradrimRider
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimRiderHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = MORDOR_HARADRIMRIDERS_BUILDCOST
    BuildTime        = MEDIUM_BUILDTIME
    VisionRange        = MORDOR_HARADRIMRIDERS_HORDE_VISION_RANGE
        VisionSide     = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = MORDOR_HARADRIMRIDERS_HORDE_SHROUD_RANGE
    CommandPoints        = 50

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel                = 2
    CrusherLevel                = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback                = 40
    CrushZFactor                = 1.0

        TransportSlotCount            = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                    = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CommandSet                = MordorHaradrimRiderHordeCommandSet

    ThreatLevel = MORDOR_HARADRIMRIDERS_HORDE_THREAT
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorHaradrimRider  EVIL_RIDER_LARGE_HORDE_SIZE
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +MordorHaradrimRider
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MordorHaradrimRiderBanner
        BannerCarrierPosition    = UnitType:MordorHaradrimRider        Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorHaradrimRider Position:X:40 Y:0            Position:X:40 Y:25        Position:X:40 Y:-25        Position:X:40 Y:50        Position:X:40 Y:-50
        RankInfo = RankNumber:2 UnitType:MordorHaradrimRider Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-25 Leader 1 2    Position:X:10 Y:50 Leader 1 3    Position:X:10 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = AISpecialPowerUpdate RivendellLancerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate ElvenMirkwoodArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object MordorPikemanHorde

    ButtonImage        = HIMordorPikeman_Wotr
    SelectPortrait     = UPMordor_Pikeman

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeMordorPikemen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorPikemanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorPikemanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost         = LOW_TIER_COST_2
    BuildTime         = WEAK_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 30

    CommandSet  = MordorPikemanHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY ORC PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 100
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorPikeman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition = UnitType:MordorPikeman Pos:X:45.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorPikeman Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorPikeman Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorPikeman Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        ComboHorde = Target:MordorAufseherHorde             Result:MordorAufseherPikemanHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody

        AlternateFormation = MordorPikemanHordePorcupine

        MeleeAttackLeashDistance = 1
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =  0.4%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End



    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseherPikemanHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseMordorAufseher
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMordorAufseherHorde
    End





    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject MordorPikemanHordePorcupine MordorPikemanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = MordorPikeman 15
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = ElvenMithlondSentryHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = MordorPikemanHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorPikeman    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:MordorPikeman  Position:X:20 Y:0      Position:X:-20 Y:0     Position:X:7 Y:0     Position:X:-7 Y:0    Position:X:7 Y:28     Position:X:-7 Y:28    Position:X:-16.18 Y:11.76     Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
     End
End


Object DolguldurOrkHorde


  ButtonImage            = HSDolguldurOrc
  SelectPortrait         = UPDolguldurOrc

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeDolguldurOrcs
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_DolguldurOrk
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_DolguldurOrk

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 350
    BuildTime         = WEAK_BUILDTIME
    VisionRange           = 200
    ShroudClearingRange   = 300
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 45
    CommandSet         = DolguldurOrkHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_BLACKORC_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = DolguldurOrk 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER +BANNER
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:DolguldurOrk    Pos:X:70.0 Y:0.0

        RandomOffset        = X:3 Y:3

        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorDolGuldurBannerOrc
        BannerCarrierPosition = UnitType:DolguldurOrk Pos:X:45.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DolguldurOrk Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:DolguldurOrk Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:DolguldurOrk Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =    0.0002%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject DolguldurOrkHordeShieldWall DolguldurOrkHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                         = DolguldurOrk 15
        Slots                             = 15
        PassengerFilter                    = NONE +INFANTRY +MONSTER +BANNER
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = DolguldurOrkShieldWall
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorDolGuldurBannerOrc
        BannerCarrierPosition    = UnitType:DolguldurOrk   Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DolguldurOrk Position:X:0 Y:0        Position:X:0 Y:12.5        Position:X:0 Y:-12.5        Position:X:0 Y:25        Position:X:0 Y:-25         Position:X:0 Y:37.5        Position:X:0 Y:-37.5       Position:X:0 Y:50        Position:X:0 Y:-50         Position:X:0 Y:62.5        Position:X:0 Y:-62.5         Position:X:0 Y:75        Position:X:0 Y:-75         Position:X:0 Y:87.5        Position:X:0 Y:-87.5
        RanksToReleaseWhenAttacking = 1

        AlternateFormation = DolguldurOrkHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


ChildObject DolguldurOrkHorde_Summoned DolguldurOrkHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    MordorFighterHordeCommandSet_Summoned
    EquivalentTo  =    DolguldurOrkHorde
    KindOf                = +SUMMONED


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = DolguldurOrk_Summoned 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No

        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:DolguldurOrk_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:DolguldurOrk_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:DolguldurOrk_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object DolguldurArcherHorde

    ButtonImage    = HIDolguldurArcher_Wotr
    SelectPortrait = UPDolguldurArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:HordeDolguldurArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DolguldurArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DolguldurArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     DolGuldurArcherMissileHordeRangefinder
        Weapon = TERTIARY    DolGuldurArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 350
    BuildTime         = WEAK_BUILDTIME

    ShroudClearingRange = 400
    VisionRange 	= 400

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel     = 0
    CrusherLevel       = 0
    UseCrushAttack     = No
    CommandPoints      = 45
    CommandSet         = DolguldurArcherHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 115
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                   = 5000
        MinCowerTime                   = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                 = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle   		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay 		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload      	= DolguldurArcher 15
        Slots               	= 15
        PassengerFilter     	= NONE +INFANTRY
        ShowPips            	= No
        RandomOffset        	= X:3 Y:3
        MeleeBehavior       	= Amoeba
        End

        BannerCarriersAllowed = MordorDolGuldurBannerOrc
        BannerCarrierPosition = UnitType:DolguldurArcher Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DolguldurArcher Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:DolguldurArcher Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:DolguldurArcher Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        ComboHorde = Target:MordorAufseherHorde             Result:MordorAufseherGuldurOrkHordeComboHorde        InitiateVoice:OrcArcherVoiceJoinAnybody

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter           = ALL
        ExperienceModifier        = 1.95
        InitiateVoice             = EVA:BloodthirstySacrificOfOrcs
    End

     Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf            	    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            = 150
        FearScanDistance            = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseherGuldurOrkHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseMordorAufseher
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMordorAufseherHorde
    End






    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry             = BOX
    GeometryMajorRadius  = 40.0
    GeometryMinorRadius  = 50.0
    GeometryHeight       = 20.0
    GeometryIsSmall      = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End


Object MordorMorgulOrkHorde

  ButtonImage            = HIMorgulOrk_Wotr
  SelectPortrait         = HPCAHMorgulOrk

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side                  = Mordor
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = OBJECT:HordeMordorMorgulOrks
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_MordorMorgulOrks
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_MordorMorgulOrks

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 380
    BuildTime             = VERYWEAK_BUILDTIME
    ShroudClearingRange   = 250
    VisionRange           = 200
    VisionSide            = 50%
    VisionRear            = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel        = 0
    CrusherLevel          = 0
    CommandPoints         = 45
    CommandSet            = MordorMorgulOrcHordeCommandSet
    FormationWidth        = 2
    FormationDepth        = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 115
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorMorgulOrk 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorMorgulBannerOrc02
        BannerCarrierPosition = UnitType:MordorMorgulOrk Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorMorgulOrk Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorMorgulOrk Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorMorgulOrk Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter            = ALL
        ExperienceModifier         = 1.95
        InitiateVoice              = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base


        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseherMorgulOrkHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseMordorAufseher
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMordorAufseherHorde
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End


ChildObject MordorMorgulOrkHorde_Summoned MordorMorgulOrkHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    MordorFighterHordeCommandSet_Summoned
    EquivalentTo  =    MordorMorgulOrkHorde
    KindOf                = +SUMMONED


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorMorgulOrk_Summoned 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No

        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorMorgulOrk_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorMorgulOrk_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorMorgulOrk_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End







Object MordorBlackOrcHorde_mod


    ButtonImage        = WOR_BlackOrc
    SelectPortrait     = UPBlackOrcPortrait


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeMordorBlackOrcs
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackOrcHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackOrcHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 250
    BuildTime         = WEAK_BUILDTIME
    VisionRange         = 200
    ShroudClearingRange     = 250
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 45
    CommandSet         = MordorBlackOrcHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_BLACKORC_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackOrc_mod 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorBlackOrc_mod    Pos:X:70.0 Y:0.0

        RandomOffset        = X:3 Y:3

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackOrc_mod Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackOrc_mod Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorBlackOrc_mod Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance     = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =    0.0002%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End





    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End




ChildObject MordorBlackOrcHorde_Summoned MordorBlackOrcHorde
    IsTrainable      =    No
    CommandPoints    =    0
    CommandSet       =    MordorFighterHordeCommandSet_Summoned
    EquivalentTo     =    MordorBlackOrcHorde
    KindOf           = +SUMMONED

    DisplayName = OBJECT:MordorMorannonOrksHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorMorannonOrks
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackOrcHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorBlackOrc_Summoned 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No

        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackOrc_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackOrc_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorBlackOrc_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4
        RankInfo = RankNumber:3 UnitType:MordorBlackOrc_Summoned Position:X:-25 Y:0 Leader 3 0  Position:X:-30 Y:25 Leader 3 1  Position:X:-30 Y:-25 Leader 3 2  Position:X:-15 Y:40 Leader 3 3  Position:X:-15 Y:-40 Leader 3 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object MordorBlackUrukHorde

   ButtonImage        = HIBlackUruk_Wotr
   SelectPortrait     = HPBlackUruk

   Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End


    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:MordorBlackUrukHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorBlackUrukHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorBlackUrukHorde


    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 450
    BuildTime = MEDIUM_BUILDTIME

    VisionRange = 200
    ShroudClearingRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints  = 40
    CrushableLevel = 0
    CrusherLevel   = 0

    CommandSet = MordorBlackUrukHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AttackPriority             = AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorBlackUruk 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = MordorBlackUrukBanner
        BannerCarrierPosition    = UnitType:MordorBlackUruk    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorBlackUruk Position:X:50 Y:0                Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUruk Position:X:30 Y:0 Leader 1 0     Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation        = MordorBlackUrukHordeBlock
        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 2.0
        InitiateVoice            = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      =    1000
        TauntAndPointExcluded         =    NONE
        AfraidOf                      =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance              =    150
        FearScanDistance              =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
        End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End



ChildObject MordorBlackUrukHordeBlock MordorBlackUrukHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorBlackUruk 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers = IsengardFighterHordeBlockBonus
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorBlackUrukBanner
        BannerCarrierPosition    = UnitType:MordorBlackUruk    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorBlackUruk Position:X:40 Y:0                Position:X:40 Y:12                Position:X:40 Y:-12                Position:X:40 Y:24                Position:X:40 Y:-24
        RankInfo = RankNumber:2 UnitType:MordorBlackUruk Position:X:20 Y:0 Leader 1 0    Position:X:20 Y:12 Leader 1 1    Position:X:20 Y:-12 Leader 1 2    Position:X:20 Y:24 Leader 1 3    Position:X:20 Y:-24 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation        = MordorBlackUrukHorde
        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End
End

ChildObject MordorBlackUrukHorde_Limit MordorBlackUrukHorde
    
End

Object MordorBlackUrukHorde_forTower

    ButtonImage     = HSBlackUruk
    SelectPortrait  = HPBlackUruk

   Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End


    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:MordorBlackUrukHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorBlackUrukHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardFighterHorde


    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 600
    BuildTime = MEDIUM_BUILDTIME

    VisionRange = 200
    ShroudClearingRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints  = 0
    CrushableLevel = 0
    CrusherLevel   = 0

    CommandSet = MordorBlackUrukHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorBlackUruk 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorBlackUrukBanner
        BannerCarrierPosition    = UnitType:MordorBlackUruk    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorBlackUruk Position:X:50 Y:0                Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUruk Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking = 1

        AlternateFormation        = MordorBlackUrukHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 2.0
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      =    1000
        TauntAndPointExcluded         =    NONE
        AfraidOf                      =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance              =    150
        FearScanDistance              =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End


ChildObject MordorBlackUrukHorde_Summoned MordorBlackUrukHorde
    IsTrainable    = No
    CommandPoints  = 0
    CommandSet     = BlackUruksHordeCommandSet_Summoned
    EquivalentTo   = MordorBlackUrukHorde

    DisplayName  =  OBJECT:HordeMordorBlackUrukHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = MordorBlackUruk_Summoned 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackUruk_Summoned Position:X:50 Y:0                Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUruk_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object MordorMorgulriderHorde

    ButtonImage           = HIMorgulreiter_Wotr
    SelectPortrait        = UPMorgulreiter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEURIL
        End
    End

    Side                   = Mordor
    EditorSorting          = UNIT
    EmotionRange           = 240
    DisplayName            = OBJECT:HordeMordorMorgulrider
    DisplayNameStrategic   = CONTROLBAR:LW_Unit_MordorMorgulrider
    DescriptionStrategic   = CONTROLBAR:LW_ToolTip_MordorMorgulriderHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = MORGULRIDERHORDE_BUILDCOST
    BuildTime        = ELITE_BUILDTIME
    VisionRange      = MORDOR_HARADRIMRIDERS_HORDE_VISION_RANGE
    VisionSide       = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = MORDOR_HARADRIMRIDERS_HORDE_SHROUD_RANGE
    CommandPoints        = 50

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel                = 2
    CrusherLevel                = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback                = 40
    CrushZFactor                = 1.0

    TransportSlotCount            = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                    = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CommandSet                = MordorMorgulriderCommandSet

    ThreatLevel = 175
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorMorgulrider 5
        Slots             = 5
        PassengerFilter     = NONE +MordorMorgulrider +MorgulRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MorgulRiderBanner
        BannerCarrierPosition    = UnitType:MordorMorgulrider        Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorMorgulrider Position:X:40 Y:0   Position:X:40 Y:25   Position:X:40 Y:-25    Position:X:40 Y:50    Position:X:40 Y:-50

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                   = No
        HealOnlyIfNotInCombat          = Yes
        HealOnlyIfNotUnderAttack       = Yes
        TriggeredBy                    = Upgrade_MiniHordeLvl2
        HealingAmount                  = 30
        Radius                         = 100
        StartHealingDelay              = 7500
        HealingDelay                   = 5000
        UnitHealPulseFX                = FX_SpellHealUnitHealBuff
        NonStackable                   = Yes
        RespawnNearbyHordeMembers      = Yes
        RespawnFXList                  = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay            = 200
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AttributeModifierUpgrade ModuleTag_Fearless
        TriggeredBy       = Upgrade_AllFactionUpgrade
        AttributeModifier = FearlessForever
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VorhutMinasMorguls
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_MiniHordeLvl1
    End

    Behavior = SpecialPowerModule ModuleTag_VorhutMinasMorgulsUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Knechtschaft
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        TriggeredBy              = Upgrade_MiniHordeLvl6
    End

    Behavior = SpecialPowerModule ModuleTag_KnechtschaftUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End


    Behavior = AISpecialPowerUpdate ElvenMirkwoodArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerWeapon
    End


End


Object MordorSpiderlingHorde

    SelectPortrait = UPWild_Spiderlings
    ButtonImage = WOR_Spiderling

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkAUGFi
        End
    End

    Side            = Mordor
    EditorSorting    = UNIT
    EmotionRange    = 240
    DisplayName        = OBJECT:MordorSpiderlingHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorSpiderlingHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorSpiderlingHorde

    IsAutoBuilt        = Yes

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 300
    BuildTime        = MEDIUM_BUILDTIME

    

    ShroudClearingRange = WILD_SPIDERLING_SHROUD_RANGE
    VisionRange = WILD_SPIDERLING_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel    = 0


    CommandPoints    = 30
    CommandSet    = MordorSpiderlingCommandSet
    FormationWidth    = 2
    FormationDepth    = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_CLIMB_WALLS

    ThreatLevel = 115
    ThreatBreakdown WildSpiderlingHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = ShelobFunctions
        MaxCowerTime            = 7500
        MinCowerTime            = 5000
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload        = MordorSpiderling 10
        Slots            = 10
        PassengerFilter        = ANY +MordorSpiderling +MordorBannerSpiderling
        ShowPips        = No

        RandomOffset        = X:2 Y:2

        MeleeBehavior         = Amoeba
        End




        BannerCarriersAllowed    = MordorBannerSpiderling
        BannerCarrierPosition    = UnitType:MordorSpiderling    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorSpiderling Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:MordorSpiderling Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:MordorSpiderling Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 25
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        AddEmotion    = Terror_Base
        AddEmotion    = OVERRIDE UncontrollableFear_Base_Evil
            Duration            =    7000
        End

        AlwaysAfraidOf    = NONE +CloudBreakSunbeam +SunflareSunbeam

        AddEmotion = Alert_Base
    End







    LocomotorSet
        Locomotor     = TestWallScalingHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy            = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap            = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    FormationPreviewItemDecal
            Texture = FPspiderCavalrySingle
            Width=32
               Height=32
        End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Spinnendasein
        StartsActive      = Yes
        RefreshDelay      = 2000
        Range             = 100
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        BonusName         = SpinnendaseinDebuff
        ObjectFilter      = ANY +CAVALRY -INFANTRY -STRUCTURE -BASE_FOUNDATION -HERO -MACHINE -SHIP -DOZER
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 40
    GeometryMinorRadius = 50
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_WildSpiderlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_WildSpiderlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_WildSpiderVenomSacks
        Weapon = AutoResolve_WildSpiderlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End


Object IronHillsBanditen_KampagneHorde

   ButtonImage     = WOR_Corsair
   SelectPortrait  = UPMordor_Corsair

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUCor
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeUmbarBanditen
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_HordeUmbarBanditen
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorCorsairsOfUmbarHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions     = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    CorsairFireBombMissileHordeRangefinder
        Weapon         = TERTIARY    CorsairFireBombMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = MORDOR_CORSAIR_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 300
    VisionRange         = 300
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 60
    CommandSet         = MordorCorsairsOfUmbarHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_CORSAIRSOFUMBAR_HORDE_THREAT
    ThreatBreakdown MordorCorsairsOfUmbarHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = MordorCorsairsOfUmbar EVIL_MEN_BIG_HORDE_SIZE
        Slots             = 15
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MordorCorsairBanner
        BannerCarrierPosition    = UnitType:MordorCorsairsOfUmbar    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorCorsairsOfUmbar Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCorsairsOfUmbar Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCorsairsOfUmbar Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = WallScalingMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = MonitorConditionUpdate MonitorConditionUpdateModuleTag
        WeaponSetFlags        = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = MordorCorsairsOfUmbarHordeFireBombCommandSet
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MordorCorsairsOfUmbarHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius    = 50.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorCorsairsOfUmbarHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorCorsairsOfUmbarArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorCorsairsOfUmbarUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorCorsairsOfUmbarWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades
End


Object MordorBlackUrukBowHorde

    SelectPortrait         = UPBUrukBow
    ButtonImage            = HIMordorUrukBow_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:HordeMordorBlackUrukBow
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorBlackUrukBowHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorBlackUrukBowHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY   GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel    = 0
    CrusherLevel      = 0
    UseCrushAttack    = No
    CommandPoints     = 40
    CommandSet        = MordorBlackUrukBowHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackUrukBow 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No


        BannerCarriersAllowed    = MordorBlackUrukBanner
        BannerCarrierPosition    = UnitType:MordorBlackUrukBow        Pos:X:55.0 Y:0.0

        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackUrukBow Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUrukBow Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 40.0
    GeometryMinorRadius     = 50.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject MordorBlackUrukBowHorde_Limit MordorBlackUrukBowHorde
    
End

Object MordorBlackUrukBowHorde_forTower

    SelectPortrait            = UPBUrukBow
    ButtonImage               = HSBUrukBow

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:HordeMordorBlackUrukBow
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorBlackUrukBowHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorBlackUrukBowHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY   GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 600
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel    = 0
    CrusherLevel     = 0
    UseCrushAttack    = No
    CommandPoints     = 0
    CommandSet     = MordorBlackUrukBowHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackUrukBow 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No


        BannerCarriersAllowed    = MordorBlackUrukBanner
        BannerCarrierPosition    = UnitType:MordorBlackUrukBow        Pos:X:55.0 Y:0.0

        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackUrukBow Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUrukBow Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End



    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 40.0
    GeometryMinorRadius     = 50.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject MordorBlackUrukBowHorde_Summoned MordorBlackUrukBowHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    MordorFighterHordeCommandSet_Summoned
    EquivalentTo  =   MordorBlackUrukBowHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorBlackUrukBow_Summoned 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No

        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorBlackUrukBow_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorBlackUrukBow_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object MordorCirithOrkHorde

    ButtonImage        = HICirithOrk_Wotr
    SelectPortrait     = UPCirithOrk

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeMordorCirithOrk
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorCirithOrkHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorCirithOrkHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost         = 400
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 45

    CommandSet  = MordorCirithOrkHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY ORC PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 115
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorCirithOrk 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed = MordorCirithSchnuffler
        BannerCarrierPosition = UnitType:MordorCirithOrk Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorCirithOrk Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCirithOrk Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCirithOrk Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        ComboHorde = Target:MordorAufseherHorde             Result:MordorAufseherCirithOrkHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody

        AlternateFormation = MordorCirithOrkHordePorcupine

        MeleeAttackLeashDistance = 1                .
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =  0.4%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End




    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
        TriggeredBy = Upgrade_PurchaseMordorAufseher
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End
    
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy    = Upgrade_ForgedBlades
    End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_HeavyArmor
    End
	
	
    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = MordorAufseherCirithOrkHordeComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseMordorAufseher
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMordorAufseherHorde
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject MordorCirithOrkHordePorcupine MordorCirithOrkHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = MordorCirithOrk 15
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = ElvenMithlondSentryHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = MordorCirithOrkHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed    = MordorCirithSchnuffler
        BannerCarrierPosition    = UnitType:MordorCirithOrk    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:MordorCirithOrk  Position:X:20 Y:0      Position:X:-20 Y:0     Position:X:7 Y:0     Position:X:-7 Y:0    Position:X:7 Y:28     Position:X:-7 Y:28    Position:X:-16.18 Y:11.76     Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64

        ComboHorde = Target:MordorAufseherHorde             Result:MordorAufseherCirithOrkHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody

     End
End


ChildObject MordorCirithOrkHorde_Summoned MordorCirithOrkHorde
    IsTrainable   =    No
    CommandPoints =    0
    CommandSet    =    MordorFighterHordeCommandSet_Summoned
    EquivalentTo  =    MordorCirithOrkHorde
    KindOf                = +SUMMONED

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorCirithOrk_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorCirithOrk_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCirithOrk_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCirithOrk_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        MeleeAttackLeashDistance = 1                .
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

End

Object MordorAufseherHorde

    ButtonImage        = HSAufseher
    SelectPortrait     = UPAufseher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:MordorAufseherHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorAufseherHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorAufseherHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 150
    BuildTime        = WEAK_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 2
    CrusherLevel         = 0
    CommandPoints         = 0
    CommandSet         = MordorAufseherHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorAufseher_forHorde 1
        Slots             = 1
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset = X:1 Y:1
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorAufseher_forHorde Position:X:0 Y:0


        ComboHorde = Target:MordorFighterHorde              Result:MordorAufseherFighterHordeComboHorde          InitiateVoice:OrcFighterVoiceJoinAnybody
        ComboHorde = Target:MordorArcherHorde               Result:MordorAufseherArcherHordeComboHorde           InitiateVoice:OrcArcherVoiceJoinAnybody
        ComboHorde = Target:MordorPikemanHorde              Result:MordorAufseherPikemanHordeComboHorde          InitiateVoice:OrcFighterVoiceJoinAnybody
        ComboHorde = Target:MordorMorgulOrkHorde            Result:MordorAufseherMorgulOrkHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody
        ComboHorde = Target:MordorCirithOrkHorde            Result:MordorAufseherCirithOrkHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody
        ComboHorde = Target:DolguldurArcherHorde            Result:MordorAufseherGuldurOrkHordeComboHorde        InitiateVoice:OrcArcherVoiceJoinAnybody


        ComboHorde = Target:MordorPikemanHordePorcupine     Result:MordorAufseherPikemanHordeComboHorde          InitiateVoice:OrcFighterVoiceJoinAnybody
        ComboHorde = Target:MordorCirithOrkHordePorcupine   Result:MordorAufseherCirithOrkHordeComboHorde        InitiateVoice:OrcFighterVoiceJoinAnybody

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_InspektionUnpause
        SpecialPowerTemplate        = SpecialAbilityAufseherInspektion
        TriggeredBy                 = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule Inspektion_ModuleTag
        SpecialPowerTemplate        = SpecialAbilityAufseherInspektion
        AttributeModifier           = BonusInspektion
        AttributeModifierRange      = 55
        AttributeModifierAffects    = ANY +MordorOrcPit ALLIES
        TriggerFX                   = FX_Industry
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityInspektion
        SpecialAbility              = SpecialAbilityAufseherInspektion
        MaxScanRange                = 100
        Query                       = 10 ANY ALLIES +MordorOrcPit -INFANTRY
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End


Object MordorAufseher02Horde

    ButtonImage        = HSAufseher
    SelectPortrait     = UPAufseher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:MordorAufseherHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorAufseherHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorAufseherHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = 150
    BuildTime        = WEAK_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 2
    CrusherLevel         = 0
    CommandPoints         = 0
    CommandSet         = MordorAufseherHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorAufseher02_forHorde 1
        Slots             = 1
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset = X:1 Y:1
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorAufseher02_forHorde Position:X:0 Y:0













        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_InspektionUnpause
        SpecialPowerTemplate        = SpecialAbilityAufseherInspektion
        TriggeredBy                 = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule Inspektion_ModuleTag
        SpecialPowerTemplate        = SpecialAbilityAufseherInspektion
        AttributeModifier           = BonusInspektion
        AttributeModifierRange      = 55
        AttributeModifierAffects    = ANY +MordorOrcPit ALLIES
        TriggerFX                   = FX_Industry
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityInspektion
        SpecialAbility              = SpecialAbilityAufseherInspektion
        MaxScanRange                = 100
        Query                       = 10 ANY ALLIES +MordorOrcPit -INFANTRY
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

Object MordorAufseherFighterHordeComboHorde

    ButtonImage        = WOR_OrcWarrior
    SelectPortrait     = UPMordor_OrcHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:MordorAufseherFighter
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorAufseherFighterHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorFighterHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = MORDOR_FIGHTER_BUILDCOST_MOD
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 30
    CommandSet         = MordorFighterComboHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY ORC LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = MordorAufseher_forHorde 1
        InitialPayload             = MordorFighter 15
        Slots                 = 16
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed = MordorBannerOrc
        BannerCarrierPosition = UnitType:MordorFighter Pos:X:55.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:MordorFighter Position:X:35 Y:0              Position:X:35 Y:20              Position:X:35 Y:-20              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorFighter Position:X:15 Y:0 Leader 1 0   Position:X:15 Y:20 Leader 1 1   Position:X:15 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorFighter Position:X:-5 Y:0 Leader 2 0   Position:X:-5 Y:20 Leader 2 1   Position:X:-5 Y:-20 Leader 2 2   Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherMeleeComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base
        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base

         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

Object MordorAufseherArcherHordeComboHorde

    ButtonImage       = WOR_OrcArcher
    SelectPortrait    = UPMordor_OrcArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:MordorAufseherArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorAufseherArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     MordorArcherMissileHordeRangefinderEdain_New
        Weapon = TERTIARY    MordorArcherMissileHordeRangefinderBombard_New
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 250
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel     = 0
    CrusherLevel     = 0
    UseCrushAttack     = No
    CommandPoints     = 30
    CommandSet     = MordorArcherComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorAufseher_forHorde 1
        InitialPayload         = MordorArcher 15
        Slots             = 16
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No

        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorArcher        Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorArcher Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorArcher Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorArcher Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherRangedComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject MordorAufseherArcherHordeComboHorde_Fire MordorAufseherArcherHordeComboHorde

    Behavior = GrantUpgradeCreate ModuleTag_EnableFireArrows
        UpgradeToGrant      = Upgrade_FireArrows
        GiveOnBuildComplete = Yes
    End
End

Object MordorAufseher02ArcherHordeComboHorde

    ButtonImage       = WOR_OrcArcher
    SelectPortrait    = UPMordor_OrcArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:MordorAufseherArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorAufseherArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     MordorArcherMissileHordeRangefinderEdain_New
        Weapon = TERTIARY    MordorArcherMissileHordeRangefinderBombard_New
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 250
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel     = 0
    CrusherLevel     = 0
    UseCrushAttack     = No
    CommandPoints     = 30
    CommandSet     = MordorArcherComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorAufseher02_forHorde 1
        InitialPayload         = MordorArcher 15
        Slots             = 16
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No

        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorArcher        Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorArcher Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorArcher Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorArcher Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher02_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherRangedComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject MordorAufseher02ArcherHordeComboHorde_Fire MordorAufseher02ArcherHordeComboHorde

    Behavior = GrantUpgradeCreate ModuleTag_EnableFireArrows
        UpgradeToGrant      = Upgrade_FireArrows
        GiveOnBuildComplete = Yes
    End
End

Object MordorAufseherPikemanHordeComboHorde

    ButtonImage        = HSMordor_Pikeman
    SelectPortrait     = UPMordor_Pikeman

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:MordorAufseherPikeman
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorAufseherPikemanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorPikemanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost         = 100
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 30

    CommandSet  = MordorPikemanComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY ORC PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorAufseher_forHorde 1
        InitialPayload = MordorPikeman 15
        Slots = 16
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition = UnitType:MordorPikeman Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorPikeman Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorPikeman Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorPikeman Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherPikeComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%                  .
    End



    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base


        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End





    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MordorPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

Object MordorAufseherMorgulOrkHordeComboHorde


  ButtonImage            = HIMorgulOrk
  SelectPortrait         = HPCAHMorgulOrk

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeMordorMorgulOrks
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorAufseherMorgulOrks
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorMorgulOrks

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = MORDOR_FIGHTER_BUILDCOST_MOD
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 45
    CommandSet         = MordorMorgulOrcComboHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_BLACKORC_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                   = MordorAufseher_forHorde 1
        InitialPayload         = MordorMorgulOrk 15
        Slots             = 16
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No

        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorMorgulBannerOrc
        BannerCarrierPosition = UnitType:MordorMorgulOrk Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorMorgulOrk Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorMorgulOrk Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorMorgulOrk Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherMeleeMorgulComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End


    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base


        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

Object MordorAufseherGuldurOrkHordeComboHorde

    ButtonImage    = HSDolguldurArcher
    SelectPortrait = UPDolguldurArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:MordorAufseherDolGuldorOrk
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorAufseheDolguldurArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DolguldurArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     DolGuldurArcherMissileHordeRangefinder
        Weapon = TERTIARY    DolGuldurArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 250
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 400
    VisionRange = 400

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel    = 0
    CrusherLevel      = 0
    UseCrushAttack    = No
    CommandPoints     = 45
    CommandSet        = DolguldurArcherComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ORC ARCHER ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                   = MordorAufseher_forHorde 1
        InitialPayload         = DolguldurArcher 15
        Slots             = 16
        PassengerFilter     = ANY +INFANTRY
        ShowPips         = No

        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorDolGuldurBannerOrc
        BannerCarrierPosition = UnitType:DolguldurArcher Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DolguldurArcher Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:DolguldurArcher Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:DolguldurArcher Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherRangedComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter           = ALL
        ExperienceModifier        = 1.95
        InitiateVoice             = EVA:BloodthirstySacrificOfOrcs
    End


    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End


     Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


Object MordorAufseherCirithOrkHordeComboHorde


    ButtonImage        = HSCirithOrk
    SelectPortrait     = UPCirithOrk

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:MordorAufseherCirithOrk
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorAufseherCirithOrkHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorCirithOrkHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost         = 100
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 45

    CommandSet  = MordorCirithOrkComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY ORC PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                   = MordorAufseher_forHorde 1
        InitialPayload         = MordorCirithOrk 15
        Slots             = 16
        PassengerFilter     = ANY +INFANTRY
        ShowPips         = No

        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = MordorCirithSchnuffler
        BannerCarrierPosition = UnitType:MordorCirithOrk Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorCirithOrk Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40                 Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorCirithOrk Position:X:10 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:10 Y:40 Leader 1 3      Position:X:10 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorCirithOrk Position:X:-10 Y:0 Leader 2 0  Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:-10 Y:40 Leader 2 3     Position:X:-10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:MordorAufseher_forHorde    Position:X:-25 Y:0

        AlternateFormation = MordorAufseherCirithOrkHordeComboHordePorcupine
        RanksThatStopAdvance = 1 2 3
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3
        RanksToJustFreeWhenAttacking = 1 2 3
        AttributeModifiers         = AufseherPikeComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End



    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =  0.4%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End



    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MordorPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject MordorAufseherCirithOrkHordeComboHordePorcupine MordorAufseherCirithOrkHordeComboHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = MordorAufseher_forHorde 1
        InitialPayload                    = MordorCirithOrk 15
        Slots                            = 16
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No

        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = ElvenMithlondSentryHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = MordorAufseherCirithOrkHordeComboHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorCirithOrk    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:MordorCirithOrk  	Position:X:20 Y:0      Position:X:-20 Y:0     Position:X:7 Y:0     Position:X:-7 Y:0    Position:X:7 Y:28     Position:X:-7 Y:28    Position:X:-16.18 Y:11.76     Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
        RankInfo    = RankNumber:2 UnitType:MordorAufseher_forHorde    Position:X:0.0 Y:20.0
     End
End


Object HaradHaradrimArcherHorde

    ButtonImage      = HIHaradHaradrimArcher_Wotr
    SelectPortrait   = UPHaradHaradrimArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side                   = Mordor
    EditorSorting          = UNIT
    EmotionRange           = EMOTION_CHEER_RADIUS
    DisplayName            = OBJECT:HordeMordorHaradrimArcher
    DisplayNameStrategic   = CONTROLBAR:LW_Unit_MordorHaradrimArcherHorde
    DescriptionStrategic   = CONTROLBAR:LW_ToolTip_MordorHaradrimArcherHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    HaradrimArcherMissileHordeRangefinder
        Weapon        = TERTIARY   HaradrimArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_HARADRIM_SHROUD_RANGE

    VisionRange             = MORDOR_HARADRIM_HORDE_VISION_RANGE
    VisionSide              = 50%
    VisionRear              = 25%
    MaxVisionBonusPercent   = 300%
    VisionBonusTestRadius   = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel        = 0
    CrusherLevel          = 0
    UseCrushAttack        = No

    CommandPoints         = 50
    CommandSet            = HaradHaradrimArcherHordeCommandSet

    FormationWidth        = 2
    FormationDepth        = 1

    TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 125
    ThreatBreakdown MordorHaradrimArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate    = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList             = InfantryFunctions
        AttackPriority              = AttackPriority_Archer
        CanAttackWhileContained     = Yes
    End

    Behavior = HordeContain ModuleTag_HordeContainOverride
        ObjectStatusOfContained     	=
        InitialPayload            	= HaradHaradrimArcher 10
        Slots                		= 10
        PassengerFilter           	= NONE +INFANTRY
        ShowPips            		= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            	= X:2 Y:2
        MeleeBehavior            	= Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:HaradHaradrimArcher        Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:HaradHaradrimArcher Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:1 UnitType:HaradHaradrimArcher Position:X:-30 Y:0    Position:X:-30 Y:25    Position:X:-30 Y:-25    Position:X:-30 Y:50    Position:X:-30 Y:-50

        MeleeAttackLeashDistance      = 25
        RanksToReleaseWhenAttacking   = 1 2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            	     = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance             = 150
        FearScanDistance             = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 52
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy       = Upgrade_BasicTraining
        LevelsToGain      = 1
        LevelCap          = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy       = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy       = Upgrade_HeavyArmor
    End


    Behavior = SpecialPowerModule ModuleTag_LongShot
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        PackTime            	    = 1000
        StartAbilityRange           = #SUBTRACT( MORDOR_HARADRIM_BOW_RANGE 100 )
        SpecialWeapon               = HaradrimBarbedArrowRangeFinder
        ApproachUntilMembersInRange = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorBarbedArrow
        SpecialAbility      = SpecialAbilityHaradrimArcherBarbedArrow
		ForbiddenStatus     = INSIDE_GARRISON
		MaxScanRange	    = 250.0
		Query		    	= 1 ANY ENEMIES +HERO +MONSTER
		Query		    	= 10 ALL ENEMIES -STRUCTURE
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorHaradrimArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BarbedArrowsAI
        CommandButtonName = Command_HaradrimArcherBarbedArrowAbility
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry               = BOX
    GeometryMajorRadius    = 15.0
    GeometryMinorRadius    = 65.0
    GeometryHeight         = 12.0
    GeometryIsSmall        = No

    Shadow                 = SHADOW_DECAL
    ShadowSizeX            = 23
    ShadowSizeY            = 23
    ShadowTexture          = ShadowI


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining  Upgrade_HeavyArmor Upgrade_FireArrows
End

ChildObject HaradHaradrimArcherHorde_Summoned HaradHaradrimArcherHorde
    IsTrainable		= No
    CommandPoints	= 0
    CommandSet		= EmptyCommandSet
    EquivalentTo	= HaradHaradrimArcherHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior	= HordeContain ModuleTag_HordeContain
        FrontAngle		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload		= HaradHaradrimArcher_Summoned 15
        Slots			= 15
        PassengerFilter		= ANY +INFANTRY
        ShowPips		= No
        RandomOffset		= X:1 Y:1
        MeleeBehavior		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:HaradHaradrimArcher_Summoned Position:X:50 Y:0        	Position:X:50 Y:20        	Position:X:50 Y:-20        	Position:X:50 Y:40        	Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:HaradHaradrimArcher_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1   Position:X:30 Y:-20 Leader 1 2  Position:X:30 Y:40 Leader 1 3   Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:HaradHaradrimArcher_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1   Position:X:10 Y:-20 Leader 2 2  Position:X:10 Y:40 Leader 2 3   Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object HaradHaradrimLancerHorde

    SelectPortrait     = UPHaradHaradrimLancer
    ButtonImage        = HIHaradHaradrimLancer_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHar
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeMordorHaradrimLancer
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimLancer
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimLancer

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    ShortRangedMissileHordeRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost      = 450
    BuildTime      = MEDIUM_BUILDTIME
    VisionRange    = MORDOR_HARADRIM_HORDE_VISION_RANGE
    CrushableLevel = 0
    CrusherLevel   = 0
    CommandPoints  = 50
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE

    CommandSet = HaradHaradrimLancerHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE CAN_USE_SIEGE_TOWER

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 125
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = MORDOR_HARADRIM_LANCER_SWITCH_RANGE_HORDE
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = HaradHaradrimLancer 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:HaradHaradrimLancer    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:HaradHaradrimLancer Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:1 UnitType:HaradHaradrimLancer Position:X:-30 Y:0    Position:X:-30 Y:25    Position:X:-30 Y:-25    Position:X:-30 Y:50    Position:X:-30 Y:-50

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance    = 25
        AlternateFormation          = MordorHaradrimLancerModHordeWedge
        End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base
        End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 52
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused 		  = No
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy        = Upgrade_HeavyArmor
    End

    Geometry = BOX
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 12.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End

Object EasterlingGuardHorde


    ButtonImage        = HIEasterlingGuard_Wotr
    SelectPortrait     = UPEasterlingGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName         = OBJECT:EasterlingGuardHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_EasterlingGuardHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_EasterlingGuardHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost = 700
    BuildTime = STRONG_BUILDTIME

    ShroudClearingRange     = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange         = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 50
    CommandSet         = EasterlingGuardHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND PIKE

    ThreatLevel     = 175
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = EasterlingGuard 5
        Slots             = 5
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:2 Y:2
        MeleeBehavior         = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:EasterlingGuard Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base
        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base
         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly        = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange             = 200
        ScanIntervalSeconds   = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 50
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 15000
        HealingDelay               = 30
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 300
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_StangenhammerEnabler
        SpecialPowerTemplate = SpecialAbilityEasterlingGuardCharge
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_StangenhammerPowerUpdate
        SpecialPowerTemplate = SpecialAbilityEasterlingGuardCharge
        Duration             = 30000
        AttributeModifier    = EasterlingGuardChargeBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = No
    End

    Behavior = AutoAbilityBehavior ModuleTag_StangenhammerAutoAbilityPower
        SpecialAbility       = SpecialAbilityEasterlingGuardCharge
        MaxScanRange         = 70
        Query                = 1 ANY ENEMIES +STRUCTURE
    End






    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ChargeAI
        CommandButtonName = Command_EasterlingGuardCharge
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End
End

Object EasterlingKataphraktHorde

    ButtonImage        = HIEasterlingKataphrakt_Wotr
    SelectPortrait     = UPEasterlingKataphrakt

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:EasterlingKataphraktHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_EasterlingKataphraktHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_EasterlingKataphraktHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = EasterlingKataphraktHordeCommandSet

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost               = 950
    BuildTime               = ELITE_BUILDTIME
    VisionRange             = 250
    VisionSide              = 35%
    VisionRear              = 25%
    MaxVisionBonusPercent   = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 5.0%
    ShroudClearingRange       = 400


    CommandPoints = 70

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 175
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList             = CavalryFunctions
        AttackPriority              = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = EasterlingKataphrakt 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:EasterlingKataphrakt Position:X:0 Y:0        Position:X:0 Y:25        Position:X:0 Y:-25        Position:X:0 Y:50        Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = EasterlingKataphraktHordeWedgeFormation

        MeleeAttackLeashDistance = 25
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded       =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
         AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                     =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End




    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate          = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack      = Yes
        StartsPaused                  = No
        AttributeModifier             = ElvenKnightsAnsturm
        AttributeModifierAffectsSelf  = Yes
        AttributeModifierFX           = FX_EasterlingKataphraktCharge
        InitiateSound                 = CaH_BerserkerRage
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime                  = 1000
        UnpackingVariation          = 1
        SpecialPowerTemplate        = SpecialAbilityTheodenGloriousCharge
        PreparationTime             = 0
        PersistentPrepTime          = 0
        PackTime                    = 1330
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 15000
        HealingDelay               = 30
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 300
    End





    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ChargeAI
        CommandButtonName = Command_EasterlingKataphraktCharge
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End
End

ChildObject EasterlingKataphraktHordeWedgeFormation EasterlingKataphraktHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = EasterlingKataphrakt 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:EasterlingKataphrakt Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation 	    = EasterlingKataphraktHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

Object MordorHaradrimLancerModHorde


    ButtonImage        = BMHaradrimPalace_Haradrim
    SelectPortrait    = UPHaradrimLancer

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHar
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeMordorHaradrimLancer
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimLancer
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimLancer

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ShortRangedMissileHordeRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = MORDOR_HARADRIM_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = MORDOR_HARADRIM_HORDE_VISION_RANGE
    CrushableLevel = 0
    CrusherLevel = 0
    CommandPoints = 30
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE

    CommandSet = HaradHaradrimLancerHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE CAN_USE_SIEGE_TOWER

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = MORDOR_HARADRIM_LANCER_SWITCH_RANGE_HORDE
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorHaradrimLancerMod 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:MordorHaradrimLancerMod    Pos:X:50.0 Y:0.0     for archer horde


        RankInfo = RankNumber:1 UnitType:MordorHaradrimLancerMod Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:1 UnitType:MordorHaradrimLancerMod Position:X:30 Y:0    Position:X:30 Y:25    Position:X:30 Y:-25    Position:X:30 Y:50    Position:X:30 Y:-50

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
        AlternateFormation = MordorHaradrimLancerModHordeWedge
        End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End


    Geometry = BOX
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 12.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End



ChildObject MordorHaradrimLancerModHordeWedge MordorHaradrimLancerModHorde


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = MordorHaradrimLancerMod 10

        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorHaradrimLancerMod        Pos:X:0.0 Y:0.0                 for archer horde

        RandomOffset = X:2 Y:2
        RankInfo = RankNumber:1 UnitType:MordorHaradrimLancerMod   Position:X:-20 Y:-60   Position:X:-10 Y:-45    Position:X:0 Y:-30    Position:X:10 Y:-15     Position:X:20 Y:0   Position:X:20 Y:-20   Position:X:10 Y:15    Position:X:0 Y:30   Position:X:-10 Y:45   Position:X:-20 Y:60

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = MordorHaradrimLancerModHorde
        AttributeModifiers = MordorEasterlingHordePorcupine
    End
 End

ChildObject MordorHaradrimLancerModHorde_Summoned MordorHaradrimLancerModHorde
    IsTrainable		= No
    CommandPoints	= 0
    CommandSet		= EmptyCommandSet
    EquivalentTo	= MordorHaradrimLancerModHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior	= HordeContain ModuleTag_HordeContain
        FrontAngle		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload		= MordorHaradrimLancerMod_Summoned 15
        Slots			= 15
        PassengerFilter		= ANY +INFANTRY
        ShowPips		= No
        RandomOffset		= X:1 Y:1
        MeleeBehavior		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorHaradrimLancerMod_Summoned Position:X:50 Y:0        	Position:X:50 Y:20        	Position:X:50 Y:-20        	Position:X:50 Y:40        	Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorHaradrimLancerMod_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1   Position:X:30 Y:-20 Leader 1 2  Position:X:30 Y:40 Leader 1 3   Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorHaradrimLancerMod_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1   Position:X:10 Y:-20 Leader 2 2  Position:X:10 Y:40 Leader 2 3   Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object MordorHaradrimRiderHordeMod


    ButtonImage        = WOR_HaradCalvary
    SelectPortrait        = UPHarradrimCavalryPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEURIL
        End
    End

    Side            = Mordor
    EditorSorting        = UNIT
    EmotionRange        = 240
    DisplayName        = OBJECT:HordeMordorHaradrimRider
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimRiderHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = 600
    BuildTime        = MEDIUM_BUILDTIME
    VisionRange        = MORDOR_HARADRIMRIDERS_HORDE_VISION_RANGE
        VisionSide     = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = MORDOR_HARADRIMRIDERS_HORDE_SHROUD_RANGE
    CommandPoints        = 50

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel                = 2
    CrusherLevel                = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback                = 40
    CrushZFactor                = 1.0

        TransportSlotCount            = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                    = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CommandSet                = EvilmenHaradRiderHordeCommandSet

    ThreatLevel = MORDOR_HARADRIMRIDERS_HORDE_THREAT
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorHaradrimRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +MordorHaradrimRider
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = MordorHaradrimRiderBanner
        BannerCarrierPosition    = UnitType:MordorHaradrimRider        Pos:X:70.0 Y:0.0     for archer horde

        RankInfo = RankNumber:1 UnitType:MordorHaradrimRider Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:MordorHaradrimRider Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:MordorHaradrimRider Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation = MordorHaradrimRiderHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = AISpecialPowerUpdate RivendellLancerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate ElvenMirkwoodArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ElvenRivendellLancerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject MordorHaradrimRiderHordeWedgeFormation MordorHaradrimRiderHordeMod

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = MordorHaradrimRider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +MordorHaradrimRiderBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorHaradrimRiderBanner
        BannerCarrierPosition    = UnitType:MordorHaradrimRider    Pos:X:30.0 Y:0.0         for archer horde

        RankInfo = RankNumber:1 UnitType:MordorHaradrimRider  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorHaradrimRider  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = MordorHaradrimRiderHordeMod

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

Object MordorEasterlingHordeMod

    ButtonImage    = WOR_Easterling
    SelectPortrait    = UPMordor_Eastering

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName         = OBJECT:HordeMordorEasterlings
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorEasterlingHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorEasterlingHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost = MORDOR_SOLDIERRHUN_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange         = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel     = 0
    CrusherLevel       = 0
    CommandPoints      = 45
    CommandSet         = MordorEasterlingHordeCommandSetModNew

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND PIKE

    ThreatLevel     = MORDOR_EASTERLING_HORDE_THREAT
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Spearman
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorEasterling 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:2 Y:2
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:MordorEasterling    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:MordorEasterling Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorEasterling Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorEasterling Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation         = MordorEasterlingHordePorcupine
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base
        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base
         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp          = ANY +CRATE -TheDroppedRing
        ScanRange              = 200
        ScanIntervalSeconds    = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy    = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy    = Upgrade_Shields
    End

    Behavior = CreateObjectDie ModuleTag_DropFluch
        CreationList    = OCL_MachtderVerdammtenObject
        UpgradeRequired = Upgrade_RaiseShield
    End

    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End

ChildObject MordorEasterlingHordePorcupineMod MordorEasterlingHordeMod

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload            = MordorEasterling 15
        Slots                = 15
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        RandomOffset            = X:2 Y:1
        MeleeBehavior             = Amoeba
        End

        RanksToReleaseWhenAttacking    = 0
        RanksToJustFreeWhenAttacking       = 0
        AttributeModifiers        = MordorEasterlingHordePorcupine
        IsPorcupineFormation        = Yes
        MinimumHordeSize        = 5

        AlternateFormation        = MordorEasterlingHorde
        VisionRearOverride        = 100%
        VisionSideOverride        = 100%
        NotComboFormation        = Yes


        BannerCarriersAllowed        = HaradHaradrimBanner
        BannerCarrierPosition        = UnitType:MordorEasterling    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:MordorEasterling Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


ChildObject MordorEasterlingHordeMod_Summoned MordorEasterlingHordeMod
    IsTrainable		= No
    CommandPoints	= 0
    CommandSet		= EmptyCommandSet
    EquivalentTo	= MordorEasterlingHordeMod

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior	= HordeContain ModuleTag_HordeContain
        FrontAngle		= STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay		= STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload		= MordorEasterling_Summoned 15
        Slots			= 15
        PassengerFilter		= ANY +INFANTRY
        ShowPips		= No
        RandomOffset		= X:1 Y:1
        MeleeBehavior		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorEasterling_Summoned Position:X:50 Y:0        	Position:X:50 Y:20        	Position:X:50 Y:-20        	Position:X:50 Y:40        	Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorEasterling_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1   Position:X:30 Y:-20 Leader 1 2  Position:X:30 Y:40 Leader 1 3   Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorEasterling_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1   Position:X:10 Y:-20 Leader 2 2  Position:X:10 Y:40 Leader 2 3   Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object MordorSchwarzeOstlingeHorde

    ButtonImage    = WOR_Easterling
    SelectPortrait    = UPMordor_Eastering

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side                     = Mordor
    EditorSorting            = UNIT
    EmotionRange             = 240
    TransportSlotCount       = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName              = OBJECT:MordorSchwarzeOstlingeHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorSchwarzeOstlingeHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorSchwarzeOstlingeHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost = MORDOR_SOLDIERRHUN_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME

    ShroudClearingRange = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange         = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel        = 0
    CrusherLevel          = 0
    CommandPoints         = 45
    CommandSet            = BlackEasterlingGuardHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND PIKE ARMY_SUMMARY

    ThreatLevel     = MORDOR_EASTERLING_HORDE_THREAT
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AttackPriority             = AttackPriority_Spearman
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay            = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorSchwarzeOstlinge 15
        Slots                  = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips               = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset           = X:2 Y:2
        MeleeBehavior          = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorSchwarzeOstlinge Position:X:50 Y:0       	Position:X:50 Y:20        	 Position:X:50 Y:-20        	   Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorSchwarzeOstlinge Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:MordorSchwarzeOstlinge Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation         = MordorSchwarzeOstlingeHordePorcupine
        MeleeAttackLeashDistance   = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance          = 1
        BackUpMaxDistance          = 3
        BackupPercentage           = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf                = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf          = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                 = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base
        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base
         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp          = ANY +CRATE -TheDroppedRing
        ScanRange              = 200
        ScanIntervalSeconds    = 0.5
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                    = Yes
        HealOnlyIfNotInCombat           = Yes
        HealOnlyIfNotUnderAttack        = Yes
        HealingAmount                   = 30
        Radius                          = 55
        StartHealingDelay               = 6000
        HealingDelay                    = 5000
        UnitHealPulseFX                 = FX_SpellHealUnitHealBuff
        NonStackable                    = Yes
        RespawnNearbyHordeMembers       = Yes
        RespawnMinimumDelay             = 120
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy    = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy    = Upgrade_Shields
    End






    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End
End



ChildObject MordorSchwarzeOstlingeHordePorcupine MordorSchwarzeOstlingeHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay              = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained   =
        InitialPayload            = MordorSchwarzeOstlinge 15
        Slots                     = 15
        PassengerFilter           = NONE +INFANTRY
        ShowPips                  = No
        ThisFormationIsTheMainFormation = No
        RandomOffset              = X:2 Y:1
        MeleeBehavior             = Amoeba
        End

        RanksToReleaseWhenAttacking     = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers              = MordorEasterlingHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize       	        = 5

        AlternateFormation        = MordorSchwarzeOstlingeHorde
        VisionRearOverride        = 100%
        VisionSideOverride        = 100%
        NotComboFormation        = Yes

        RankInfo    = RankNumber:1 UnitType:MordorSchwarzeOstlinge Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End

Object MordorSchwarzeReiterHorde

    SelectPortrait = HPBlackRiderTogether

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side                     = Mordor
    EditorSorting            = UNIT
    EmotionRange             = 240
    DisplayName              = OBJECT:HordeBlackRiders
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackRiderHorde
    CommandSet               = SchwarzeReiterCommandSet

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost                   = 2300
    BuildTime                   = HEROIC_BUILDTIME
    ShockwaveResistance         = SHOCKWAVE_RESISTANCE_STRONG
    ShroudClearingRange         = EVILMEN_BLACKRIDER_SHROUD_RANGE
    VisionRange                 = EVILMEN_BLACKRIDER_VISION_RANGE
    MaxVisionBonusPercent       = 300%
    VisionBonusTestRadius       = 200
    VisionBonusPercentPerFoot   = 2.0%
    MaxSimultaneousOfType       = 1
    CommandPoints               = 40
    CrushableLevel              = 2
    MountedCrusherLevel         = 1
    MountedCrushableLevel       = 3
    CrushWeapon                 = HeroCrush
    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    RamPower                    = 30
    RamZMult                    = 0.5

    TransportSlotCount          = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                      = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = BLACKRIDER_THREAT_LEVEL
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = EvilMenBlackRiderFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = MordorSchwarzeReiter  5
        Slots                   = 5
        PassengerFilter         = NONE +CAVALRY +MordorSchwarzeReiter
        ShowPips                = No
        RandomOffset            = X:1 y:1
        MeleeBehavior           = Amoeba
        End


        RankInfo    = RankNumber:1 UnitType:MordorSchwarzeReiter Position:X:25 Y:0    Position:X:5 Y:-25    Position:X:10 Y:29    Position:X:-20 Y:-18    Position:X:-24 Y:12

        ThisFormationIsTheMainFormation = Yes
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"












    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = Yes
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes

        HealingAmount            = 30
        Radius                = 55
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End





    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_Ringgeister
    End

    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End



    Behavior = SpecialPowerModule ModuleTag_BlackRiderScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No

    End
    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 0
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        Instant                        = Yes
        EffectRange                    = 180
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_MiniHordeLvl1
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_MiniHordeLvl1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory    = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
    Behavior = ModelConditionUpgrade ModuleTag_DreadVisageModelCondition
        TriggeredBy            = Upgrade_MiniHordeLvl1
        AddConditionFlags    = USER_3
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_MiniHordeLvl1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Held4RespawnLevel
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End
    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_JagdChargeEnabler
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        TriggeredBy                  = Upgrade_Held7RespawnLevel
    End

    Behavior = SpecialPowerModule ModuleTag_JagdChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = BlackRiderJagdCharge
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_JagdringChargeFX
        InitiateSound                = NazgulScreech
    End

    Behavior = SpecialAbilityUpdate ModuleTag_JagdChargeAnimation
        UnpackTime                   = 1000
        UnpackingVariation           = 1
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        PreparationTime              = 0
        PersistentPrepTime           = 0
        PackTime                     = 1330
     End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = SchwarzerAnhauchEffect
            FireDelay = 0
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_IgniteStarter
        SpecialPowerTemplate      = SpecialAbilityBannerderOrkhordeKing
        UpdateModuleStartsAttack  = Yes
        InitiateSound             = SpellEffecktEvil1
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate
        SpecialPowerTemplate    = SpecialAbilityBannerderOrkhordeKing
        UnpackingVariation      = 1
        UnpackTime              = 1800
        PackTime                = 1600
        AwardXPForTriggering    = 0
        HeroAttributeModifier   = SchwarzerAnhauchModifier
        HeroEffectDuration      = 30000
    End





     Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate    = Yes
         UnpackTime                    = MORDOR_MOUNT_TIME
         PreparationTime                = 1
         PersistentPrepTime            = 250
         PackTime                    = MORDOR_MOUNT_TIME
         OpacityTarget                = .3
         AwardXPForTriggering        = 0
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End







    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreechBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate MorgulBladeAI
        CommandButtonName = Command_BlackRiderMorgulBlade
        SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End

Object MordorSchwarzeReiterHorde_Summoned



    SelectPortrait = HPBlackRiderTogether

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    EquivalentTo = MordorSchwarzeReiterHorde

    Side                     = Mordor
    EditorSorting            = UNIT
    EmotionRange             = 240
    DisplayName              = OBJECT:HordeBlackRiders
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackRiderHorde
    CommandSet               = AngmarSchwarzeReiterCommandSet

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost                   = 2300
    BuildTime                   = HEROIC_BUILDTIME
    ShockwaveResistance         = SHOCKWAVE_RESISTANCE_STRONG
    ShroudClearingRange         = EVILMEN_BLACKRIDER_SHROUD_RANGE
    VisionRange                 = EVILMEN_BLACKRIDER_VISION_RANGE
    MaxVisionBonusPercent       = 300%
    VisionBonusTestRadius       = 200
    VisionBonusPercentPerFoot   = 2.0%
    MaxSimultaneousOfType       = 1
    IsTrainable   =    No
    CommandPoints =    0
    CrushableLevel              = 2
    MountedCrusherLevel         = 1
    MountedCrushableLevel       = 3
    CrushWeapon                 = HeroCrush
    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    RamPower                    = 30
    RamZMult                    = 0.5

    TransportSlotCount          = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                      = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = BLACKRIDER_THREAT_LEVEL
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = EvilMenBlackRiderFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = MordorSchwarzeReiter_Summoned  5
        Slots                   = 5
        PassengerFilter         = NONE +CAVALRY +MordorSchwarzeReiter_Summoned
        ShowPips                = No
        RandomOffset            = X:1 y:1
        MeleeBehavior           = Amoeba
        End


        RankInfo    = RankNumber:1 UnitType:MordorSchwarzeReiter_Summoned Position:X:25 Y:0    Position:X:5 Y:-25    Position:X:10 Y:29    Position:X:-20 Y:-18    Position:X:-24 Y:12

        ThisFormationIsTheMainFormation = Yes
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType          = FADED
    End




    Behavior = SpecialPowerModule ModuleTag_BlackRiderScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No

    End
    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 0
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        Instant                        = Yes
        EffectRange                    = 180
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_MiniHordeLvl1
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_MiniHordeLvl1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory    = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
    Behavior = ModelConditionUpgrade ModuleTag_DreadVisageModelCondition
        TriggeredBy            = Upgrade_MiniHordeLvl1
        AddConditionFlags    = USER_3
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_MiniHordeLvl1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Held4RespawnLevel
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound                = RinggeistVoiceMorgulBlade
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End
    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_JagdChargeEnabler
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        TriggeredBy                  = Upgrade_Held7RespawnLevel
    End

    Behavior = SpecialPowerModule ModuleTag_JagdChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = BlackRiderJagdChargeFoot
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_JagdringChargeFX
        InitiateSound                = NazgulScreech
    End

    Behavior = SpecialAbilityUpdate ModuleTag_JagdChargeAnimation
        UnpackTime                   = 1000
        UnpackingVariation           = 1
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        PreparationTime              = 0
        PersistentPrepTime           = 0
        PackTime                     = 1330
     End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = SchwarzerAnhauchEffect
            FireDelay = 0
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_IgniteStarter
        SpecialPowerTemplate      = SpecialAbilityBannerderOrkhordeKing
        UpdateModuleStartsAttack  = Yes
        InitiateSound             = SpellEffecktEvil1
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate
        SpecialPowerTemplate    = SpecialAbilityBannerderOrkhordeKing
        UnpackingVariation      = 1
        UnpackTime              = 1800
        PackTime                = 1600
        AwardXPForTriggering    = 0
        HeroAttributeModifier   = SchwarzerAnhauchModifier
        HeroEffectDuration      = 30000
    End





     Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
     End
    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate    = Yes
         UnpackTime                    = MORDOR_MOUNT_TIME
         PreparationTime                = 1
         PersistentPrepTime            = 250
         PackTime                    = MORDOR_MOUNT_TIME
         OpacityTarget                = .3
         AwardXPForTriggering        = 0
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End







    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_MountHorseBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreechBlackRider
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate MorgulBladeAI
        CommandButtonName = Command_BlackRiderMorgulBlade
        SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End

Object MordorNazgulHorde

    SelectPortrait         = HPBlackRiderTogether
    ButtonImage = HINazgulFoot

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    EquivalentTo = MordorNazgulHorde

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarNazgulHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarNazgulHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarNazgulHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost                   = 2300
    BuildTime                   = HEROIC_BUILDTIME
    ShockwaveResistance         = SHOCKWAVE_RESISTANCE_STRONG
    ShroudClearingRange         = EVILMEN_BLACKRIDER_SHROUD_RANGE
    VisionRange                 = EVILMEN_BLACKRIDER_VISION_RANGE
    MaxVisionBonusPercent       = 300%
    VisionBonusTestRadius       = 200
    VisionBonusPercentPerFoot   = 2.0%
    MaxSimultaneousOfType       = 1
    CommandPoints               = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1

    CrushOnlyWhileCharging = Yes

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = MordorNazgul 5
        Slots                 = 5
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        RankInfo    = RankNumber:1 UnitType:MordorNazgul Position:X:25 Y:0    Position:X:5 Y:-25    Position:X:10 Y:29    Position:X:-20 Y:-18    Position:X:-24 Y:12

        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded         = NONE
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS


        AddEmotion            = BraceForBeingCrushed_Base


        AddEmotion            = FearIdle_Base




        AddEmotion            = Point_Base




        AddEmotion            = Taunt_Base



         AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_FAST_HORDE_SPEED
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = Yes
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes

        HealingAmount            = 30
        Radius                = 55
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = ObjectCreationUpgrade ModuleTag_Nekromant
        TriggeredBy     = Upgrade_Level_1
        Delay           = 0
        ThingToSpawn    = MordorHeroesSklavenPing_Ringgeister
    End

    ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 100000.0
          ObjectFilter      = ANY +MordorNekromantSauron +MordorSauron_mod +MordorAnnatar +MordorGorthaur +MordorSauronWerwolf +MordorGorthaurVampir +MordorSauron
          DropOff           = 1.0
       End
    End




    Behavior = SpecialPowerModule ModuleTag_BlackRiderScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No

    End
    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                    = 0
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        Instant                        = Yes
        EffectRange                    = 180
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_MiniHordeLvl1
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = No
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_MiniHordeLvl1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory                = LEADERSHIP BUFF STRUCTURE INNATE_ARMOR
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End





    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = No
        TriggeredBy                            = Upgrade_MiniHordeLvl1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Held4RespawnLevel
    End
    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = RinggeistVoiceMorgulBlade
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End
    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_JagdChargeEnabler
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        TriggeredBy                  = Upgrade_Held7RespawnLevel
    End

    Behavior = SpecialPowerModule ModuleTag_JagdChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = BlackRiderJagdCharge
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_JagdringChargeFX
        InitiateSound                = NazgulScreech
    End

    Behavior = SpecialAbilityUpdate ModuleTag_JagdChargeAnimation
        UnpackTime                   = 1000
        UnpackingVariation           = 1
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        PreparationTime              = 0
        PersistentPrepTime           = 0
        PackTime                     = 1330
     End







    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = SchwarzerAnhauchEffect
            FireDelay = 0
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_IgniteStarter
        SpecialPowerTemplate      = SpecialAbilityBannerderOrkhordeKing
        UpdateModuleStartsAttack  = Yes
        InitiateSound             = SpellEffecktEvil1
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate
        SpecialPowerTemplate    = SpecialAbilityBannerderOrkhordeKing
        UnpackingVariation      = 1
        UnpackTime              = 1800
        PackTime                = 1600
        AwardXPForTriggering    = 0
        HeroAttributeModifier   = SchwarzerAnhauchModifier
        HeroEffectDuration      = 30000
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    #include "..\..\..\includes\AngmarChargeUpdate.inc"

    CommandSet = SchwarzeReiterFootCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End

Object MordorNazgulToggleHorde

    ButtonImage     = HIBlackRiderTogether
    SelectPortrait  = HPBlackRiderTogether

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw123
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side                     = Mordor
    EditorSorting            = UNIT
    EmotionRange             = 240
    DisplayName              = OBJECT:HordeBlackRiders
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorBlackRiderHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorBlackRiderHorde
    CommandSet               = MordorNazgulToggleHordeNewCommandSet

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = MOUNTED
        Weapon        = PRIMARY    NormalCavalryHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost                   = BLACKRIDERHORDE_BUILDCOST
    BuildTime                   = HEROIC_BUILDTIME
    ShockwaveResistance         = SHOCKWAVE_RESISTANCE_STRONG
    ShroudClearingRange 	= 500
    VisionRange 		= 200
    VisionSide 			= 35%
    VisionRear 			= 25%
    MaxVisionBonusPercent 	= 300%
    VisionBonusTestRadius 	= 250
    VisionBonusPercentPerFoot 	= 2.0%
    MaxSimultaneousOfType       = 1
    CrushableLevel              = 2
    MountedCrusherLevel         = 1
    MountedCrushableLevel       = 3

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    CrushKnockback              = 40
    CrushZFactor                = 1.0
    CommandPoints               = 0

    FormationWidth              = 2
    FormationDepth              = 1

    TransportSlotCount          = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf                      = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND HERO

    ThreatLevel = BLACKRIDER_THREAT_LEVEL
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AILuaEventsList            = MordorNazgulHordeFunctions
        AttackPriority             = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = MordorNazgulToggle 5
        Slots                   = 5
        PassengerFilter         = NONE +MordorNazgulToggle
        ShowPips                = No
        RandomOffset            = X:1 y:1
        MeleeBehavior           = Amoeba
        End

        RankInfo    = RankNumber:1 UnitType:MordorNazgulToggle Position:X:25 Y:0    Position:X:5 Y:-25    Position:X:10 Y:29    Position:X:-20 Y:-18    Position:X:-24 Y:12

        ThisFormationIsTheMainFormation = Yes
        AlternateFormation = MordorNazgulToggleHordeMount
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = HEALING_AMOUNT_HEROUNIT
        Radius                     = 55
        StartHealingDelay          = START_HEALING_DELAY_HEROUNIT
        HealingDelay               = HEALING_DELAY_HEROUNIT
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = RESPAWN_MINIMUM_DELAY_HEROUNIT
    End

    Behavior = SpecialPowerModule ModuleTag_MountSpecialStarter2
        UpdateModuleStartsAttack    = Yes
        SpecialPowerTemplate        = SpecialAbilityHordeMount
        StartsPaused                = No
        SetModelCondition           = ModelConditionState:USER_6
        SetModelConditionTime       = 0.1
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_MountSpecialUpdate2
        SpecialPowerTemplate        = SpecialAbilityHordeMount
        UnpackTime                  = 500
        PreparationTime             = 1
        PersistentPrepTime          = 0
        PackTime                    = 2000
        AwardXPForTriggering        = 0
        MustFinishAbility           = Yes
        WhichSpecialPower           = 3
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderScreechEnabler
        SpecialPowerTemplate        = SpecialAbilityScreech
        TriggeredBy                 = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderScreech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechSAUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 0
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        Instant                     = Yes
        EffectRange                 = 150
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderDreadVisage
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive             = Yes
        BonusName                = NazgulAllgemeinDebuff
        TriggeredBy              = Upgrade_Level_1
        RefreshDelay             = 2000
        Range                    = STANDARD_LEADERSHIP_RANGE
        TargetEnemy              = Yes
        AntiCategory             = LEADERSHIP BUFF
        ObjectFilter             = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAddition
        StartsActive             = Yes
        BonusName                = NazgulBlackriderDebuff
        TriggeredBy              = Upgrade_Level_1
        RefreshDelay             = 2000
        Range                    = STANDARD_LEADERSHIP_RANGE
        TargetEnemy              = Yes
        AntiCategory             = LEADERSHIP BUFF
        ObjectFilter             = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive          = Yes
        TriggeredBy              = Upgrade_Level_1
        WhichSpecialPower        = 1
        GenerateTerror           = No
        GenerateFear             = Yes
        EmotionPulseRadius       = 100
        EmotionPulseInterval     = 1000
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_VorhutMM
        StartsActive             = Yes
        BonusName                = VorhutMMLeadership
        RefreshDelay             = 2000
        Range                    = STANDARD_LEADERSHIP_RANGE
        ObjectFilter             = ANY +MordorMorgulrider +MorgulRiderBanner +MordorMorgulriderHorde ALLIES
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlackRiderMorgulBlade
        SpecialPowerTemplate = SpecialAbilityBlackRiderMorgulBlade
        TriggeredBy = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
        InitiateSound               = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_JagdChargeEnabler
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        TriggeredBy                  = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_JagdChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = BlackRiderJagdCharge
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_JagdringChargeFX
        InitiateSound                = NazgulScreech
    End

    Behavior = SpecialAbilityUpdate ModuleTag_JagdChargeAnimation
        UnpackTime                   = 1000
        UnpackingVariation           = 1
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        PreparationTime              = 0
        PersistentPrepTime           = 0
        PackTime                     = 1330
     End


    Behavior = SpecialPowerModule ModuleTag_IgniteStarter
        SpecialPowerTemplate      = SpecialAbilityBannerderOrkhordeKing
        UpdateModuleStartsAttack  = Yes
        InitiateSound             = SpellEffecktEvil1
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate
        SpecialPowerTemplate    = SpecialAbilityBannerderOrkhordeKing
        UnpackingVariation      = 1
        UnpackTime              = 1800
        PackTime                = 1600
        AwardXPForTriggering    = 0
        HeroAttributeModifier   = SchwarzerAnhauchModifier
        HeroEffectDuration      = 30000
    End

    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = SchwarzerAnhauchEffect
            FireDelay = 0
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    LocomotorSet
        Locomotor = NazgulLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_EVIL_FAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_CAVALRY_FAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = NORMAL_CAVALRY_FAST_HORDE_SPEED
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel2
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_2
        BonusName        = DurinLevel2
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel3
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_3
        BonusName        = DurinLevel3
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel4
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_4
        BonusName        = DurinLevel4
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel5
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_5
        BonusName        = DurinLevel5
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel6
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_6
        BonusName        = DurinLevel6
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel7
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_7
        BonusName        = DurinLevel7
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel8
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_8
        BonusName        = DurinLevel8
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel9
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_9
        BonusName        = DurinLevel9
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_NazgulFixLevel10
        StartsActive     = No
        TriggeredBy      = Upgrade_Level_10
        BonusName        = DurinLevel10
        RefreshDelay     = 2000
        Range            = 9999999999
	    TargetEnemy	 = No
        ObjectFilter     = NONE +MinasMorgulKatakomben2
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_MountToggleBlackrider
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate ScreechAI
        CommandButtonName = Command_SpecialAbilityScreechMordorNazgul
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate MorgulBladeAI
        CommandButtonName = Command_SpecialAbilityMordorNazgulMorgulklinge
        SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_SpecialAbilitySchwarzerAnhauch
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End

ChildObject MordorNazgulToggleHordeMount MordorNazgulToggleHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = MordorNazgulToggle 5
        Slots                   = 5
        PassengerFilter         = NONE +MordorNazgulToggle +CAVALRY
        ShowPips                = No
        RandomOffset            = X:1 y:1
        AttributeModifiers      = MordorNazgulMountBonus
        MeleeBehavior           = Amoeba
        End

        RankInfo    = RankNumber:1 UnitType:MordorNazgulToggle Position:X:25 Y:0    Position:X:5 Y:-25    Position:X:10 Y:29    Position:X:-20 Y:-18    Position:X:-24 Y:12

        ThisFormationIsTheMainFormation = No
        AlternateFormation = MordorNazgulToggleHorde
        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    LocomotorSet
        Locomotor = NormalCavalryHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End
End

ChildObject MordorNazgulToggleHordeLvl2 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 2
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl3 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 3
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl4 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 4
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl5 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 5
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl6 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 6
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl7 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 7
        MPOnly               = Yes
    End

End

ChildObject MordorNazgulToggleHordeLvl8 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 8
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl9 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 9
        MPOnly               = Yes
    End
End

ChildObject MordorNazgulToggleHordeLvl10 MordorNazgulToggleHorde
    MaxSimultaneousOfType = 1
    EquivalentTo = MordorNazgulToggleHorde

    Behavior                 = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant         = 10
        MPOnly               = Yes
    End
End

Object MordorMorgulschattenHorde

   SelectPortrait = UPMorgulschatten
   ButtonImage    = HSMorgulschatten

   Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End


    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:MordorMorgulschattenHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_MordorMorgulschattenHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorMorgulschattenHorde
    MaxSimultaneousOfType = 3

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 1000
    BuildTime = ELITE_BUILDTIME

    ShroudClearingRange = ISENGARD_URUKFIGHTER_SHROUD_RANGE
    VisionRange         = ISENGARD_URUKFIGHTER_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints  = 65
    CrushableLevel = 2
    CrusherLevel   = 0

    CommandSet = MordorMorgulschattenCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = MordorMorgulschatten 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:MordorMorgulschatten Position:X:50 Y:0        Position:X:50 Y:30       Position:X:50 Y:-30                Position:X:50 Y:60                Position:X:50 Y:-60

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      =    1000
        TauntAndPointExcluded         =    NONE
        AfraidOf                      =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance              =    150
        FearScanDistance              =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ISENGARD_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_PlantShield
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SwitchToRockThrowing
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl2
        HealingAmount              = 30
        Radius                     = 100
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

Object MordorHaradrimArcherHordeMod

    ButtonImage        = WOR_HaradrimArcher
    SelectPortrait     = UPMordor_Haradrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side            = Mordor
    EditorSorting        = UNIT
    EmotionRange        = EMOTION_CHEER_RADIUS
    DisplayName        = OBJECT:HordeMordorHaradrimArcher
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorHaradrimArcherHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorHaradrimArcherHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    HaradrimArcherMissileHordeRangefinder
        Weapon        = TERTIARY   HaradrimArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 600
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_HARADRIM_SHROUD_RANGE

    VisionRange         = MORDOR_HARADRIM_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel        = 0
    CrusherLevel        = 0
    UseCrushAttack         = No

    CommandPoints        = 50
    CommandSet        = MordorHaradrimArcherCommandSetMod

    FormationWidth        = 2
    FormationDepth        = 1

    TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = MORDOR_HARADRIM_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorHaradrimArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate    = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Archer
        CanAttackWhileContained        = Yes
    End

    Behavior = HordeContain ModuleTag_HordeContainOverride
        ObjectStatusOfContained     =
        InitialPayload            = MordorHaradrimArcher 10
        Slots                = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:2 Y:2
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:MordorHaradrimArcher        Pos:X:40.0 Y:0.0         for archer horde

        RandomOffset = X:0 Y:-12

        RankInfo = RankNumber:1 UnitType:MordorHaradrimArcher Position:X:0 Y:12    Position:X:0 Y:-12    Position:X:0 Y:-36    Position:X:0 Y:36    Position:X:0 Y:-60
        RankInfo = RankNumber:2 UnitType:MordorHaradrimArcher Position:X:20 Y:12    Position:X:15 Y:-12    Position:X:20 Y:-36    Position:X:20 Y:36    Position:X:20 Y:-60

        MeleeAttackLeashDistance    = 25
        RanksToReleaseWhenAttacking     = 1 2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_MEMBER_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap        = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy        = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy        = Upgrade_HeavyArmor
    End

    Behavior = SpecialPowerModule ModuleTag_LongShot
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        UpdateModuleStartsAttack    = Yes
        StartsPaused              = No

    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate        = SpecialAbilityHaradrimArcherBarbedArrow
        PackTime            		= 3000
        StartAbilityRange        	= #SUBTRACT( MORDOR_HARADRIM_BOW_RANGE 100 )
        SpecialWeapon            	= HaradrimBarbedArrowRangeFinder
        ApproachUntilMembersInRange = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorBarbed
        SpecialAbility      = SpecialAbilityHaradrimArcherBarbedArrow
		ForbiddenStatus     = INSIDE_GARRISON
		MaxScanRange	    = 250.0
		Query		    	= 1 ANY ENEMIES +HERO +MONSTER
		Query		    	= 10 ALL ENEMIES -STRUCTURE
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate MordorHaradrimArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BarbedArrowsAI
        CommandButtonName = Command_HaradrimArcherBarbedArrowAbility
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry        = BOX
    GeometryMajorRadius     = 15.0
    GeometryMinorRadius     = 65.0
    GeometryHeight        = 12.0
    GeometryIsSmall        = No

        Shadow            = SHADOW_DECAL
        ShadowSizeX        = 23
        ShadowSizeY        = 23
       ShadowTexture        = ShadowI

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

