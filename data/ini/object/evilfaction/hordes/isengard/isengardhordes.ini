Object IsengardFighterHorde

    ButtonImage       = UIIsenUruk
    SelectPortrait    = UPUrukhainew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardFighter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = QUATERNARY NONE
    End

    BuildCost         = 420
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = 325
    VisionRange         = 200

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints         = 45
    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandSet         = IsengardFighterHordeCommandSet_Edain

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardFighter 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardFighter Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3


        ComboHorde = Target:IsengardShieldurukHorde             Result:IsengardFighterShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukHauptmannHorde          Result:IsengardFighterHauptmannComboHorde         InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUglukHordeSystem            Result:IsengardUglukComboHorde                    InitiateVoice:UrukWarriorVoiceJoin

        AlternateFormation    = IsengardFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HauptmannPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        Duration             = 20000
        AttributeModifier    = UrukHauptmannSchwertkampferBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BonusUnpause
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        TriggeredBy                 = Upgrade_ObjectLevel5
    End

    Behavior = SpecialPowerModule ModuleTag_HeroLeadership
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End


	; Behavior = DoCommandUpgrade Module_DoCommandUpgrade2    
        ; TriggeredBy                 = Upgrade_ErestorZweiteReihe
        ; RequiresAllTriggers         = Yes
        ; GetUpgradeCommandButtonName = Command_SpecialAbilityOrkstadtOrksSummon
    ; End

    ; Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        ; StartsPaused                = No
        ; SpecialPowerTemplate        = SpecialAbilityOrkstadtOrksSummon
        ; OCL                         = OCL_SpawnShieldUrukUpgrade
        ; CreateLocation              = CREATE_AT_LOCATION
    ; End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ComboPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ComboPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCombosBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End






    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject IsengardFighterHordePending IsengardFighterHorde

	BuildCost = 720
	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_ErestorZweiteReihe
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = IsengardFighterShieldurukComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_ErestorZweiteReihe
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End

End

Object IronNumenorsHorde
      ; This is required for garrisoned objects - please put in all objects.
    SelectPortrait = UPDarkNum
    ButtonImage    = HSDarkNum

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarDarkGuard
    DisplayNameStrategic = CONTROLBAR:AngmarDarkGuard
    DescriptionStrategic = CONTROLBAR:ToolTipBuildTaurnuFuinGaurd

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = QUATERNARY NONE
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = 1100
    BuildTime         = FirstAgeHordeBuildtime
    ShroudClearingRange     = 325
    VisionRange         = 280
    VisionSide         = 60%
    VisionRear         = 35%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 55

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1

    CrushOnlyWhileCharging = Yes

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarNumElite2 5
        Slots                 = 5
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

;--------------------Necro Death Mask Power--------------------------------
    

  

        RankInfo = RankNumber:1 UnitType:AngmarNumElite2 Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        

        RanksToReleaseWhenAttacking     = 1 2
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      = 1000
        TauntAndPointExcluded         = NONE
        AfraidOf                      = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance              = 150
        FearScanDistance              = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            = Terror_Base
        AddEmotion            = Doom_Base

        AddEmotion            = BraceForBeingCrushed_Base

        AddEmotion            = UncontrollableFear_Base

        AddEmotion            = FearIdle_Base

        AddEmotion            = FearBusy_Base

        AddEmotion            = Point_Base

        AddEmotion            = Taunt_Base

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp          = ANY +CRATE -TheDroppedRing
        ScanRange              = 200
        ScanIntervalSeconds    = 0.5
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 60
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = 60
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    

   


    Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
        StartsActive            = Yes
        BonusName            = DeathMaskModifier
        RefreshDelay            = 2000
        Range                = ANGMAR_NECRO_DEATH_MASK_RANGE
        TargetEnemy            = Yes
        ObjectFilter            = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy          = Upgrade_ObjectLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused        = Yes
		InitiateSound            = DkDunVoiceChargePower
    End





    Behavior = SpecialPowerModule ModuleTag_PaktDummy
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_PaktHeal            TARGETPOS
        TriggerSpecialPower             = ModuleTag_PaktBlastStarter    TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_PaktHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 0.5
        HealAsPercent                   = Yes
        HealAffects                     = GANDALF
        HealRadius                      = 999999999
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = DainMightyRage

    End

    Behavior = SpecialPowerModule ModuleTag_PaktBlastStarter
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_PaktBlastWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        WhichSpecialWeapon              = 1
        SkipContinue                    = Yes
        UnpackTime                      = 100
        PreparationTime                 = 1

        PackTime                        = 100
        FreezeAfterTriggerDuration      = 100
        AwardXPForTriggering            = 100
        StartAbilityRange               = 20.0
        EffectRange                     = 55
        SpecialWeapon                   = ErfullterPaktWeapon
    End


   

    #include "..\..\..\includes\AngmarChargeUpdate.inc"

    CommandSet = IronNumenorsHordeCommandSet





    Behavior = AISpecialPowerUpdate AngmarCharge
        CommandButtonName = Command_AngmarChargeAttack
        SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    
End


ChildObject IsengardFighterHordeBlock IsengardFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardFighter 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers = IsengardFighterHordeBlockBonus
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardFighter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardFighter Position:X:40 Y:0                Position:X:40 Y:14                Position:X:40 Y:-14                Position:X:40 Y:28                Position:X:40 Y:-28
        RankInfo = RankNumber:2 UnitType:IsengardFighter Position:X:20 Y:0 Leader 1 0    Position:X:20 Y:14 Leader 1 1    Position:X:20 Y:-14 Leader 1 2    Position:X:20 Y:28 Leader 1 3    Position:X:20 Y:-28 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter Position:X: 0 Y:0 Leader 2 0    Position:X: 0 Y:14 Leader 2 1    Position:X: 0 Y:-14 Leader 2 2    Position:X: 0 Y:28 Leader 2 3    Position:X: 0 Y:-28 Leader 2 4


        ComboHorde = Target:IsengardShieldurukHorde             Result:IsengardFighterShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukHauptmannHorde          Result:IsengardFighterHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin


        RanksToReleaseWhenAttacking = 1

        AlternateFormation        = IsengardFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

End

ChildObject IsengardFighterHorde_Summoned IsengardFighterHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardFighterHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardFighter_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardFighter_Summoned        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardFighter_Summoned Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardFighter_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DAIN_SUMMON_TIMEOUT
        MaxLifetime        = DAIN_SUMMON_TIMEOUT
        DeathType        = FADED
    End
End



Object IsengardUglukHorde_Summoned

    ButtonImage             = HIMauhur
    SelectPortrait          = HPMauhur

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardUgluksSpaher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardUgluksSpaher
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = QUATERNARY NONE
    End

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME
    MaxSimultaneousOfType = 1

    ShroudClearingRange     = 325
    VisionRange         = 200

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints        = 0
    CrushableLevel       = 0
    CrusherLevel         = 0

    CommandSet           = MauhurCommandSet_Spell

    FormationWidth       = 2
    FormationDepth       = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry

    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IsengardEliteFighter 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY +IsengardMauhur_Spell
        ShowPips                        = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardMauhur_Spell
        BannerCarrierPosition    = UnitType:IsengardMauhur_Spell    Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel    = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


         RankInfo = RankNumber:1 UnitType:IsengardEliteFighter Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
         RankInfo = RankNumber:2 UnitType:IsengardEliteFighter Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
         RankInfo = RankNumber:3 UnitType:IsengardEliteFighter Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25




        RanksToReleaseWhenAttacking        = 1 2 3

        MeleeAttackLeashDistance        = 25
        BackUpMinDelayTime                = 1
        BackUpMaxDelayTime                = 3000
        BackUpMinDistance                = 1
        BackUpMaxDistance                = 3
        BackupPercentage                = 80%
    End






    Behavior                                = SpecialPowerModule ModuleTag_WitterungUpdate
        SpecialPowerTemplate                = SpecialAbilityUglukHardMarch
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = WitterungModifier
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierFX                 = FX_AbwehrLeadership40
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_WitterungAnimation
        SpecialPowerTemplate                = SpecialAbilityUglukHardMarch
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"



    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End











    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object IsengardShieldurukHorde

  ButtonImage    = HIUrukSchildtrager_Wotr
  SelectPortrait = UPUrukSchildtrager

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardShielduruk
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardShieldurukHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardShieldurukHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost         = 300
    BuildTime         = 12

    ShroudClearingRange     = 325
    VisionRange         = 200

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints         = 5
    CrushableLevel         = 1
    CrusherLevel         = 0

    CommandSet         = IsengardShieldurukHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardShielduruk 5
        Slots             = 5
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:1 Y:1
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardShielduruk Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardShielduruk Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardShielduruk Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1


        ComboHorde = Target:IsengardFighterHorde             Result:IsengardFighterShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardPikemanHorde             Result:IsengardPikemanShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukCrossbowHorde        Result:IsengardShieldurukCrossbowComboHorde       InitiateVoice:UrukWarriorVoiceJoin


        ComboHorde = Target:IsengardFighterHordeBlock        Result:IsengardFighterShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardPikemanHordePorcupine    Result:IsengardPikemanShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"



    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End
	
	LocomotorSet
		Locomotor     = HumanSpecialChargeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_EVIL_FAST_MEMBER_SPEED
	End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ComboPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ComboPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCombosBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End



    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SteelBoltArrows
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsengardShieldurukHorde_Summoned IsengardShieldurukHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardShieldurukHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardShielduruk_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk_Summoned        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk_Summoned Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardShielduruk_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardShielduruk_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DAIN_SUMMON_TIMEOUT
        MaxLifetime        = DAIN_SUMMON_TIMEOUT
        DeathType        = FADED
    End
End




Object IsengardPikemanHorde

    ButtonImage       = UIIsenUrukPike
    SelectPortrait    = UPUrukhaiPikemen

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardPikemen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardPikemanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardPikemanHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME

    VisionRange          = 200
    ShroudClearingRange  = 325

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 45

    CommandSet          = IsengardPikemanHordeCommandSet_Edain

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 150
    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardPikeman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardPikeman    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardPikeman Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardPikeman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardPikeman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        ComboHorde = Target:IsengardShieldurukHorde             Result:IsengardPikemanShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukHauptmannHorde             Result:IsengardPikemanHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = IsengardPikemanHordePorcupine
        MeleeAttackLeashDistance = 1                .
    End







    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End



    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End
	
	LocomotorSet
		Locomotor     = HumanSpecialChargeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_EVIL_FAST_MEMBER_SPEED
	End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_IsengardPikemanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsengardPikemanHordePorcupine IsengardPikemanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = IsengardPikeman 15
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers                = IsengardPikemanHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IsengardPikemanHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes
        ComboHorde = Target:IsengardShieldurukHorde             Result:IsengardPikemanShieldurukComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukHauptmannHorde             Result:IsengardPikemanHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin


        BannerCarriersAllowed            = IsengardBannerOrc
        BannerCarrierPosition            = UnitType:IsengardPikeman    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:IsengardPikeman Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
	
	Behavior = AttributeModifierUpgrade ModuleTag_CaptainBonus
        TriggeredBy       = Upgrade_ErestorZweiteReihe
        AttributeModifier = IsengardShieldUrukDefense
    End
End

ChildObject IsengardPikemanHordePending IsengardPikemanHorde

	BuildCost = 800

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_ErestorZweiteReihe
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = IsengardPikemanShieldurukComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_ErestorZweiteReihe
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End

End


ChildObject IsengardPikemanHorde_Summoned IsengardPikemanHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardPikemanHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardPikeman_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardPikeman_Summoned        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardPikeman_Summoned Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardPikeman_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardPikeman_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DAIN_SUMMON_TIMEOUT
        MaxLifetime        = DAIN_SUMMON_TIMEOUT
        DeathType        = FADED
    End
End


Object IsengardWildmanHorde

	ButtonImage	= UIIsenDunland
	SelectPortrait	= UPWildmennew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemplate
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeWildman
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardWildmanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWildmanHorde

    WeaponSet
        Conditions = CONTAINED
        Weapon = PRIMARY    NormalMissileHordeRangefinder
    End
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost         = 180
    BuildTime         = 15

    ShroudClearingRange = 300
    VisionRange = 200


    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints         = 45

    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandSet = IsengardWildmanHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWildman 15
        Slots             = 15
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        =X:4 Y:4

        MeleeBehavior = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = DunlandIngameBanner
        BannerCarrierPosition    = UnitType:IsengardWildman    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildman Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildman Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildman Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Behavior = SpecialPowerModule ModuleTag_PillageStandin
        SpecialPowerTemplate       = SpecialAbilityWildmanPillage
        StartsPaused               = No
        UpdateModuleStartsAttack   = No
    End



    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_IsengardTorches
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWildmanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.4
    GeometryMinorRadius = 30.4
    GeometryHeight = 8.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardWildmanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanArmor
    End

    AutoResolveWeapon
	RequiredUpgrades = Upgrade_IsengardTorches
	Weapon = AutoResolve_IsengardWildmanUpgradedWeapon
    End

    AutoResolveWeapon
	ExcludedUpgrades = Upgrade_IsengardTorches
	Weapon = AutoResolve_IsengardWildmanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor Upgrade_IsengardTorches
End


ChildObject IsengardWildmanHorde_Summoned IsengardWildmanHorde
    IsTrainable   = No
    CommandPoints = 0
    CommandSet    = IsengardWildmanHordeCommandSet_Summoned
    EquivalentTo  = IsengardWildmanHorde

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType          = FADED
    End
    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildman_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardWildman_Summoned Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildman_Summoned Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildman_Summoned Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End
End


ChildObject IsengardWildmanHordeInn IsengardWildmanHorde
    BuildCost = 150
    CommandSet = IsengardWildmanHordeCommandSet_Summoned
    EquivalentTo = IsengardWildmanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildman 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardWildman Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildman Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildman Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End
End

ChildObject IsengardWildmanHordeKampagne IsengardWildmanHorde

    EquivalentTo = IsengardWildmanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWildman 15
        Slots             = 15
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        =X:4 Y:4

        MeleeBehavior = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = DunlandKampagneBanner
        BannerCarrierPosition    = UnitType:IsengardWildman    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildman Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildman Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildman Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1 2 3
    End

End



ChildObject IsengardWildmanHordeFree IsengardWildmanHorde
    BuildCost = 0
    CommandSet = IsengardWildmanHordeCommandSet_Summoned
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
End


ChildObject AngmarWildmanHordeFree IsengardWildmanHorde
    SelectPortrait    = UPIsengard_WildmenofDunland


    BuildCost = 0
    Side = Isengard
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    CommandSet    = AngmarWildmanHordeCommandSet

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_IsengardTorches
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End
End


Object IsengardUrukCrossbowHorde

    ButtonImage       = UIIsenUrukCrossbow
    SelectPortrait    = UPIsenguard_UrukCrossbow

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUArc
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardCrossbow
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardUrukCrossbowHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardUrukCrossbowHorde

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    IsengardArcherHordeRangeFinder
        Weapon            = SECONDARY  IsengardArcherHordeRangeFinder
        Weapon            = TERTIARY   IsengardArcherHordeRangeFinderBombard
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = ISENGARDURUKCROSSBOWHORDE_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 350
    VisionRange = 300

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandPoints         = 45


    CommandSet = IsengardUrukCrossbowHordeCommandSet_Edain

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY ARCHER HORDE CAN_USE_SIEGE_TOWER ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = IsengardArcherFunctions
        AttackPriority                =     AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardUrukCrossbow 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukCrossbow        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardUrukCrossbow Position:X:50 Y:0        Position:X:50 Y:22        Position:X:50 Y:-22        Position:X:50 Y:44        Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4


        ComboHorde = Target:IsengardShieldurukHorde         Result:IsengardShieldurukCrossbowComboHorde       InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukHauptmannHorde      Result:IsengardHauptmannCrossbowComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardMauhurHorde             Result:IsengardMauhurComboHorde                   InitiateVoice:UrukWarriorVoiceJoin

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 25


    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End



    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End


    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End


    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                            = OCL_UrukCrossbowLongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No



        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No



        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS        = No
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HauptmannPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCrossbowBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BonusUnpause
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        TriggeredBy                 = Upgrade_ObjectLevel5
    End

    Behavior = SpecialPowerModule ModuleTag_HeroLeadership
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End


	Behavior = DoCommandUpgrade Module_DoCommandUpgrade2    
        TriggeredBy                 = Upgrade_ErestorZweiteReihe
        RequiresAllTriggers         = Yes
        GetUpgradeCommandButtonName = Command_SpecialAbilityOrkstadtOrksSummon
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        StartsPaused                = No
        SpecialPowerTemplate        = SpecialAbilityOrkstadtOrksSummon
        OCL                         = OCL_SpawnShieldUrukUpgrade
        CreateLocation              = CREATE_AT_LOCATION
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ComboPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ComboPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCombosBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End



    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_SteelBoltArrows Upgrade_HeavyArmor
End

ChildObject IsengardUrukCrossbowHordePending IsengardUrukCrossbowHorde

	BuildCost = 900
	
    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_ErestorZweiteReihe
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = IsengardShieldurukCrossbowComboHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_ErestorZweiteReihe
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End

End

Object IsengardWargRiderHorde

    ButtonImage       = WOR_WargRiders
    SelectPortrait    = UPIsenguard_WargRiders

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardWargRiders
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardWargRiderHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWargRiderHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End




    BuildCost           = 600
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450


    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 40

    CommandSet            = WargRiderHordeModCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = IsengardWargRiderBanner
        BannerCarrierPosition    = UnitType:IsengardWargRider    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargRider Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargRider Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation = IsengardWargRiderHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject IsengardWargRiderHordeWedgeFormation IsengardWargRiderHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsengardWargRider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +IsengardWargRiderBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardWargRiderBanner
        BannerCarrierPosition    = UnitType:IsengardWargRider    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardWargRider  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsengardWargRiderHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


ChildObject IsengardWargRiderHorde_Summoned IsengardWargRiderHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = WargRiderHordeCommandSet
    EquivalentTo = IsengardUrukCrossbowHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargRider_Summoned  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End



        BannerCarriersAllowed    = IsengardWargRiderBanner
        BannerCarrierPosition    = UnitType:IsengardWargRider_Summoned       Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Summoned Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Summoned Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargRider_Summoned Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DAIN_SUMMON_TIMEOUT
        MaxLifetime        = DAIN_SUMMON_TIMEOUT
        DeathType        = FADED
    End
End


Object IsengardBerserkerHorde

    ButtonImage        = WOR_Deathbringer
    SelectPortrait    = HPDeathbringer

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side                 = Isengard
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:HordeIsengardBerserker
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardBerserkerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardBerserkerHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
        Weapon         = SECONDARY    NormalMeleeHordeRangefinder
        OnlyAgainst     = SECONDARY MINE
    End

    BuildCost         = 1000
    BuildTime         = STRONG_BUILDTIME

    ShroudClearingRange     = ISENGARD_FANATIC_SHROUD_RANGE
    VisionRange         = ISENGARD_FANATIC_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    MaxSimultaneousOfType    = 3

    CommandPoints         = 60
    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandSet         = IsengardFanaticHordeCommandSet




    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_BERSERKER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardFanatic 5
        Slots                 = 5
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior             = Amoeba
        End





        RankInfo = RankNumber:1 UnitType:IsengardFanatic     Position:X:0 Y:0    Position:X:25 Y:25    Position:X:25 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%

    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base_Evil
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate = SpecialAbilityFanaticHeroMode
        TriggeredBy = Upgrade_MiniHordeLvl7
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityFanaticHeroMode
        Duration                = 30000
        AttributeModifier        = FanaticDeathWish


        StartsPaused            = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_StoneWallEnabler
        SpecialPowerTemplate = SpecialAbilityStoneWall
        TriggeredBy = Upgrade_MiniHordeLvl2
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_StoneWallPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityStoneWall
        Duration                = 20000
        AttributeModifier        = FanaticStoneWall


        StartsPaused            = Yes
    End



    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl3
        HealingAmount              = 30
        Radius                     = 100
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End







    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

End


Object IsengardWildmanAxeHorde

	ButtonImage		= UIIsenDunlandAxe
	SelectPortrait		= UPWildmenAxeThrowernew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side                  = Isengard
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = OBJECT:IsengardWildmanAxe
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_IsengardWildmanAxeHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_IsengardWildmanAxeHorde

    WeaponSet
        Conditions     = None
        Weapon        = PRIMARY    WildAxeThrowerHordeRangefinder
    End

    CommandSet =  IsengardWildmanAxeHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel       = 0
    CrusherLevel         = 0
    UseCrushAttack       = No

    BuildCost = 225
    BuildTime = MEDIUM_BUILDTIME

    VisionRange = 250
    ShroudClearingRange     = 300

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 45

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = ISENGARD_WILDMAN_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =  AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildmanAxe 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = DunlandIngameBanner
        BannerCarrierPosition    = UnitType:IsengardWildmanAxe    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildmanAxe Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildmanAxe Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildmanAxe Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RandomOffset = X:5 Y:3

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_IsengardTorches
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = TooltipUpgrade ModuleTag_Name
        TriggeredBy                = Upgrade_IsengardTorches
        DisplayName                = OBJECT:IsengardWildmanFackel
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate DwarvenMenOfDaleHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No


	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardWildmanAxeHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_IsengardWildmanAxeHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_IsengardWildmanAxeArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardWildmanAxeWeapon
	End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor Upgrade_IsengardTorches
End

ChildObject IsengardWildmanAxeHorde_Summoned IsengardWildmanAxeHorde
    IsTrainable   = No
    CommandPoints = 0
    CommandSet    = IsengardWildmanHordeCommandSet_Summoned
    EquivalentTo  = IsengardWildmanAxeHorde

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType          = FADED
    End
    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildmanAxe_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardWildmanAxe_Summoned Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildmanAxe_Summoned Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildmanAxe_Summoned Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance    = 25
    End
End

ChildObject IsengardWildmanAxeHordeKampagne IsengardWildmanAxeHorde

    EquivalentTo = IsengardWildmanAxeHorde

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildmanAxe 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = DunlandKampagneBanner
        BannerCarrierPosition    = UnitType:IsengardWildmanAxe    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildmanAxe Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildmanAxe Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildmanAxe Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RandomOffset = X:5 Y:3

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End
End


ChildObject IsengardUrukCrossbowHorde_Summoned IsengardUrukCrossbowHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardUrukCrossbowHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardUrukCrossbow_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukCrossbow_Summoned        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardUrukCrossbow_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4


        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End
End


Object IsengardWildeliteHorde

    ButtonImage        = HIWildelite_Wotr
    SelectPortrait     = UPWildelite

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemplate
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardWildmanElite
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardWildmanEliteHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWildmanEliteHorde

    WeaponSet
        Conditions = CONTAINED
        Weapon = PRIMARY    NormalMissileHordeRangefinder
    End
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost         = 325
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 300
    VisionRange = 200

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints         = 50

    CrushableLevel         = 0
    CrusherLevel         = 0

    CommandSet = IsengardWildeliteHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WILDMAN_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWildelite 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        = X:2 Y:3

        MeleeBehavior = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = DunlandIngameBanner
        BannerCarrierPosition    = UnitType:IsengardWildelite    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildelite Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWildelite Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWildelite Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Behavior = SpecialPowerModule ModuleTag_PillageStandin
        SpecialPowerTemplate        = SpecialAbilityWildmanPillage
        StartsPaused            = No
        UpdateModuleStartsAttack    = No
    End




    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_IsengardTorches
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly      = Yes
        StuffToPickUp       = ANY +CRATE -TheDroppedRing
        ScanRange           = 200
        ScanIntervalSeconds = 0.5
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWildmanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.4
    GeometryMinorRadius = 30.4
    GeometryHeight = 8.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardWildmanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardWildmanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End


ChildObject IsengardWildeliteHorde_Summoned IsengardWildeliteHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengardWildmanHordeCommandSet_Summoned
    EquivalentTo = IsengardWildeliteHorde

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildelite_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardWildelite_Summoned Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildelite_Summoned Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildelite_Summoned Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = ISENGARD_WILDMAN_SUMMON_DURATION
        MaxLifetime        = ISENGARD_WILDMAN_SUMMON_DURATION
        DeathType        = FADED
    End

End

ChildObject IsengardWildeliteHordeKampagne IsengardWildeliteHorde

    EquivalentTo = IsengardWildeliteHorde

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWildelite 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        = X:2 Y:3

        MeleeBehavior = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = DunlandKampagneBanner
        BannerCarrierPosition    = UnitType:IsengardWildelite    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildelite Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWildelite Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWildelite Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
    End
End



Object IsengardUrukScoutHorde

    ButtonImage        = HSUrukScout
    SelectPortrait     = UPUrukScout

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUArc
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardUrukScoutHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardUrukScoutHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardUrukScoutHorde

    MaxSimultaneousOfType    = 6

    WeaponSet
        Conditions = None
        Weapon         = PRIMARY    IsengardScoutArcherMissileHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 500
    BuildTime = MEDIUM_BUILDTIME

    VisionRange                = 350
    VisionSide                 = 50%
    VisionRear                 = 25%
    VisionBonusPercentPerFoot  = 1.0%
    ShroudClearingRange        = 500
    CrushableLevel             = 0
    CrusherLevel               = 0
    CommandPoints              = 50

    ThreatLevel = 150
    CommandSet  = UrukScoutHordeNewCommandSet

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE CAN_USE_SIEGE_TOWER URUK ARMY_SUMMARY

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        MaxCowerTime            	= 5000
        MinCowerTime            	= 3000
        CanAttackWhileContained         = Yes
        AILuaEventsList                 = IsengardArcherFunctions
        AttackPriority                  = AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardUrukScout 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = IsengardScoutBanner
        BannerCarrierPosition    = UnitType:IsengardUrukScout        Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardUrukScout Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardUrukScout Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardUrukScout Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf          =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                 =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 1.2
        InitiateVoice            = UrukWarriorVoiceJoinOrcsMS
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 50
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BonusUnpause
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        TriggeredBy                 = Upgrade_ObjectLevel5
    End

    Behavior = SpecialPowerModule ModuleTag_HeroLeadership
        SpecialPowerTemplate        = SpecialAbilityBonusLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ScoutToggleAI
	CommandButtonName = Command_ToggleUrukScoutWeapon
	SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_SteelBoltArrows Upgrade_HeavyArmor
End

Object IsengardWildmanAxeHordeMod

	ButtonImage		= UIIsenDunlandAxe
	SelectPortrait		= UPWildmenAxeThrowernew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side                  = Isengard
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = OBJECT:IsengardWildmanAxe
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_IsengardWildmanAxeHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_IsengardWildmanAxeHorde

    WeaponSet
        Conditions     = None
        Weapon        = PRIMARY    WildAxeThrowerHordeRangefinder
    End

    CommandSet =  IsengardWildmanAxeHordeModCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel       = 0
    CrusherLevel         = 0
    UseCrushAttack       = No

    BuildCost = 225
    BuildTime = MEDIUM_BUILDTIME

    VisionRange = 250
    ShroudClearingRange     = 300

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 45

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = ISENGARD_WILDMAN_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =  AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildmanAxe 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = DunlandIngameBanner
        BannerCarrierPosition    = UnitType:IsengardWildmanAxe    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildmanAxe Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildmanAxe Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildmanAxe Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RandomOffset = X:5 Y:3

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_IsengardTorches
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = TooltipUpgrade ModuleTag_Name
        TriggeredBy                = Upgrade_IsengardTorches
        DisplayName                = OBJECT:IsengardWildmanFackel
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate DwarvenMenOfDaleHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No


	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardWildmanAxeHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_IsengardWildmanAxeHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_IsengardWildmanAxeArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardWildmanAxeWeapon
	End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor Upgrade_IsengardTorches
End


ChildObject IsengardWildmanAxeHordeModKampagne IsengardWildmanAxeHordeMod

    EquivalentTo = IsengardWildmanAxeHordeMod

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsengardWildmanAxe 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = DunlandKampagneBanner
        BannerCarrierPosition    = UnitType:IsengardWildmanAxe    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildmanAxe Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildmanAxe Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildmanAxe Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RandomOffset = X:5 Y:3

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance   = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance          = 1
        BackUpMaxDistance          = 3
        BackupPercentage           = 80%
    End
End


Object IsengardWildSpearmanHorde

	ButtonImage	= UIIsenDunlandSpear
	SelectPortrait	= UPWildmenSpearsnew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardDunlandSpearmen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardDunlandSpearmen
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardDunlandSpearmen

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End



    BuildCost = 180
    BuildTime = MEDIUM_BUILDTIME

    VisionRange = ANGMAR_RHUDAURSPEAR_HORDE_VISION_RANGE
    ShroudClearingRange = ANGMAR_RHUDAURSPEAR_SHROUD_RANGE


    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 45

    CommandSet = IsengardWildmanSpearHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ANGMAR_RHUDAURSPEAR_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           =    500
        MaxCowerTime                  =    5000
        MinCowerTime                  =    3000
        AILuaEventsList               =    InfantryFunctions
        AttackPriority                =    AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardWildSpearman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos          =    -0.17
            InnerRange             =    30
            OuterRange             =    80
            OuterRangeBuildings    =    140
        End

        RandomOffset = X:5 Y:3

        BannerCarriersAllowed    = DunlandIngameBanner
        BannerCarrierPosition    = UnitType:IsengardWildSpearman    Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWildSpearman Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38     Position:X:25 Y:-15
        RankInfo = RankNumber:2 UnitType:IsengardWildSpearman Position:X:9 Y:2    Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39     Position:X:20 Y:20
        RankInfo = RankNumber:3 UnitType:IsengardWildSpearman Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18        Position:X:-11 Y:40     Position:X:-5 Y:40

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TriggerButton
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership
    End

    Behavior = SpecialPowerModule ModuleTag_TriggerButtonUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
		UpdateRate		= 1000
		HordeMemberFilter	= NONE +IsengardWildSpearman
		Count			= 50
		Radius			= 200
		RubOffRadius		= 200
		AlliesOnly		= Yes
		AttributeModifier	= WildManSpearLargeGroupBonus
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = SpecialPowerModule ModuleTag_PillageStandin
        SpecialPowerTemplate        = SpecialAbilityWildmanPillage
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End


    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Scale = 0.90
    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



	AutoResolveUnitType = AutoResolveUnit_Pikemen
	AutoResolveCombatChain = AutoResolve_PikemenCombatChain

	AutoResolveBody = AutoResolve_RohanSpearmenHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_RohanSpearmenHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_HeavyArmor
		Armor = AutoResolve_RohanSpearmenArmor
	End

	AutoResolveWeapon
		Weapon =  AutoResolve_RohanSpearmenWeapon
	End

	WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End

Object DunlandSchlachterHorde

    ButtonImage        = HSDunlandSchlachter
    SelectPortrait     = UPDunlandSchlachter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemplate
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeDunlandSchlachter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DunlandSchlachterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DunlandSchlachterorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
        Weapon         = SECONDARY    NormalMeleeHordeRangefinder
        OnlyAgainst     = SECONDARY MINE
    End

    BuildCost         = 900
    BuildTime         = ELITE_BUILDTIME

    VisionRange = DWARVEN_ZERKER_HORDE_VISION_RANGE
    ShroudClearingRange = DWARVEN_ZERKER_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    MaxSimultaneousOfType    = 3

    CommandPoints         = 60
    CrushableLevel         = 1
    CrusherLevel         = 0

    CommandSet = DunlandSchlachterCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_BERSERKER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = DunlandSchlachter 5
        Slots                 = 5
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior             = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:DunlandSchlachter     Position:X:0 Y:0    Position:X:28 Y:28    Position:X:28 Y:-28    Position:X:0 Y:53    Position:X:0 Y:-53

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%

    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base_Evil
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



	Behavior = SpecialPowerModule ModuleTag_Dummy
        SpecialPowerTemplate      = SpecialAbilityVeteransDummy
        StartsPaused = No
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BoarCultEnabler
        SpecialPowerTemplate = SpecialAbilityBoarCult
        TriggeredBy = Upgrade_MiniHordeLvl3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_BoarCultPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityBoarCult
        Duration                = 20000
        AttributeModifier        = BoarCultMod
		LockWeaponSlot       = SECONDARY
        StartsPaused            = Yes
    End

	Behavior = AutoAbilityBehavior ModuleTag_BoarCultAutoAbility
        SpecialAbility    = SpecialAbilityBoarCult
        ForbiddenStatus = INSIDE_GARRISON ;;,;; This seems to prevent the ability from being used inside a tower
        MaxScanRange    = 100
        Query            = 1 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BearCultEnabler
        SpecialPowerTemplate = SpecialAbilityBearCult
        TriggeredBy = Upgrade_MiniHordeLvl5
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_BearCultPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityBearCult
        Duration                = 20000
        AttributeModifier        = BearCultMod
		LockWeaponSlot       	= TERTIARY
        StartsPaused            = Yes
    End
	
	Behavior = AutoAbilityBehavior ModuleTag_BearCultAutoAbility
        SpecialAbility    = SpecialAbilityBearCult
        ForbiddenStatus = INSIDE_GARRISON ;;,;; This seems to prevent the ability from being used inside a tower
        MaxScanRange    = 100
        Query            = 1 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WolfCultEnabler
        SpecialPowerTemplate = SpecialAbilityWolfCult
        TriggeredBy = Upgrade_MiniHordeLvl7
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_WolfCultPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityWolfCult
        Duration                = 20000
        AttributeModifier        = WolfCultMod
		LockWeaponSlot       = QUINARY
        StartsPaused            = Yes
    End
	
	Behavior = AutoAbilityBehavior ModuleTag_WolfCultAutoAbility
        SpecialAbility    = SpecialAbilityWolfCult
        ForbiddenStatus = INSIDE_GARRISON ;;,;; This seems to prevent the ability from being used inside a tower
        MaxScanRange    = 100
        Query            = 1 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End



    Behavior = SpecialPowerModule ModuleTag_PillageStandin
        SpecialPowerTemplate        = SpecialAbilityWildmanPillage
        StartsPaused            = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly      = Yes
        StuffToPickUp       = ANY +CRATE -TheDroppedRing
        ScanRange           = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl3
        HealingAmount              = 30
        Radius                     = 100
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End







    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWildmanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive

        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.4
    GeometryMinorRadius = 30.4
    GeometryHeight = 8.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardWildmanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWildmanArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardWildmanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End



Object IsengardFighterShieldurukComboHorde

        ButtonImage            = UIIsenUruk
        SelectPortrait         = UPUrukhainew

        Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUHai
        End
    End

    Side                    = Isengard
    EditorSorting           = UNIT
    EmotionRange            = 240
    DisplayName             = OBJECT:HordeIsengardFighterShieldurukCombo
    DisplayNameStrategic         = CONTROLBAR:LW_Unit_IsengardFighterShieldurukComboHorde
    DescriptionStrategic         = CONTROLBAR:LW_ToolTip_IsengardFighterShieldurukComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY    NormalMeleeHordeRangefinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost              = 720
    BuildTime              = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKFIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange    = ISENGARD_URUKFIGHTER_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%
	IsTrainable					= Yes
    CommandPoints             = 50
    CommandSet             = IsengardFighterShieldurukHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE COMBO_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT

    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End
    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk 5
        InitialPayload             = IsengardFighter 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardFighter    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardFighter    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4

        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
        AttributeModifiers         = MeleeFighterComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.2
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
    End

    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange        = 15.0
        UnpackTime            = 1
        PreparationTime            = 20000
        PackTime            = 1
        DoCaptureFX            = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ComboPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ComboPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCombosBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End






    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsengardFighterShieldurukComboHorde_Summoned IsengardFighterShieldurukComboHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardShieldurukHordeCommandSetSummoned


    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk_Summoned 5
        InitialPayload             = IsengardFighter_Summoned 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1


        MeleeBehavior             = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk_Summoned    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk_Summoned      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardFighter_Summoned    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter_Summoned    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardFighter_Summoned    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4

        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
        AttributeModifiers         = MeleeFighterComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType        = FADED
    End
End


Object IsengardShieldurukCrossbowComboHorde

        SelectPortrait         = UPIsengardShieldurukCrossbowCombo
        ButtonImage            = HIIsengardShieldurukCrossbowCombo_Wotr

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUArc
        End
    End

    Side                 = Isengard
    EditorSorting             = UNIT
    EmotionRange             = 240
    DisplayName             = OBJECT:HordeIsengardShieldurukCrossbowCombo
    DisplayNameStrategic         = CONTROLBAR:LW_Unit_IsengardShieldurukCrossbowComboHorde
    DescriptionStrategic         = CONTROLBAR:LW_ToolTip_IsengardShieldurukCrossbowComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY    IsengardArcherHordeRangeFinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 900
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKCROSSBOW_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKCROSSBOW_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%
	IsTrainable					= Yes
    CommandPoints             = 50
    CommandSet             = IsengardMeleeRangeComboHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0


    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER CAN_USE_SIEGE_TOWER COMBO_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_URUKCROSSBOW_HORDE_THREAT

    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                = IsengardArcherFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk 5
        InitialPayload             = IsengardUrukCrossbow 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardUrukCrossbow    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4




        RanksThatStopAdvance = 2
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4

        AttributeModifiers         = MeleeRangedComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ComboPowerUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        TriggeredBy          = Upgrade_IsengardFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ComboPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannCombos
        Duration             = 20000
        AttributeModifier    = UrukHauptmannCombosBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End






    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_SteelBoltArrows
End


ChildObject IsengardShieldurukCrossbowComboHorde_Summoned IsengardShieldurukCrossbowComboHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardShieldurukCrossbowComboHorde


    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk_Summoned 5
        InitialPayload             = IsengardUrukCrossbow_Summoned 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1


        MeleeBehavior             = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk_Summoned    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk_Summoned      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow_Summoned    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow_Summoned    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardUrukCrossbow_Summoned    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4




        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
        AttributeModifiers         = MeleeRangedComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType        = FADED
    End
End

Object IsengardPikemanShieldurukComboHorde

        ButtonImage            = UIIsenUrukPike
        SelectPortrait         = UPUrukhaiPikemen

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUPik
        End
    End

    Side                 = Isengard
    EditorSorting             = UNIT
    EmotionRange             = 240
    DisplayName             = OBJECT:HordeIsengardPikemanShieldurukCombo
    DisplayNameStrategic         = CONTROLBAR:LW_Unit_IsengardPikemanShieldurukComboHorde
    DescriptionStrategic         = CONTROLBAR:LW_ToolTip_IsengardPikemanShieldurukComboHorde

    WeaponSet
        Conditions             = None
        Weapon                 = PRIMARY    TowerGuardHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 800
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKPIKEMAN_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKPIKEMAN_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%
	IsTrainable					= Yes
    CommandPoints             = 50
    CommandSet             = IsengardPikemanShielduruksComboHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE CAN_USE_SIEGE_TOWER COMBO_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_PIKEMAN_HORDE_THREAT

    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk 5
        InitialPayload             = IsengardPikeman 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk        Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardPikeman    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardPikeman    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardPikeman    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4




        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
		AlternateFormation = IsengardPikemanShieldurukComboHordePhalanx
        AttributeModifiers = MeleePikemenComboHorde
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange        = 15.0
        UnpackTime            = 1
        PreparationTime            = 20000
        PackTime            = 1
        DoCaptureFX            = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End
	
	LocomotorSet
		Locomotor     = HumanSpecialChargeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_EVIL_FAST_MEMBER_SPEED
	End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_EVIL_FAST_MEMBER_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy          = Upgrade_ObjectLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused        = Yes
		InitiateSound            = DkDunVoiceChargePower
    End

	#include "..\..\..\includes\AngmarChargeUpdate.inc"


    Behavior = AISpecialPowerUpdate IsengardPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_IsengardPikemanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsengardPikemanShieldurukComboHorde_Summoned IsengardPikemanShieldurukComboHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = IsengartSpellUnitsCommandSet
    EquivalentTo = IsengardPikemanShieldurukComboHorde


    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk_Summoned 5
        InitialPayload             = IsengardPikeman_Summoned 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1


        MeleeBehavior             = Amoeba
        End



        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk_Summoned    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsengardShielduruk_Summoned      Position:X:50 Y:0               Position:X:50 Y:20                   Position:X:50 Y:-20                   Position:X:50 Y:40                   Position:X:50 Y:-40

        RankInfo = RankNumber:2 UnitType:IsengardPikeman_Summoned    Position:X:30 Y:0  Leader 1 0        Position:X:30 Y:20 Leader 1 1        Position:X:30 Y:-20 Leader 1 2        Position:X:30 Y:40 Leader 1 3        Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardPikeman_Summoned    Position:X:10 Y:0  Leader 2 0        Position:X:10 Y:20 Leader 2 1        Position:X:10 Y:-20 Leader 2 2        Position:X:10 Y:40 Leader 2 3        Position:X:10 Y:-40 Leader 2 4
        RankInfo = RankNumber:4 UnitType:IsengardPikeman_Summoned    Position:X:-10 Y:0 Leader 3 0        Position:X:-10 Y:20 Leader 3 1       Position:X:-10 Y:-20 Leader 3 2       Position:X:-10 Y:40 Leader 3 3       Position:X:-10 Y:-40 Leader 3 4

        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
        AttributeModifiers         = MeleePikemenComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType        = FADED
    End
End

ChildObject IsengardPikemanShieldurukComboHordePhalanx IsengardPikemanShieldurukComboHorde

    Behavior = HordeContain ModuleTag_HordeContain
        AttributeModifiers = IsengardShieldUrukDefense
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardShielduruk 5
        InitialPayload             = IsengardPikeman 15
        Slots                 = 20
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardShielduruk   Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardShielduruk Position:X:25 Y:0        Position:X:25 Y:12.5        Position:X:25 Y:-12.5        Position:X:25 Y:25        Position:X:25 Y:-25
		RankInfo = RankNumber:2 UnitType:IsengardPikeman Position:X:12.5 Y:0        Position:X:12.5 Y:12.5        Position:X:12.5 Y:-12.5        Position:X:12.5 Y:25        Position:X:12.5 Y:-25
        RankInfo = RankNumber:3 UnitType:IsengardPikeman Position:X:0 Y:0        Position:X:0 Y:12.5        Position:X:0 Y:-12.5        Position:X:0 Y:25        Position:X:0 Y:-25
        RankInfo = RankNumber:4 UnitType:IsengardPikeman Position:X:-12.5 Y:0        Position:X:-12.5 Y:12.5        Position:X:-12.5 Y:-12.5        Position:X:-12.5 Y:25        Position:X:-12.5 Y:-25
		
		RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = IsengardPikemanShieldurukComboHorde
		AttributeModifiers         = MeleePikemenComboHorde
		AttributeModifiers		   = PikemenComboHordePhalanx
        MeleeAttackLeashDistance = 2
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

Object IsengardUrukHauptmannHorde

  ButtonImage    = HSUrukhauptmann
  SelectPortrait = UPUrukhauptmann

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardUrukHauptmann
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardUrukHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardUrukHauptmannHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost         = 1000
    BuildTime         = ELITE_BUILDTIME
    MaxSimultaneousOfType    = 3
    ShroudClearingRange = ISENGARD_URUKFIGHTER_SHROUD_RANGE
    VisionRange         = ISENGARD_URUKFIGHTER_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints        = 10
    CrushableLevel       = 1
    CrusherLevel         = 0

    CommandSet         = IsengardUrukHauptmannHordeCommandSet

    FormationWidth         = 1
    FormationDepth         = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardUrukHauptmann 1
        Slots             = 1
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukHauptmann    Pos:X:-30.0 Y:20.0

        RankInfo = RankNumber:1 UnitType:IsengardUrukHauptmann Position:X:0 Y:0

        RanksToReleaseWhenAttacking = 1


        ComboHorde = Target:IsengardFighterHorde             Result:IsengardFighterHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardPikemanHorde             Result:IsengardPikemanHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardUrukCrossbowHorde        Result:IsengardHauptmannCrossbowComboHorde       InitiateVoice:UrukWarriorVoiceJoin


        ComboHorde = Target:IsengardFighterHordeBlock        Result:IsengardFighterHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin
        ComboHorde = Target:IsengardPikemanHordePorcupine    Result:IsengardPikemanHauptmannComboHorde        InitiateVoice:UrukWarriorVoiceJoin

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive              = Yes
        BonusName                 = UrukHauptmannLeadership
        RefreshDelay              = 2000
        Range                     = 100
	    TargetEnemy			= No
        ObjectFilter              = ANY +IsengardFighter +IsengardPikeman +IsengardUrukCrossbow +IsengardShielduruk -INFANTRY -HERO -STRUCTURE -DOZER -CAVALRY -MONSTER -SHIP -MACHINE ALLIES
    End



    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                            = OCL_UrukCrossbowLongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No



        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No



        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS        = No
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object IsengardPikemanHauptmannComboHorde
        SelectPortrait         = UPIsengard_Army
        ButtonImage            = WOR_UrukPikemen

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUPik
        End
    End

    Side                   = Isengard
    EditorSorting          = UNIT
    EmotionRange           = 240
    DisplayName            = OBJECT:HordeIsengardPikemanUrukHauptmannCombo
    DisplayNameStrategic   = CONTROLBAR:HordeIsengardPikemanIsengardUrukHauptmannCombo
    DescriptionStrategic   = CONTROLBAR:LW_Unit_IsengardPikemanIsengardUrukHauptmannComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY   TowerGuardHordeRangefinder
        Weapon             = SECONDARY TowerGuardHordeRangefinder
        AutoChooseSources  = SECONDARY NONE
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 1000
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKPIKEMAN_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKPIKEMAN_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%

    CommandPoints             = 55
    CommandSet             = IsengardPikemanHauptmannComboHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE CAN_USE_SIEGE_TOWER COMBO_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_PIKEMAN_HORDE_THREAT

    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardUrukHauptmann 1
        InitialPayload             = IsengardPikeman 15
        Slots                 = 16
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1


        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukHauptmann       Pos:X:50.0 Y:20.0


        RankInfo = RankNumber:1 UnitType:IsengardUrukHauptmann      Position:X:70 Y:0

        RankInfo = RankNumber:2 UnitType:IsengardPikeman    Position:X:30 Y:0         Position:X:30 Y:20         Position:X:30 Y:-20         Position:X:30 Y:40         Position:X:30 Y:-40
        RankInfo = RankNumber:3 UnitType:IsengardPikeman    Position:X:10 Y:0         Position:X:10 Y:20         Position:X:10 Y:-20         Position:X:10 Y:40         Position:X:10 Y:-40
        RankInfo = RankNumber:4 UnitType:IsengardPikeman    Position:X:-10 Y:0        Position:X:-10 Y:20        Position:X:-10 Y:-20        Position:X:-10 Y:40        Position:X:-10 Y:-40

        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 4
        RanksToJustFreeWhenAttacking = 1 2 3 4

        AttributeModifiers         = MeleeHauptmannComboHorde
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange        = 15.0
        UnpackTime            = 1
        PreparationTime            = 20000
        PackTime            = 1
        DoCaptureFX            = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End



    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannLanzentrager
        Duration             = 20000
        AttributeModifier    = UrukHauptmannLanzentragerBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = No
    End







    Behavior = AISpecialPowerUpdate IsengardPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object IsengardFighterHauptmannComboHorde

        SelectPortrait         = UPIsenguard_UrukHai
        ButtonImage            = WOR_UrukWarriors

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUHai
        End
    End

    Side                    = Isengard
    EditorSorting           = UNIT
    EmotionRange            = 240
    DisplayName             = OBJECT:HordeIsengardFighterUrukHauptmannCombo
    DisplayNameStrategic         = CONTROLBAR:LW_Unit_IsengardFighterIsengardUrukHauptmannComboHorde
    DescriptionStrategic         = CONTROLBAR:LW_ToolTip_IsengardFighterIsengardUrukHauptmannComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY   NormalMeleeHordeRangefinder
        Weapon             = SECONDARY NormalMeleeHordeRangefinder
        AutoChooseSources  = SECONDARY NONE
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 1000
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKFIGHTER_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKFIGHTER_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%

    CommandPoints             = 55
    CommandSet             = IsengardFighterHauptmannComboHordeCommandSet

    CrushableLevel             = 0
    CrusherLevel             = 0

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE COMBO_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT

    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End
    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardUrukHauptmann 1
        InitialPayload             = IsengardFighter 15
        Slots                 = 16
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:1 Y:1


        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukHauptmann    Pos:X:50.0 Y:20.0


        RankInfo = RankNumber:1 UnitType:IsengardUrukHauptmann      Position:X:70 Y:0

        RankInfo = RankNumber:2 UnitType:IsengardFighter    Position:X:30 Y:0         Position:X:30 Y:20        Position:X:30 Y:-20        Position:X:30 Y:40         Position:X:30 Y:-40
        RankInfo = RankNumber:3 UnitType:IsengardFighter    Position:X:10 Y:0         Position:X:10 Y:20        Position:X:10 Y:-20        Position:X:10 Y:40         Position:X:10 Y:-40
        RankInfo = RankNumber:4 UnitType:IsengardFighter    Position:X:-10 Y:0        Position:X:-10 Y:20       Position:X:-10 Y:-20       Position:X:-10 Y:40        Position:X:-10 Y:-40

        RanksThatStopAdvance = 1
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4
        AttributeModifiers         = MeleeHauptmannComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.2
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
    End

    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange        = 15.0
        UnpackTime            = 1
        PreparationTime            = 20000
        PackTime            = 1
        DoCaptureFX            = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End



    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        Duration             = 20000
        AttributeModifier    = UrukHauptmannSchwertkampferBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = No
    End







    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object IsengardHauptmannCrossbowComboHorde

        SelectPortrait         = UPIsengard_Army
        ButtonImage            = WOR_UrukCrossbowmen

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUArc
        End
    End

    Side                 = Isengard
    EditorSorting             = UNIT
    EmotionRange             = 240
    DisplayName             = CONTROLBAR:HordeIsengardCrossbowIsengardUrukHauptmannCombo
    DisplayNameStrategic         = CONTROLBAR:LW_Unit_IsengardCrossbowIsengardUrukHauptmannComboHorde
    DescriptionStrategic         = CONTROLBAR:LW_ToolTip_IsengardCrossbowIsengardUrukHauptmannComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY    IsengardArcherHordeRangeFinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 1000
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKCROSSBOW_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKCROSSBOW_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%

    CommandPoints             = 55
    CommandSet             = IsengardMeleeRangeHauptmannComboHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0
    UseCrushAttack             = No

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER CAN_USE_SIEGE_TOWER COMBO_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_URUKCROSSBOW_HORDE_THREAT

    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                = IsengardArcherFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardUrukHauptmann 1
        InitialPayload             = IsengardUrukCrossbow 15
        Slots                 = 16
        PassengerFilter         = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes


        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardUrukHauptmann        Pos:X:50.0 Y:20.0


        RankInfo = RankNumber:1 UnitType:IsengardUrukHauptmann      Position:X:70 Y:0

        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow    Position:X:30 Y:0          Position:X:30 Y:20        Position:X:30 Y:-20         Position:X:30 Y:40         Position:X:30 Y:-40
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow    Position:X:10 Y:0          Position:X:10 Y:20        Position:X:10 Y:-20         Position:X:10 Y:40         Position:X:10 Y:-40
        RankInfo = RankNumber:4 UnitType:IsengardUrukCrossbow    Position:X:-10 Y:0         Position:X:-10 Y:20       Position:X:-10 Y:-20        Position:X:-10 Y:40        Position:X:-10 Y:-40




        RanksThatStopAdvance = 2
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4

        AttributeModifiers         = MeleeHauptmannComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End


    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                            = OCL_UrukCrossbowLongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No



        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No




        ApproachRequiresLOS        = No
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_SteelBoltArrows
End


Object IsengardFighterHordeForHauptmannSummon

    ButtonImage        = WOR_UrukWarriors
    SelectPortrait     = UPUrukhainew

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUHai
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardFighterUrukHauptmannCombo
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardFighterHordeForHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
        AutoChooseSources = QUATERNARY NONE
    End

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = ISENGARD_URUKFIGHTER_SHROUD_RANGE
    VisionRange         = ISENGARD_URUKFIGHTER_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints        = 45
    CrushableLevel       = 0
    CrusherLevel         = 0

    CommandSet           = IsengardUrukHauptmannForSummonFighterHordeCommandSet

    FormationWidth       = 2
    FormationDepth       = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_FIGHTER_HORDE_THREAT
    ThreatBreakdown IsengardFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry

    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardFighter 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = IsengardUrukHauptmannForSummonBanner
        BannerCarrierPosition    = UnitType:IsengardFighter    Pos:X:75.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No

        RankInfo = RankNumber:1 UnitType:IsengardFighter Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1
        LivingWorldOverloadTemplate = IsengardUrukHauptmannForSummon

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime    = 1
        BackUpMaxDelayTime    = 3000
        BackUpMinDistance    = 1
        BackUpMaxDistance    = 3
        BackupPercentage    = 80%
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"



    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HauptmannPowerEnabler
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        TriggeredBy          = Upgrade_AllFactionUpgrade
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        Duration             = 20000
        AttributeModifier    = UrukHauptmannSchwertkampferBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End






    Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardFighterArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object IsengardCrossbowHordeForHauptmannSummon

    ButtonImage        = WOR_UrukCrossbowmen
    SelectPortrait    = UPIsenguard_UrukCrossbow

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUArc
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardCrossbowUrukHauptmannCombo
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardCrossbowHordeForHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardUrukCrossbowHorde

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    IsengardArcherHordeRangeFinder
        Weapon            = SECONDARY  IsengardArcherHordeRangeFinder
        Weapon            = TERTIARY   IsengardArcherHordeRangeFinderBombard
        AutoChooseSources = SECONDARY  NONE
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 600
    BuildTime         = MEDIUM_BUILDTIME

    VisionRange         = ISENGARD_URUKCROSSBOW_HORDE_VISION_RANGE
    ShroudClearingRange     = ISENGARD_URUKCROSSBOW_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    UseCrushAttack         = No
    CommandPoints         = 45


    CommandSet = IsengardUrukHauptmannForSummonCrossbowHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY ARCHER HORDE CAN_USE_SIEGE_TOWER ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_URUKCROSSBOW_HORDE_THREAT
    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = IsengardArcherFunctions
        AttackPriority                =     AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardUrukCrossbow 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardUrukHauptmannForSummonBanner
        BannerCarrierPosition    = UnitType:IsengardUrukCrossbow    Pos:X:75.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No


        RankInfo = RankNumber:1 UnitType:IsengardUrukCrossbow Position:X:50 Y:0        Position:X:50 Y:22        Position:X:50 Y:-22        Position:X:50 Y:44        Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        LivingWorldOverloadTemplate = IsengardUrukHauptmannForSummon
        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End




    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End


    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End


    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                            = OCL_UrukCrossbowLongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No



        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No




        ApproachRequiresLOS        = No
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_SteelBoltArrows Upgrade_HeavyArmor
End


Object IsengardPikemanHordeForHauptmannSummon

    ButtonImage        = WOR_UrukPikemen
    SelectPortrait    = UPUrukhaiPikemen

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardPikemanUrukHauptmannCombo
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardPikemanHordeForHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardPikemanHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    TowerGuardHordeRangefinder
        Weapon     = SECONDARY   NormalMeleeHordeRangefinder
        AutoChooseSources = SECONDARY NONE
    End

    BuildCost         = 550
    BuildTime         = MEDIUM_BUILDTIME


    VisionRange         = ISENGARD_URUKPIKEMAN_HORDE_VISION_RANGE
    ShroudClearingRange     = ISENGARD_URUKPIKEMAN_SHROUD_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 45

    CommandSet          = IsengardUrukHauptmannForSummonPikemanHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = ISENGARD_PIKEMAN_HORDE_THREAT
    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardPikeman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardUrukHauptmannForSummonBanner
        BannerCarrierPosition    = UnitType:IsengardPikeman   Pos:X:75.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No


        RankInfo = RankNumber:1 UnitType:IsengardPikeman Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:IsengardPikeman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardPikeman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:22 Leader 2 1    Position:X:10 Y:-22 Leader 2 2    Position:X:10 Y:44 Leader 2 3    Position:X:10 Y:-44 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        LivingWorldOverloadTemplate = IsengardUrukHauptmannForSummon
        MeleeAttackLeashDistance = 1                .
    End







    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End



    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter        = ALL
        ExperienceModifier    = 1.1
        InitiateVoice        = UrukWarriorVoiceJoinOrcsMS
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HauptmannPowerEnabler
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannLanzentrager
        TriggeredBy          = Upgrade_AllFactionUpgrade
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_HauptmannPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannLanzentrager
        Duration             = 20000
        AttributeModifier    = UrukHauptmannLanzentragerBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_IsengardPikemanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardPikemanArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object IsengardBergwargreiterHorde

    ButtonImage        = WOR_WargRiders
    SelectPortrait    = UPIsenguard_WargRiders

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardBergwargreiterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardBergwargreiterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWargRiderHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End



    BuildCost           = 600
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 60

    CommandSet            = BergwargreiterHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 125
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargRider_Bergwargreiter  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner_Bergwargreiter
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = IsengardWargRiderBanner_Bergwargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Bergwargreiter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Bergwargreiter Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Bergwargreiter Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargRider_Bergwargreiter Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation = IsengardBergwargreiterHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl

        AttributeModifierAffectsSelf = Yes

        AttributeModifierFX = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject IsengardBergwargreiterHordeWedgeFormation IsengardBergwargreiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsengardWargRider_Bergwargreiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +IsengardWargRiderBanner_Bergwargreiter
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardWargRiderBanner_Bergwargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Bergwargreiter    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Bergwargreiter  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Bergwargreiter  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsengardBergwargreiterHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


Object IsengardZuchtwargreiterHorde

    ButtonImage       = WOR_WargRiders
    SelectPortrait    = UPIsenguard_WargRiders

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardZuchtwargreiterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardZuchtwargreiterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWargRiderHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End



    BuildCost           = 650
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 60

    CommandSet            = ZuchtwargreiterHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargRider_Zuchtwargreiter  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner_Zuchtwargreiter
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = IsengardWargRiderBanner_Zuchtwargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Bergwargreiter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Zuchtwargreiter Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Zuchtwargreiter Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargRider_Zuchtwargreiter Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation = IsengardZuchtwargreiterHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl

        AttributeModifierAffectsSelf = Yes

        AttributeModifierFX = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject IsengardZuchtwargreiterHordeWedgeFormation IsengardZuchtwargreiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsengardWargRider_Zuchtwargreiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +IsengardWargRiderBanner_Zuchtwargreiter
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardWargRiderBanner_Zuchtwargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Zuchtwargreiter    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Zuchtwargreiter  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Zuchtwargreiter  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsengardZuchtwargreiterHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

Object IsengardSharkuswargreiterHorde

    ButtonImage       = WOR_WargRiders
    SelectPortrait    = UPIsenguard_WargRiders

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardSharkuswargreiterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardSharkuswargreiterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWargRiderHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
        Weapon     = SECONDARY  NormalMissileHordeRangefinder
    End

    BuildCost           = 700
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide          = 50%
    VisionRear          = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints         = 60

    CommandSet            = ZuchtwargreiterHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel           = 2
    CrusherLevel             = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback           = 40
    CrushZFactor             = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 175
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =    CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = IsengardWargRider_Sharkuswargreiter  10
        Slots                   = 10
        PassengerFilter         = NONE +CAVALRY +IsengardWargRiderBanner_Sharkuswargreiter
        ShowPips                = No
        RandomOffset            = X:2 y:3
        MeleeBehavior           = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed    = IsengardWargRiderBanner_Sharkuswargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Sharkuswargreiter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Sharkuswargreiter Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Sharkuswargreiter Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargRider_Sharkuswargreiter Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        AlternateFormation          = IsengardSharkuswargreiterHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate         = SpecialAbilityWargHowl
        UpdateModuleStartsAttack     = No
        AttributeModifier            = IsengardWargHowl
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject IsengardSharkuswargreiterHordeWedgeFormation IsengardSharkuswargreiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsengardWargRider_Sharkuswargreiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +IsengardWargRiderBanner_Sharkuswargreiter
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = IsengardWargRiderBanner_Sharkuswargreiter
        BannerCarrierPosition    = UnitType:IsengardWargRider_Sharkuswargreiter   Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargRider_Sharkuswargreiter  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardWargRider_Sharkuswargreiter  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsengardSharkuswargreiterHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


Object IsengardWargBowHorde

    ButtonImage    = HIWargBow_Wotr
    SelectPortrait = UPWargBow

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardWargBowHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardWargBowHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardWargBowHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End



    BuildCost         = 650
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange     = 450


    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 60

    CommandSet            = WargBowHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUPPORT

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargBow  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = IsengardWargRiderBanner
        BannerCarrierPosition    = UnitType:IsengardWargBow    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardWargBow Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargBow Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargBow Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate      = SpecialAbilityWargHowl
        UpdateModuleStartsAttack  = No
        AttributeModifier = IsengardWargHowl

        AttributeModifierAffectsSelf = Yes

        AttributeModifierFX = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_SteelBoltArrows Upgrade_HeavyArmor
End

ChildObject IsengardWargBowHorde_Summoned IsengardWargBowHorde

    IsTrainable = No
    CommandPoints = 0
    CommandSet = WargBowHordeCommandSet_Summoned
    EquivalentTo = IsengardWargBowHorde
    KindOf                = +SUMMONED


    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = IsengardWargBow_Summoned 10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +IsengardWargRiderBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:IsengardWargBow_Summoned Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:IsengardWargBow_Summoned Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:IsengardWargBow_Summoned Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType        = FADED
    End
End

Object IsengardOrcHorde

    SelectPortrait = UPIsenguard_OrcLaborer
    ButtonImage    = HIIsengardOrcHorde_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeIsengardOrc
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_IsengardOrcHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorFighterHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 50
    BuildTime         = VERYWEAK_BUILDTIME
    VisionRange         = 200
    ShroudClearingRange = 250
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 30
    CommandSet         = IsengardOrkHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardOrc 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER +IsengardGasthausBannerOrc
        ShowPips         = No


        BannerCarriersAllowed    = IsengardGasthausBannerOrc
        BannerCarrierPosition    = UnitType:IsengardOrc    Pos:X:70.0 Y:0.0

        RandomOffset        = X:5 Y:3

        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardOrc Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardOrc Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardOrc Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier        = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =    0.0002%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsengardOrcHordeFree IsengardOrcHorde
    BuildCost = 0
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
End


Object IsengardDeserteureHorde

    ButtonImage       = WOR_GondorTowerGuard
    SelectPortrait    = UPGondor_TowerGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardDeserteure
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardDeserteureHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardDeserteureHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End



    BuildCost             = 430
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = GONDOR_TOWERGUARD_HORDE_VISION_RANGE
    ShroudClearingRange         = GONDOR_TOWERGUARD_HORDE_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
    CommandPoints             = 45

    CommandSet = IsengardDeserteureHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        =    500
        MaxCowerTime            =    5000
        MinCowerTime            =    3000
        AILuaEventsList            =    InfantryFunctions
        AttackPriority            =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardDeserteure 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY +IsengardBannerOrc
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus    = 30.0
            AngleLimitCos    = -0.17
            InnerRange    = 30
            OuterRange    = 80
            OuterRangeBuildings    = 140
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardDeserteure    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardDeserteure Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardDeserteure Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardDeserteure Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = IsengardDeserteureHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End


End

ChildObject IsengardDeserteureHordePorcupine IsengardDeserteureHorde



    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay            = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IsengardDeserteure GOOD_MEN_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IsengardDeserteureHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = IsengardBannerOrc
        BannerCarrierPosition            = UnitType:IsengardDeserteure    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:IsengardDeserteure Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End

Object WildSklavenHorde


    ButtonImage       = HSWildSklaven
    SelectPortrait    = UPWildSklaven

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUDFG
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeWildSklaven
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeWildSklaven
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeWildSklaven

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 80
    BuildTime = VERYWEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 0

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK LARGE_RECTANGLE_PATHFIND IGNORES_SELECT_ALL

    ThreatLevel = DWARVEN_GUARDIAN_HORDE_THREAT
    ThreatBreakdown DwarvenGuardianHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000

        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                = WildSklaven 15
        Slots                    = 15
        PassengerFilter                = NONE +INFANTRY
        ShowPips                = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:WildSklaven Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:WildSklaven Position:X:15 Y:0 		    Position:X:10 Y:20  	    Position:X:10 Y:-20		     Position:X:15 Y:40 	     Position:X:15 Y:-40
        RankInfo = RankNumber:3 UnitType:WildSklaven Position:X:-5 Y:0	   	    Position:X:-10 Y:20 	    Position:X:-10 Y:-20	     Position:X:0 Y:40     	     Position:X:0 Y:-40

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 60.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base

         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
         QuarrelProbability    =  0.5%
         AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End







    Behavior = SpecialPowerModule ModuleTag_TunnelDummy
        SpecialPowerTemplate            = SpecialAbilityTunnelbesetzen
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityTunnelbesetzen
        StartAbilityRange               = 30
        TriggerSpecialPower             = ModuleTag_TunnelSpecialPower    TARGETPOS
        TriggerSpecialPower             = ModuleTag_SpecialAbilityTunnel  TARGETPOS
    End

    Behavior                            = OCLSpecialPower ModuleTag_TunnelSpecialPower
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        OCL                             = OCL_SklavenTunnelbesetzen
        TriggerFX                       = FX_Tunnelbesetzen
        CreateLocation                  = CREATE_AT_LOCATION
        StartsPaused                    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_SpecialAbilityTunnel
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        AttributeModifier               = SklavenTunnelbesetzenModifier
        AttributeModifierRange          = 55
        TriggerFX                       = FX_Industry
        AttributeModifierAffects        = INDUSTRY_TYPE_SPELL_OBJECT_FILTER
    End



    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 35
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = 35
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    CommandSet = WildSklavenHordeCommandSet





    Behavior = AISpecialPowerUpdate DwarvenGuardianHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenGuardianArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenGuardianWeapon
    End

End

ChildObject WildSklavenHordeFree WildSklavenHorde
    BuildCost = 0
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
End


Object IsengardManSlayerHorde

	ButtonImage    = UIIsenDB
	SelectPortrait = UPIsenDeathbringernew

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUHai
		End
	End

	Side 			= Isengard
	EditorSorting 		= UNIT
	EmotionRange 		= 240
	DisplayName 		= OBJECT:HordeIsengardManSlayer
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_IsengardManSlayerHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_IsengardManSlayerHorde

	WeaponSet
		Conditions 	= None
		Weapon 		= PRIMARY    NormalMeleeHordeRangefinder
	End

	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon 		= PRIMARY	NormalMeleeHordeRangefinder
		Weapon 		= SECONDARY	NormalMeleeHordeRangefinder
		OnlyAgainst 	= SECONDARY MINE
	End

	BuildCost 		= 1200
	BuildTime 		= ELITE_BUILDTIME

	ShroudClearingRange 	= ISENGARD_FANATIC_SHROUD_RANGE
	VisionRange 		= ISENGARD_FANATIC_HORDE_VISION_RANGE

	VisionSide 		= 50%
	VisionRear 		= 25%

	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%

	MaxSimultaneousOfType	= 3

	CommandPoints 		= 60
	CrushableLevel 		= 0
	CrusherLevel 		= 0

	CommandSet 		= IsengardManSlayerHordeCommandSet

	TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE MELEE_HORDE URUK LARGE_RECTANGLE_PATHFIND ARMY_SUMMARY

	ThreatLevel = ISENGARD_BERSERKER_HORDE_THREAT
	ThreatBreakdown IsengardFighterHorde_DetailedThreat
		AIKindOf = INFANTRY
	End

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End


	Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
		SpecialPowerTemplate = SpecialAbilitySiegeDeploy
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        	StanceTemplate = FighterHorde
    	End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
        	AILuaEventsList			= InfantryFunctions
       	 	AttackPriority			= AttackPriority_Infantry
	End

	Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
		ObjectStatusOfContained 	=
		InitialPayload 			= IsengardManSlayer 3
		Slots 				= 3
		PassengerFilter			= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes
		RandomOffset			= X:3 Y:3
		MeleeBehavior 			= Amoeba
		End

		RankInfo = RankNumber:1 UnitType:IsengardManSlayer 	Position:X:40 Y:0	Position:X:50 Y:20	Position:X:50 Y:-20

		RanksToReleaseWhenAttacking = 1

		MeleeAttackLeashDistance = 50
		BackUpMinDelayTime	 = 1
		BackUpMaxDelayTime	 = 3000
		BackUpMinDistance	 = 1
		BackUpMaxDistance	 = 3
		BackupPercentage	 = 80%

	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base_Evil
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base

		AddEmotion			=	OVERRIDE Taunt_Base

 		End

		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
	End

	#include "..\..\..\includes\CaptureBuilding.inc"

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
		UpgradeRequired		= Upgrade_EliteHordeLvl1
		IdleSpawnRate		= 30000
		UnitSpawnFX		= FX_BannerCarrierSpawnUnit
		ReplenishNearbyHorde	= Yes
		ScanHordeDistance	= 0
	End

	Behavior = AutoHealBehavior ModuleTag_ManSlayerHealing
		StartsActive		= Yes
		HealingAmount		= HERO_HEAL_AMOUNT
		HealingDelay		= 1000
		StartHealingDelay	= HERO_HEAL_DELAY
		HealOnlyIfNotInCombat	= Yes
	End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GoblinKingLeadershipUnpause2
		SpecialPowerTemplate = SpecialAbilityFakeLeadership2
		TriggeredBy 	     = Upgrade_EliteHordeLvl7
	End

	Behavior = SpecialPowerModule ModuleTag_GoblinKingLeadershipPower2
		SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
		UpdateModuleStartsAttack  = No
		StartsPaused 	 	  = Yes
	End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
		SpecialPowerTemplate = SpecialAbilityFanaticHeroMode
		TriggeredBy 	     = Upgrade_EliteHordeLvl4
	End

	Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
		SpecialPowerTemplate	= SpecialAbilityFanaticHeroMode
		Duration		= 20000
		AttributeModifier	= ManSlayerDeathWish
		StartsPaused		= Yes
	End

	Behavior = AutoAbilityBehavior ModuleTag_BladeOfPurityAutoAbility
		SpecialAbility		= SpecialAbilityFanaticHeroMode
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= 200
		Query			= 1 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL
	End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
		SpecialPowerTemplate = SpecialAbilityStoneWall
		TriggeredBy 	     = Upgrade_EliteHordeLvl1
	End

	Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
		SpecialPowerTemplate      = SpecialAbilityStoneWall
		UpdateModuleStartsAttack  = No
		StartsPaused 		  = Yes
	End


	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = ANY +CRATE -TheDroppedRing
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End





	Behavior = AISpecialPowerUpdate IsengardFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate StoneWallAI
		CommandButtonName = Command_SpecialAbilityStoneWallManSlayer
		SpecialPowerAIType =  AI_SPECIAL_POWER_BASIC_SELF_BUFF
	End

	Behavior = AISpecialPowerUpdate AragornBladeMasterAI
		CommandButtonName = Command_SpecialAbilityDeathWishManSlayer
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
	End

	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 45.0
	GeometryHeight = 20.0
	GeometryIsSmall = No



	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_IsengardFanaticHordeBody

	AutoResolveArmor
		Armor = AutoResolve_IsengardFanaticArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_IsengardFanaticWeapon
	End
End

Object IsengardorcfighterHorde

    ButtonImage        = BIIsengardOrcFighter
    SelectPortrait     = UPIsengardOrcFighter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side             	= Isengard
    EditorSorting       = UNIT
    EmotionRange        = 240
    DisplayName         = OBJECT:HordeIsengardOrcs
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_IsengardOrcFighterHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_IsengardOrcFighterHorde

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 0
    BuildTime             = VERYWEAK_BUILDTIME
    ShroudClearingRange   = 250
    VisionRange           = 200
    VisionSide            = 50%
    VisionRear            = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel        = 0
    CrusherLevel          = 0
    CommandPoints         = 30
    CommandSet            = IsengardorcfighterHordeCommandSet
    FormationWidth        = 2
    FormationDepth        = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        AILuaEventsList              = InfantryFunctions
        MaxCowerTime                 = 5000
        MinCowerTime                 = 3000
        AttackPriority               = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IsengardOrcFighter 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed = IsengardBannerOrc
        BannerCarrierPosition = UnitType:IsengardOrcFighter Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsengardOrcFighter Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardOrcFighter Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardOrcFighter Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter          = ALL
        ExperienceModifier       = 1.95
        InitiateVoice            = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base
         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        QuarrelProbability    =  0.5%
        AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject IsengardorcfighterHorde_Summoned IsengardorcfighterHorde
    IsTrainable    = No
    CommandPoints     = 0
    CommandSet    = IsengardorcfighterCommandSet_Summoned
    EquivalentTo      = IsengardorcfighterHorde

    KindOf = SUMMONED SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    DisplayName     = OBJECT:HordeIsengardOrcs

    Behavior     = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = IsengardOrcFighter_Summoned 15
        Slots         = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips     = No

        RandomOffset    = X:3 Y:3

        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardOrcFighter_Summoned Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardOrcFighter_Summoned Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardOrcFighter_Summoned Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object  IsengardMauhurHorde

    ButtonImage             = HIMauhur
    SelectPortrait          = HPMauhur

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUArc
        End
    End

    Side = Isengard
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:IsengardMauhur
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsengardMauhur
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_IsengardMauhur

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    IsengardArcherHordeRangeFinder
   End

    BuildCost         = 2000
    BuildTime         = MAUHUR_BUILDTIME

    VisionRange = VISION_HERO_RANGED
    ShroudClearingRange = SHROUD_CLEAR_RANGED_HERO

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    UseCrushAttack         = No
    CommandSet = MauhurHordeCommandSet
    CommandPoints = 15
    MaxSimultaneousOfType = 1

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY ARCHER HORDE CAN_USE_SIEGE_TOWER ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_URUKCROSSBOW_HORDE_THREAT
    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardMauhurMember 1
        Slots = 1
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardMauhurMember Position:X:0 Y:0

        ComboHorde = Target:IsengardUrukCrossbowHorde             Result:IsengardMauhurComboHorde        InitiateVoice:UrukWarriorVoiceJoin

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LeadershipUnpause
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End
    Behavior = SpecialPowerModule ModuleTag_Leadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_LeadershipUpdate
        StartsActive     = No
        BonusName        = MauhurLeadership
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = NONE +IsengardUrukCrossbow +IsengardMauhurMember ALLIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseWoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        TriggeredBy                 = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_WoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        SkipContinue                = Yes
        UnpackTime                  = 2000
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = FARAMIR_WOUNDING_ARROW_RANGE
        ApproachRequiresLOS         = Yes
        SpecialWeapon               = MauhurHarterBolzen
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoundArrowAutoAbility
        SpecialAbility              = SpecialAbilityWoundArrow
	ForbiddenStatus 	    = INSIDE_GARRISON
        MaxScanRange                = FARAMIR_WOUNDING_ARROW_RANGE
        Query                       = 1 ANY +MONSTER +HERO +AngmarThrallMaster +AngmarThrallMasterBanner +AngmarThrallMasterAxeBanner +AngmarThrallMasterWolfBanner +AngmarNecromancerBanner +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir +GondorGwaihir_Summoned +ElvenFortressEagle +KhamulFellBeast +MorgomirFellBeast +Drogoth +Drogoth ENEMIES
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UglukBerserkerCarnage
        SpecialPowerTemplate = SpecialAbilityUglukBerserker
        TriggeredBy          = Upgrade_Level_3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_UglukBerserkerPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUglukBerserker
        Duration             = 20000
        AttributeModifier    = MauhurSchutze
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End







	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler2
		SpecialPowerTemplate = SpecialAbilityMauhurHeadHunt
		TriggeredBy = Upgrade_Level_7
	End

	Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate2
		SpecialPowerTemplate      = SpecialAbilityMauhurHeadHunt
		UpdateModuleStartsAttack  = Yes
		StartsPaused              = Yes
		AttributeModifier         = HeadHunt
		AttributeModifierRange    = 225
		AttributeModifierAffectsSelf = Yes
		AttributeModifierAffects  = ANY +URUK -HERO
		AttributeModifierFX       = FX_UglukHeadhunt
	End

	Behavior = AutoAbilityBehavior ModuleTag_GloriousChargeAutoAbility2
		SpecialAbility	= SpecialAbilityMauhurHeadHunt
		ForbiddenStatus = INSIDE_GARRISON
		MaxScanRange	= 200
		Query		= 20 ANY +URUK -HERO ALLIES
	End

	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_GloriousChargeAnimation2
		SpecialPowerTemplate	= SpecialAbilityMauhurHeadHunt
		HeroEffectDuration	= 25000
		UnpackTime              = 1000
		UnpackingVariation	= 2
 		PreparationTime         = 0
 		PersistentPrepTime      = 0
 		PackTime                = 1330
 	End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GoblinKingLeadershipUnpause2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GoblinKingLeadershipPower2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_GoblinKingLeadershipUpdate2
        StartsActive    = No
        BonusName       = MauhurAuge
        TriggeredBy     = Upgrade_Level_7
        RefreshDelay    = 2000
        Range           = 1
        AllowSelf       = Yes

        ObjectFilter    = NONE +IsengardMauhurMember
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainSummonEnabler
        SpecialPowerTemplate = SpecialAbilityDainSummonRoyalGuard
        TriggeredBy = Upgrade_Level_10
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        SpecialPowerTemplate    = SpecialAbilityDainSummonRoyalGuard
        OCL                     = OCL_MauhurUruksEgg
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes


    End


    #include "..\..\..\includes\CaptureBuilding.inc"




    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate CarnageAI2
	CommandButtonName = Command_SpecialAbilityMauhurHeadHunt
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_SteelBoltArrows Upgrade_HeavyArmor
End




Object IsengardMauhurComboHorde
        SelectPortrait         = UPIsengard_Army
        ButtonImage            = WOR_UrukCrossbowmen

    Draw                 = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags    = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model        = None
        End
        ModelConditionState = HORDE_EMPTY
            Model        = None
        End

        ModelConditionState = WORLD_BUILDER
            Model        = HordeMarkIUArc
        End
    End

    Side                  = Isengard
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = CONTROLBAR:IsengardMauhurComboHorde
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_IsengardMauhurComboHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_IsengardMauhurComboHorde

    WeaponSet
        Conditions         = None
        Weapon             = PRIMARY    IsengardArcherHordeRangeFinder
        Weapon             = SECONDARY  IsengardArcherHordeRangeFinder
        AutoChooseSources  = SECONDARY  NONE
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = ISENGARD_URUKCROSSBOW_BUILDCOST
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange            = ISENGARD_URUKCROSSBOW_HORDE_VISION_RANGE
    ShroudClearingRange         = ISENGARD_URUKCROSSBOW_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1%
    MaxSimultaneousOfType = 1

    CommandPoints             = 60
    CommandSet             = MauhurComboHordeCommandSet

     CrushableLevel             = 0
    CrusherLevel             = 0
    UseCrushAttack             = No

    FormationWidth             = 2
    FormationDepth             = 2

     TransportSlotCount         = TRANSPORTSLOTCOUNT_LARGE_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER CAN_USE_SIEGE_TOWER COMBO_HORDE ARMY_SUMMARY URUK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_URUKCROSSBOW_HORDE_THREAT

    ThreatBreakdown IsengardUrukCrossbowHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate                = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = IsengardMauhurMember 1
        InitialPayload             = IsengardUrukCrossbow 15
        Slots                 = 16
        PassengerFilter         = NONE +INFANTRY +HERO
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RankSplit            = Yes
        SplitHordeNumber        = 15
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = IsengardBannerOrc
        BannerCarrierPosition    = UnitType:IsengardMauhurMember        Pos:X:50.0 Y:20.0         for fighter horde


        RankInfo = RankNumber:1 UnitType:IsengardMauhurMember      Position:X:70 Y:0

        RankInfo = RankNumber:2 UnitType:IsengardUrukCrossbow    Position:X:30 Y:0          Position:X:30 Y:20        Position:X:30 Y:-20         Position:X:30 Y:40         Position:X:30 Y:-40
        RankInfo = RankNumber:3 UnitType:IsengardUrukCrossbow    Position:X:10 Y:0          Position:X:10 Y:20        Position:X:10 Y:-20         Position:X:10 Y:40         Position:X:10 Y:-40
        RankInfo = RankNumber:4 UnitType:IsengardUrukCrossbow    Position:X:-10 Y:0         Position:X:-10 Y:20       Position:X:-10 Y:-20        Position:X:-10 Y:40        Position:X:-10 Y:-40

        SplitHorde = SplitResult:IsengardMauhurHorde    UnitType:IsengardMauhurMember
        SplitHorde = SplitResult:IsengardUrukCrossbowHorde    UnitType:IsengardUrukCrossbow

        RanksThatStopAdvance = 2
        MeleeAttackLeashDistance = 1
        RanksToReleaseWhenAttacking = 1 2 3 4
        RanksToJustFreeWhenAttacking = 1 2 3 4

        AttributeModifiers         = MeleeHauptmannComboHorde
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
        SpecialPowerTemplate      = SpecialAbilitySplitHorde
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base


         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LeadershipUnpause
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                    = Upgrade_Level_1
    End
    Behavior = SpecialPowerModule ModuleTag_Leadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_LeadershipUpdate
        StartsActive    = No
        BonusName       = MauhurLeadership
        TriggeredBy     = Upgrade_Level_1
        RefreshDelay    = 2000
        Range           = 200
        ObjectFilter    = NONE +IsengardUrukCrossbow +IsengardMauhurMember ALLIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseWoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        TriggeredBy                 = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_WoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        UpdateModuleStartsAttack    = Yes

        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        SkipContinue                = Yes
        UnpackTime                  = 2000
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = #SUBTRACT( FARAMIR_WOUNDING_ARROW_RANGE 25 )
        ApproachRequiresLOS         = Yes
        SpecialWeapon               = MauhurHarterBolzen
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoundArrowAutoAbility
        SpecialAbility              = SpecialAbilityWoundArrow
	ForbiddenStatus 	    = INSIDE_GARRISON
        MaxScanRange                = FARAMIR_WOUNDING_ARROW_RANGE
        Query                       = 1 ANY +MONSTER +HERO +AngmarThrallMaster +AngmarThrallMasterBanner +AngmarThrallMasterAxeBanner +AngmarThrallMasterWolfBanner +AngmarNecromancerBanner +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir +GondorGwaihir_Summoned +ElvenFortressEagle +KhamulFellBeast +MorgomirFellBeast +Drogoth +Drogoth ENEMIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UglukBerserkerCarnage
        SpecialPowerTemplate = SpecialAbilityUglukBerserker
        TriggeredBy          = Upgrade_Level_3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_UglukBerserkerPowerUpdate
        SpecialPowerTemplate = SpecialAbilityUglukBerserker
        Duration             = 20000
        AttributeModifier    = MauhurSchutze
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End







	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler2
		SpecialPowerTemplate = SpecialAbilityMauhurHeadHunt
		TriggeredBy = Upgrade_Level_7
	End

	Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate2
		SpecialPowerTemplate      = SpecialAbilityMauhurHeadHunt
		UpdateModuleStartsAttack  = Yes
		StartsPaused              = Yes
		AttributeModifier         = HeadHunt
		AttributeModifierRange    = 225
		AttributeModifierAffectsSelf = Yes
		AttributeModifierAffects  = ANY +URUK -HERO
		AttributeModifierFX       = FX_UglukHeadhunt
	End

	Behavior = AutoAbilityBehavior ModuleTag_GloriousChargeAutoAbility2
		SpecialAbility	= SpecialAbilityMauhurHeadHunt
		ForbiddenStatus = INSIDE_GARRISON
		MaxScanRange	= 200
		Query		= 20 ANY +URUK -HERO ALLIES
	End

	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_GloriousChargeAnimation2
		SpecialPowerTemplate	= SpecialAbilityMauhurHeadHunt
		HeroEffectDuration	= 25000
		UnpackTime              = 1000
		UnpackingVariation	= 2
 		PreparationTime         = 0
 		PersistentPrepTime      = 0
 		PackTime                = 1330
 	End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GoblinKingLeadershipUnpause2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_GoblinKingLeadershipPower2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_GoblinKingLeadershipUpdate2
        StartsActive    = No
        BonusName       = MauhurAuge
        TriggeredBy     = Upgrade_Level_7
        RefreshDelay    = 2000
        Range           = 1
        AllowSelf       = Yes
        ObjectFilter    = NONE +IsengardMauhurMember
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainSummonEnabler
        SpecialPowerTemplate = SpecialAbilityDainSummonRoyalGuard
        TriggeredBy = Upgrade_Level_10
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        SpecialPowerTemplate    = SpecialAbilityDainSummonRoyalGuard
        OCL                     = OCL_MauhurUruksEgg
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_SteelBoltArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate IsengardUrukCrossbowHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate CarnageAI2
	CommandButtonName = Command_SpecialAbilityMauhurHeadHunt
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_IsengardUrukCrossbowHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardUrukCrossbowArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_SteelBoltArrows
        Weapon = AutoResolve_IsengardUrukCrossbowWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_SteelBoltArrows
End

