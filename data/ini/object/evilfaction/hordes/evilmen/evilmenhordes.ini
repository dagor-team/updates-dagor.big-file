Object MordorEasterlingHordeObsolete

	ButtonImage		= WOR_Easterling
	SelectPortrait	= UPMordor_Eastering

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkMUSol
		End
	End

	Side = Mordor
	EditorSorting = UNIT
	EmotionRange = 240
	TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	DisplayName = OBJECT:HordeMordorEasterlings

	WeaponSet
		Conditions = None
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End

	BuildCost = MORDOR_SOLDIERRHUN_BUILDCOST
	BuildTime = MEDIUM_BUILDTIME
	VisionRange = VISION_STANDARD_MELEE
	CrushableLevel = 0
	CrusherLevel = 0
	CommandPoints = 15
	CommandSet = MordorEasterlingHordeCommandSet

	FormationWidth = 2
	FormationDepth = 2

	TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

	ThreatLevel = MORDOR_EASTERLING_HORDE_THREAT
	ThreatBreakdown MordorEasterlingHorde_DetailedThreat
		AIKindOf = PIKEMAN
	End

	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		AILuaEventsList				=	InfantryFunctions
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AttackPriority				= 	AttackPriority_Spearman
	End



	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained =
		InitialPayload = MordorEasterling 15
		Slots = 15
		PassengerFilter	= NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes
		RandomOffset=X:0 Y:0
		MeleeBehavior = Amoeba
		End


		BannerCarriersAllowed	= MordorBannerOrc
		BannerCarrierPosition	= UnitType:MordorEasterling	Pos:X:50.0 Y:0.0


		RankInfo = RankNumber:1 UnitType:MordorEasterling Position:X:34 Y:0		Position:X:34 Y:15		Position:X:34 Y:-15		Position:X:34 Y:30		Position:X:34 Y:-30
		RankInfo = RankNumber:2 UnitType:MordorEasterling Position:X:22 Y:0 Leader 1 0	Position:X:22 Y:15 Leader 1 1	Position:X:22 Y:-15 Leader 1 2	Position:X:22 Y:30 Leader 1 3	Position:X:22 Y:-30 Leader 1 4
		RankInfo = RankNumber:3 UnitType:MordorEasterling Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:15 Leader 2 1	Position:X:10 Y:-15 Leader 2 2	Position:X:10 Y:30 Leader 2 3	Position:X:10 Y:-30 Leader 2 4

		RanksToReleaseWhenAttacking = 1

		AlternateFormation = GondorFighterHordeBlock
		MeleeAttackLeashDistance = 1
		BackUpMinDelayTime		= 1
		BackUpMaxDelayTime		= 3000
		BackUpMinDistance		= 1
		BackUpMaxDistance		= 3
		BackupPercentage		= 80%
	End



	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS
		TauntAndPointUpdateDelay	=	1000
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf				=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt						=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance			=	150
		FearScanDistance			=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base

		AddEmotion	=	OVERRIDE Taunt_Base

 		End

		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End


	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_BasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 35.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End



ChildObject MordorEasterlingPorcupineHorde MordorEasterlingHordeObsolete 


	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained =
		InitialPayload = MordorEasterling EVIL_MEN_NORMAL_HORDE_SIZE
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No

		ThisFormationIsTheMainFormation = No


		BannerCarriersAllowed	= MordorBannerOrc
		BannerCarrierPosition	= UnitType:MordorEasterling		Pos:X:20.0 Y:0.0

		RankInfo = RankNumber:1 UnitType:MordorEasterling Position:X:0	Y:20		Position:X:0	Y:0		Position:X:0	Y:-20
		RankInfo = RankNumber:2 UnitType:MordorEasterling Position:X:-20  Y:20		Position:X:-20	Y:-20

		RanksToReleaseWhenAttacking = 1 2
		AlternateFormation = MordorEasterlingHorde

		AttributeModifiers = MordorEasterlingHordePorcupineBonus
		UseSlowHordeMovement = Yes

	End
End

Object EvilmenHaradSwordHorde

    ButtonImage        = HSHaradSword
    SelectPortrait     = _uHaradFghtrPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    TransportSlotCount       = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName             = OBJECT:EvilmenHaradSwordHorde
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_EvilmenHaradSwordHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorEasterlingSwordHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange             = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 30
    CommandSet         = MordorHaradrimSchwerterCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel     = MORDOR_EASTERLING_HORDE_THREAT
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = EvilmenHaradSword 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        AlternateFormation = EvilmenHaradSwordHordeBlock

        RandomOffset        = X:2 Y:2
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:EvilmenHaradSword    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:EvilmenHaradSword Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:EvilmenHaradSword Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:EvilmenHaradSword Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base

        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base

         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality1
        TriggeredBy    = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy    = Upgrade_Shields
    End

    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End

ChildObject EvilmenHaradSwordHordeBlock EvilmenHaradSwordHorde

    // Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
    // Any modifications need to be done via the Attribute Modifiers in the contain module. 
    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = 270
        FlankedDelay = 2000
        ObjectStatusOfContained = 
        InitialPayload                  = EvilmenHaradSword 15
        Slots                           = 15
        PassengerFilter                 = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No    //Used to determine which armorset to use (and anything else we want!)
        AttributeModifiers              = ThalMarschformation
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End
       

        // Banner Carrier info        
        BannerCarriersAllowed    = HaradHaradrimBanner                                    // types of units that are allowed as banner carriers
        BannerCarrierPosition    = UnitType:EvilmenHaradSword Pos:X:46.0 Y:0.0        // (DEFAULT) position of banner carrier
               
        RankInfo = RankNumber:1 UnitType:EvilmenHaradSword Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:41 Y:-40 
        RankInfo = RankNumber:2 UnitType:EvilmenHaradSword Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:17 Y:-42 Leader 1 4
        RankInfo = RankNumber:3 UnitType:EvilmenHaradSword Position:X:-5 Y:0 Leader 2 0   Position:X:-12 Y:20 Leader 2 1  Position:X:-15 Y:-20 Leader 2 2  Position:X:-5 Y:40 Leader 2 3    Position:X:-8 Y:-38 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2
                
        AlternateFormation = EvilmenHaradSwordHorde
        MeleeAttackLeashDistance = 1   //How far the hordes    can    move from the center of    the    horde when melee attacking.                  
        BackUpMinDelayTime       = 1    //The minimum amount of    time to    delay before backing up
        BackUpMaxDelayTime       = 3000    //The maximum amount of    time to    delay before backing up
        BackUpMinDistance        = 1    //The minimum number of    cells to backup
        BackUpMaxDistance        = 3    //The maximum number of    cells to backup
        BackupPercentage         = 80%    //The amount of    chance that    a unit will    back up.        
    End
End


ChildObject EvilmenHaradSwordHorde_Summoned EvilmenHaradSwordHorde
    IsTrainable       = No
    CommandPoints     = 0
    CommandSet        = HaradrimSchwertkampferHordeCommandSet_Summoned
    EquivalentTo      = EvilmenHaradSwordHorde

    DisplayName  =  OBJECT:HordeHaradrimSchwertkampfer

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = EvilmenHaradSword_Summoned GOOD_MEN_GIANT_HORDE_SIZE
        Slots         = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:EvilmenHaradSword_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:EvilmenHaradSword_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:EvilmenHaradSword_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    KindOf              = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND SUMMONED

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

End

Object EvilmenKhandRiderHorde

    ButtonImage     = __uKhandreiterButton
    SelectPortrait  = _uHaradRtrBgPortrait


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End


    BuildCost = 600
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    CommandPoints = 40
    DisplayName = OBJECT:HordeKhandRider
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeKhandRider
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeThalReiter

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY ARCHER

    CommandSet = EvilmenKhandRiderHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY ARCHER

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = EvilmenKhandRider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = EvilmenRhunriderBanner
        BannerCarrierPosition    = UnitType:EvilmenKhandRider    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:EvilmenKhandRider  Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:EvilmenKhandRider  Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:EvilmenKhandRider  Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End


    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList             = CavalryFunctions
        AttackPriority              = AttackPriority_Cavalry
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End


    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorKnightArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorKnightWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

Object EvilmenKhandSoldierHorde

    ButtonImage            = HSKhandSoldier
    SelectPortrait         = UPKhandSoldier

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:EvilmenKhandSoldierHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_EvilmenKhandSoldierHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WachterderVesteHorde

   WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = EvilmenKhandSoldierHordeCommandSet






     CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = 800
    BuildTime = STRONG_BUILDTIME
    VisionRange = 370
    ShroudClearingRange = 161
    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE

    ThreatLevel = ELVEN_LORIENWARRIOR_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = EvilmenKhandSoldier 10
        Slots = 10
        PassengerFilter = NONE +EvilmenKhandSoldier
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = MordorBannerOrc
        BannerCarrierPosition    = UnitType:EvilmenKhandSoldier  Pos:X:40.0 Y:0.0     for elven warrior horde


        RankInfo = RankNumber:1 UnitType:EvilmenKhandSoldier Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:EvilmenKhandSoldier Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

     Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_FireArrows
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades
End

Object EvilmenRhunArcherHorde

    ButtonImage    = HSRhunArcher
    SelectPortrait = UPRhunArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUHLa
        End
    End

    Side                 = Mordor
    EditorSorting        = UNIT
    EmotionRange         = EMOTION_CHEER_RADIUS
    DisplayName          = OBJECT:EvilmenRhunArcherHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_EvilmenRhunArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_MordorHaradrimArcherHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    HaradrimArcherMissileHordeRangefinder
        Weapon        = TERTIARY   HaradrimArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = MORDOR_HARADRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange       = MORDOR_HARADRIM_SHROUD_RANGE

    VisionRange               = MORDOR_HARADRIM_HORDE_VISION_RANGE
    VisionSide                = 50%
    VisionRear                = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel        = 0
    CrusherLevel          = 0
    UseCrushAttack        = No
    CommandPoints         = 48
    CommandSet            = EvilmenRhunArcherHordeCommandSet
    FormationWidth        = 2
    FormationDepth        = 1

    TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = MORDOR_HARADRIM_ARCHER_HORDE_THREAT
    ThreatBreakdown MordorHaradrimArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate    = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Archer
        CanAttackWhileContained        = Yes
    End

    Behavior = HordeContain ModuleTag_HordeContainOverride
        ObjectStatusOfContained     =
        InitialPayload            = EvilmenRhunArcher 12
        Slots                = 12
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:2 Y:2
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:EvilmenRhunArcher        Pos:X:40.0 Y:0.0         for archer horde


        RandomOffset = X:0 Y:-12

        RankInfo = RankNumber:1 UnitType:EvilmenRhunArcher Position:X:0 Y:12    Position:X:0 Y:-12    Position:X:0 Y:-36    Position:X:0 Y:36    Position:X:0 Y:-60     Position:X:0 Y:60
        RankInfo = RankNumber:2 UnitType:EvilmenRhunArcher Position:X:20 Y:12    Position:X:15 Y:-12    Position:X:20 Y:-36    Position:X:20 Y:36    Position:X:20 Y:-60    Position:X:20 Y:60

        MeleeAttackLeashDistance    = 25
        RanksToReleaseWhenAttacking     = 1 2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap        = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy        = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy        = Upgrade_HeavyArmor
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate MordorHaradrimArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate BarbedArrowsAI
        CommandButtonName = Command_HaradrimArcherBarbedArrowAbility
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End




    Geometry        = BOX
    GeometryMajorRadius     = 15.0
    GeometryMinorRadius     = 65.0
    GeometryHeight        = 12.0
    GeometryIsSmall        = No

        Shadow            = SHADOW_DECAL
        ShadowSizeX        = 23
        ShadowSizeY        = 23
       ShadowTexture        = ShadowI



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorHaradrimArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorHaradrimArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_MordorHaradrimArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

Object EvilmenRhunriderHorde


    ButtonImage        = HSRhunrider
    SelectPortrait     = UPRhunrider

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Mordor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeEvilmenRhunrider
    DisplayNameStrategic = CONTROLBAR:LW_Unit_EvilmenRhunriderHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_EvilmenRhunriderHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = EvilmenRhunRiderHordeCommandSet





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = GONDOR_KNIGHT_BUILDCOST
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = GONDOR_KNIGHT_HORDE_VISION_RANGE
    VisionSide             = 35%
    VisionRear             = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot     = 5.0%
    ShroudClearingRange         = GONDOR_KNIGHT_HORDE_SHROUD_RANGE

    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_KNIGHT_HORDE_THREAT
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = EvilmenRhunrider GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +EvilmenRhunriderBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = EvilmenRhunriderBanner
        BannerCarrierPosition    = UnitType:EvilmenRhunrider    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:EvilmenRhunrider Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:EvilmenRhunrider Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = EvilmenRhunriderHordeLineFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End




    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion                =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End





ChildObject EvilmenRhunriderHordeLineFormation EvilmenRhunriderHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = EvilmenRhunrider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +EvilmenRhunriderBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = EvilmenRhunriderBanner
        BannerCarrierPosition    = UnitType:EvilmenRhunrider    Pos:X:30.0 Y:0.0         for archer horde

        RankInfo = RankNumber:1 UnitType:EvilmenRhunrider    Position:X:0 Y:20       Position:X:0 Y:-20      Position:X:0 Y:40       Position:X:0 Y:-40        Position:X:0 Y:60         Position:X:0 Y:-60       Position:X:0 Y:80        Position:X:0 Y:-80        Position:X:0 Y:100        Position:X:0 Y:-100

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = EvilmenRhunriderHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

Object MordorRhunSwordHorde

    ButtonImage       = HSRhunSchwert
    SelectPortrait    = UPRhunSchwert

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUSol
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    DisplayName         = OBJECT:HordeMordorEasterlingSword
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_MordorEasterlingSwordHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_MordorEasterlingSwordHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost = 800
    BuildTime = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_SOLDIERRHUN_SHROUD_RANGE
    VisionRange         = MORDOR_SOLDIERRHUN_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 40
    CommandSet         = MordorRhunSchwerterHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount     = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY CAN_USE_SIEGE_TOWER LARGE_RECTANGLE_PATHFIND

    ThreatLevel     = MORDOR_EASTERLING_HORDE_THREAT
    ThreatBreakdown MordorEasterlingHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"
    #include "..\..\..\includes\CaptureBuilding.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Spearman
    End



    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = MordorRhunSword 10
        Slots             = 10
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:2 Y:2
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:MordorRhunSword    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:MordorRhunSword Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:MordorRhunSword Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking = 1 2
        AlternateFormation = MordorRhunSwordHordeShieldWall

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End



    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        = Terror_Base
        AddEmotion        = Doom_Base

        AddEmotion        = UncontrollableFear_Base_Evil
        AddEmotion        = FearIdle_Base
        AddEmotion        = FearBusy_Base
        AddEmotion        = Point_Base

        AddEmotion        = OVERRIDE Taunt_Base

         End

        AddEmotion        = CheerIdle_Base
        AddEmotion        = CheerBusy_Base
        AddEmotion        = HeroCheerIdle_Base
        AddEmotion        = HeroCheerBusy_Base
        AddEmotion        = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality1
        TriggeredBy    = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy    = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End






    Behavior = AISpecialPowerUpdate MordorEasterlingHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 35.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_MordorEasterlingHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_MordorEasterlingArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_MordorEasterlingWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End


ChildObject MordorRhunSwordHordeShieldWall MordorRhunSwordHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained          =
        InitialPayload                   = MordorRhunSword 10
        Slots                            = 10
        PassengerFilter                  = NONE +INFANTRY
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = No
        AttributeModifiers               = RhunswordsmenShieldWall
        RandomOffset                     = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = HaradHaradrimBanner
        BannerCarrierPosition    = UnitType:MordorRhunSword   Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:MordorRhunSword Position:X:0 Y:0        Position:X:0 Y:12.5        Position:X:0 Y:-12.5        Position:X:0 Y:25        Position:X:0 Y:-25
        RankInfo = RankNumber:2 UnitType:MordorRhunSword Position:X:-12.5 Y:0        Position:X:-12.5 Y:12.5        Position:X:-12.5 Y:-12.5        Position:X:-12.5 Y:25        Position:X:-12.5 Y:-25
        RanksToReleaseWhenAttacking = 1

        AlternateFormation = MordorRhunSwordHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

Object EvilmenSalemeHasharinHorde

    SelectPortrait         = UPHasharin
    ButtonImage            = HIHasharin_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUCor
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeHasharinofHarad
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_HordeHasharinofHarad
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_HordeHasharinofHarad
    MaxSimultaneousOfType    = 1
    ShowHealthInSelectionDecal = Yes

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions     = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    CorsairFireBombMissileHordeRangefinder
        Weapon         = TERTIARY    CorsairFireBombMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 2000
    BuildTime         = HEROIC_BUILDTIME

    ShroudClearingRange     = MORDOR_CORSAIR_HORDE_SHROUDCLEAR_RANGE
    VisionRange         = MORDOR_CORSAIR_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 0
    CommandSet         = EvilmenSalemeHasharinHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = MORDOR_CORSAIRSOFUMBAR_HORDE_THREAT

    ThreatBreakdown MordorCorsairsOfUmbarHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
    End

    Behavior                      = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained   =
        InitialPayload            = EvilmenHasharin 10
        Slots                     = 10
        PassengerFilter           = NONE +EvilmenHasharin
        ShowPips                  = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:EvilmenHasharin Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:EvilmenHasharin Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:EvilmenHasharin Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 25
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End
    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End





    Behavior = SpecialPowerModule ModuleTag_ElfCloakStarter
        SpecialPowerTemplate      = SpecialAbilityElfCloak
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = No
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_ElfCloakUpdate
        SpecialPowerTemplate = SpecialAbilityElfCloak
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType            = CAMOUFLAGE
            ForbiddenConditions         = TAKING_DAMAGE FIRING_ANY USING_ABILITY
            DetectionRange              = CAMOUFLAGE_RADIUS
            Options                     = ALLOW_NEAR_TREES
        End
		UnitSpecificSoundNameToUseAsVoiceMoveToStealthyArea = VoiceMoveToTrees
		UnitSpecificSoundNameToUseAsVoiceEnterStateMoveToStealthyArea = VoiceEnterStateMoveToTrees
        StartsActive                    = Yes
        UpdatePeriod                    = 2000
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HinterhaltEnabler
        SpecialPowerTemplate     = SpecialAbilityHasharinTeleport
        TriggeredBy              = Upgrade_MiniHordeLvl3
    End

    Behavior = SpecialPowerModule ModuleTag_HinterhaltStarter
        SpecialPowerTemplate     = SpecialAbilityHasharinTeleport
        UpdateModuleStartsAttack = Yes
        TriggerFX                = FX_NoriHinterhalt
        StartsPaused             = Yes
    End

    Behavior = TeleportSpecialAbilityUpdate ModuleTag_HinterhaltUpdate
        SpecialPowerTemplate     = SpecialAbilityHasharinTeleport
        UnpackingVariation       = 1
        UnpackTime               = 1
        PackTime                 = 1
        ApproachRequiresLOS      = No
        BusyForDuration          = 1
        MaxDistance              = 180
        DestinationWeaponName    = HasharinBladesWeapon
    End

	Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
		UpgradeRequired		= Upgrade_EliteHordeLvl1
		IdleSpawnRate		= 20000
		UnitSpawnFX		= FX_BannerCarrierSpawnUnit
		ReplenishNearbyHorde	= Yes
		ScanHordeDistance	= 0
	End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ElrondsErfahrungsLeadership3
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        TriggeredBy                 = Upgrade_MiniHordeLvl5
    End
    Behavior = SpecialPowerModule ModuleTag_ElrondsErfahrungsLeadershipUpdate3
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership3
        StartsActive                = No
        BonusName                   = Unsagbare
        TriggeredBy                 = Upgrade_MiniHordeLvl5
        RefreshDelay                = 2000
        Range                       = 200
        AntiCategory                = BUFF
        ObjectFilter                = NONE +EvilmenSaleme
    End
	
    Behavior = AutoHealBehavior ModuleTag_ElvenGiftHealing
        StartsActive                = No
        TriggeredBy                 = Upgrade_MiniHordeLvl1
        HealingAmount               = ELVEN_GIFT_REGEN_AMOUNT
        HealingDelay                = ELVEN_GIFT_REGEN_DELAY
        StartHealingDelay           = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat       = Yes
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy = Upgrade_MiniHordeLvl10
    End



    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End




    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = WallScalingMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End


    #include "..\..\..\includes\CaptureBuilding.inc"









    Behavior = AISpecialPowerUpdate MordorCorsairsOfUmbarHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius    = 50.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_EomerBody

    AutoResolveArmor
        Armor = AutoResolve_EomerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_EomerWeapon
    End

    AutoResolveLeadership = AutoResolve_EomerBonus
End



Object EvilmenHasharinHordeNew

    SelectPortrait         = UPHasharin
    ButtonImage            = HIHasharin_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUCor
        End
    End

    Side             = Mordor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeHasharinofHarad
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_HordeHasharinofHarad
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_HordeHasharinofHarad

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions     = WEAPONSET_TOGGLE_1
        Weapon         = PRIMARY    CorsairFireBombMissileHordeRangefinder
        Weapon         = TERTIARY    CorsairFireBombMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    BuildCost         = 700
    BuildTime         = STRONG_BUILDTIME

    ShroudClearingRange     = MORDOR_CORSAIR_HORDE_SHROUDCLEAR_RANGE
    VisionRange         = MORDOR_CORSAIR_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 0
    CommandSet         = EvilmenHasharinCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = MORDOR_CORSAIRSOFUMBAR_HORDE_THREAT

    ThreatBreakdown MordorCorsairsOfUmbarHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
    End

    Behavior                      = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained   =
        InitialPayload            = EvilmenHasharin 10
        Slots                     = 10
        PassengerFilter           = NONE +EvilmenHasharin
        ShowPips                  = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:3 Y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:EvilmenHasharin Position:X:25 Y:-25 Position:X:25 Y:0 Position:X:25 Y:25
        RankInfo = RankNumber:2 UnitType:EvilmenHasharin Position:X:0 Y:-35 Position:X:5 Y:-7 Position:X:-5 Y:8 Position:X:0 Y:35
        RankInfo = RankNumber:3 UnitType:EvilmenHasharin Position:X:-25 Y:-25 Position:X:-25 Y:0 Position:X:-25 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 25
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End







    Behavior = SpecialPowerModule ModuleTag_ElfCloakStarter
        SpecialPowerTemplate      = SpecialAbilityElfCloak
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = No
    End

    Behavior = ToggleHiddenSpecialAbilityUpdate ModuleTag_ElfCloakUpdate
        SpecialPowerTemplate = SpecialAbilityElfCloak
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType            = CAMOUFLAGE
            ForbiddenConditions         = TAKING_DAMAGE FIRING_ANY USING_ABILITY
            DetectionRange              = CAMOUFLAGE_RADIUS
            Options                     = ALLOW_NEAR_TREES
        End
		UnitSpecificSoundNameToUseAsVoiceMoveToStealthyArea = VoiceMoveToTrees
		UnitSpecificSoundNameToUseAsVoiceEnterStateMoveToStealthyArea = VoiceEnterStateMoveToTrees
        StartsActive                    = Yes
        UpdatePeriod                    = 2000
    End



     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End




    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = WallScalingMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End


    #include "..\..\..\includes\CaptureBuilding.inc"









    Behavior = AISpecialPowerUpdate MordorCorsairsOfUmbarHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius    = 50.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorWachterderVesteWeapon
    End
End



