Object AngmarDarkDunedainHorde

    SelectPortrait         = UPDarkDunSword
    ButtonImage            = UPDarkDunSword

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarDarkDunedain
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarDarkDunedainHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarDarkDunedainHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = 400
    BuildTime         = MEDIUM_BUILDTIME
    ShroudClearingRange     = 325
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1

    CrushOnlyWhileCharging = Yes

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarDarkDunedain 10
        Slots                 = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed        = AngmarInfantryBanner
        BannerCarrierPosition        = UnitType:AngmarDarkDunedain   Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking     = 1 2

        AlternateFormation         = GondorFighterHordeBlock
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      = 1000
        TauntAndPointExcluded         = NONE
        AfraidOf                      = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance              = 150
        FearScanDistance              = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            = Terror_Base
        AddEmotion            = Doom_Base

        AddEmotion            = BraceForBeingCrushed_Base

        AddEmotion            = UncontrollableFear_Base

        AddEmotion            = FearIdle_Base

        AddEmotion            = FearBusy_Base

        AddEmotion            = Point_Base

        AddEmotion            = Taunt_Base

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp          = ANY +CRATE -TheDroppedRing
        ScanRange              = 200
        ScanIntervalSeconds    = 0.5
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeathMaskUnpause
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy          = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers  = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
        StartsActive            = No
        TriggeredBy             = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers     = Yes
        BonusName               = DeathMaskModifier
        RefreshDelay            = 2000
        Range                   = ANGMAR_NECRO_DEATH_MASK_RANGE
        TargetEnemy             = Yes
        ObjectFilter            = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy          = Upgrade_ObjectLevel2
    End

      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused        = Yes
    End






    Behavior = SpecialPowerModule ModuleTag_PaktDummy
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_PaktHeal            TARGETPOS
        TriggerSpecialPower             = ModuleTag_PaktBlastStarter    TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_PaktHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 0.5
        HealAsPercent                   = Yes
        HealAffects                     = GANDALF
        HealRadius                      = 999999999
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = DainMightyRage

    End

    Behavior = SpecialPowerModule ModuleTag_PaktBlastStarter
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_PaktBlastWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        WhichSpecialWeapon              = 1
        SkipContinue                    = Yes
        UnpackTime                      = 100
        PreparationTime                 = 1

        PackTime                        = 100
        FreezeAfterTriggerDuration      = 100
        AwardXPForTriggering            = 100
        StartAbilityRange               = 20.0
        EffectRange                     = 55
        SpecialWeapon                   = ErfullterPaktWeapon
    End


    Behavior = CommandSetUpgrade ModuleTag_CommandsetPakt
        TriggeredBy       = Upgrade_RaiseShield
        CommandSet        = AngmarDarkDunedainHordeCommandSet_DunklerPakt
    End


    #include "..\..\..\includes\AngmarChargeUpdate.inc"

    CommandSet = AngmarDarkDunedainHordeCommandSet





    Behavior = AISpecialPowerUpdate AngmarCharge
        CommandButtonName = Command_AngmarChargeAttack
        SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarDarkDunedainHorde_Summoned AngmarDarkDunedainHorde
    IsTrainable    = No
    CommandPoints     = 0
    CommandSet    = AngmarDarkDunedainHordeCommandSet_Summoned
    EquivalentTo      = AngmarDarkDunedainHorde

    DisplayName  =  OBJECT:HordeAngmarDarkDunedain

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = AngmarDarkDunedain_Summoned 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


ChildObject AngmarDarkDunedainHordeBlock AngmarDarkDunedainHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload            = AngmarDarkDunedain GOOD_MEN_GIANT_HORDE_SIZE
        Slots                = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers        = GondorFighterBlock
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = AngmarBanner
        BannerCarrierPosition    = UnitType:AngmarDarkDunedain    Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation         = AngmarDarkDunedainHorde
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End
End


Object AngmarDarkRangerHorde

    SelectPortrait       = UPDarkDunBow
    ButtonImage          = HIDarkDunBow_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side                   = Angmar
    EditorSorting          = UNIT
    EmotionRange           = 240
    DisplayName            = OBJECT:HordeAngmarDarkRanger
    DisplayNameStrategic   = CONTROLBAR:LW_Unit_AngmarDarkRangerHorde
    DescriptionStrategic   = CONTROLBAR:LW_ToolTip_AngmarDarkRangerHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    AngmarEdainRangerMissileHordeRangefinder
        Weapon         = TERTIARY   AngmarEdainRangerMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ANGMARDARKRANGERHORDE_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 420
    ShroudClearingRange     = 420
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 50

    CrushableLevel        = 0
    CrusherLevel          = 0
    UseCrushAttack        = No

    FormationWidth        = 2
    FormationDepth        = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 150
    ThreatBreakdown GondorRangerHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarDarkRanger 10
        Slots                 = 10
        PassengerFilter         = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:4 Y:4
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed        = AngmarRangerBanner
        BannerCarrierPosition        = UnitType:AngmarDarkRanger    Pos:X:40.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarDarkRanger Position:x:20 Y:0              Position:X:20 Y:-20              Position:X:20 Y:20              Position:X:20 Y:-40              Position:X:20 Y:40
        RankInfo = RankNumber:2 UnitType:AngmarDarkRanger Position:X:0 Y:0 Leader 1 0    Position:X:0 Y:-20 Leader 1 1    Position:X:0 Y:20 Leader 1 2    Position:X:0 Y:-40 Leader 1 3    Position:X:0 Y:40 Leader 1 4

        RanksToReleaseWhenAttacking     = 1 2

        MeleeAttackLeashDistance   = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance          = 1
        BackUpMaxDistance          = 3
        BackupPercentage           = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base


        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    CommandSet = AngmarDarkRangerHordeCommandSetMod

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                         = OCL_LongIceShotAbility
        CreateLocation              = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No
        SetModelCondition           = ModelConditionState:USER_1
        SetModelConditionTime       = 5.0
        DisableDuringAnimDuration   = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate = SpecialAbilityMenLongShot
        PackTime             = 5000
        MustFinishAbility    = Yes
        SpecialWeapon        = MenLongShotWeapon
        NeedLivingTargets    = No
        ApproachRequiresLOS  = No
    End






    Behavior = SpecialPowerModule ModuleTag_PaktDummy
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_PaktHeal            TARGETPOS
        TriggerSpecialPower             = ModuleTag_PaktBlastStarter    TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_PaktHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 0.5
        HealAsPercent                   = Yes
        HealAffects                     = GANDALF
        HealRadius                      = 999999999
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = DainMightyRage
    End

    Behavior = SpecialPowerModule ModuleTag_PaktBlastStarter
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeathMaskUnpause
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        TriggeredBy               = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
        StartsActive            = No
        TriggeredBy             = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers     = Yes
        BonusName               = DeathMaskModifier
        RefreshDelay            = 2000
        Range                   = ANGMAR_NECRO_DEATH_MASK_RANGE
        TargetEnemy             = Yes
        ObjectFilter            = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_PaktBlastWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        WhichSpecialWeapon              = 1
        SkipContinue                    = Yes
        UnpackTime                      = 100
        PreparationTime                 = 1

        PackTime                        = 100
        FreezeAfterTriggerDuration      = 100
        AwardXPForTriggering            = 100
        StartAbilityRange               = 20.0
        EffectRange                     = 55
        SpecialWeapon                   = ErfullterPaktWeapon
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandsetPakt
        TriggeredBy       = Upgrade_RaiseShield
        CommandSet        = AngmarDarkRangerHordeCommandSetMod_DunklerPakt
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_IceArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RangerLongshotAI

	CommandButtonName  = Command_AngmarLongShotAbilityEdain

	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF

    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_IceArrows
        Weapon = AutoResolve_GondorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_IceArrows
        Weapon = AutoResolve_GondorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_IceArrows Upgrade_HeavyArmor
End


ChildObject AngmarDarkRangerHorde_Summoned AngmarDarkRangerHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = AngmarDarkRangerHordeCommandSet_Summoned
    EquivalentTo = AngmarDarkRangerHorde

    DisplayName  =  OBJECT:HordeAngmarDarkRanger
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarDarkRanger_Summoned GOOD_MEN_HORDE_SIZE
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:4 Y:4


        RankInfo = RankNumber:1 UnitType:AngmarDarkRanger_Summoned Position:X:0 Y:0    Position:X:0 Y:20    Position:X:0 Y:-20    Position:X:0 Y:40    Position:X:0 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarDarkRanger_Summoned Position:X:15 Y:0    Position:X:15 Y:20    Position:X:15 Y:-20    Position:X:15 Y:40    Position:X:15 Y:-40

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange        = 100
        DetectionRate         = 500
        CancelOneRingEffect   = Yes
    End
End

Object AngmarDunedainPikemanHorde

    SelectPortrait       = UPDarkDunLance
    ButtonImage          = HIDarkDunLance_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarDunedainPikeman
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarDunedainPikemanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarDunedainPikemanHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange = 325
    VisionRange         = 200

    VisionSide          = 50%
    VisionRear          = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 50

    CommandSet          = AngmarDarkDunedainPikemanHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    ThreatLevel = 150
    ThreatBreakdown IsengardPikemanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList                =    InfantryFunctions
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarDunedainPikeman 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:2 Y:2
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarInfantryBanner
        BannerCarrierPosition    = UnitType:AngmarDunedainPikeman    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:AngmarDunedainPikeman Position:X:50 Y:0                Position:X:50 Y:22                Position:X:50 Y:-22                Position:X:50 Y:44                Position:X:50 Y:-44
        RankInfo = RankNumber:2 UnitType:AngmarDunedainPikeman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:22 Leader 1 1    Position:X:30 Y:-22 Leader 1 2    Position:X:30 Y:44 Leader 1 3    Position:X:30 Y:-44 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = AngmarDunedainPikemanHordePorcupine
        MeleeAttackLeashDistance = 1                .
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeathMaskUnpause
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        TriggeredBy               = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
        StartsActive            = No
        TriggeredBy             = Upgrade_ObjectLevel2 Upgrade_Mornamarth_Arrive
        RequiresAllTriggers     = Yes
        BonusName               = DeathMaskModifier
        RefreshDelay            = 2000
        Range                   = ANGMAR_NECRO_DEATH_MASK_RANGE
        TargetEnemy             = Yes
        ObjectFilter            = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End







    Behavior = SpecialPowerModule ModuleTag_PaktDummy
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityDainMightyRage
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_PaktHeal            TARGETPOS
        TriggerSpecialPower             = ModuleTag_PaktBlastStarter    TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_PaktHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 0.5
        HealAsPercent                   = Yes
        HealAffects                     = GANDALF
        HealRadius                      = 999999999
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = DainMightyRage

    End

    Behavior = SpecialPowerModule ModuleTag_PaktBlastStarter
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_PaktBlastWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilityWizardBlast
        WhichSpecialWeapon              = 1
        SkipContinue                    = Yes
        UnpackTime                      = 100
        PreparationTime                 = 1

        PackTime                        = 100
        FreezeAfterTriggerDuration      = 100
        AwardXPForTriggering            = 100
        StartAbilityRange               = 20.0
        EffectRange                     = 55
        SpecialWeapon                   = ErfullterPaktWeapon
    End


    Behavior = CommandSetUpgrade ModuleTag_CommandsetPakt
        TriggeredBy       = Upgrade_RaiseShield
        CommandSet        = AngmarDarkDunedainPikemanHordeCommandSet_DunklerPakt
    End





    Behavior = AISpecialPowerUpdate IsengardPikemanHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_IsengardPikemanHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_ForgedBlades
        Armor = AutoResolve_IsengardPikemanHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_ForgedBlades
        Armor = AutoResolve_IsengardPikemanArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardPikemanWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject AngmarDunedainPikemanHordePorcupine AngmarDunedainPikemanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = AngmarDunedainPikeman 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers                = IsengardPikemanHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = AngmarDunedainPikemanHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = AngmarInfantryBanner
        BannerCarrierPosition            = UnitType:AngmarDunedainPikeman    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:AngmarDunedainPikeman Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End

ChildObject AngmarDarkDunedainHorde_Edikt AngmarDarkDunedainHorde

    EquivalentTo  = AngmarDarkDunedainHorde
    BuildCost	  = 200
End


ChildObject AngmarDarkRangerHorde_Edikt AngmarDarkRangerHorde

    EquivalentTo  = AngmarDarkRangerHorde
    BuildCost	  = 250
End

ChildObject AngmarDunedainPikemanHorde_Edikt AngmarDunedainPikemanHorde

    EquivalentTo  = AngmarDunedainPikemanHorde
    BuildCost	  = 225
End

ChildObject AngmarDunedainPikemanHordePorcupine_Edikt AngmarDunedainPikemanHorde_Edikt

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                        = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay                      = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = AngmarDunedainPikeman 10
        Slots                             = 10
        PassengerFilter                   = NONE +INFANTRY
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        RandomOffset                      = X:2 Y:1
        RanksToReleaseWhenAttacking       = 0
        RanksToJustFreeWhenAttacking      = 0
        AttributeModifiers                = IsengardPikemanHordePorcupine
        IsPorcupineFormation              = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = AngmarDunedainPikemanHorde_Edikt
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = AngmarInfantryBanner
        BannerCarrierPosition            = UnitType:AngmarDunedainPikeman    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:AngmarDunedainPikeman Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End

Object AngmarDireWolfHorde

    ButtonImage    = WOR_DireWolvesIcon
    SelectPortrait = KUDireWolfPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             		= Angmar
    EditorSorting         	= UNIT
    EmotionRange         	= 240
    DisplayName         	= OBJECT:HordeAngmarDireWolf
    DisplayNameStrategic     	= CONTROLBAR:LW_Unit_AngmarDireWolfHorde
    DescriptionStrategic     	= CONTROLBAR:LW_ToolTip_AngmarDireWolfHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY  NormalMissileHordeRangefinder
    End




    BuildCost = 200
    BuildTime = WEAK_BUILDTIME
    VisionRange = ANGMAR_DIREWOLF_VISION_RANGE

    ShroudClearingRange = ANGMAR_DIREWOLF_SHROUD_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 30

    CommandSet = AngmarDireWolfHordeCommandSet_Edain

    FormationWidth = 2
    FormationDepth = 2

    CrushableLevel           = 2
    CrusherLevel             = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarDireWolf 10
        Slots                 = 10
        PassengerFilter            = NONE +INFANTRY +AngmarDireWolf
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = AngmarBannerDireSnowTroll
        BannerCarrierPosition    = UnitType:AngmarDireWolf    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarDireWolf Position:X:40 Y:0        Position:X:40 Y:25        Position:X:40 Y:-25        Position:X:40 Y:50        Position:X:40 Y:-50
        RankInfo = RankNumber:2 UnitType:AngmarDireWolf Position:X:10 Y:0     Position:X:10 Y:25   Position:X:10 Y:-25    Position:X:10 Y:50    Position:X:10 Y:-50 
        RanksToReleaseWhenAttacking     = 2

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

	LocomotorSet
		Locomotor     = NormalCavalryHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
	End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSetGoblinCreepLair
        TriggeredBy         = Upgrade_WildFaction
        CommandSet          = AngmarDireWolfHordeCommandSet_EdainCreep
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_AngmarSpikedCollar
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange        = 200
        ScanIntervalSeconds     = 0.5
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius     = 40.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType    = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_AngmarSpikedCollar
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_AngmarSpikedCollar
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_AngmarSpikedCollar
End


Object AngmarSnowTrollHorde

    ButtonImage        = WOR_SnowTrollIcon
    SelectPortrait     = KUSnowTrollPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUPik
        End
    End

    Side                  = Angmar
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = OBJECT:AngmarSnowTrollHorde
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_AngmarSnowTrollHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_AngmarSnowTrollHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost        = 600
    BuildTime        = MEDIUM_BUILDTIME
    CommandPoints    = 60

    ShroudClearingRange  = ANGMAR_SNOWTROLL_SHROUD_RANGE
    VisionRange          = ANGMAR_SNOWTROLL_HORDE_VISION_RANGE

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel             = 2
    CrusherLevel               = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback             = 55
    CrushZFactor               = 1.110

    CommandSet  = AngmarSnowTrollHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount    = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND TROLL
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 175
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = CavalryFunctions
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AttackPriority             = AttackPriority_Cavalry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle               = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained  =
        InitialPayload           = AngmarSnowTroll 6
        PassengerFilter          = NONE +CAVALRY
        Slots                    = 6
        ShowPips                 = No

        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = AngmarBannerSnowTroll
        BannerCarrierPosition    = UnitType:AngmarSnowTroll    Pos:X:60.0 Y:0

        RankInfo        = RankNumber:1 UnitType:AngmarSnowTroll Position:X:30 Y:-25            Position:X:30 Y:0            Position:X:30 Y:25
        RankInfo        = RankNumber:2 UnitType:AngmarSnowTroll Position:X:0  Y:-25    Leader 1 0     Position:X:0  Y:0     Leader 1 1    Position:X:0  Y:25     Leader 1 2

        RanksToReleaseWhenAttacking = 1 2

        UseSlowHordeMovement = Yes
        MeleeAttackLeashDistance = 150
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf                     = NONE +GondorGwaihir +MordorBalrog +MordorFellBeast +AngmarWitchking +MordorWitchKingOnFellBeast +MordorMumakil +MordorGateWatchersExpansion +SpellBookArrowVolley +TomBombadil +TomBombadil_Summoned +EvilMenBlackRider +CreateAHero
        AlwaysAfraidOf               = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_MOUNTED_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy        = Upgrade_BasicTraining
        LevelsToGain        = 1
        LevelCap        = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy               = Upgrade_ObjectLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    #include "..\..\..\includes\AngmarChargeUpdate.inc"





    Behavior = AISpecialPowerUpdate AngmarCharge
        CommandButtonName = Command_AngmarChargeAttack
        SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry            = BOX
    GeometryMajorRadius = 55
    GeometryMinorRadius = 55
    GeometryHeight        = 8.0
    GeometryIsSmall        = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_WildMarauderHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object AngmarHillTrollHorde

    ButtonImage        = WOR_HillTrollIcon
    SelectPortrait        = KUHillTrollPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkIUPik
        End
    End

    Side                = Angmar
    EditorSorting       = UNIT
    EmotionRange        = 240
    DisplayName         = OBJECT:AngmarHillTrollHorde
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_AngmarHillTrollHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_AngmarHillTrollHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost        = 700
    BuildTime        = STRONG_BUILDTIME

    ShroudClearingRange  = ANGMAR_HILLTROLL_SHROUD_RANGE
    VisionRange          = ANGMAR_HILLTROLL_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel       = 2
    CrusherLevel         = 0
    CommandPoints        = 60

    CommandSet           = AngmarHillTrollHordeCommandSet

    FormationWidth       = 2
    FormationDepth       = 2

    TransportSlotCount    = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND TROLL
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 175
    ThreatBreakdown WildMauraderHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        AILuaEventsList              = InfantryFunctions
        MaxCowerTime                 = 5000
        MinCowerTime                 = 3000
        AttackPriority               = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload          = AngmarHillTroll 6
        PassengerFilter         = NONE +INFANTRY +AngmarBannerHillTroll
        Slots                   = 6
        ShowPips                = No

        ThisFormationIsTheMainFormation = Yes

        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarBannerHillTroll
        BannerCarrierPosition    = UnitType:AngmarHillTroll    Pos:X:60.0 Y:0.0

        RankInfo        = RankNumber:1 UnitType:AngmarHillTroll Position:X:30 Y:-25            Position:X:30 Y:0            Position:X:30 Y:25
        RankInfo        = RankNumber:2 UnitType:AngmarHillTroll Position:X:0  Y:-25    Leader 1 0     Position:X:0  Y:0     Leader 1 1    Position:X:0  Y:25     Leader 1 2

        RanksToReleaseWhenAttacking = 1 2

        UseSlowHordeMovement     = Yes
        MeleeAttackLeashDistance = 150

        AlternateFormation     = AngmarHillTrollPorcupine
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    NONE +GondorGwaihir +MordorBalrog +MordorFellBeast +AngmarWitchking +MordorWitchKingOnFellBeast +MordorMumakil +MordorGateWatchersExpansion +SpellBookArrowVolley +TomBombadil +TomBombadil_Summoned +EvilMenBlackRider +CreateAHero
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy    = Upgrade_BasicTraining
        LevelsToGain    = 1
        LevelCap    = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry            = BOX
    GeometryMajorRadius = 25
    GeometryMinorRadius = 50
    GeometryHeight      = 8.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_WildMarauderHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_WildMarauderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_WildMarauderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarHillTrollPorcupine AngmarHillTrollHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle               = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained  =
        InitialPayload           = AngmarHillTroll 6
        Slots                    = 6
        PassengerFilter          = NONE +INFANTRY +AngmarBannerHillTroll
        ShowPips                 = No
        ThisFormationIsTheMainFormation     = No
        RandomOffset                = X:2 Y:1
        RanksToReleaseWhenAttacking    = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers             = WildMarauderHordePorcupine
        IsPorcupineFormation           = Yes
        MinimumHordeSize               = 3

        AlternateFormation             = AngmarHillTrollHorde
        VisionRearOverride             = 100%
        VisionSideOverride             = 100%
        NotComboFormation              = Yes


        BannerCarriersAllowed            = AngmarBannerHillTroll
        BannerCarrierPosition            = UnitType:AngmarHillTroll    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:AngmarHillTroll Position:X:30 Y:0    Position:X:-30 Y:0        Position:X:0 Y:30    Position:X:0 Y:-30    Position:X:21.21 Y:21.21    Position:X:-21.21 Y:-21.21
    End
End


Object AngmarOrcWarriors

    ButtonImage        = KUSummonOrcIcon
    SelectPortrait    = UPZuchtmeister

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUOrc
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarOrcWarriors
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarOrcWarriors
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarOrcWarriors

    IsAutoBuilt = Yes

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 60
    BuildTime         = WEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 250
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel         = 0
    CommandPoints         = 0
    CommandSet         = AngmarWildSpearCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarOrcWarrior 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No


        BannerCarriersAllowed    = AngmarThrallMasterBanner
        BannerCarrierPosition    = UnitType:AngmarOrcWarrior    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior Position:X:35 Y:0               Position:X:30 Y:25               Position:X:30 Y:-25               Position:X:40 Y:40               Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior Position:X:15 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:15 Y:40 Leader 1 3    Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:-5 Y:0 Leader 2 0    Position:X:-10 Y:20 Leader 2 1   Position:X:-10 Y:-20 Leader 2 2   Position:X:0 Y:40 Leader 2 3     Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End


    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty

        SacrificeFilter            = ALL
        ExperienceModifier         = 1.95
        InitiateVoice              = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
         QuarrelProbability    =  0.5%
         AddEmotion    =    Quarrel_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End
    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject AngmarOrcWarriors_Summoned AngmarOrcWarriors






    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = AngmarOrcWarriors

    Side = Angmar
    KindOf = SELECTABLE SUMMONED CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarOrcWarrior_Summoned 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No


        BannerCarriersAllowed    = AngmarBannerOrcWarrior
        BannerCarrierPosition    = UnitType:AngmarOrcWarrior_Summoned    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel   = 6
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RandomOffset=X:3 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior_Summoned Position:X:35 Y:0               Position:X:30 Y:25               Position:X:30 Y:-25               Position:X:40 Y:40               Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior_Summoned Position:X:15 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:15 Y:40 Leader 1 3    Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior_Summoned Position:X:-5 Y:0 Leader 2 0    Position:X:-10 Y:20 Leader 2 1   Position:X:-10 Y:-20 Leader 2 2   Position:X:0 Y:40 Leader 2 3     Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End



ChildObject AngmarOrcWarriors_Placed AngmarOrcWarriors






    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = AngmarOrcWarriors

    Side = Angmar
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarOrcWarrior 15
        Slots = 15
        PassengerFilter = ANY +INFANTRY +MONSTER
        ShowPips = No


        BannerCarriersAllowed    = AngmarBannerOrcWarrior
        BannerCarrierPosition    = UnitType:AngmarOrcWarrior    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel   = 6
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RandomOffset=X:5 Y:3

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
    End

End


Object AngmarWolfRiders


    ButtonImage        = WOR_WolfRider
    SelectPortrait    = UPZuchtmeister

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarWolfRiders
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarWolfRiders
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarWolfRiders

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = ANGMAR_WOLFRIDER_BUILDCOST
    BuildTime         = WEAK_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 20

    CommandSet         = AngmarWolfRiderHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 125
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarWolfRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY +AngmarThrallMasterBanner
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End


        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = AngmarThrallMasterWolfBanner
        BannerCarrierPosition    = UnitType:AngmarWolfRider    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel     = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:AngmarWolfRider Position:X:40 Y:0        Position:X:40 Y:25        Position:X:40 Y:-25        Position:X:40 Y:50        Position:X:40 Y:-50
        RankInfo = RankNumber:2 UnitType:AngmarWolfRider Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:25 Leader 1 1    Position:X:10 Y:-25 Leader 1 2    Position:X:10 Y:50 Leader 1 3    Position:X:10 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25

        AlternateFormation = AngmarWolfRiderHordeWedgeFormation

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
        AttributeModifiers = IsengardWargSkirmish
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End




    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarWolfRiderHordeWedgeFormation AngmarWolfRiders

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = AngmarWolfRider 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +AngmarThrallMasterWolfBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarThrallMasterWolfBanner
        BannerCarrierPosition    = UnitType:AngmarWolfRider    Pos:X:-60.0 Y:0.0
        BannerCarrierMinLevel     = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:AngmarWolfRider  Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarWolfRider  Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = AngmarWolfRiders

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End




ChildObject AngmarWolfRider_Summoned AngmarWolfRiders

    Side = Angmar

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarWolfRider  10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End


        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = AngmarBannerWolfRider
        BannerCarrierPosition    = UnitType:AngmarWolfRider    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel     = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:AngmarWolfRider Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:AngmarWolfRider Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking     = 1 2
        MeleeAttackLeashDistance    = 25
        AttributeModifiers         = IsengardWargSkirmish
        LivingWorldOverloadTemplate         = AngmarThrallMaster
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End






Object AngmarRhudaurSpearmen


    ButtonImage        = KUSummonSpearmenIcon
    SelectPortrait    = UPZuchtmeister

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarRhudaurSpearmen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarRhudaurSpearmen
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarRhudaurSpearmen

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End


    BuildCost = 180
    BuildTime = WEAK_BUILDTIME

    VisionRange = ANGMAR_RHUDAURSPEAR_HORDE_VISION_RANGE
    ShroudClearingRange = ANGMAR_RHUDAURSPEAR_SHROUD_RANGE


    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 15

    CommandSet = AngmarWildSpearCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ANGMAR_RHUDAURSPEAR_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarRhudaurSpearman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = AngmarThrallMasterBanner
        BannerCarrierPosition    = UnitType:AngmarRhudaurSpearman    Pos:X:-35.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = AngmarRhudaurSpearmenPorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End
    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarRhudaurSpearmenPorcupine AngmarRhudaurSpearmen

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = AngmarRhuduarSpearman GOOD_MEN_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = AngmarRhudaurSpearmenPorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = AngmarRhudaurSpearmen
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = AngmarThrallMasterBanner
        BannerCarrierPosition            = UnitType:AngmarRhuduarSpearman    Pos:X:0.0 Y:0.0
        BannerCarrierMinLevel             = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo    = RankNumber:1 UnitType:AngmarRhuduarSpearman Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End
End

ChildObject AngmarRhudaurSpearmenNoBanner AngmarRhudaurSpearmen






    Side = Angmar

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
            ObjectStatusOfContained =
            InitialPayload = AngmarRhudaurSpearman EVIL_MEN_BIG_HORDE_SIZE
            Slots = 15
            PassengerFilter    = NONE +INFANTRY
            ShowPips = No
            ThisFormationIsTheMainFormation = Yes
            RandomOffset=X:0 Y:0
            MeleeBehavior = Amoeba
                FacingBonus            =    30.0
                AngleLimitCos        =    -0.17
                InnerRange            =    30
                OuterRange            =    80
                OuterRangeBuildings    =    140
            End


            BannerCarriersAllowed    = AngmarThrallMasterBanner
            BannerCarrierPosition    = UnitType:AngmarRhudaurSpearman    Pos:X:-35.0 Y:0.0
            BannerCarrierMinLevel   = 6
            BannerCarrierDestroyHordeOnDeath = Yes
            BannerCarrierHordeDeathType = +NORMAL

            RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
            RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
            RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

            RanksToReleaseWhenAttacking = 1

            AlternateFormation = AngmarRhudaurSpearmenPorcupine
            MeleeAttackLeashDistance = 1
            BackUpMinDelayTime         = 1
            BackUpMaxDelayTime         = 3000
            BackUpMinDistance         = 1
            BackUpMaxDistance         = 3
            BackupPercentage         = 80%
            LivingWorldOverloadTemplate = AngmarThrallMaster
    End
End

ChildObject AngmarRhudaurSpearmenArnorBanner AngmarRhudaurSpearmen

    Side = Angmar

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarRhudaurSpearman EVIL_MEN_BIG_HORDE_SIZE
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:AngmarRhudaurSpearman    Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = AngmarRhudaurSpearmenPorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End
End


ChildObject RhudaurSpearmenHorde_Summoned AngmarRhudaurSpearmen
    IsTrainable = No
    CommandPoints = 0
    CommandSet = AngmarWildSpearCommandSet
    EquivalentTo = AngmarRhudaurSpearmen

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE PIKE MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
        MaxLifetime        = ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
        DeathType        = FADED
    End
    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RhudaurSpearman_Summoned 12
        Slots = 12
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:RhudaurSpearman_Summoned Position:X:27 Y:1    Position:X:30 Y:18        Position:X:28 Y:-21        Position:X:30 Y:38
        RankInfo = RankNumber:2 UnitType:RhudaurSpearman_Summoned Position:X:9 Y:2        Position:X:8 Y:19        Position:X:10 Y:-22        Position:X:11 Y:39
        RankInfo = RankNumber:3 UnitType:RhudaurSpearman_Summoned Position:X:-10 Y:-1    Position:X:-12 Y:22        Position:X:-10 Y:-18    Position:X:-11 Y:40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

End



Object AngmarRhudaurSlingers


    ButtonImage        = KUSummonAxeThrowerIcon
    SelectPortrait    = UPZuchtmeister

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side             = Angmar
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:AngmarRhudaurSlingers
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_AngmarRhudaurSlingers
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_AngmarRhudaurSlingers

    WeaponSet
        Conditions     = None
        Weapon        = PRIMARY    DwarvenMissileHordeRangefinder
    End

    CommandSet =  AngmarWildMissileHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel         = 0
    CrusherLevel         = 0
    UseCrushAttack         = No

    BuildCost = 220
    BuildTime = WEAK_BUILDTIME

    VisionRange = 200
    ShroudClearingRange = 300

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 0

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ANGMAR_RHUDAURSPEAR_HORDE_THREAT
    ThreatBreakdown IsengardWildmanHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =  AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = AngmarRhudaurSlinger 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarThrallMasterBanner
        BannerCarrierPosition    = UnitType:AngmarRhudaurSlinger        Pos:X:-55.0 Y:0.0
        BannerCarrierMinLevel    = 0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL


        RandomOffset = X:5 Y:3

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSlinger Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
        LivingWorldOverloadTemplate = AngmarThrallMaster
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_DwarvenMithrilMail
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End
    Behavior = AISpecialPowerUpdate DwarvenMenOfDaleHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_DwarvenMenOfDaleHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_DwarvenMithrilMail
        Armor = AutoResolve_DwarvenMenOfDaleHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_DwarvenMithrilMail
        Armor = AutoResolve_DwarvenMenOfDaleArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_DwarvenMenOfDaleUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_DwarvenMenOfDaleWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_DwarvenMithrilMail
End

ChildObject AngmarRhudaurSlingersNoBanner AngmarRhudaurSlingers






    Side = Angmar

    Behavior = HordeContain ModuleTag_HordeContain
            ObjectStatusOfContained =
            InitialPayload = AngmarRhudaurSlinger 15
            Slots = 15
            PassengerFilter = NONE +INFANTRY
            ShowPips = No
            ThisFormationIsTheMainFormation = Yes
            MeleeBehavior = Amoeba
            End


            BannerCarriersAllowed    = AngmarThrallMasterBanner
            BannerCarrierPosition    = UnitType:AngmarRhudaurSlinger        Pos:X:-35.0 Y:0.0
            BannerCarrierMinLevel    = 6
            BannerCarrierDestroyHordeOnDeath = Yes
            BannerCarrierHordeDeathType = +NORMAL


            RandomOffset = X:5 Y:3

            RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSlinger Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
        RanksToReleaseWhenAttacking = 1 2 3

            MeleeAttackLeashDistance = 1
            BackUpMinDelayTime         = 1
            BackUpMaxDelayTime         = 3000
            BackUpMinDistance         = 1
            BackUpMaxDistance         = 3
            BackupPercentage         = 80%

            LivingWorldOverloadTemplate = AngmarThrallMaster
    End
End

ChildObject AngmarRhudaurSlingersFree AngmarRhudaurSlingers
    BuildCost = 0
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER LARGE_RECTANGLE_PATHFIND
    Behavior = HordeContain ModuleTag_HordeContain
            ObjectStatusOfContained =
            InitialPayload = AngmarRhudaurSlinger 15
            Slots = 15
            PassengerFilter = NONE +INFANTRY
            ShowPips = No
            ThisFormationIsTheMainFormation = Yes
            MeleeBehavior = Amoeba
            End


            BannerCarriersAllowed    = AngmarThrallMasterBanner
            BannerCarrierPosition    = UnitType:AngmarRhudaurSlinger        Pos:X:-35.0 Y:0.0
            BannerCarrierMinLevel    = 6
            BannerCarrierDestroyHordeOnDeath = Yes
            BannerCarrierHordeDeathType = +NORMAL


            RandomOffset = X:5 Y:3

          RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSlinger Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
        RanksToReleaseWhenAttacking = 1 2 3

            

            MeleeAttackLeashDistance = 1
            BackUpMinDelayTime         = 1
            BackUpMaxDelayTime         = 3000
            BackUpMinDistance         = 1
            BackUpMaxDistance         = 3
            BackupPercentage         = 80%

            LivingWorldOverloadTemplate = AngmarThrallMaster
    End
End



ChildObject RhudaurSlingerHorde_Summoned AngmarRhudaurSlingers
    IsTrainable = No
    CommandPoints = 0
    CommandSet = AngmarWildMissileHordeCommandSet
    EquivalentTo = AngmarRhudaurSlingers

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = ANGMAR_RHUDAURSLING_SUMMON_DURATION
        MaxLifetime        = ANGMAR_RHUDAURSLING_SUMMON_DURATION
        DeathType        = FADED
    End
    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RhudaurSlinger_Summoned 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarRhudaurSlinger Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 25
    End

End


Object AngmarNecromancerHorde

    ButtonImage        = WOR_Necromancer
    SelectPortrait    = KUNecromancerPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUDFG
        End
    AnimationState = JUST_BUILT
        BeginScript
            CurDrawableHideSubObject("BlueFlame")
            CurDrawableHideSubObject("PurpleFlame")
            CurDrawableHideSubObject("GreenFlame")
            CurDrawableHideSubObject("BlueGlow")
            CurDrawableHideSubObject("PurpleGlow")
            CurDrawableHideSubObject("GreenGlow")
        EndScript
    End

    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeNecromancerGuardian
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarNecromancerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarNecromancerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost             = 500
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = ANGMAR_NECRO_HORDE_VISION_RANGE
    ShroudClearingRange         = ANGMAR_NECRO_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%

    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
    CommandPoints             = 25

    FormationWidth             = 2
    FormationDepth             = 2

    CrushableLevel             = 0
    CrusherLevel             = 1

    CrushOnlyWhileCharging         = Yes

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback             = 40
    CrushZFactor             = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE SUPPORT ATTACK_NEEDS_LINE_OF_SIGHT ARCHER HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND INFANTRY PATH_THROUGH_INFANTRY

    ThreatLevel = 125
    ThreatBreakdown AngmarGuardianHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000

        CanAttackWhileContained        = Yes
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior                 = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload            = AngmarNecroAcolyte 7
        Slots                = 7
        PassengerFilter            = NONE +ARCHER
        ShowPips                = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:10 Y:10

        MeleeBehavior = Amoeba




        End


        BannerCarriersAllowed    = AngmarNecromancerBanner
        BannerCarrierPosition    = UnitType:AngmarNecromancerBanner    Pos:X:0.0 Y:0.0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL
              BannerCarrierMinLevel   = 0

        RankInfo    = RankNumber:1 UnitType:AngmarNecroAcolyte Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78



        RanksToReleaseWhenAttacking    = 1

        MeleeAttackLeashDistance    = 25
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 60.0
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base




         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base


    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


      Behavior = CommandSetUpgrade ModuleTag_commandSetWellOfSouls
        TriggeredBy             = Upgrade_AngmarWellOfSouls
        CommandSet             = AngmarNecromancerHordeWellCommandSet
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseWellOfSouls
        TriggeredBy             = Upgrade_AngmarWellOfSouls
        SpecialPowerTemplate = SpecialAbilityNecroWellOfSouls
    End

      Behavior = CommandSetUpgrade ModuleTag_commandSetSoulFreeze
        TriggeredBy             = Upgrade_AngmarSoulFreeze
        CommandSet             = AngmarNecromancerHordeFreezeCommandSet
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseSoulFreeze
        TriggeredBy             = Upgrade_AngmarSoulFreeze
        SpecialPowerTemplate = SpecialAbilityNecroSoulFreeze
    End

      Behavior = CommandSetUpgrade ModuleTag_commandSetCorpseRain
        TriggeredBy             = Upgrade_AngmarCorpseRain
        CommandSet             = AngmarNecromancerHordeRainCommandSet
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseCorpseRain
        TriggeredBy             = Upgrade_AngmarCorpseRain
        SpecialPowerTemplate = SpecialAbilityNecroCorpseRain
    End

    Behavior = SubObjectsUpgrade ModuleTag_StaffWellOfSouls
        TriggeredBy             = Upgrade_AngmarWellOfSouls
        ShowSubObjects    = PurpleFlame PurpleGlow
        HideSubObjects = MultiFlame MultiGlow BlueFlame BlueGlow GreenFlame GreenGlow
    End

    Behavior = SubObjectsUpgrade ModuleTag_StaffSoulFreeze
        TriggeredBy             = Upgrade_AngmarSoulFreeze
        ShowSubObjects    = BlueFlame BlueGlow
        HideSubObjects = MultiFlame MultiGlow PurpleFlame PurpleGlow GreenFlame GreenGlow
    End


    Behavior = SubObjectsUpgrade ModuleTag_StaffCorpseRain
        TriggeredBy             = Upgrade_AngmarCorpseRain
        ShowSubObjects    = GreenFlame GreenGlow
        HideSubObjects = MultiFlame MultiGlow PurpleFlame PurpleGlow BlueFlame BlueGlow
    End



    Behavior = SpecialPowerModule ModuleTag_NecroBlackIceStarter
        SpecialPowerTemplate        = SpecialAbilityNecroBlackIce
        StartsPaused                = No
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_NecroBlackIceMover
        SpecialPowerTemplate       = SpecialAbilityNecroBlackIce
        StartAbilityRange          = ANGMAR_NECRO_BLACK_ICE_START_RANGE
        TriggerSpecialPower        = ModuleTag_NecroBlackIceBlastTrigger TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroBlackIceBlastWeapon TARGETPOS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroBlackIceBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityNecroBlackIceWeaponStarter
        WhichSpecialWeapon          = 2
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1
        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_BLACK_ICE_START_RANGE
        TriggerSound 		    = NecroVoiceModeBlackIce
        SpecialWeapon               = AngmarNecroBlackIceWeapon
    End

    Behavior = SpecialPowerModule ModuleTag_NecroBlackIceBlastTrigger
        SpecialPowerTemplate        = SpecialAbilityNecroBlackIceFXStarter
        TriggerFX                   = FX_BlackIce
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = SpecialPowerModule ModuleTag_NecroBlackIceBlastWeapon
        SpecialPowerTemplate        = SpecialAbilityNecroBlackIceWeaponStarter
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
       End

    Behavior = SpecialPowerModule ModuleTag_BarrowCorruptTrigger
        SpecialPowerTemplate        = SpecialAbilityBarrowCorruptFXStarter
        TriggerFX                    = FX_BarrowCorruption
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
       End


    Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeStarter
        SpecialPowerTemplate        = SpecialAbilityNecroSoulFreeze
        StartsPaused            = Yes
         UpdateModuleStartsAttack    = Yes


    End

    Behavior = ActivateModuleSpecialPower ModuleTag_NecroSoulFreezeMover
        SpecialPowerTemplate        = SpecialAbilityNecroSoulFreeze
        StartAbilityRange        = ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
        TriggerSpecialPower        = ModuleTag_NecroSoulFreezeBlastTrigger TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroSoulFreezeBlastWeapon TARGETPOS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroSoulFreezeBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityNecroSoulFreezeWeaponStarter
        WhichSpecialWeapon        = 3
        SkipContinue            = Yes
        FreezeAfterTriggerDuration     = 100
        UnpackTime            = 700
        PreparationTime            = 1

        PackTime            = 100
        AwardXPForTriggering        = 0
        StartAbilityRange        = ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
               TriggerSound = NecroVoiceModeSoulFreeze
        SpecialWeapon            = AngmarNecroSoulFreezeWeapon
    End

    Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeBlastTrigger
        SpecialPowerTemplate        = SpecialAbilityNecroSoulFreezeFXStarter
        TriggerFX            = FX_SoulFreezeGround
        UpdateModuleStartsAttack    = No
        StartsPaused            = No
      End

      Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeBlastWeapon
        SpecialPowerTemplate        = SpecialAbilityNecroSoulFreezeWeaponStarter
        UpdateModuleStartsAttack    = No
        StartsPaused            = No
       End





    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityNecroCorpseRain
        StartsPaused            = Yes
         UpdateModuleStartsAttack    = Yes
        TriggerFX                      = FX_GandalfLightningSwordBlastWeapon
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityNecroCorpseRain
        WhichSpecialWeapon        = 4
        SkipContinue            = Yes
        FreezeAfterTriggerDuration     = 100
        UnpackTime                    = 700
        PreparationTime                = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange        = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
            TriggerSound = NecroVoiceModeCorpseRain
        SpecialWeapon            = AngmarNecroCorpseRainWeapon
    End



    Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthStarter
        SpecialPowerTemplate        = SpecialAbilityNecroFellStrength
        StartsPaused            = No
         UpdateModuleStartsAttack    = No
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_NecroFellStrengthMover
        SpecialPowerTemplate        = SpecialAbilityNecroFellStrength
        StartAbilityRange        = ANGMAR_NECRO_FELL_STRENGTH_START_RANGE
        TriggerSpecialPower        = ModuleTag_NecroFellStrengthBlastStarter TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroFellStrengthBlastTrigger TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroFellStrengthBuffStarter OBJECTPOS
    End

    Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBlastTrigger
        SpecialPowerTemplate        = SpecialAbilityNecroFellStrengthFXStarter
        TriggerFX            = FX_FellStrength
        UpdateModuleStartsAttack    = No
        StartsPaused            = No
       End

    Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBuffStarter
        SpecialPowerTemplate        = SpecialAbilityActivateeDummy
        AttributeModifier        = FellStrengthModifier
        AttributeModifierRange        = ANGMAR_NECRO_FELL_STRENGTH_BUFF_RANGE
        AttributeModifierAffects    = ANY +INFANTRY +CAVALRY +MONSTER +HORDE ALLIES -STRUCTURE
        AttributeModifierAffectsSelf    = Yes
        UpdateModuleStartsAttack    = No
        StartsPaused            = No
       End

    Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBlastStarter
        SpecialPowerTemplate          = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack      = Yes
        StartsPaused              = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroFellStrengthBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWizardBlast
        WhichSpecialWeapon        = 5
        SkipContinue            = Yes
        FreezeAfterTriggerDuration     = 100
        UnpackTime                    = 700
        PreparationTime                = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange        = ANGMAR_NECRO_FELL_STRENGTH_START_RANGE
            TriggerSound = NecroVoiceModeFellStrength
        SpecialWeapon            = NecroFellStrength
    End


    Behavior = SpecialPowerModule ModuleTag_NecroWellOfSoulsStarter
        SpecialPowerTemplate        = SpecialAbilityNecroWellOfSouls
        StartsPaused            = Yes
         UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_NecroWellOfSoulsMover
        SpecialPowerTemplate        = SpecialAbilityNecroWellOfSouls
        StartAbilityRange        = ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE
        TriggerSpecialPower        = ModuleTag_NecroBlastStarter TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroWellOfSoulsBlastTrigger TARGETPOS
        TriggerSpecialPower        = ModuleTag_NecroBuffHeal OBJECTPOS
    End

    Behavior = SpecialPowerModule ModuleTag_NecroWellOfSoulsBlastTrigger
        SpecialPowerTemplate        = SpecialAbilityNecroWellOfSouls
        TriggerFX            = FX_WellOfSoulsWeapon
        UpdateModuleStartsAttack    = No
        StartsPaused            = Yes
       End


       Behavior = PlayerHealSpecialPower ModuleTag_NecroBuffHeal
        SpecialPowerTemplate        = SpecialAbilityActivateeDummy
        HealAmount            = ANGMAR_NECRO_WELL_OF_SOULS_HEAL_AMT
        HealAsPercent            = Yes
        HealAffects            = INFANTRY CAVALRY HERO DOZER MONSTER
        HealRadius            = ANGMAR_NECRO_WELL_OF_SOULS_BUFF_RADIUS
        HealFX                = FX_SpellHealUnitHealBuff
        InitiateSound            = DainMightyRage
        TriggerFX            = FX_WellOfSoulsCast
    End

    Behavior = SpecialPowerModule ModuleTag_NecroBlastStarter
        SpecialPowerTemplate          = SpecialAbilityWellOfSoulsBlast
        UpdateModuleStartsAttack      = Yes
        StartsPaused            = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellOfSoulsBlast
        WhichSpecialWeapon        = 1
        SkipContinue            = Yes
        UnpackTime                    = 700
        PreparationTime                = 1
        PackTime                    = 100
        FreezeAfterTriggerDuration     = 100
        AwardXPForTriggering        = 0
        StartAbilityRange        = ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE
        TriggerSound = NecroVoiceModeWellofSouls
        SpecialWeapon            = NecroWellOfSoulsAttack
    End



    CommandSet = AngmarNecromancerHordeCommandSet





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End




    Behavior = AISpecialPowerUpdate AngmarNecroBlackIceAI
        CommandButtonName = Command_NecromancerBlackIce
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK_UNITS
    End

    Behavior = AISpecialPowerUpdate AngmarNecroSoulFreezeAI
        CommandButtonName = Command_NecromancerSoulFreeze
        SpecialPowerAIType = AI_SPECIAL_POWER_SOUL_FREEZE
        SpecialPowerRange = ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
    End

    Behavior = AISpecialPowerUpdate AngmarNecroCorpseRainAI
        CommandButtonName = Command_NecromancerCorpseRain
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK_UNITS
    End

    Behavior = AISpecialPowerUpdate AngmarNecroFellStrengthAI
        CommandButtonName = Command_NecromancerFellStrength
        SpecialPowerAIType = AI_SPECIAL_POWER_AOE_AND_BUFF
    End

    Behavior = AISpecialPowerUpdate AngmarNecroWellofSoulsAI
        CommandButtonName = Command_NecromancerWellOfSouls
        SpecialPowerAIType = AI_SPECIAL_POWER_ATTACK_HEAL_AOE
        SpecialPowerRadius = ANGMAR_NECRO_WELL_OF_SOULS_BUFF_RADIUS
        SpecialPowerRange  = ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Support
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        Armor = AutoResolve_DwarvenGuardianHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DwarvenGuardianWeapon
    End
End


Object AngmarVerdammterHorde


    ButtonImage        = UPVerdammter
    SelectPortrait     = HSVerdammter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarVerdammter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeAngmarVerdammter
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeAngmarVerdammter
    MaxSimultaneousOfType = 3

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = 1200
    BuildTime         = ELITE_BUILDTIME
    ShroudClearingRange     = ANGMAR_DARKDUNEDAIN_HORDE_SHROUD_RANGE
    VisionRange         = ANGMAR_DARKDUNEDAIN_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 30

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1

    CrushOnlyWhileCharging = Yes

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarVerdammter 3
        Slots                 = 3
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarVerdammter Position:X:0 Y:0     Position:X:-15 Y:25     Position:X:-15 Y:-25

        RanksToReleaseWhenAttacking = 1


        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded         = NONE
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            = Terror_Base
        AddEmotion            = Doom_Base

        AddEmotion            = BraceForBeingCrushed_Base


        AddEmotion            = Point_Base

        AddEmotion            = Taunt_Base

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End







    Behavior = SpecialPowerModule ModuleTag_OpferritusStarter
        SpecialPowerTemplate        = SpecialAbilityOpferritus
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_OpferritusUpdate
        SpecialPowerTemplate        = SpecialAbilityOpferritus
        SkipContinue                = Yes
        UnpackTime                  = 3000
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 100
        StartAbilityRange           = 250
        SpecialWeapon               = OpferritusWeapon
        WhichSpecialWeapon          = 1
        MustFinishAbility           = Yes
    End







    Behavior = SpecialPowerModule ModuleTag_OpferritusDummy
        SpecialPowerTemplate            = SpecialAbilityOpferritusRefresh
        StartsPaused                    = No
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityOpferritusRefresh
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_OpferritusHeal            TARGETPOS
        TriggerSpecialPower             = ModuleTag_OpferritusRefresh         TARGETPOS
        TriggerSpecialPower             = ModuleTag_OpferritusBlastStarter    TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_OpferritusHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 0.5
        HealAsPercent                   = Yes
        HealAffects                     = INFANTRY CAVALRY HERO MONSTER
        HealRadius                      = 52
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = DainMightyRage

    End

    Behavior = SpecialPowerTimerRefreshSpecialPower ModuleTag_OpferritusRefresh
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        StartsPaused                    = No
        UpdateModuleStartsAttack        = No
        AffectAllies                    = Yes
        AttributeModifierRange          = 52
        AttributeModifierAffects        = ALL -AngmarVerdammter ALLIES
    End

    Behavior = SpecialPowerModule ModuleTag_OpferritusBlastStarter
        SpecialPowerTemplate            = SpecialAbilityOpferritusBlast
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_OpferritusBlastWeaponFireUpdate
        SpecialPowerTemplate            = SpecialAbilityOpferritusBlast
        WhichSpecialWeapon              = 1
        SkipContinue                    = Yes
        UnpackTime                      = 1200
        PreparationTime                 = 1

        PackTime                        = 100
        FreezeAfterTriggerDuration      = 1000
        AwardXPForTriggering            = 100
        StartAbilityRange               = 20.0
        EffectRange                     = 52
        SpecialWeapon                   = OpferritusRefreshAttack
    End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive              = Yes
        HealOnlyIfNotInCombat     = Yes
        HealOnlyIfNotUnderAttack  = Yes
        HealingAmount             = 30
        Radius                    = 100
        StartHealingDelay         = 7500
        HealingDelay              = 5000
        UnitHealPulseFX           = FX_SpellHealUnitHealBuff
        NonStackable              = Yes
        RespawnNearbyHordeMembers = Yes
        RespawnFXList             = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay       = 200
    End






    Behavior = AISpecialPowerUpdate AngmarCharge
        CommandButtonName = Command_AngmarChargeAttack
        SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        TriggeredBy          = Upgrade_MiniHordeLvl2
    End

      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate      = SpecialAbilityAngmarCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused        = Yes
    End
    #include "..\..\..\includes\AngmarChargeUpdate.inc"

    CommandSet = AngmarVerdammterCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End
End

Object AngmarNumEliteHorde

    SelectPortrait = UPDarkNum
    ButtonImage    = UPDarkNum

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarNumElite
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarNumEliteHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarNumEliteHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = TERTIARY    NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY NONE
        AutoChooseSources     = QUATERNARY NONE
        ShareWeaponReloadTime = Yes
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 1000
    BuildTime = ELITE_BUILDTIME
    ShroudClearingRange = GONDOR_SOLDIER_HORDE_SHROUD_RANGE
    VisionRange = GONDOR_SOLDIER_HORDE_VISION_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 200
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarNumElite 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed            = AngmarNumEliteBanner
        BannerCarrierPosition            = UnitType:AngmarNumElite    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarNumElite   Position:X:40 Y:0        Position:X:40 Y:17        Position:X:40 Y:-17        Position:X:40 Y:34        Position:X:40 Y:-34

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base



        AddEmotion            =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = AngmarShadowGuardHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
	ConflictsWith		    = Upgrade_GunstlingKarshs Upgrade_GunstlingGulzars Upgrade_GunstlingZaphragors
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Karsh
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_GunstlingKarshs
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Karsh
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Karsh
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = AngmarShadowGuardHorde_Karsh
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Karsh
        TriggeredBy                 = Upgrade_GunstlingKarshs Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Gulzar
        SpecialPowerTemplate         = SpecialAbilityToggleSauronGestaltenSauron
        TriggeredBy                  = Upgrade_GunstlingGulzars
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Gulzar
         SpecialPowerTemplate        = SpecialAbilityToggleSauronGestaltenSauron
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Gulzar
         SpecialPowerTemplate       = SpecialAbilityToggleSauronGestaltenSauron
         MountedTemplate            = AngmarShadowGuardHorde_Gulzar
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Gulzar
        TriggeredBy                 = Upgrade_GunstlingGulzars Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_ToggleNekromantGestaltenSauron
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Zaphragor
        SpecialPowerTemplate         = SpecialAbilityGandalfVerfuhrte
        TriggeredBy                  = Upgrade_GunstlingZaphragors
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Zaphragor
         SpecialPowerTemplate        = SpecialAbilityGandalfVerfuhrte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Zaphragor
         SpecialPowerTemplate       = SpecialAbilityGandalfVerfuhrte
         MountedTemplate            = AngmarShadowGuardHorde_Zaphragor
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Zaphragor
        TriggeredBy                 = Upgrade_GunstlingZaphragors Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfVerfuhrte
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl2
        HealingAmount              = 30
        Radius                     = 100
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive      = No
        BonusName         = GenericDebuff
        TriggeredBy       = Upgrade_GunstlingKarshs
        RefreshDelay      = 2000
        Range             = 200
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP STRUCTURE
        ObjectFilter      = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    CommandSet = AngmarDarkNumEliteHordeCommandSet

    Behavior = CommandSetUpgrade ModuleTag_commandSet1
        TriggeredBy            = Upgrade_GunstlingZaphragors
        CommandSet             = AngmarDarkNumEliteHordeZaphragorCommandSet
    End

    Behavior = CommandSetUpgrade ModuleTag_commandSet2
        TriggeredBy            = Upgrade_GunstlingGulzars
        CommandSet             = AngmarDarkNumEliteHordeGulzarCommandSet
    End

    Behavior = CommandSetUpgrade ModuleTag_commandSet3
        TriggeredBy            = Upgrade_GunstlingKarshs
        CommandSet             = AngmarDarkNumEliteHordeKarshCommandSet
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KarshPowerEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumZaphragorSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_KarshPowerStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumZaphragorSword
        StartsPaused            = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DakNumKarshSwordEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumKarshSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_DakNumKarshSwordStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumKarshSword
        StartsPaused            = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DakNumGulzarSwordEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumGulzarSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_DakNumGulzarSwordStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumGulzarSword
        StartsPaused            = Yes
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KarshPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumKarshSword
        Duration             = 20000
        AttributeModifier    = DarkNumKarshDeathWish
        LockWeaponSlot       = SECONDARY
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ZaphragorPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumZaphragorSword
        Duration             = 20000
        AttributeModifier    = DarkNumFanaticDeathWish
        LockWeaponSlot       = TERTIARY
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_GulzarPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumGulzarSword
        Duration             = 20000
        AttributeModifier    = DarkNumGulzarDeathWish
        LockWeaponSlot       = QUATERNARY
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_GunstlingSchwarzeNumenor
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_GunstlingKarshs
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_GunstlingZaphragors
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_GunstlingGulzars
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_GunstlingSchwarzeNumenor
End


Object AngmarSchwarzeRitterHorde

    SelectPortrait = UPSchwarzeRitter
    ButtonImage    = UPSchwarzeRitter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarSchwarzeRitter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarSchwarzeRitterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarSchwarzeRitterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = TERTIARY    NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY NONE
        AutoChooseSources     = QUATERNARY NONE
        ShareWeaponReloadTime = Yes
    End

    CommandSet = AngmarDarkNumEliteHordeCommandSet


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 1300
    BuildTime = ELITE_BUILDTIME
    ShroudClearingRange = GONDOR_SOLDIER_HORDE_SHROUD_RANGE
    VisionRange = GONDOR_SOLDIER_HORDE_VISION_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 200
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarSchwarzeRitter  5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarSchwarzeRitterBanner
        BannerCarrierPosition    = UnitType:AngmarSchwarzeRitter    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarSchwarzeRitter Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance      =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay   =    1000
        TauntAndPointExcluded      =    NONE
        AfraidOf                   =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf             =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                    =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance           =    150
        FearScanDistance           =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl2
        HealingAmount              = 30
        Radius                     = 100
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive      = No
        BonusName         = GenericDebuff
        TriggeredBy       = Upgrade_GunstlingKarshs
        RefreshDelay      = 2000
        Range             = 200
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP STRUCTURE
        ObjectFilter      = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    CommandSet = AngmarDarkNumEliteHordeCommandSet

    Behavior = CommandSetUpgrade ModuleTag_commandSet1
        TriggeredBy            = Upgrade_GunstlingZaphragors
        CommandSet             = AngmarDarkNumEliteHordeZaphragorCommandSet
    End

    Behavior = CommandSetUpgrade ModuleTag_commandSet2
        TriggeredBy            = Upgrade_GunstlingGulzars
        CommandSet             = AngmarDarkNumEliteHordeGulzarCommandSet
    End

    Behavior = CommandSetUpgrade ModuleTag_commandSet3
        TriggeredBy            = Upgrade_GunstlingKarshs
        CommandSet             = AngmarDarkNumEliteHordeKarshCommandSet
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KarshPowerEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumZaphragorSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_KarshPowerStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumZaphragorSword
        StartsPaused            = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DakNumKarshSwordEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumKarshSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_DakNumKarshSwordStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumKarshSword
        StartsPaused            = Yes
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DakNumGulzarSwordEnabler
        SpecialPowerTemplate    = SpecialAbilityDakNumGulzarSword
        TriggeredBy             = Upgrade_AllFactionUpgrade
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_DakNumGulzarSwordStarter
        SpecialPowerTemplate    = SpecialAbilityDakNumGulzarSword
        StartsPaused            = Yes
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KarshPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumKarshSword
        Duration             = 20000
        AttributeModifier    = DarkNumKarshDeathWish
        LockWeaponSlot       = SECONDARY
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_ZaphragorPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumZaphragorSword
        Duration             = 20000
        AttributeModifier    = DarkNumFanaticDeathWish
        LockWeaponSlot       = TERTIARY
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_GulzarPowerUpdate
        SpecialPowerTemplate = SpecialAbilityDakNumGulzarSword
        Duration             = 20000
        AttributeModifier    = DarkNumGulzarDeathWish
        LockWeaponSlot       = QUATERNARY
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_GunstlingSchwarzeNumenor
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_GunstlingKarshs
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_GunstlingZaphragors
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_GunstlingGulzars
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityGandalfGeprufte
         MountedTemplate            = AngmarShadowKnightHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
	ConflictsWith		    = Upgrade_GunstlingKarshs Upgrade_GunstlingGulzars Upgrade_GunstlingZaphragors
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Karsh
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_GunstlingKarshs
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Karsh
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Karsh
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = AngmarShadowKnightHorde_Karsh
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Karsh
        TriggeredBy                 = Upgrade_GunstlingKarshs Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Gulzar
        SpecialPowerTemplate         = SpecialAbilityToggleSauronGestaltenSauron
        TriggeredBy                  = Upgrade_GunstlingGulzars
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Gulzar
         SpecialPowerTemplate        = SpecialAbilityToggleSauronGestaltenSauron
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Gulzar
         SpecialPowerTemplate       = SpecialAbilityToggleSauronGestaltenSauron
         MountedTemplate            = AngmarShadowKnightHorde_Gulzar
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Gulzar
        TriggeredBy                 = Upgrade_GunstlingGulzars Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_ToggleNekromantGestaltenSauron
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler_Zaphragor
        SpecialPowerTemplate         = SpecialAbilityGandalfVerfuhrte
        TriggeredBy                  = Upgrade_GunstlingZaphragors
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter_Zaphragor
         SpecialPowerTemplate        = SpecialAbilityGandalfVerfuhrte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle_Zaphragor
         SpecialPowerTemplate       = SpecialAbilityGandalfVerfuhrte
         MountedTemplate            = AngmarShadowKnightHorde_Zaphragor
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Zaphragor
        TriggeredBy                 = Upgrade_GunstlingZaphragors Upgrade_TestBuilding
	RequiresAllTriggers	    = Yes
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfVerfuhrte
    End







    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_GunstlingSchwarzeNumenor
End



Object AngmarOrkSchlachterHorde

  ButtonImage            = HSAngmarOrkSchlachter
  SelectPortrait         = UPAngmarOrkSchlachter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarOrkSchlachter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarOrkSchlachter
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarOrkSchlachter
    IsAutoBuilt = Yes


    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = 300
    BuildTime            = MEDIUM_BUILDTIME
    ShroudClearingRange  = 250
    VisionRange          = 200
    VisionSide           = 50%
    VisionRear           = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel       = 0
    CrusherLevel         = 0
    CommandPoints        = 30
    CommandSet           = AngmarOrksBergGramHordeCommandSet
    FormationWidth       = 2
    FormationDepth       = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        AILuaEventsList             = InfantryFunctions
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AttackPriority              = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarOrkSchlachter 15
        Slots             = 15
        PassengerFilter     = ANY +INFANTRY +MONSTER
        ShowPips         = No
        RandomOffset = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed        = AngmarBannerOrc
        BannerCarrierPosition        = UnitType:AngmarOrkSchlachter   Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarOrkSchlachter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:AngmarOrkSchlachter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:AngmarOrkSchlachter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
        SpecialPowerTemplate = SpecialAbilitySiegeDeploy
    End

    Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
        SacrificeFilter            = ALL
        ExperienceModifier         = 1.95
        InitiateVoice              = EVA:BloodthirstySacrificOfOrcs
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =    BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base
        End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        QuarrelProbability    =  0.5%
        AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarOrkSchlachterHordeFree AngmarOrkSchlachterHorde
    BuildCost = 50
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
End


Object AngmarRhudaurKnochenbrecherHorde


  ButtonImage            = HSKnochenbrecher
  SelectPortrait         = UPKnochenbrecher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkMUOrc
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarRhudaurKnochenbrecherHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarRhudaurKnochenbrecherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarRhudaurKnochenbrecherHorde
    IsAutoBuilt = Yes


    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 600
    BuildTime         = STRONG_BUILDTIME
    ShroudClearingRange     = 250
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    CrushableLevel         = 0
    CrusherLevel           = 0
    CommandPoints          = 40
    CommandSet             = AngmarRhudaurKnochenbrecherHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND

    ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown MordorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList            = InfantryFunctions
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarRhudaurKnochenbrecher 10
        Slots             = 10
        PassengerFilter     = ANY +INFANTRY
        ShowPips         = No
        RandomOffset = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurKnochenbrecher Position:X:60 Y:0        Position:X:52 Y:22        Position:X:55 Y:-23        Position:X:47 Y:45        Position:X:50 Y:-42
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurKnochenbrecher Position:X:20 Y:0 Leader 1 0    Position:X:32 Y:18 Leader 1 1    Position:X:16 Y:-21 Leader 1 2    Position:X:31 Y:40 Leader 1 3    Position:X:28 Y:-38 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End



    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker

         TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion        =    Terror_Base
        AddEmotion        =    Doom_Base
        AddEmotion        =       BraceForBeingCrushed_Base
        AddEmotion        =    UncontrollableFear_Base_Evil
        AddEmotion        =    FearIdle_Base
        AddEmotion        =    FearBusy_Base
        AddEmotion        =    Point_Base

        AddEmotion        =    OVERRIDE Taunt_Base
         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Quarrel_Base
        AddEmotion        =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 40.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_MordorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorFighterArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorFighterWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining
End

ChildObject AngmarRhudaurKnochenbrecherHorde_Summoned AngmarRhudaurKnochenbrecherHorde
    IsTrainable    = No
    CommandPoints     = 0
    EquivalentTo      = AngmarRhudaurKnochenbrecherHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = AngmarRhudaurKnochenbrecher_Summoned 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarRhudaurKnochenbrecher_Summoned Position:X:60 Y:0        Position:X:52 Y:22        Position:X:55 Y:-23        Position:X:47 Y:45        Position:X:50 Y:-42
        RankInfo = RankNumber:2 UnitType:AngmarRhudaurKnochenbrecher_Summoned Position:X:20 Y:0 Leader 1 0    Position:X:32 Y:18 Leader 1 1    Position:X:16 Y:-21 Leader 1 2    Position:X:31 Y:40 Leader 1 3    Position:X:28 Y:-38 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime      = ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
        MaxLifetime      = ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
        DeathType        = FADED
    End

End




Object AngmarWolfReiterHorde


    ButtonImage = WOR_DireWolvesIcon
    SelectPortrait = KUDireWolfPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarWolfRiders
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarWolfRiders
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarWolfRiders

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = ANGMAR_WOLFRIDER_BUILDCOST
    BuildTime         = WEAK_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 20

    CommandSet         = AngmarWolfRiderHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarWolfReiter 10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End


        ThisFormationIsTheMainFormation = Yes
        BannerCarrierPosition    = UnitType:AngmarWolfRider    Pos:X:-35.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarWolfReiter Position:X:40 Y:0        Position:X:40 Y:25        Position:X:40 Y:-25        Position:X:40 Y:50        Position:X:40 Y:-50
        RankInfo = RankNumber:2 UnitType:AngmarWolfReiter Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:25 Leader 1 1    Position:X:10 Y:-25 Leader 1 2    Position:X:10 Y:50 Leader 1 3    Position:X:10 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25

        AlternateFormation = AngmarWolfRiderHordeWedgeFormation

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End




    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object AngmarWeierWargHorde


    ButtonImage        = HSWeieWarge
    SelectPortrait     = UPWeieWarge

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             = Angmar
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeAngmarWeierWarg
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_AngmarWeierWargHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_AngmarWeierWargHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME

    VisionRange         = 250
    ShroudClearingRange     = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints         = 20

    CommandSet         = WeierWargHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGPACK_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarWeierWarg  10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY +AngmarWeierWarg
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes
		
        BannerCarriersAllowed    = AngmarBannerDireSnowTroll
        BannerCarrierPosition    = UnitType:AngmarWeierWarg    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarWeierWarg Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:AngmarWeierWarg Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:AngmarWeierWarg Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
        AttributeModifiers          = WhiteWolfBonus
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = SpecialPowerModule ModuleTag_HowlUpdate
        SpecialPowerTemplate          = SpecialAbilityWargHowl
        UpdateModuleStartsAttack      = No
        AttributeModifier         = IsengardWargHowl

        AttributeModifierAffectsSelf     = Yes

        AttributeModifierFX         = FX_WargHowl
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

End

Object AngmarShadowGuardHorde

    SelectPortrait = UPShadowGuardPortrait
    ButtonImage    = BIShadowGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarShadowGuard
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarShadowGuardHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarShadowGuardHorde


    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalMeleeHordeRangefinder
        Weapon = SECONDARY   NormalMeleeHordeRangefinder
        Weapon = TERTIARY    NormalMeleeHordeRangefinder
        Weapon = QUATERNARY  NormalMeleeHordeRangefinder
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY NONE
        AutoChooseSources     = QUATERNARY NONE
        ShareWeaponReloadTime = Yes
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 1350
    BuildTime = ELITE_BUILDTIME

    ShroudClearingRange = INFANTRY_SHROUD_CLEARING
    VisionRange = INFANTRY_VISION_RANGE
    VisionSide = INFANTRY_HORDE_VISION_SIDE
    VisionRear = INFANTRY_HORDE_VISION_REAR
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = INFANTRY_VISION_BONUS_TEST_RADIUS
    VisionBonusPercentPerFoot = INFANTRY_HORDE_VISION_BONUS_PERCENT

    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowGuard 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed            = AngmarNumEliteBanner
        BannerCarrierPosition            = UnitType:AngmarShadowGuard    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowGuard   Position:X:40 Y:0        Position:X:40 Y:17        Position:X:40 Y:-17        Position:X:40 Y:34        Position:X:40 Y:-34

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base

        AddEmotion            =    FearIdle_Base

        AddEmotion            =    FearBusy_Base

        AddEmotion            =    Point_Base

        AddEmotion            =    Taunt_Base

        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly        = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange             = 200
        ScanIntervalSeconds   = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    CommandSet = AngmarShadowGuardHordeCommandSet






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GardistenklingenEnabler
        SpecialPowerTemplate     = SpecialAbilityDakNumKarshSword
        TriggeredBy              = Upgrade_AngmarFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_GardistenklingenPowerUpdate
        SpecialPowerTemplate     = SpecialAbilityDakNumKarshSword
        Duration                 = 30000
        AttributeModifier        = DarkNumKarshDeathWish
        LockWeaponSlot           = SECONDARY
        StartsPaused             = Yes
    End





    Behavior = SpecialPowerModule ModuleTag_SchwurStarter
        SpecialPowerTemplate     = SpecialAbilitySchwarzerSchwur
        StartsPaused             = No
        UpdateModuleStartsAttack = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SchwurWeaponFireUpdate
        SpecialPowerTemplate     = SpecialAbilitySchwarzerSchwur
        SkipContinue             = Yes
        UnpackTime               = 1100
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 500
        MustFinishAbility        = Yes
        AwardXPForTriggering     = 0
        StartAbilityRange        = 200
        WhichSpecialWeapon       = 1
        SpecialWeapon            = SchwarzerSchwurWeapon
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = HEALING_AMOUNT_HEROUNIT
        Radius                     = 55
        StartHealingDelay          = START_HEALING_DELAY_HEROUNIT
        HealingDelay               = HEALING_DELAY_HEROUNIT
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = RESPAWN_MINIMUM_DELAY_HEROUNIT
    End



    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End
End

Object AngmarShadowKnightHorde

    SelectPortrait = UPShadowKnightPortrait
    ButtonImage    = BIShadowKnight

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeAngmarShadowKnight
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarShadowKnightHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarShadowKnightHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     NormalCavalryHordeRangefinder
        Weapon = SECONDARY   NormalCavalryHordeRangefinder
        Weapon = TERTIARY    NormalCavalryHordeRangefinder
        Weapon = QUATERNARY  NormalCavalryHordeRangefinder
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY NONE
        AutoChooseSources     = QUATERNARY NONE
        ShareWeaponReloadTime = Yes
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost        = 1350
    BuildTime        = HEROIC_BUILDTIME
    VisionRange        = 200

    VisionSide         = 35%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 5.0%
    ShroudClearingRange     = 500

    CommandPoints        = 50
    CommandSet           = AngmarShadowKnightHordeCommandset

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel        = 2
    CrusherLevel          = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback        = 40
    CrushZFactor          = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_KNIGHT_HORDE_THREAT
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowKnight  5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarSchwarzeRitterBanner
        BannerCarrierPosition    = UnitType:AngmarShadowKnight    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowKnight Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded       =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
         AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                     =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly        = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange             = 200
        ScanIntervalSeconds   = 0.5
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GardistenklingenEnabler
        SpecialPowerTemplate     = SpecialAbilityDakNumKarshSword
        TriggeredBy              = Upgrade_AngmarFaction
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_GardistenklingenPowerUpdate
        SpecialPowerTemplate     = SpecialAbilityDakNumKarshSword
        Duration                 = 30000
        AttributeModifier        = DarkNumKarshDeathWish
        LockWeaponSlot           = SECONDARY
        StartsPaused             = Yes
    End






    Behavior = SpecialPowerModule ModuleTag_SchwurStarter
        SpecialPowerTemplate     = SpecialAbilitySchwarzerSchwur
        StartsPaused             = No
        UpdateModuleStartsAttack = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SchwurWeaponFireUpdate
        SpecialPowerTemplate     = SpecialAbilitySchwarzerSchwur
        SkipContinue             = Yes
        UnpackTime               = 1000
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 500
        MustFinishAbility        = Yes
        AwardXPForTriggering     = 0
        StartAbilityRange        = 200
        WhichSpecialWeapon       = 1
        SpecialWeapon            = SchwarzerSchwurWeapon
    End


    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = 40
        Radius                     = 55
        StartHealingDelay          = 15000
        HealingDelay               = 15000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 300
    End







    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject AngmarShadowGuardHorde_Karsh AngmarShadowGuardHorde

    CommandSet         = AngmarShadowGuardHorde_KarshCommandset

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowGuard 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed            = AngmarNumEliteBannerKarsh
        BannerCarrierPosition            = UnitType:AngmarShadowGuard    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowGuard   Position:X:40 Y:0        Position:X:40 Y:17        Position:X:40 Y:-17        Position:X:40 Y:34        Position:X:40 Y:-34

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableKarsh
        UpgradeToGrant      = Upgrade_GunstlingKarshs
        GiveOnBuildComplete = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive      = No
        BonusName         = GenericDebuff
        TriggeredBy       = Upgrade_MiniHordeLvl1
        RefreshDelay      = 2000
        Range             = 200
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP STRUCTURE
        ObjectFilter      = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
End

ChildObject AngmarShadowGuardHorde_Gulzar AngmarShadowGuardHorde

    CommandSet         = AngmarShadowGuardHorde_GulzarCommandset

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowGuard 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed            = AngmarNumEliteBannerGulzar
        BannerCarrierPosition            = UnitType:AngmarShadowGuard    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowGuard   Position:X:40 Y:0        Position:X:40 Y:17        Position:X:40 Y:-17        Position:X:40 Y:34        Position:X:40 Y:-34

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableGulzar
        UpgradeToGrant      = Upgrade_GunstlingGulzars
        GiveOnBuildComplete = Yes
    End

End

ChildObject AngmarShadowGuardHorde_Zaphragor AngmarShadowGuardHorde

    CommandSet         = AngmarShadowGuardHorde_ZaphragorCommandset

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowGuard 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed            = AngmarNumEliteBannerZaphragor
        BannerCarrierPosition            = UnitType:AngmarShadowGuard    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowGuard   Position:X:40 Y:0        Position:X:40 Y:17        Position:X:40 Y:-17        Position:X:40 Y:34        Position:X:40 Y:-34

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableZaphragor
        UpgradeToGrant      = Upgrade_GunstlingZaphragors
        GiveOnBuildComplete = Yes
    End
End

ChildObject AngmarShadowKnightHorde_Karsh AngmarShadowKnightHorde

    CommandSet         = AngmarShadowKnightHorde_KarshCommandset

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowKnight  5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarSchwarzeRitterBanner
        BannerCarrierPosition    = UnitType:AngmarShadowKnight    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowKnight Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableKarsh
        UpgradeToGrant      = Upgrade_GunstlingKarshs
        GiveOnBuildComplete = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive      = No
        BonusName         = GenericDebuff
        TriggeredBy       = Upgrade_MiniHordeLvl1
        RefreshDelay      = 2000
        Range             = 200
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP STRUCTURE
        ObjectFilter      = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
End

ChildObject AngmarShadowKnightHorde_Gulzar AngmarShadowKnightHorde

    CommandSet         = AngmarShadowKnightHorde_GulzarCommandset

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowKnight  5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarSchwarzeRitterBanner
        BannerCarrierPosition    = UnitType:AngmarShadowKnight    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowKnight Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableGulzar
        UpgradeToGrant      = Upgrade_GunstlingGulzars
        GiveOnBuildComplete = Yes
    End
End

ChildObject AngmarShadowKnightHorde_Zaphragor AngmarShadowKnightHorde

    CommandSet         = AngmarShadowKnightHorde_ZaphragorCommandset

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = AngmarShadowKnight  5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarSchwarzeRitterBanner
        BannerCarrierPosition    = UnitType:AngmarShadowKnight    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:AngmarShadowKnight Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableZaphragor
        UpgradeToGrant      = Upgrade_GunstlingZaphragors
        GiveOnBuildComplete = Yes
    End
End

Object DunkelelfenHorde


    ButtonImage            = HSDunkelelfArcher
    SelectPortrait         = UPDunkelelfArcher


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEULoW
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName              = OBJECT:HordeDunkelelfenArcher
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_HordeDunkelelfenArcher
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_HordeDunkelelfenArcher

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     LorienArcherMissileHordeRangefinder
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    CommandSet = DunkelelfenHordeCommandSet





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel     = 0
    CrusherLevel     = 0
    UseCrushAttack     = No

    BuildCost     = 700
    BuildTime     = MEDIUM_BUILDTIME
    VisionRange     = ELVEN_LORIENARCHER_HORDE_VISION_RANGE
    VisionSide     = 50%
    VisionRear     = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange = ELVEN_LORIENARCHER_HORDE_SHROUD_RANGE
    CommandPoints     = 50

    MaxSimultaneousOfType             = 3

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = ELVEN_LORIENARCHER_HORDE_THREAT
    ThreatBreakdown ElvenLorienArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = Dunkelelfen 10
        Slots             = 10
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = DunkelelfBanner
        BannerCarrierPosition    = UnitType:Dunkelelfen    Pos:X:70.0 Y:0.0



        RankInfo = RankNumber:1 UnitType:Dunkelelfen Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:Dunkelelfen Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4







        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS


        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SilverThornArrows
    End







    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorRangerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorRangerUpgradedWeapon
    End

End

Object DunkelelfAsassinHorde

   ButtonImage     = HSDunkelelbSichel
   SelectPortrait  = UPDunkelelbSichel

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUCor
        End
    End

    Side                  = Angmar
    EditorSorting         = UNIT
    EmotionRange          = 240
    DisplayName           = OBJECT:DunkelelfAsassinHorde
    DisplayNameStrategic  = CONTROLBAR:LW_Unit_DunkelelfAsassinHorde
    DescriptionStrategic  = CONTROLBAR:LW_ToolTip_DunkelelfAsassinHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME

    ShroudClearingRange     = MORDOR_CORSAIR_HORDE_SHROUDCLEAR_RANGE
    VisionRange         = MORDOR_CORSAIR_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%

    CrushableLevel         = 0
    CrusherLevel           = 0
    CommandPoints          = 50
    CommandSet             = DunkelelfAsassineHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = MORDOR_CORSAIRSOFUMBAR_HORDE_THREAT
    ThreatBreakdown MordorCorsairsOfUmbarHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload         = DunkelelfAsassin 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed        = DunkelelfBanner
        BannerCarrierPosition        = UnitType:DunkelelfAsassin    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:DunkelelfAsassin Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:DunkelelfAsassin Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1  2
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly     = Yes
        StuffToPickUp     = ANY +CRATE -TheDroppedRing
        ScanRange     = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = WallScalingMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    #include "..\..\..\includes\CaptureBuilding.inc"



    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType            = CAMOUFLAGE
            ForbiddenConditions         = TAKING_DAMAGE FIRING_ANY USING_ABILITY
            DetectionRange              = CAMOUFLAGE_RADIUS
            Options                     = ALLOW_NEAR_TREES
        End
		UnitSpecificSoundNameToUseAsVoiceMoveToStealthyArea = VoiceMoveToTrees
		UnitSpecificSoundNameToUseAsVoiceEnterStateMoveToStealthyArea = VoiceEnterStateMoveToTrees
        StartsActive                    = Yes
        UpdatePeriod                    = 2000
    End





    Behavior = AISpecialPowerUpdate MordorCorsairsOfUmbarHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius    = 50.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No

End

Object DunkelelfMagierHorde


    ButtonImage            = HSDunkelelfMagier
    SelectPortrait         = UPDunkelelfMagier

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:DunkelelfMagier
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DunkelelfMagierHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LichtbringerHorde

    WeaponSet
        Conditions     = None
        Weapon        = PRIMARY    SchattenbinderMissileHordeRangefinder
    End

    CommandSet = DunkelelbSchattenbinderHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 1
    CrusherLevel = 0

    BuildCost = 700
    BuildTime = MEDIUM_BUILDTIME
    VisionRange             = ELVEN_MIRKWOOD_ARCHER_HORDE_VISION_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = ELVEN_MIRKWOOD_ARCHER_HORDE_SHROUD_RANGE
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE
    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = DunkelelfMagier 3
        Slots = 3
        PassengerFilter = NONE +DunkelelfMagier
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:DunkelelfMagier Position:X:50 Y:0        Position:X:50 Y:30        Position:X:50 Y:-30

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_HORDE_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"



    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End











    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DissentEnabler
        SpecialPowerTemplate        = SpecialAbilityMouthOfSauronDissent
        TriggeredBy                 = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_DissentStarter
        SpecialPowerTemplate        = SpecialAbilityMouthOfSauronDissent
        StartsPaused                = No
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_DissentMover
        SpecialPowerTemplate        = SpecialAbilityMouthOfSauronDissent
        StartAbilityRange           = 300
        TriggerSpecialPower         = ModuleTag_DissentTrigger TARGETPOS
    End

    Behavior = SpecialPowerModule ModuleTag_DissentTrigger
        SpecialPowerTemplate        = SpecialAbilityMouthOfSauronDissent
        AttributeModifier           = MouthOfSauronDissentModifier
        AttributeModifierRange      = MOUTH_OF_SAURON_DISSENT_RADIUS
        AttributeModifierAffects    = ANY +INFANTRY +CAVALRY +MONSTER -HERO
        TriggerFX                   = FX_SchattenbinderDissent
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
        TargetAllSides              = Yes
    End









    Behavior = SpecialPowerModule   ModuleTag_Blight
        SpecialPowerTemplate        = SpellBookBlight
        AttributeModifier           = SpellBookBlight
        AttributeModifierRange      = BLIGHT_EFFECT_RADIUS
        AttributeModifierAffects    = BLIGHT_TYPE_SPELL_OBJECT_FILTER
        TriggerFX                   = FX_BlightSpellFX
        UpdateModuleStartsAttack    = No
        AvailableAtStart            = No
        TargetEnemy                 = Yes
    End







    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


End

Object DunkelelbPikeHorde


       ButtonImage            = HSDunkelelbPike
       SelectPortrait         = UPDunkelelbPike

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags     = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEULoW
        End
    End

    Side         = Angmar
    EditorSorting     = UNIT
    EmotionRange     = 240
    DisplayName     = OBJECT:DunkelelbPikeHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DunkelelbPikeHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DunkelelbPikeHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    TowerGuardHordeRangefinder
    End
    WeaponSet
        Conditions     = CONTAINED
        Weapon     = PRIMARY GarrisonedUnitBowHordeRangefinder
    End

    CommandSet = DunkelelfenHordeCommandSet





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel = 0
    CrusherLevel = 0

    BuildCost   = 480
    BuildTime   = MEDIUM_BUILDTIME
    VisionRange         = ELVEN_MITHLONDSENTRY_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = ELVEN_MITHLONDSENTRY_SHROUD_RANGE
    CommandPoints         = 50
    MaxSimultaneousOfType             = 3

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND PIKE

    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT
    ThreatBreakdown ElvenMithlondSentryHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = DunkelelbPike 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset         = X:0 Y:0
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = DunkelelfBanner
        BannerCarrierPosition    = UnitType:DunkelelbPike    Pos:X:70.0 Y:0.0     for elven warrior horde

        RankInfo = RankNumber:1 UnitType:DunkelelbPike Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:DunkelelbPike Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking     = 1 2

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%

        AlternateFormation = DunkelelbPikeHordePorcupine
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End







    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_ElvenMithlondSentryHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

End

ChildObject DunkelelbPikeHordePorcupine DunkelelbPikeHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained         =
        InitialPayload                = DunkelelbPike 10
        Slots                    = 10
        PassengerFilter                = NONE +INFANTRY
        ShowPips                = No
        ThisFormationIsTheMainFormation     = No
        RandomOffset                = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking           = 0
        AttributeModifiers            = ElvenMithlondSentryHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize            = 5

        AlternateFormation            = DunkelelbPikeHorde
        VisionRearOverride            = 100%
        VisionSideOverride            = 100%
        NotComboFormation            = Yes


        BannerCarriersAllowed    = DunkelelfBanner
        BannerCarrierPosition    = UnitType:DunkelelbPike    Pos:X:0.0 Y:0.0

        RankInfo        = RankNumber:1 UnitType:DunkelelbPike Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
   End
End

Object DunkelelfenreiterHorde


    SelectPortrait    = UPDunkelelfReiter
    ButtonImage       = HSDunkelelfReiter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkEURIL
        End
    End

    Side                 = Angmar
    EditorSorting        = UNIT
    EmotionRange         = 240
    DisplayName          = OBJECT:HordeDunkelelfenreiter
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_DunkelelfenreiterHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_DunkelelfenreiterHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = 700
    BuildTime        = MEDIUM_BUILDTIME
    VisionRange        = GONDOR_KNIGHTSOFDOL_HORDE_VISION_RANGE

    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = GONDOR_KNIGHTSOFDOL_HORDE_SHROUD_RANGE

    CommandPoints        = 60

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel        = 2
    CrusherLevel        = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback        = 40
    CrushZFactor        = 1.0

        TransportSlotCount    = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf            = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    CommandSet        = RohanRohirrimModCommandSet

    ThreatLevel = GONDOR_KNIGHTSOFDOL_HORDE_THREAT
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = Dunkelelfenreiter 10
        Slots             = 10
        PassengerFilter     = NONE +CAVALRY
        ShowPips         = No
        RandomOffset         = X:2 y:3
        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:Dunkelelfenreiter     Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:Dunkelelfenreiter     Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    Behavior = AISpecialPowerUpdate RivendellLancerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate ElvenMirkwoodArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End
End

Object DunkelelfenHorde2


    ButtonImage            = HSDunkelelfWarrior
    SelectPortrait         = UPDunkelelfWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags     = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model         = None
        End
        ModelConditionState     = HORDE_EMPTY
            Model         = None
        End
        ModelConditionState     = WORLD_BUILDER
            Model         = HordeMarkEULoW
        End
    End

    Side                     = Angmar
    EditorSorting            = UNIT
    EmotionRange             = 240
    DisplayName              = OBJECT:HordeDunkelelfen1
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_HordeDunkelelfen1
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_HordeDunkelelfen1



    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End


    CommandSet         = DunkelelfenHordeCommandSet





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel         = 0
    CrusherLevel         = 0

    BuildCost   = 500
    BuildTime   = MEDIUM_BUILDTIME
    VisionRange         = ELVEN_LORIENWARRIOR_HORDE_VISION_RANGE
    VisionSide     = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange     = ELVEN_LORIENWARRIOR_HORDE_SHROUD_RANGE
    CommandPoints         = 50
    MaxSimultaneousOfType             = 3

    FormationWidth         = 2
    FormationDepth         = 1

    TransportSlotCount         = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    CamouflageDetectionMultiplier     = CAMOUFLAGE_DETECTION_DISTANCE_LONG


    ThreatLevel         = ELVEN_LORIENWARRIOR_HORDE_THREAT
    ThreatBreakdown ElvenLorienWarriorHorde_DetailedThreat
        AIKindOf     = INFANTRY
    End

    Body             = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth     = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = Dunkelelfen2 10
        Slots                 = 10
        PassengerFilter            = NONE +Dunkelelfen2 +BANNER
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed        = DunkelelfBanner
        BannerCarrierPosition        = UnitType:Dunkelelfen2    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:Dunkelelfen2 Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:Dunkelelfen2 Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor         = NormalMeleeHordeLocomotor
        Condition         = SET_NORMAL
        Speed             = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior         = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy     = Upgrade_BasicTraining
        LevelsToGain     = 1
        LevelCap     = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SilverThornArrows
    End








    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 30.0
    GeometryMinorRadius     = 50.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End
End

Object AngmarGulzarHorde

    SelectPortrait     = HPGulzar
    ButtonImage        = HIGulzar

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUDFG
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGulzar
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarGulzarHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarGulzarHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost             = 1000
    BuildTime             = ELITE_BUILDTIME
    VisionRange           = VISION_HERO_STANDARD
    ShroudClearingRange   = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandSet             = AngmarGulzarCommandSet_Start
    CommandPoints             = 0
    MaxSimultaneousOfType = 1
    FormationWidth             = 2
    FormationDepth             = 2

    CrushableLevel             = 0
    CrusherLevel             = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE SUPPORT ATTACK_NEEDS_LINE_OF_SIGHT HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND PATH_THROUGH_INFANTRY HERO

    ThreatLevel = ANGMAR_NECRO_HORDE_THREAT
    ThreatBreakdown AngmarGuardianHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000

        CanAttackWhileContained        = Yes
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Archer
    End


    Behavior                       = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained    =
        InitialPayload             = AngmarGulzarAcolyte 7
        Slots                      = 7
        PassengerFilter            = NONE +ARCHER
        ShowPips                   = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset  = X:10 Y:10
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = AngmarGulzar
        BannerCarrierPosition    = UnitType:AngmarGulzar    Pos:X:0.0 Y:0.0
        BannerCarrierDestroyHordeOnDeath = Yes
        BannerCarrierHordeDeathType = +NORMAL
        BannerCarrierMinLevel   = 0

        RankInfo    = RankNumber:1 UnitType:AngmarGulzarAcolyte Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78

        RanksToReleaseWhenAttacking    = 1
        MeleeAttackLeashDistance       = 25
        BackUpMinDelayTime             = 1
        BackUpMaxDelayTime             = 3000
        BackUpMinDistance              = 1
        BackUpMaxDistance              = 3
        BackupPercentage               = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 60.0
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End








    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = Yes
        StartsPaused      = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive      = Yes
        BonusName         = PrasenzdesHexenmeistersDebuff
        RefreshDelay      = 2000
        Range             = 300
        TargetEnemy       = Yes
        AntiCategory      = LEADERSHIP STRUCTURE
        ObjectFilter      = NONE +HERO ENEMIES
    End







    Behavior = SpecialPowerModule ModuleTag_SchattenschlagStarter
        SpecialPowerTemplate        = SpecialAbilityGulzarSchattenschlag
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SchattenschlagUpdate
        SpecialPowerTemplate        = SpecialAbilityGulzarSchattenschlag
        WhichSpecialWeapon          = 6
        SkipContinue                = Yes
        UnpackTime                  = 1700
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1000
        AwardXPForTriggering        = 0
        StartAbilityRange           = SARUMAN_FIREBALL_RANGE
        MustFinishAbility           = Yes
        SpecialWeapon               = GulzarSchattenschlagWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_SchattenschlagAutoAbility
        SpecialAbility              = SpecialAbilityGulzarSchattenschlag
        MaxScanRange                = #SUBTRACT( SARUMAN_FIREBALL_RANGE 25 )
        Query                       = 1 ALL ENEMIES -STRUCTURE
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LebensschildEnabler
        SpecialPowerTemplate      = SpecialAbilityLebensschild
        TriggeredBy               = Upgrade_TechnologyGulzarLebensschild
    End

    Behavior = SpecialPowerModule ModuleTag_LebensschildStarter
        SpecialPowerTemplate      = SpecialAbilityLebensschild
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LebensschildWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityLebensschild
        WhichSpecialWeapon        = 2
        SkipContinue              = Yes
        UnpackTime                = 1700
        PackTime                  = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering      = 0
        StartAbilityRange         = 80.0
        SpecialWeapon             = GulzarLebensschildNewWeapon
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SeelenopferEnabler
        SpecialPowerTemplate      = SpecialAbilityGulzardasSeelenopfer
        TriggeredBy               = Upgrade_TechnologyGulzarSeelenopfer
    End

    Behavior = SpecialPowerModule ModuleTag_SeelenopferStarter
        SpecialPowerTemplate      = SpecialAbilityGulzardasSeelenopfer
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SeelenopferWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityGulzardasSeelenopfer
        WhichSpecialWeapon        = 3
        SkipContinue              = Yes
        UnpackTime                = 1700
        PackTime                  = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering      = 0
        StartAbilityRange         = 80.0
        SpecialWeapon             = GulzarSeelenopfernewWeapon
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MagiebundlungEnabler
        SpecialPowerTemplate     = SpecialAbilityMagiebundlung
        TriggeredBy              = Upgrade_TechnologyGulzarSeelenwanderung
    End

    Behavior = SpecialPowerModule ModuleTag_MagiebundlungStarter
        SpecialPowerTemplate     = SpecialAbilityMagiebundlung
        UpdateModuleStartsAttack = Yes
        TriggerFX                = FX_MagiebundlungWeapon
        StartsPaused             = Yes
    End

    Behavior = TeleportSpecialAbilityUpdate ModuleTag_MagiebundlungUpdate
        SpecialPowerTemplate     = SpecialAbilityMagiebundlung
        UnpackingVariation       = 3
        UnpackTime               = 1500
        PackTime                 = 1000
        ApproachRequiresLOS      = No
        BusyForDuration          = 8000
        DestinationWeaponName    = MagiebundlungWeapon
    End







    Behavior = SpecialPowerModule ModuleTag_SchattenschleierStarter
        SpecialPowerTemplate        = SpecialAbilityGulzarSchattenschleier
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_SchattenschleierMover
        SpecialPowerTemplate       = SpecialAbilityGulzarSchattenschleier
        StartAbilityRange          = ANGMAR_NECRO_FELL_STRENGTH_START_RANGE
        TriggerSpecialPower        = ModuleTag_SchattenschleierTrigger TARGETPOS
        TriggerSpecialPower        = ModuleTag_SchattenschleierUnseen  TARGETPOS
    End

    Behavior = SpecialPowerModule ModuleTag_SchattenschleierTrigger
        SpecialPowerTemplate       = SpecialAbilityGulzarSchattenschleier
        TriggerFX                  = FX_GulzarSchattenschleier
        UpdateModuleStartsAttack   = No
        StartsPaused               = No
    End

    Behavior = InvisibilitySpecialPower ModuleTag_SchattenschleierUnseen
        SpecialPowerTemplate        = SpecialAbilityActivateeDummy
        AvailableAtStart            = Yes
        StartsPaused                = No
        BroadcastRadius             = THRANDUIL_MOVEUNSEEN_EFFECT_RADIUS
        ObjectFilter                = ANY +HORDE +HERO +DOZER ALLIES
        Duration                    = 30000
        InvisibilityNugget
            ForbiddenConditions        = FIRING_ANY
            DetectionRange            = CAMOUFLAGE_RADIUS
            InvisibilityType        = CAMOUFLAGE
        End
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Vergeltung
        SpecialPowerTemplate       = SpecialAbilityFlammendeVergeltung
        TriggeredBy                = Upgrade_TechnologyGulzarFlammendeVergeltung
    End

    Behavior = SpecialPowerModule ModuleTag_VergeltungStarter
        SpecialPowerTemplate       = SpecialAbilityFlammendeVergeltung
        StartsPaused               = Yes
        UpdateModuleStartsAttack   = Yes
        TriggerFX                  = FX_FlammendeVergeltung
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_VergeltungBlastWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityFlammendeVergeltung
        WhichSpecialWeapon         = 4
        SkipContinue               = Yes
        FreezeAfterTriggerDuration = 200
        UnpackTime                 = 1700
        PreparationTime            = 1
        PackTime                   = 1000
        AwardXPForTriggering       = 0
        StartAbilityRange          = ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
        SpecialWeapon              = FlammendeVergeltungWeapon
        TriggerSound               = GulzarVoiceFlammendeVergeltung
    End

    Behavior = AutoAbilityBehavior ModuleTag_VergeltungAutoAbility
        SpecialAbility             = SpecialAbilityFlammendeVergeltung
        MaxScanRange               = 80
        Query                      = 1 ANY +HORDE +INFANTRY ENEMIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FluchdesHexenmeistersEnabler
        SpecialPowerTemplate        = SpecialAbilityFluchesHexenmeisters
        TriggeredBy                 = Upgrade_TechnologyGulzarFluchdesHexenmeisters
    End

    Behavior = SpecialPowerModule ModuleTag_FluchdesHexenmeistersStarter
        SpecialPowerTemplate        = SpecialAbilityFluchesHexenmeisters
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FluchdesHexenmeistersUpdate
        SpecialPowerTemplate        = SpecialAbilityFluchesHexenmeisters
        WhichSpecialWeapon          = 5
        SkipContinue                = Yes
        UnpackTime                  = 1700
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1000
        AwardXPForTriggering        = 0
        StartAbilityRange           = SARUMAN_FIREBALL_RANGE
        MustFinishAbility           = Yes
        SpecialWeapon               = GulzarFluchWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_FluchdesHexenmeistersAutoAbility
        SpecialAbility              = SpecialAbilityFluchesHexenmeisters
        MaxScanRange                = #SUBTRACT( SARUMAN_FIREBALL_RANGE 25 )
        Query                       = 1 ANY +HERO ENEMIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MorgulseucheEnabler
        SpecialPowerTemplate         = SpecialAbilityGulzarMorgulSeuche
        TriggeredBy                  = Upgrade_TechnologyGulzarMorgulseuche
    End

    Behavior = SpecialPowerModule ModuleTag_MorgulseucheStarter
        SpecialPowerTemplate         = SpecialAbilityGulzarMorgulSeuche
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MorgulseucheWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityGulzarMorgulSeuche
        WhichSpecialWeapon           = 5
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 1000
        UnpackTime                   = 1700
        PreparationTime              = 1
        PackTime                     = 1000
        AwardXPForTriggering         = 0
        StartAbilityRange            = 270
        SpecialWeapon                = GulzarMorgulseucheWeapon
        TriggerSound                 = EasMachtBlastWeapon
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DunklesRitualEnabler
        SpecialPowerTemplate         = SpecialAbilityGulzarDunklesRitual
        TriggeredBy                  = Upgrade_TechnologyGulzarDunklesRitual
    End

    Behavior = SpecialPowerModule ModuleTag_DunklesRitualStarter
        SpecialPowerTemplate         = SpecialAbilityGulzarDunklesRitual
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_DunklesRitualWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityGulzarDunklesRitual
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 1000
        UnpackTime                   = 1700
        PreparationTime              = 1
        PackTime                     = 1000
        AwardXPForTriggering         = 0
        StartAbilityRange            = 270
        SpecialWeapon                = GulzarDunklesRitualWeapon
    End










    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild
        CommandSet          = AngmarGulzarCommandSet_variante1a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer
        CommandSet          = AngmarGulzarCommandSet_variante1b
    End





    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a
    End





    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3a
    End





    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3a4a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3a4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3a4b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3a4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3b4a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3b4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2a3b4b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2a3b4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3b4a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3b4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3b4b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3b4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3a4a
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3a4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1a2b3a4b
        TriggeredBy         = Upgrade_TechnologyGulzarLebensschild Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1a2b3a4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3b4a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3b4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3b4b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3b4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3b4a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3b4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3b4b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFlammendeVergeltung Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3b4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3a4a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3a4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2b3a4b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSchattenschleier Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2b3a4b
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3a4a
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarMorgulseuche
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3a4a
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_variante1b2a3a4b
        TriggeredBy         = Upgrade_TechnologyGulzarSeelenopfer Upgrade_TechnologyGulzarSeelenwanderung Upgrade_TechnologyGulzarFluchdesHexenmeisters Upgrade_TechnologyGulzarDunklesRitual
        RequiresAllTriggers = Yes
        CommandSet          = AngmarGulzarCommandSet_variante1b2a3a4b
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate FireballAI
        CommandButtonName = Command_SpecialAbilityGulzarDarthBall
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate AngmarNecroCorpseRainAI
        CommandButtonName = Command_SpecialAbilityGulzarMOrgulSeuche
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
    End

    Behavior = AISpecialPowerUpdate ThunderboltAI
        CommandButtonName = Command_FlammendeVergeltung
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate CurseEnemyL3AI
        CommandButtonName = Command_Magiekopplung
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_RANGED
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_BoromirBody

    AutoResolveArmor
        Armor = AutoResolve_BoromirArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_BoromirWeapon
    End
End

Object AngmarNachtmahrHorde


    ButtonImage = HSNachtmahr
    SelectPortrait = UPNachtmahr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkIUWar
        End
    End

    Side             = Angmar
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeAngmarNachtmahr
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_AngmarNachtmahr
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_AngmarDireWolfHorde

    WeaponSet
        Conditions = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
        Weapon        = SECONDARY    NormalMissileHordeRangefinder
    End







    BuildCost         = ANGMAR_WOLFRIDER_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange = 450

    VisionSide         = 50%
    VisionRear         = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CommandPoints = 40

    CommandSet = AngmarNachtmahrCommandSet


    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 2
    CrusherLevel         = 1
    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    CrushKnockback         = 40
    CrushZFactor         = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
    ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
        AddEmotion    =       CheerForAboutToCrush_Base
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = AngmarNachtmahr  8
        Slots             = 8
        PassengerFilter     = NONE +CAVALRY +AngmarNachtmahr
        ShowPips         = No
        RandomOffset         = X:2 y:3

        MeleeBehavior         = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes

        RankInfo    = RankNumber:1 UnitType:AngmarNachtmahr Position:X:30 Y:-35    Position:X:50 Y:-15    Position:X:65 Y:15    Position:X:30 Y:42        Position:X:-5 Y:-25    Position:X:-45 Y:0    Position:X:5 Y:5    Position:X:-20 Y:30

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
        AttributeModifiers = IsengardWargSkirmish
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End


    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End




    Behavior = AISpecialPowerUpdate HowlAI
        CommandButtonName = Command_SpecialAbilityWargHowl
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_IsengardWargRiderArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_IsengardWargRiderWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object AngmarNazgulHorde

    SelectPortrait         = HPBlackRiderTogether
    ButtonImage = HIBlackRider

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarNazgulHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarNazgulHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarNazgulHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 1000
    BuildTime         = ELITE_BUILDTIME
    ShroudClearingRange     = 325
    VisionRange         = 200
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 30

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1

    CrushOnlyWhileCharging = Yes

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarNazgul 3
        Slots                 = 3
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarNazgul Position:X:25 Y:0      Position:X:10 Y:22     Position:X:0 Y:-20

        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded         = NONE
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS


        AddEmotion            = BraceForBeingCrushed_Base


        AddEmotion            = FearIdle_Base
        AddEmotion            = Point_Base
        AddEmotion            = Taunt_Base
        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly         = Yes
        StuffToPickUp         = ANY +CRATE -TheDroppedRing
        ScanRange         = 200
        ScanIntervalSeconds     = 0.5
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_FAST_HORDE_SPEED
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive            = No
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack    = Yes
        TriggeredBy            = Upgrade_MiniHordeLvl2
        HealingAmount            = 30
        Radius                = 55
        StartHealingDelay         = 7500
        HealingDelay            = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable            = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList            = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End




    Behavior = SpecialPowerModule ModuleTag_Screech
        SpecialPowerTemplate        = SpecialAbilityScreech
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = SpecialAbilityUpdate ModuleTag_ScreechUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = NazgulScreech
        EffectRange                 = 180
        PreparationTime             = 1
        PackTime                    = 3000
        CustomAnimAndDuration       = AnimState:SPECIAL_WEAPON_TWO AnimTime:3000
    End




    Behavior = SpecialPowerModule ModuleTag_BlackRiderDreadVisageUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive        = Yes
        BonusName        = GenericDebuff
        TriggeredBy        = Upgrade_Level_1
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory       = LEADERSHIP BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                        = Yes
        TriggeredBy                            = Upgrade_Level_1
        WhichSpecialPower                    = 1
        GenerateTerror                        = No
        GenerateFear            = Yes
        EmotionPulseRadius                    = 100
        EmotionPulseInterval                = 1000
    End







    Behavior = SpecialPowerModule ModuleTag_BlackRiderMorgulBladeStarter
        SpecialPowerTemplate        = SpecialAbilityBlackRiderMorgulBlade
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
        InitiateSound               = RinggeistVoiceMorgulBlade
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BlackRiderMorgulBladeUpdate
        SpecialPowerTemplate    = SpecialAbilityBlackRiderMorgulBlade
        SkipContinue            = Yes

        UnpackTime                = 250
        PreparationTime            = 1
        PersistentPrepTime        = 500
        PackTime                = 100

        AwardXPForTriggering    = 0
        StartAbilityRange        = 15.0

        SpecialWeapon            = SchwarzeReiterMorgulBlade
        WhichSpecialWeapon        = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_MorgulBladeAutoAbility
        SpecialAbility    = SpecialAbilityBlackRiderMorgulBlade
        ForbiddenStatus = INSIDE_GARRISON
        AllowSelf        = No
        Query            = 1 MORGULBLADE_OBJECT_FILTER
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    #include "..\..\..\includes\AngmarChargeUpdate.inc"

    CommandSet = AngmarNazgulCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End

ChildObject AngmarNazgulHorde_Summoned AngmarNazgulHorde
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = AngmarNazgulHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = AngmarNazgul_Summoned 3
        Slots                 = 3
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarNazgul_Summoned Position:X:25 Y:0      Position:X:10 Y:22     Position:X:0 Y:-20

        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End
End

Object AngmarHeroWolfHorde


    ButtonImage        = HIWerewolf
    SelectPortrait    = KUWerewolfPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
        DefaultModelConditionState
            Model = None
        End

        RandomTexture = kuwwolf_bat.tga 0 kuwwolf.tga

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUOrc
        End
    End



    Side = Angmar
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:AngmarHeroWolfHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HeroWolfHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DwarvenZerkerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = MORDOR_BLACKURUK_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange = DWARVEN_ZERKER_HORDE_VISION_RANGE
    ShroudClearingRange = DWARVEN_ZERKER_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    MaxSimultaneousOfType        = 3
    CommandPoints = 120

    FormationWidth         = 2
    FormationDepth         = 2

    CrushableLevel = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = DWARVEN_GUARDIAN_HORDE_THREAT
    ThreatBreakdown DwarvenGuardianHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LamentEnabler
        SpecialPowerTemplate        = SpecialAbilityDarkLordsLament
        TriggeredBy                    = Upgrade_MiniHordeLvl2
    End
    Behavior = SpecialPowerModule ModuleTag_LamentStarter
        SpecialPowerTemplate      = SpecialAbilityDarkLordsLament
        UpdateModuleStartsAttack  = Yes
        StartsPaused          = Yes
        InitiateSound        = BalrogRoar
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LamentWeaponFireUpdate
        SpecialPowerTemplate    = SpecialAbilityDarkLordsLament
        SpecialWeapon            = AngmarDarkLordsLamentWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange        = 10.0

        SkipContinue            = Yes
        UnpackTime            = 1000
        PackTime            = 2000
        MustFinishAbility        = Yes
    End


    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000

        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                = AngmarHeroWolf 4
        Slots                    = 4
        PassengerFilter                = NONE +INFANTRY
        ShowPips                = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0

        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:AngmarHeroWolf Position:X:0 Y:35        Position:X:0 Y:-35       Position:X:0 Y:-70        Position:X:0 Y:70



        RanksToReleaseWhenAttacking        = 1

        MeleeAttackLeashDistance        = 50
        BackUpMinDelayTime            = 1
        BackUpMaxDelayTime            = 3000
        BackUpMinDistance            = 1
        BackUpMaxDistance            = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = DualWeaponBehavior ModuleTag_11
        SwitchWeaponOnCloseRangeDistance = 40
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 60.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
    End

  LocomotorSet
    Locomotor     = ShadeofWolfLocomotor
    Condition     = SET_NORMAL
    Speed         = 120
  End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End


    CommandSet = AngmarHeroWolfCommandSet







    Behavior = AISpecialPowerUpdate DwarvenGuardianHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry            = CYLINDER
    GeometryMajorRadius = 18.0
    GeometryHeight        = 90.0
      GeometryOffset        = X:-20 Y:0 Z:0
    GeometryIsSmall        = No

    Shadow                = SHADOW_VOLUME
    ShadowSizeX            = 100
    ShadowSizeY            = 100
    ShadowTexture        = ShadowI
End

