Object BruchtalLichtbringerWasserErdeComboHorde

       ButtonImage            = HILichtbringerWasserErdeCombo_Wotr
       SelectPortrait         = UPLichtbringerWasserErdeCombo

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerWasserErdeComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerWasserErdeComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerWasserErdeComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerWasserErdeComboHordeCommandSet



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerWasser 3
        InitialPayload = BruchtalLichtbringerErde 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerWasser +BruchtalLichtbringerErde
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerErde Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerWasser Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerErdeHorde         UnitType:BruchtalLichtbringerErde
        SplitHorde = SplitResult:BruchtalLichtbringerWasserHorde       UnitType:BruchtalLichtbringerWasser

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_NecroCorpseRainEnabler
        SpecialPowerTemplate         = SpecialAbilityWellenHoffnungRain
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1
        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon
    End







        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius         = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX             = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End








    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End


Object BruchtalLichtbringerErdeFeuerComboHorde


       ButtonImage            = HILichtbringerErdeFeuerCombo_Wotr
       SelectPortrait         = UPLichtbringerErdeFeuerCombo


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerErdeFeuerComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerErdeFeuerComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerErdeFeuerComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerErdeFeuerComboHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerFeuer 3
        InitialPayload = BruchtalLichtbringerErde 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerFeuer +BruchtalLichtbringerErde
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerErde Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerFeuer Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerErdeHorde         UnitType:BruchtalLichtbringerErde
        SplitHorde = SplitResult:BruchtalLichtbringerFeuerHorde       UnitType:BruchtalLichtbringerFeuer

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS


        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_NecroCorpseRainEnabler
        SpecialPowerTemplate         = SpecialAbilityWellenHoffnungRain
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = No
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_NecroCorpseRainTrigger
        SpecialPowerTemplate             = SpecialAbilityDainMightyRage
        StartAbilityRange                = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        TriggerSpecialPower              = ModuleTag_NecroCorpseRainBlastWeaponFireUpdate            TARGETPOS
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1
        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon
    End





        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy             = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed
        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End








    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End





    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End

Object BruchtalLichtbringerErdeLuftComboHorde

       ButtonImage            = HILichtbringerErdeLuftCombo_Wotr
       SelectPortrait         = UPLichtbringerErdeLuftCombo

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR

        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerErdeLuftComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerErdeLuftComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerErdeLuftComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerErdeLuftComboHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerLuft 3
        InitialPayload = BruchtalLichtbringerErde 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerLuft +BruchtalLichtbringerErde
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerErde Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerLuft Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerErdeHorde         UnitType:BruchtalLichtbringerErde
        SplitHorde = SplitResult:BruchtalLichtbringerLuftHorde       UnitType:BruchtalLichtbringerLuft

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End








    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon

    End







        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy             = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed

        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End








    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End


Object BruchtalLichtbringerFeuerLuftComboHorde


       ButtonImage            = HILichtbringerFeuerLuftCombo_Wotr
       SelectPortrait         = UPLichtbringerFeuerLuftCombo


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerFeuerLuftComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerFeuerLuftComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerFeuerLuftComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerFeuerLuftComboHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerLuft 3
        InitialPayload = BruchtalLichtbringerFeuer 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerLuft +BruchtalLichtbringerFeuer
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerFeuer Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerLuft Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerFeuerHorde      UnitType:BruchtalLichtbringerFeuer
        SplitHorde = SplitResult:BruchtalLichtbringerLuftHorde       UnitType:BruchtalLichtbringerLuft

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End








    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon

    End







        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy             = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed

        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End








    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End





    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End


Object BruchtalLichtbringerWasserFeuerComboHorde


       ButtonImage            = HILichtbringerWasserFeuerCombo_Wotr
       SelectPortrait         = UPLichtbringerWasserFeuerCombo


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerFeuerWasserComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerFeuerWasserComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerFeuerWasserComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerWasserFeuerComboHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerWasser 3
        InitialPayload = BruchtalLichtbringerFeuer 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerWasser +BruchtalLichtbringerFeuer
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerFeuer Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerWasser Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerFeuerHorde        UnitType:BruchtalLichtbringerFeuer
        SplitHorde = SplitResult:BruchtalLichtbringerWasserHorde       UnitType:BruchtalLichtbringerWasser

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS


        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End








    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon

    End







        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy             = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed

        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End








    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End


Object BruchtalLichtbringerWasserLuftComboHorde


       ButtonImage            = HILichtbringerWasserLuftCombo_Wotr
       SelectPortrait         = UPLichtbringerWasserLuftCombo


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Imladris
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:BruchtalLichtbringerLuftWasserComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_LichtbringerLuftWasserComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_BruchtalLichtbringerLuftWasserComboHorde
	MaxSimultaneousOfType       = 1

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    LichtbringerMissileHordeRangefinder
    End


    CommandSet = BruchtalLichtbringerWasserLuftComboHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = IMLADRISMAGESHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange             = 450
    VisionSide             = 50%
    VisionRear             = 25%
    VisionBonusPercentPerFoot     = 1.0%
    ShroudClearingRange         = 500
    CommandPoints = 30

    FormationWidth = 1
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE ARMY_SUMMARY CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER COMBO_HORDE

    ThreatLevel = ELVEN_MITHLONDSENTRY_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = BruchtalLichtbringerWasser 3
        InitialPayload = BruchtalLichtbringerLuft 3
        Slots = 6
        PassengerFilter = NONE +BruchtalLichtbringerWasser +BruchtalLichtbringerLuft
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior           = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:BruchtalLichtbringerLuft Position:X:50 Y:10        Position:X:50 Y:-30        Position:X:50 Y:50
        RankInfo = RankNumber:2 UnitType:BruchtalLichtbringerWasser Position:X:50 Y:-10        Position:X:50 Y:30        Position:X:50 Y:-50

        SplitHorde = SplitResult:BruchtalLichtbringerLuftHorde         UnitType:BruchtalLichtbringerLuft
        SplitHorde = SplitResult:BruchtalLichtbringerWasserHorde       UnitType:BruchtalLichtbringerWasser

        RanksThatStopAdvance = 1
        RanksToReleaseWhenAttacking = 1 2
        RanksToJustFreeWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%

    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base

        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End


    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RaiseShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SinneEnabler
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        TriggeredBy                  = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_SinneStarter
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_SinneWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityStillederSinne
        WhichSpecialWeapon           = 1
        SkipContinue                 = Yes
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 300
        SpecialWeapon                = StillederSinneSpecialWeapon
    End






	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityHerzdesFeuers
		StartAbilityRange			= 200
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= HerzdesFeuersUpgrade
		AttributeModifierRange			= 75
		AttributeModifierAffects		= HERZDESFUERST_UPGRADE
	End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeuerEnabler
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        TriggeredBy           = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower ModuleTag_FeuerOCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFeuerderHochsten
        OCL                   = OCL_SpecialPowerFeuerderHochsten
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
        SetModelCondition     = ModelConditionState:USER_1
        SetModelConditionTime = 2.1
    End








    Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        StartsPaused                = No
        UpdateModuleStartsAttack    = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWellenHoffnungRain
        WhichSpecialWeapon          = 4
        SkipContinue                = Yes
        FreezeAfterTriggerDuration  = 100
        UnpackTime                  = 700
        PreparationTime             = 1

        PackTime                    = 100
        AwardXPForTriggering        = 0
        StartAbilityRange           = ANGMAR_NECRO_CORPSE_RAIN_START_RANGE
        SpecialWeapon               = WellenderHoffnungWeapon

    End







        Behavior                         = SpecialPowerModule ModuleTag_Wasser
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            UpdateModuleStartsAttack     = Yes
            StartsPaused                 = No
            TriggerFX                    = FX_WasserdesBruinen
            SetModelCondition            = ModelConditionState:EMOTION_TAUNTING
            SetModelConditionTime        = 2.1
        End

        Behavior                         = SpecialAbilityUpdate ModuleTag_WasserUpdate
            SpecialPowerTemplate         = SpecialAbilityWasserdesBruinen
            StartAbilityRange            = 1.6
            UnpackTime                   = 1
            PreparationTime              = 3
            PackTime                     = 2096
            AwardXPForTriggering         = 0
        End

        Behavior                         = AutoHealBehavior ModuleTag_WasserHeal
            StartsActive                 = Yes
            ButtonTriggered              = Yes
            HealingAmount                = 400
            Radius                       = 250
            HealOnlyOthers               = No
            SingleBurst                  = Yes
            UnitHealPulseFX              = FX_WasserdesBruinen
            KindOf                       = INFANTRY HERO CAVALRY
        End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FloodEnabler
        SpecialPowerTemplate = SpecialAbilityPersonalFlood
        TriggeredBy = Upgrade_RaiseShield
    End

    Behavior = SpecialPowerModule ModuleTag_FloodStarter
        SpecialPowerTemplate        = SpecialAbilityPersonalFlood
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FloodUpdate
        SpecialPowerTemplate    = SpecialAbilityPersonalFlood

        UnpackTime              = 1300
        PackTime                = 1500

        StartAbilityRange = 150.0

        SpecialWeapon = LichtbringerPersonalFlood
        WhichSpecialWeapon = 5
    End

    Behavior = AutoAbilityBehavior ModuleTag_PersonalFloodAutoAbility
        SpecialAbility              = SpecialAbilityPersonalFlood
        MinScanRange                = 150
        MaxScanRange                = 300
        Query                       = 1 ANY ENEMIES +STRUCTURE +HERO
        Query                       = 20 ALL ENEMIES
    End







    Behavior                                = SpecialPowerModule ModuleTag_LuftUpdate
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        UpdateModuleStartsAttack            = Yes
        StartsPaused                        = No
        AttributeModifier                   = HauchValinors
        AttributeModifierRange              = 200
        AttributeModifierAffectsSelf        = Yes
        AttributeModifierAffects            = ANY +INFANTRY +CAVALRY
        AttributeModifierFX                 = FX_HauchContrailFX
    End

    Behavior                                = SpecialAbilityUpdate ModuleTag_LuftAnimation
        SpecialPowerTemplate                = SpecialAbilityHauchValinors
        PreparationTime                     = 0
        PersistentPrepTime                  = 0
        PackTime                            = 1330
        UnpackTime                          = 1000
        UnpackingVariation                  = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModulTag_ElrondTornadoEnabler
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        TriggeredBy              = Upgrade_RaiseShield
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate     = SpecialPowerSpawnTornado
        OCL                      = OCL_Wirbelwind
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
        SetModelCondition        = ModelConditionState:USER_1
        SetModelConditionTime    = 8.1
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ReinigungnEnabler
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        TriggeredBy             = Upgrade_RaiseShield
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpecialAbilityReinigungnordlicheWalder
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed

        StartsPaused            = Yes
        SetModelCondition       = ModelConditionState:USER_1
        SetModelConditionTime   = 8.1
    End






    Behavior                   = OCLSpecialPower ModuleTag_ErdeOCLSpecialPower
       SpecialPowerTemplate    = SpecialAbilityVorbotedesTelperion
       OCL                     = OCL_ElementErdeOCL
       TriggerFX               = FX_ElementErdeSpellFX
       CreateLocation          = CREATE_AT_LOCATION
       StartsPaused            = No
       SetModelCondition       = ModelConditionState:USER_2
       SetModelConditionTime   = 2.1
    End







    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                = Yes
        HealOnlyIfNotInCombat       = Yes
        HealOnlyIfNotUnderAttack    = Yes
        HealingAmount               = 30
        Radius                      = 100
        StartHealingDelay           = 7500
        HealingDelay                = 5000
        UnitHealPulseFX             = FX_SpellHealUnitHealBuff
        NonStackable                = Yes
        RespawnNearbyHordeMembers   = Yes
        RespawnFXList               = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay         = 200
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End






    Behavior = AISpecialPowerUpdate ElvenMithlondSentryHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType     = AutoResolveUnit_Support
    AutoResolveCombatChain  = AutoResolve_PikemenCombatChain

    AutoResolveBody         = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ElvenMithlondSentryHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElvenMithlondSentryUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_RaiseShield
End

