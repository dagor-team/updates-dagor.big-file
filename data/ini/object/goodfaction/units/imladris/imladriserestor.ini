Object ImladrisErestor

    SelectPortrait  = HPLindir
    ButtonImage     = HILindir

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

  Draw = W3DHordeModelDraw ModuleTag_01

    OkToChangeModelColor = No
    StaticModelLODMode   = No

        ExtraPublicBone = STAFF
        ExtraPublicBone = B_SWORDBONE

        DefaultModelConditionState
            Model               = euerestor_skn
            Skeleton            = chwz_yw_u_skl
            WeaponLaunchBone    = PRIMARY B_STAFF
        End

        AnimationState        =    USER_1
            Animation
                AnimationName =    chwz_yw_U_SPCE
                AnimationMode =    ONCE
            End
        End

        AnimationState        =    USER_2
            Animation
                AnimationName =    chwz_yw_U_SPCC
                AnimationMode =    ONCE
            End
        End


TransitionState                =    TRANS_Select
    Animation
        AnimationName        =    chwz_yw_M_ATNA
        AnimationMode        =    ONCE
    End
End


AnimationState                = MOUNTED
    Animation
        AnimationName        =    chwz_yw_M_IDLA
        AnimationPriority    =    20
        AnimationMode        =    ONCE
        AnimationBlendTime    =    15
    End
    Flags                =    RESTART_ANIM_WHEN_COMPLETE
End






AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = chwz_yw_B_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End

AnimationState        = STUNNED_FLAILING
    StateName           = STATE_Sword
    Animation
        AnimationName     = chwz_yw_U_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End


AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = chwz_yw_B_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING SPLATTED
    StateName           = STATE_Sword
    Animation
        AnimationName     = chwz_yw_U_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = chwz_yw_B_DIEA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING
    StateName           = STATE_Sword
    Animation
        AnimationName     = chwz_yw_U_DIEA
        AnimationMode     = ONCE
    End
    Animation           = GUHero_DIEB
        AnimationName     = chwz_yw_U_DIEB
        AnimationMode     = ONCE
    End
End





AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = chwz_yw_B_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End

AnimationState        = STUNNED_STANDING_UP
    StateName           = STATE_Sword
    Animation
        AnimationName     = chwz_yw_U_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End

AnimationState        = STUNNED WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = chwz_yw_B_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = STUNNED
    StateName           = STATE_Sword
    Animation           = GUHero_LNDA
        AnimationName     = chwz_yw_U_LNDA
        AnimationMode     = ONCE
    End
End





AnimationState                = PACKING_TYPE_1  WEAPONSET_TOGGLE_1
    StateName                = rainofarrows
    Animation
        AnimationName        = chwz_yw_B_ATKA2
        AnimationMode        = LOOP
    End

End


AnimationState                = PACKING_TYPE_1
    StateName                = Curse
    Animation
        AnimationName        = chwz_yw_U_LVLA
        AnimationMode        = ONCE
    End

End


AnimationState                = PACKING_TYPE_3
    StateName                = Curse
    Animation
        AnimationName        = chwz_yw_U_SPCA
        AnimationMode        = ONCE
    End

End


AnimationState        =  SPECIAL_WEAPON_TWO
    StateName = STATE_Bow
    Animation
        AnimationName       = chwz_yw_U_SPCL chwz_yw_U_ATKC
        AnimationMode       = ONCE
    End
    FrameForPristineBonePositions = 59
    BeginScript
        CurDrawableShowSubObject("arrow")
    EndScript
End

AnimationState        =  SPECIAL_WEAPON_THREE
    StateName = STATE_Bow
    Animation
        AnimationName       = chwz_yw_U_SPCL chwz_yw_U_ATKC
        AnimationMode       = ONCE
    End
    FrameForPristineBonePositions = 59
    BeginScript
        CurDrawableShowSubObject("arrow")
    EndScript
End

AnimationState        =  SPECIAL_WEAPON_ONE
    StateName =    Attacking
    Animation
        AnimationName       = chwz_yw_U_IBFA
        AnimationMode       = ONCE
    End
End



        AnimationState        = MOVING USER_4
            StateName           = Slaughter
            Flags               = RANDOMSTART

            Animation           = GUHero_ATKE
                AnimationName     = chwz_yw_U_ATKE
                AnimationMode     = LOOP
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
        End


        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART

            Animation
                AnimationName   = chwz_yw_B_RUNA

                AnimationSpeedFactorRange = 0.85 0.85

            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
                if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning_WeaponToggle") return end
            EndScript
        End


        AnimationState            = MOVING
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART

            Animation
                AnimationName   = chwz_yw_U_RUNA

                AnimationSpeedFactorRange = 0.85 0.85

            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
                if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
            EndScript
        End



        AnimationState                    =    PREATTACK_A WEAPONSET_TOGGLE_1
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    chwz_yw_B_ATKA1
                AnimationMode            =    ONCE


            End
        End

        AnimationState                    =    FIRING_OR_RELOADING_A WEAPONSET_TOGGLE_1
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    chwz_yw_B_ATKA2
                AnimationMode            =    ONCE

                AnimationSpeedFactorRange = 1.1 1.1

            End
        End




        AnimationState                = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName                = STATE_Firing
            Animation
                AnimationName        = chwz_yw_B_ATKA1
                AnimationMode        = ONCE
                UseWeaponTiming        = No
            End
        End

        AnimationState                = FIRING_OR_PREATTACK_A
            Animation
                AnimationName        = chwz_yw_U_spca
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End






        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation
                AnimationName = chwz_yw_B_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation
                AnimationName = chwz_yw_B_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Sword_HITA
                AnimationName = chwz_yw_U_HITA
                AnimationMode = ONCE
            End
            Animation = Sword_HITB
                AnimationName = chwz_yw_U_HITB
                AnimationMode = ONCE
            End

            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                if PrevAnim == "Foot_IDLB"
                then
                    return "Sword_HITB"
                else
                    return "Swort_HITA"
                end
            EndScript
        End



        AnimationState                = SPECIAL_POWER_1
            StateName                = STATE_ready
            Animation
                AnimationName        = chwz_yw_U_SPCA
                AnimationMode        = ONCE
            End
            ParticleSysBone            = B_SWORDBONE ElendilFlare FollowBone:Yes
            ParticleSysBone            = B_SWORDBONE ElendilSwordFlare FollowBone:Yes

        End



        AnimationState          =    SPECIAL_WEAPON_TWO MOUNTED
            StateName          =    Attacking
            Animation
                AnimationName =    chwz_yw_U_SPLD chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    SPECIAL_WEAPON_TWO
            StateName          =    Attacking
            Animation
                AnimationName =    chwz_yw_U_SPCB chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    SPECIAL_WEAPON_THREE MOUNTED
            StateName          =    Attacking
            Animation          =    StaffLaser
                AnimationName =    chwz_yw_U_SPCD chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
            FXEvent              =    Frame:30 Name:FX_GandalfStaffFlare
        End


        AnimationState          =    SPECIAL_WEAPON_THREE
            StateName          =    Attacking
            Animation          =    StaffLaser
                AnimationName =    chwz_yw_U_SPCE chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
            FXEvent              =    Frame:30 Name:FX_GandalfStaffFlare
        End


        AnimationState          =    SPECIAL_WEAPON_FOUR
            StateName          =    Attacking
            Animation
                AnimationName =    chwz_yw_U_SPCD
                AnimationMode =    ONCE
            End
            FrameForPristineBonePositions    = 44
        End

        AnimationState          =    SPECIAL_WEAPON_FIVE
            StateName          =    Attacking
            Animation
                AnimationName =    chwz_yw_U_SPCE
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    SPECIAL_WEAPON_SIX
            StateName          =    Attacking
            Animation
                AnimationName =    chwz_yw_U_SPCF
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    PACKING_TYPE_1 UNPACKING
            StateName          =    Attacking
            Animation          =    LightningSwordStart
                AnimationName =    chwz_yw_U_SPCC chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_1 PREPARING
            StateName          =    Attacking
            Animation          =    LightningSwordLoop
                AnimationName =    chwz_yw_U_SPCA chwz_yw_U_ATKA
                AnimationMode =    LOOP
            End
        End

        AnimationState          =    PACKING_TYPE_1 PACKING
            StateName          =    Attacking
            Animation          =    LightningSwordPutAway
                AnimationName =    chwz_yw_U_SPCB chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    PACKING_TYPE_2 CREATE_A_HERO_20 CREATE_A_HERO_21
            Animation
                AnimationName =    chwz_yw_U_SPCC
                AnimationMode =    LOOP
            End
        End


        AnimationState          =    PACKING_TYPE_2 UNPACKING
            StateName          =    Attacking
            Animation          =    LightningSwordStart
                AnimationName =    chwz_yw_U_SPCC chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_2 PREPARING
            StateName          =    Attacking
            Animation          =    LightningSwordLoop
                AnimationName =    chwz_yw_U_SPCA chwz_yw_U_ATKA
                AnimationMode =    LOOP
            End
        End

        AnimationState          =    PACKING_TYPE_2 PACKING
            StateName          =    Attacking
            Animation          =    LightningSwordPutAway
                AnimationName =    chwz_yw_U_SPCB chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End


        AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
            StateName          =    CaptainPower
            Animation           = GUHero_CHRC
                AnimationName     = chwz_yw_U_CHRC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = PACKING_TYPE_2
            StateName          =    STATE_CaptainBow
            Animation           = GUHero_CHRD
                AnimationName     = chwz_yw_U_SPCE chwz_yw_U_SPCA chwz_yw_U_CHRD
                AnimationMode     = ONCE

            End
        End


        AnimationState          =    PACKING_TYPE_3 UNPACKING
            StateName          =    Attacking
            Animation          =    LightningSwordStart
                AnimationName =    chwz_yw_U_SPCC chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_3 PREPARING
            StateName          =    Attacking
            Animation          =    LightningSwordLoop
                AnimationName =    chwz_yw_U_SPCA chwz_yw_U_ATKA
                AnimationMode =    LOOP
            End
        End

        AnimationState          =    PACKING_TYPE_3 PACKING
            StateName          =    Attacking
            Animation          =    LightningSwordPutAway
                AnimationName =    chwz_yw_U_SPCB chwz_yw_U_ATKA
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    PACKING_TYPE_4 UNPACKING
            Animation
                AnimationName =    chwz_yw_U_SPCA
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_4 PREPARING
            Animation
                AnimationName =    chwz_yw_U_SPCA

                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_4 PACKING
            Animation
                AnimationName =    chwz_yw_U_SPCA
                AnimationMode =    ONCE
            End
        End

        AnimationState          =    PACKING_TYPE_5 PACKING WEAPONSET_TOGGLE_1
            Animation
                AnimationName =    chwz_yw_B_SPCB
                AnimationMode =    ONCE
                AnimationSpeedFactorRange = 0.7333 0.7333
            End
        End

        AnimationState          =    PACKING_TYPE_5 PACKING
            Animation
                AnimationName =    chwz_yw_U_SPCB
                AnimationMode =    ONCE
            End
        End


        AnimationState          =    PACKING_TYPE_6 PACKING
            Animation
                AnimationName =    chwz_yw_U_SPCD
                AnimationMode =    ONCE
            End
        End





        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = chwz_yw_B_CHRA chwz_yw_B_LVLA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = chwz_yw_U_CHRA chwz_yw_U_LVLA
                AnimationMode        = ONCE
            End
        End




        AnimationState                =    EMOTION_CELEBRATING MOUNTED
            Animation
                AnimationName        =    chwz_yw_M_CHRA chwz_yw_M_IRFA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    chwz_yw_B_CHRA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_CELEBRATING
            Animation CHRA
                AnimationName        =    chwz_yw_U_CHRA chwz_yw_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    chwz_yw_U_CHRB chwz_yw_U_CHRA chwz_yw_U_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING MOUNTED
            Animation
                AnimationName        =    chwz_yw_M_TNTA chwz_yw_M_IRFA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    chwz_yw_B_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING
            Animation CHRA
                AnimationName        =    chwz_yw_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    chwz_yw_U_TNTB chwz_yw_U_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End





        AnimationState                = ENGAGED
            StateName                = STATE_ready
            Animation
                AnimationName        = chwz_yw_U_IDLA
                AnimationMode        = ONCE
            End
        End


        AnimationState                = WEAPONSET_TOGGLE_1
            StateName                = STATE_Idle_Bow
            Animation
                AnimationName        =    chwz_yw_B_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
        End

        IdleAnimationState
            StateName                    = STATE_Idle_Sword
            Animation = Foot_IDLB
                AnimationName       = chwz_yw_U_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLC
                AnimationName       = chwz_yw_U_WPNA
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End
            Animation = Foot_IDLD
                AnimationName       = chwz_yw_U_IBFB
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End




        TransitionState = TRANS_BoredToSelectedSword

            Animation = ANTD
                AnimationName    = chwz_yw_U_ATNA chwz_yw_U_ATND chwz_yw_U_IDLA
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = chwz_yw_U_ATNC chwz_yw_U_ATNF chwz_yw_U_ATNE
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = chwz_yw_U_ATNF chwz_yw_U_ATNE
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = chwz_yw_U_ATNF
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA
                AnimationName    = chwz_yw_U_ATNF
                AnimationMode    = ONCE
            End
        End


        TransitionState       = TRANS_BowToSword
            Animation           = CUHero_STHA
                AnimationName     = chwz_yw_B_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = CUHero_STHB
                AnimationName     = chwz_yw_U_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = chwz_yw_B_STHB
                AnimationMode       = ONCE
            End
        End

        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = chwz_yw_U_STHB
                AnimationMode       = ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = exldrspimla
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                = Imladris
    EditorSorting       = UNIT
    ThreatLevel         = GLORFINDEL_THREAT_LEVEL
    ThingClass          = CHARACTER_UNIT
    TransportSlotCount  = TRANSPORTSLOTCOUNT_HERO
    BuildCost           = VERY_PIGGY_HERO_COST
    BuildTime           = VERY_WEAK_HERO_BUILDTIME
    BountyValue         = 100
    CommandPoints       = 0


    ArmorSet
        Conditions      = None
        Armor           = VeryWeakHeroArmor
        DamageFX        = NormalDamageFX
    End


    VisionRange = VISION_HERO_STANDARD
    ShroudClearingRange = SHROUD_CLEAR_HERO

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = 750
    RecruitText = CONTROLBAR:ImladrisErestorRecruitNew
    ReviveText  = CONTROLBAR:ImladrisErestorRevive
    Hotkey      = CONTROLBAR:ImladrisErestorHotkey
    DisplayName = OBJECT:ImladrisErestor
    CrushableLevel = 1
    CrusherLevel = 0
    CrushRevengeWeapon = RangedInfantryCrushRevenge

    CommandSet = ErestorCommandSet


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_FaramirBody

    AutoResolveArmor
        Armor = AutoResolve_FaramirArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_FaramirWeapon
    End



    VoiceCreated                       = ErestorVoiceRecruit
    VoiceMove                          = ErestorVoiceMove
    VoiceMoveToCamp                    = ErestorVoiceMove
    VoiceMoveWhileAttacking            = ErestorVoiceMove
    VoiceEnterStateMove                = ErestorVoiceMove
    VoiceEnterStateMoveToCamp          = ErestorVoiceMove
    VoiceEnterStateMoveWhileAttacking  = ErestorVoiceMove
    VoicePriority                      = 80
    VoiceRetreatToCastle               = ErestorVoiceMove
    VoiceEnterStateRetreatToCastle     = ErestorVoiceMove
    VoiceSelect                        = ErestorVoiceSelect
    VoiceSelectBattle                  = ErestorVoiceSelect
    VoiceGuard                         = ErestorVoiceMove

    SoundImpact                        = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip    = ErestorVoiceMove
        VoiceGarrison                       = ErestorVoiceMove
        VoiceInitiateCaptureBuilding        = ErestorVoiceMove
    End



    CrowdResponseKey = Elf


    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop

        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Elf Unit Infantry Elf_Warrior
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallOrc            Animation:chwz_yw_U_SKL.chwz_yw_U_DIEC    Frames:56
        AnimationSound = Sound:BodyFallOrc            Animation:chwz_yw_U_SKL.chwz_yw_U_DTHA    Frames:23
        AnimationSound = Sound:BodyFallOrc            Animation:chwz_yw_U_SKL.chwz_yw_U_DTHB    Frames:34
        AnimationSound = Sound:BodyFallOrc            Animation:chwz_yw_U_SKL.chwz_yw_U_LNDD    Frames:2
        AnimationSound = Sound:BodyFallOrc            Animation:chwz_yw_U_SKL.chwz_yw_U_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGeneric1       Animation:chwz_yw_U_SKL.chwz_yw_U_DIEA    Frames:50
        AnimationSound = Sound:BodyFallGeneric1       Animation:chwz_yw_U_SKL.chwz_yw_U_DIEB    Frames:75
        AnimationSound = Sound:BodyFallGeneric1       Animation:chwz_yw_U_SKL.chwz_yw_U_DIEC    Frames:53
        AnimationSound = Sound:BodyFallGeneric1       Animation:chwz_yw_U_SKL.chwz_yw_U_PLTA    Frames:18
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY IGNORES_SELECT_ALL


    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                   = VERY_WEAK_HERO_HEALTH
        PermanentlyKilledByFilter   = NONE
        DodgePercent                = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 6500
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HILindir
	

        RespawnRules =            AutoSpawn:No    Cost:500        Time:VERY_WEAK_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WachpostenerrichtenEnabler
        SpecialPowerTemplate    = SpecialAbilityErestorsFarm
        TriggeredBy             = Upgrade_ErestorLevel1
    End

    Behavior = OCLSpecialPower ModuleTag_WachpostenerrichtenSpecialPower
        SpecialPowerTemplate    = SpecialAbilityErestorsFarm
        OCL                     = OCL_ErestorsFarm
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Berater
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        TriggeredBy               = Upgrade_ErestorLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_BeraterUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = CostModifierUpgrade ModuleTag_CostModifier
        TriggeredBy               = Upgrade_ErestorLevel2
        ObjectFilter              = ANY +HERO
        Percentage                = -10%
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
        SpecialPowerTemplate         = SpecialAbilityNaturverbundenheit
        TriggeredBy                  = Upgrade_ErestorLevel2
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate        = SpecialAbilityNaturverbundenheit
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
        SpecialPowerTemplate        = SpecialAbilityNaturverbundenheit
        UnpackingVariation          = 2
        StartAbilityRange           = 200.0
        LevelFX                     = FX_NaturverbundenheitFlare
        Experience                  = 1500
        RadiusEffect                = 53
        AcceptanceFilter            = ANY +ArnorFarm +ArnorFarm_AI +GondorFarm +GondorFarm_AI +BFME1GondorFarm +DwarvenMineShaft +DwarvenMineShaft_AI +ElvenMallornTree +ElvenMallornTree_AI +ImladrisFarm +ImladrisFarm_AI +RohanFarmMod +RohanFarmMod_AI +IsengardMinenschacht +IsengardMinenschacht_AI +IsengardFurnace +IsengardFurnace_FestungsMaps +IsengardFurnacePlayer +MordorSlaughterHouse +WildMineShaft +WildMineShaft_AI +AngmarMill +AngmarMill_AI -INFANTRY -CAVALRY -HERO -MONSTER -SHIP -DOZER -MACHINE ALLIES
        UnpackTime                  = 3000
        PreparationTime             = 0
        FreezeAfterTriggerDuration  = 2000
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = SpecialPowerModule ModuleTag_LeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive             = No
		TriggeredBy				 = Upgrade_ErestorLevel3
        BonusName                = ImladrisGelehrterAura
        RefreshDelay             = 2000
        Range                    = 500
        ObjectFilter             = ANY +HERO -BruchtalGelehrter -ImladrisZwillingeEdain_Schmiede ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Wissen
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        TriggeredBy               = Upgrade_ErestorLevel4
		ConflictsWith		  	  = Upgrade_GlobalFirstAgeSpell
    End

    Behavior = SpecialPowerModule ModuleTag_WissenUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior                      = SpellRechargeModifierUpgrade ModuleTag_MakeSpellsRefreshFaster
        TriggeredBy               = Upgrade_ErestorLevel4 
		ConflictsWith		  	  = Upgrade_GlobalFirstAgeSpell
        StartsActive              = No
        Percentage                = -8%
    End

    Behavior                      = SpellRechargeModifierUpgrade ModuleTag_MakeSpellsRefreshFaster2
        TriggeredBy               =  Upgrade_GlobalFirstAgeSpell
        StartsActive              = No
        Percentage                = -15%
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SchätzeEnabler
        SpecialPowerTemplate     = SpecialAbilityErestorZweiteReihe
        TriggeredBy              = Upgrade_ErestorLevel5
        ObeyRechageOnTrigger     = Yes
    End

   Behavior = SpecialPowerModule ModuleTag_StudienStarter
      SpecialPowerTemplate      = SpecialAbilityErestorZweiteReihe
      UpdateModuleStartsAttack  = Yes
      StartsPaused              = Yes
   End

   Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_StudienUpdate
       SpecialPowerTemplate     = SpecialAbilityErestorZweiteReihe
	   SkipContinue             = Yes
       UnpackTime               = 1100
       PreparationTime          = 1
       PersistentPrepTime       = 500
       PackTime                 = 500
       MustFinishAbility        = Yes
       AwardXPForTriggering     = 0
       StartAbilityRange        = 300
       ApproachRequiresLOS      = Yes
       SpecialWeapon            = MilitarischeStudienSPy
       WhichSpecialWeapon       = 3
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy    = Upgrade_ErestorLevel2
        LevelsToGain   = 1
        LevelCap       = 2
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining2
        TriggeredBy    = Upgrade_ErestorLevel3
        LevelsToGain   = 1
        LevelCap       = 3
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining3
        TriggeredBy    = Upgrade_ErestorLevel4
        LevelsToGain   = 1
        LevelCap       = 4
	End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining4
        TriggeredBy    = Upgrade_ErestorLevel5
        LevelsToGain   = 1
        LevelCap       = 5
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        BurningDeathTime                = BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor   = HumanLocomotor
        Condition   = SET_NORMAL
        Speed       = NORMAL_ELVEN_PIKEMEN_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor   = BurningDeathLocomotorInfantry
        Condition   = SET_BURNINGDEATH
        Speed       = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
        ShockStunnedTimeLow     = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime       = 2133
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL ScholarVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL ElfGenericVoiceDie
    End

    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = AutoHealBehavior ModuleTag_ElrondHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate        = 10
        DetectionRange       = 200
        CancelOneRingEffect  = Yes
    End




    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate SpecialPowerSchriftfuhrerdesRates_AI
        CommandButtonName  = Command_SchriftfuhrerdesRates
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate SpecialMilitarischeStudien_AI
	CommandButtonName  = Command_MilitarischeStudien
	SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_RANGED

	SpecialPowerAIType = AI_SPECIAL_POWER_MORGUL_BLADE

    End

    Behavior = AISpecialPowerUpdate SpecialPowerEffizienteErnte_AI
	CommandButtonName  = Command_EffizienteErnte
	SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE

	SpecialPowerRadius = 30.0

    End


    Behavior = ObjectCreationUpgrade ModuleTag_IamAI2
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 100000
        GrantUpgrade = Upgrade_ErestorLevel2
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI3
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 150000
        GrantUpgrade = Upgrade_ErestorLevel3
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI4
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 200000
        GrantUpgrade = Upgrade_ErestorLevel4
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI5
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 250000
        GrantUpgrade = Upgrade_ErestorLevel5
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight      = 19.2
    GeometryIsSmall     = Yes

    Shadow        = SHADOW_DECAL
    ShadowSizeX   = 21
    ShadowSizeY   = 21
    ShadowTexture = ShadowI
    Scale         = 0.95
End

