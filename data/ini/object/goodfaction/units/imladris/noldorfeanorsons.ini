Object NoldorMaedhros

    SelectPortrait = HPMaedhros
    ButtonImage    = HIMaedhros

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    DefaultModelConditionState
               Model                    = eumaedhros
            Skeleton                 = CHHW_CG_U_SKL
            ModelAnimationPrefix     = CHHW_CG
            ParticleSysBone          = B_HANDR MaedhrosSwordFX FollowBone:Yes
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = #(MODEL)_B_CHRA
                AnimationMode        = ONCE
            End
        End


AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = #(MODEL)_B_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End

AnimationState        = STUNNED_FLAILING
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End



AnimationState  = DYING DEATH_2
        Animation         = FadingOut
            AnimationName     = #(MODEL)_B_CHRA
            AnimationMode     = ONCE
    End
End

AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = #(MODEL)_B_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING SPLATTED
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = #(MODEL)_B_DIEA
        AnimationMode     = ONCE
    End
End

AnimationState = DYING
    StateName             = STATE_Sword
        Animation         = Dying
        AnimationName     = #(MODEL)_U_DIEA
        AnimationMode     = ONCE
    End
End





AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = #(MODEL)_B_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End

AnimationState        = STUNNED_STANDING_UP
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End

AnimationState        = STUNNED WEAPONSET_TOGGLE_1
    StateName           = STATE_Bow
    Animation
        AnimationName     = #(MODEL)_B_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = STUNNED
    StateName           = STATE_Sword
    Animation           = GUHero_LNDA
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End






        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART

            Animation
                AnimationName   = #(MODEL)_B_RUNA

                AnimationSpeedFactorRange = 0.85 0.85

            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
                if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning_WeaponToggle") return end
            EndScript
        End


        AnimationState            = MOVING
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART

            Animation
                AnimationName   = #(MODEL)_U_RUNA

                AnimationSpeedFactorRange = 0.85 0.85

            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
                if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
            EndScript
        End


        AnimationState                = FIRING_OR_PREATTACK_A
            Animation
                AnimationName        = #(MODEL)_U_ATKA #(MODEL)_U_ATKB
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End





        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation
                AnimationName = #(MODEL)_B_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation
                AnimationName = #(MODEL)_B_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation
                AnimationName = #(MODEL)_U_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = #(MODEL)_B_CHRA #(MODEL)_B_LVLA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = #(MODEL)_U_CHRA #(MODEL)_U_LVLA
                AnimationMode        = ONCE
            End
        End




        AnimationState                =    EMOTION_CELEBRATING MOUNTED
            Animation
                AnimationName        =    #(MODEL)_M_CHRA #(MODEL)_M_IRFA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    #(MODEL)_B_CHRA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_CELEBRATING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_CHRA #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_CHRB #(MODEL)_U_CHRA #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING MOUNTED
            Animation
                AnimationName        =    #(MODEL)_M_TNTA #(MODEL)_M_IRFA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    #(MODEL)_B_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_TNTB #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                = ENGAGED
            StateName                = STATE_ready
            Animation
                AnimationName        = #(MODEL)_U_IDLA
                AnimationMode        = ONCE
            End
        End



        IdleAnimationState
            StateName      = STATE_Idle_Sword
            Animation = Foot_IDLB
                AnimationName       = #(MODEL)_U_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLC
                AnimationName       = #(MODEL)_U_IBFA
                AnimationMode       = ONCE
                AnimationPriority   = 10
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End




        AnimationState   =  SELECTED
            StateName                =    STATE_Selected_Sword
            Animation                =    ATNB
                AnimationName        =    #(MODEL)_U_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") end
            EndScript
        End




        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName    = #(MODEL)_U_ATNA
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = #(MODEL)_U_ATNC
                AnimationMode    = ONCE
            End
        End

    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                    = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorMaedhros
    Hotkey                            = CONTROLBAR:NoldorMaedhrosHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorMaedhrosCommandset
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY MaedhrosSwordPower
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType              = AutoResolveUnit_Hero
    AutoResolveCombatChain           = AutoResolve_HeroCombatChain

    AutoResolveBody                  = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                        = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                       = AutoResolve_GlorfindelWeapon
    End





    VoiceAttack                      = MaedhrosVoiceAttack
    VoiceAttackAir                   = MaedhrosVoiceAttack
    VoiceAttackCharge                = MaedhrosVoiceAttack
    VoiceAttackMachine               = MaedhrosVoiceAttack
    VoiceAttackStructure             = MaedhrosVoiceAttack
    VoiceGuard                       = MaedhrosVoiceMove
    VoiceMove                        = MaedhrosVoiceMove
    VoiceMoveWhileAttacking          = MaedhrosVoiceMove
    VoicePriority                    = 85
    VoiceSelect                      = MaedhrosVoiceSelect
    VoiceSelectBattle                = MaedhrosVoiceSelect

    SoundImpact                      = ImpactHorse

    CrowdResponseKey = Elf

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Elf_LorienWarrior
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:CHHW_CG_U_SKL.CHHW_CG_U_RUNA     Frames:10 22
        AnimationSound = Sound:FootstepDirtA           Animation:CHHW_CG_U_SKL.CHHW_CG_U_RUNB     Frames:10 22
        AnimationSound = Sound:FootstepDirtA           Animation:CHHW_CG_U_SKL.CHHW_CG_U_ATRA     Frames:11 23 35 47
        AnimationSound = Sound:FootstepDirtA           Animation:CHHW_CG_U_SKL.CHHW_CG_U_MFDA     Frames:8 20 31 41
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:CHHW_CG_U_SKL.CHHW_CG_U_DTHA     Frames:116
        AnimationSound = Sound:BodyFallSoldier         Animation:CHHW_CG_U_SKL.CHHW_CG_U_LNDA     Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:CHHW_CG_U_SKL.CHHW_CG_U_SPCE     Frames:82
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 300
        TauntAndPointUpdateDelay        = 10000
        AddEmotion                      = Doom_Base



        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
         AddEmotion                     = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 2800
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate  = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        CanAttackWhileContained         = Yes
        AILuaEventsList                 = RohanElvenWarriorFunctions
        BurningDeathTime                = BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 55
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.4
        DestructionDelay         = 8000
        Sound                 = INITIAL ElfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 2700
        HitReactionLifeTimer2         = 3366
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 5.0
        HitReactionThreshold2         = 100.0
        HitReactionThreshold3         = 300.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership1Update
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                              = 300
        ObjectFilter                       = ANY -HERO +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End




    Scale         = 1.06
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 25
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 20
    ShadowSizeY     = 20
    ShadowTexture     = ShadowI
End


ChildObject NoldorMaedhros_Summoned NoldorMaedhros
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorMaedhros
    CommandSet                   = NoldorMaedhrosCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorMaglor

    SelectPortrait = HPMaglor
    ButtonImage    = HIMaglor

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                      = eumaglor
            Skeleton                   = RUTheoden_SKL
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End


        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                       =    DYING DEATH_2
            Animation                        =    FadingOut
                AnimationName                =    RUTheoden_CHRB
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        =    DYING
            Animation                        =    Dying
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    FIRING_OR_PREATTACK_B
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    FIRING_OR_PREATTACK_C
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    FIRING_OR_PREATTACK_D
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

           AnimationState  = PACKING_TYPE_1
                Animation = SONG
                AnimationName       = RUTheoden_IDLC
                   AnimationMode       = LOOP
              End
        End



        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HERO
            Model           = exldrspimla
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                             = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorMaglor
    Hotkey                            = CONTROLBAR:NoldorMaglorHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorMaglorCommandset
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY FeanorSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                         = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_GlorfindelWeapon
    End





    VoiceAttack                       = MaglorVoiceAttack
    VoiceAttackAir                    = MaglorVoiceAttack
    VoiceAttackCharge                 = MaglorVoiceAttack
    VoiceAttackMachine                = MaglorVoiceAttack
    VoiceAttackStructure              = MaglorVoiceAttack
    VoiceGuard                        = MaglorVoicenMove
    VoiceMove                         = MaglorVoicenMove
    VoiceMoveWhileAttacking           = MaglorVoicenMove
    VoicePriority                     = 85
    VoiceSelect                       = MaglorVoiceSelect
    VoiceSelectBattle                 = MaglorVoiceSelect

    SoundImpact                       = ImpactHorse

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        AnimationSound = Sound:FootstepDirtA             Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA             Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27
        AnimationSound = Sound:TauntHumanHitShield       Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier           Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 300
        TauntAndPointUpdateDelay        = 10000
        AddEmotion                      = Doom_Base



        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
         AddEmotion                     = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 2000
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        CanAttackWhileContained         = Yes
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 54
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult               = 1.0
        ShockStandingTime         = 2000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.4
        DestructionDelay         = 8000
        Sound                 = INITIAL GlorfindelVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 2700
        HitReactionLifeTimer2         = 3366
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 5.0
        HitReactionThreshold2         = 100.0
        HitReactionThreshold3         = 300.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership2Update
        SpecialPowerTemplate           = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack       = No
        StartsPaused                   = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                   = Yes
        BonusName                      = InseperableOnOath
        RefreshDelay                   = 2000
        Range                          = 300
        ObjectFilter                   = ANY -HERO +NoldorMaedhros_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Gesang
        SpecialPowerTemplate           = SpecialAbilityLuthienSong
        TriggeredBy                    = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_GesangStarter
        SpecialPowerTemplate           = SpecialAbilityLuthienSong
        UpdateModuleStartsAttack       = Yes
        StartsPaused                   = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_GesangUpdate
        SpecialPowerTemplate           = SpecialAbilityLuthienSong
        UnpackingVariation             = 1
        UnpackTime                     = 1800
        PackTime                       = 1600
        AwardXPForTriggering           = 0
        HeroAttributeModifier          = MaglorSongSelfModifier
        HeroEffectDuration             = 15000
    End

    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName                 = MaglorSongWeapon
            FireDelay                  = 0
            OneShot                    = No
        End
        HeroModeTrigger                = Yes
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate MaglorSongAI
        CommandButtonName  = Command_MaglorSong
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_DEBUFF
        SpecialPowerRange  = 100
    End




    Scale         = 1.03
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 25
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 20
    ShadowSizeY     = 20
    ShadowTexture     = ShadowI
End


ChildObject NoldorMaglor_Summoned NoldorMaglor
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorMaglor
    CommandSet                   = NoldorMaglorCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorCelegorm







    SelectPortrait = HPCelegorm
    ButtonImage    = HICelegorm



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    ExtraPublicBone = arrow
    ExtraPublicBone = PASSENGERBONE

        DefaultModelConditionState
            Model                      = eucelegorn
            WeaponLaunchBone           = PRIMARY arrow
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
        End




        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End

            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
        End



        AnimationState        = DYING WEAPONSET_TOGGLE_1 DEATH_2
            StateName           = FadingOut
            Animation           = GUFaramir_DIEUSA
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation           = FadingOut
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING WEAPONSET_TOGGLE_1
            StateName           = FadingOut
            Animation           = GUFaramir_DIEUSA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUFaramir_IDLC
                AnimationMode                = LOOP
            End
        End





        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            StateName           = STATE_Bow

            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = USER_1



            Animation           = GUFaramir_POSA
                AnimationName     = GUFaramir_SKL.GUFaramir_POSA
                AnimationMode     = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End






        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.47 1.47
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End





        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB

                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
        End



        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode     = MANUAL
            End
        End



        AnimationState            = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA

                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
        End



        AnimationState                    =    PREATTACK_A
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode            =    ONCE


            End
        End

        AnimationState                    =    FIRING_OR_RELOADING_A
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    ONCE

                AnimationSpeedFactorRange = 1.1 1.1

            End
        End


        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW

            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode                = ONCE
            End
        End









        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
        End





        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
        End



        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End



        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTC
                AnimationMode        =    ONCE
            End
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTD
                AnimationMode        =    ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End




        AnimationState                    = SELECTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Selected_Sword

            Animation                    = ATNE
                AnimationName            = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
        End


        AnimationState                =    EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                =    STATE_READY
            Animation                =    ready
                AnimationName        =    GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    STATE_Selected_Bow

            Animation                =    ATNB
                AnimationName        =    GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow"    then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
        End





        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = STATE_Idle_Sword

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority        = 20
                AnimationBlendTime  = 15
            End

            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            Animation                   = IDLG
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLG
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End

        IdleAnimationState
            StateName           = STATE_Idle_Bow

            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End



        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName        = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA

                AnimationName    = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode    = ONCE
            End
        End


        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End

        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End

    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = VISION_HERO_RANGED
    ShroudClearingRange               = SHROUD_CLEAR_RANGED_HERO
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorCelegorm
    Hotkey                            = CONTROLBAR:NoldorCelegornHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorCelegormCommandSet
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY CelegormBow
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = WEAPONSET_TOGGLE_1
        Weapon                        = PRIMARY FeanorSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_HaldirBody

    AutoResolveArmor
        Armor                         = AutoResolve_HaldirArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_HaldirWeapon
    End





    VoiceAttack                      = CelegormVoiceAttack
    VoiceAttackAir                   = CelegormVoiceAttack
    VoiceAttackCharge                = CelegormVoiceAttack
    VoiceAttackMachine               = CelegormVoiceAttack
    VoiceAttackStructure             = CelegormVoiceAttack
    VoiceGuard                       = CelegormVoiceMove
    VoiceMove                        = CelegormVoiceMove
    VoiceMoveWhileAttacking          = CelegormVoiceMove
    VoicePriority                    = 85
    VoiceSelect                      = CelegormVoiceSelect
    VoiceSelectBattle                = CelegormVoiceSelect

    SoundImpact                      = ImpactHorse

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA             Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA             Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12
        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18
        AnimationSound = Sound:SwordShingClean1          Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1          Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier           Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier           Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 200
        TauntAndPointUpdateDelay        = 10000
        PointAt                         = ANY +HERO
        AddEmotion                      = Terror_Base
        AddEmotion                      = Doom_Base

        AddEmotion                      = UncontrollableFear_Base


        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 2000
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        CanAttackWhileContained        = Yes
        AILuaEventsList                = LegolasFunctions
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 56
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                   = 1.0
        ShockStandingTime             = 2000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes                    = ALL -FADED
        SinkDelay                     = 3000
        SinkRate                      = 0.4
        DestructionDelay              = 8000
        Sound                         = INITIAL HaldirVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight                   = 25
        SecondHeight                  = 25
        FirstPercentIndent            = 30%
        SecondPercentIndent           = 70%
        TumbleRandomly                = Yes
        CrushStyle                    = Yes
        DieOnImpact                   = Yes
        BounceCount                   = 1
        BounceDistance                = 41
        BounceFirstHeight             = 25
        BounceSecondHeight            = 25
        BounceFirstPercentIndent      = 20%
        BounceSecondPercentIndent     = 80%
        GroundHitFX                   = FX_ThrownRockGroundHit
        GroundBounceFX                = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 2700
        HitReactionLifeTimer2         = 3366
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 5.0
        HitReactionThreshold2         = 100.0
        HitReactionThreshold3         = 300.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership3Update
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                             = 300
        ObjectFilter                       = ANY -HERO +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseBeastArrow
        SpecialPowerTemplate               = SpecialAbilityDaleBeastSlayerArrow
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_BeastArrow
        SpecialPowerTemplate               = SpecialAbilityDaleBeastSlayerArrow
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BeastArrowUpdate
        SpecialPowerTemplate               = SpecialAbilityDaleBeastSlayerArrow
        SkipContinue                       = Yes
        WhichSpecialWeapon                 = 1
        UnpackTime                         = 2000
        PreparationTime                    = 1
        PersistentPrepTime                 = 1000
        PackTime                           = 1
        AwardXPForTriggering               = 0
        StartAbilityRange                  = HALDIR_BOW_RANGE
        ApproachRequiresLOS                = Yes
        SpecialWeapon                      = CelegormBlackArrow
    End

    Behavior = AutoAbilityBehavior ModuleTag_BeastArrowAutoAbility
        SpecialAbility                     = SpecialAbilityDaleBeastSlayerArrow
        MaxScanRange                       = HALDIR_BOW_RANGE
        Query                              = 1 ANY ENEMIES +HERO +MONSTER -STRUCTURE
        Query                              = 1 ANY ENEMIES +INFANTRY +CAVALRY -STRUCTURE
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate ToggleWeapon_AI
        CommandButtonName  = Command_ToggleFaramirWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Behavior = AISpecialPowerUpdate BlackArrow_AI
        CommandButtonName  = Command_CelegormBlackArrow
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
        SpecialPowerRadius = 250
    End




    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 19.2
    GeometryIsSmall     = Yes
    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
    Scale = 1.04
End


ChildObject NoldorCelegorm_Summoned NoldorCelegorm
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorCelegorm
    CommandSet                   = NoldorCelegormCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorCaranthir







    SelectPortrait = HPCaranthir
    ButtonImage    = HICaranthir



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                    = eucaranthir
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = KuMorg_SKL.KUMorg_CHRB
                AnimationMode        = ONCE
            End
        End


        IdleAnimationState
            StateName = Idle
            Animation           = IDLB
                AnimationName     = KuMorg_SKL.KUMorg_IDLB
                AnimationMode     = ONCE
                AnimationPriority   = 10
            End
            Animation           = IDLC
                AnimationName     = KuMorg_SKL.KUMorg_IDLC
                AnimationMode     = ONCE
                AnimationPriority   = 1
            End
            Animation           = IDLD
                AnimationName     = KuMorg_SKL.KUMorg_IDLD
                AnimationMode     = ONCE
                AnimationPriority   = 5
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    KuMorg_SKL.KUMorg_DTHA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Animation
                AnimationName        =    KuMorg_SKL.KUMorg_DTHB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    BURNINGDEATH
            Animation
                AnimationName        =    KuMorg_SKL.KUMorg_MFDA
                AnimationMode        =    LOOP
                Distance            =    90
            End
        End

            AnimationState                       =    DYING DEATH_2
                    Animation                        =    FadingOut
                        AnimationName                =    KuMorg_SKL.KUMorg_CHRB
                        AnimationMode                =    ONCE
                    End
            End

            AnimationState                        =    DYING
                    Animation                        =    Dying
                        AnimationName                =    KuMorg_SKL.KUMorg_DTHB
                        AnimationMode                =    ONCE
                    End
            End

        AnimationState = FREEFALL
            Animation
                AnimationName = KuMorg_SKL.KUMorg_FLYA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED_FLAILING
            Animation
                AnimationName = KuMorg_SKL.KUMorg_FLYA
                AnimationMode = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags = RANDOMSTART
        End

        AnimationState = STUNNED
            Animation
                AnimationName = KuMorg_SKL.KUMorg_LNDA
                AnimationMode = ONCE
            End
            EnteringStateFX                    = FX_OrcHitGround
        End

        AnimationState = STUNNED_STANDING_UP
            Animation
                AnimationName = KuMorg_SKL.KUMorg_GTPA
                AnimationMode = ONCE
            End
        End

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation
                AnimationName = KuMorg_SKL.KUMorg_RUNB
                AnimationMode = LOOP
            End

            Flags = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = KuMorg_SKL.KUMorg_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = KuMorg_SKL.KUMorg_ATKB
                AnimationMode = ONCE
            End
            Animation
                AnimationName = KuMorg_SKL.KUMorg_ATKC
                AnimationMode = ONCE
            End
        End

        AnimationState = USER_1
            Animation
                AnimationName      = KuMorg_SKL.KUMorg_CHRA
                AnimationMode      = ONCE
            End
        End


        AnimationState = MOVING
            Animation
                AnimationName = KuMorg_SKL.KUMorg_RUNB
                AnimationMode = LOOP
            End
            Flags = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = KuMorg_SKL.KUMorg_IDLA
                AnimationMode     = LOOP
            End

        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = KuMorg_SKL.KUMorg_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = KuMorg_SKL.KUMorg_LVLA
                AnimationMode = ONCE
            End
        End


        AnimationState = EMOTION_CELEBRATING
            Animation
                AnimationName = KuMorg_SKL.KUMorg_CHRA
                AnimationMode = LOOP
            End
            Animation
                AnimationName = KuMorg_SKL.KUMorg_CHRB
                AnimationMode = LOOP
            End
        End

        AnimationState                            = EMOTION_TAUNTING
            Animation                            = TNTA
                AnimationName                    = KuMorg_SKL.KUMorg_TNTA
                AnimationMode                    = ONCE

            End
            Animation                            = TNTB
                AnimationName                    = KuMorg_SKL.KUMorg_TNTB
                AnimationMode                    = ONCE

            End
        End

        AnimationState = RAISING_FLAG
            Animation
                AnimationName = KuMorg_SKL.KUMorg_CHRA
                AnimationMode = LOOP
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    KuMorg_SKL.KUMorg_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNC
                AnimationName            =    KuMorg_SKL.KUMorg_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = KuMorg_SKL.KUMorg_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    KuMorg_SKL.KUMorg_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End
    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                      = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorCaranthir
    Hotkey                            = CONTROLBAR:NoldorCaranthirHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorCaranthirCommandSet
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY CaranthirSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                         = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_GlorfindelWeapon
    End





    VoiceAttack                       = CaranthirVoiceAttack
    VoiceAttackAir                   = CaranthirVoiceAttack
    VoiceAttackCharge                 = CaranthirVoiceAttack
    VoiceAttackMachine                = CaranthirVoiceAttack
    VoiceAttackStructure              = CaranthirVoiceAttack
    VoiceGuard                        = CaranthirVoiceMove
    VoiceMove                         = CaranthirVoiceMove
    VoiceMoveWhileAttacking           = CaranthirVoiceMove
    VoicePriority                     = 85
    VoiceSelect                       = CaranthirVoiceSelect
    VoiceSelectBattle                 = CaranthirVoiceSelect

    SoundImpact                       = ImpactHorse

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
    AnimationSound = Sound:FootstepDirtA               Animation:KuMorg_SKL.KUMorg_RUNA        Frames:4 15
    AnimationSound = Sound:BodyFallGenericNoArmor       Animation:KuMorg_SKL.KUMorg_DIEA        Frames:48
    AnimationSound = Sound:BodyFallGenericNoArmor       Animation:KuMorg_SKL.KUMorg_DIEB        Frames:18
    AnimationSound = Sound:BodyFallSoldier                Animation:KuMorg_SKL.KUMorg_LNDA        Frames:4
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 250
        TauntAndPointUpdateDelay        = 1000
        AddEmotion                      = Terror_Base
        AddEmotion                      = Doom_Base

        AddEmotion                      = UncontrollableFear_Base


        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
         AddEmotion                     = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
     End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                    = EMOTION_CHEER_RADIUS
        MaxHealth                       = 2500
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                = EvilMenBlackRiderFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 50
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                    = 1.0
        ShockStandingTime              = 3000
        ShockStunnedTimeLow            = 1000
        ShockStunnedTimeHigh           = 1200
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.4
        DestructionDelay         = 8000
        Sound                 = INITIAL ElrondVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership4Update
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                              = 300
        ObjectFilter                       = ANY -HERO +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeanorSilLightEnabler
        SpecialPowerTemplate               = SpecialAbilityGlorfindelStarlight
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = OCLSpecialPower ModuleTag_FeanorSilLight
        StartsPaused                       = No
        SpecialPowerTemplate               = SpecialAbilityGlorfindelStarlight
        OCL                                = OCL_CarantirSilLightObject
        CreateLocation                     = CREATE_AT_LOCATION
        SetModelCondition                  = ModelConditionState:USER_1
        SetModelConditionTime              = 8.1
    End

    Behavior = AutoAbilityBehavior ModuleTag_StarlightAutoAbilityBehavior
        SpecialAbility                     = SpecialAbilityGlorfindelStarlight
        MaxScanRange                       = GLORFINDEL_STARLIGHT_RADIUS
        Query                              = 2 ANY ALLIES +HORDE
        Query                              = 1 ALL ENEMIES
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate SilLightAI
        CommandButtonName  = Command_CaranthirSilLight
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
        SpecialPowerRadius = 100
    End




    Scale         = 0.98
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 19.2
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 20
    ShadowSizeY     = 20
    ShadowTexture     = ShadowI
End


ChildObject NoldorCaranthir_Summoned NoldorCaranthir
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorCaranthir
    CommandSet                   = NoldorCaranthirCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorCurufin







    SelectPortrait = HPCurufin
    ButtonImage    = HICurufin



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                    = eucurufin
            Skeleton                 = char_fe_u_skl
            ModelAnimationPrefix     = char_fe
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = #(MODEL)_U_CHRA
                AnimationMode        = ONCE
            End
        End



    AnimationState        = STUNNED_FLAILING
            StateName           = STATE_Sword
            Animation
                AnimationName     = #(MODEL)_U_FLYA
                AnimationMode     = LOOP
            End
            Flags               = RANDOMSTART
    End




    AnimationState        = DYING DEATH_2
            Animation           = FadingOut
                AnimationName     = #(MODEL)_U_CHRA
                   AnimationMode     = ONCE
            End
    End

    AnimationState        = DYING SPLATTED
            StateName           = STATE_Sword
            Animation
                AnimationName     = #(MODEL)_U_LNDA
                AnimationMode     = ONCE
            End
    End

    AnimationState        = DYING
            StateName           = STATE_Sword
            Animation           = GUHero_DIEB
                AnimationName     = #(MODEL)_U_DIEB
                AnimationMode     = ONCE
            End
    End



    AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Sword
            Animation
            AnimationName     = #(MODEL)_U_GTPA
                   AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
    End

    AnimationState        = STUNNED
            StateName           = STATE_Sword
            Animation           = GUHero_LNDA
                AnimationName     = #(MODEL)_U_LNDA
                AnimationMode     = ONCE
            End
    End



        AnimationState = FIRING_OR_PREATTACK_A
            Animation
                AnimationName = #(MODEL)_U_ATKA
                AnimationMode = ONCE
            End
            Animation
                AnimationName = #(MODEL)_U_ATKB
                AnimationMode = ONCE
            End
            Animation
                AnimationName = #(MODEL)_U_ATKD
                AnimationMode = ONCE
            End
        End




        AnimationState        = MOVING USER_4
            StateName           = Slaughter
            Flags               = RANDOMSTART

            Animation           = GUHero_ATKE
                AnimationName     = #(MODEL)_U_ATKE
                AnimationMode     = LOOP
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
        End



        AnimationState            = MOVING
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART

            Animation
                AnimationName   = #(MODEL)_U_RUNA

                AnimationSpeedFactorRange = 0.85 0.85

            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
                if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
            EndScript
        End




        AnimationState = EMOTION_ALERT HIT_REACTION
            Animation
                AnimationName = #(MODEL)_B_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation
                AnimationName = #(MODEL)_U_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState        = PACKING_TYPE_1
            StateName         = Charge
            Animation
            AnimationName         = #(MODEL)_U_CHRA
            AnimationMode         = Once
            AnimationBlendTime   = 5
          End
        End




        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = #(MODEL)_U_CHRA #(MODEL)_U_LVLA
                AnimationMode        = ONCE
            End
        End




        AnimationState                =    EMOTION_CELEBRATING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_CHRA #(MODEL)_U_CHRA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    EMOTION_TAUNTING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_TNTB #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                = ENGAGED
            StateName                = STATE_ready
            Animation
                AnimationName        = #(MODEL)_U_IDLA
                AnimationMode        = ONCE
            End
        End



        IdleAnimationState
            StateName                    = STATE_Idle_Sword
            Animation = Foot_IDLA
                AnimationName       = #(MODEL)_U_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLB
                AnimationName       = #(MODEL)_U_IBFA
                AnimationMode       = ONCE
                AnimationPriority   = 10
            End
            Animation = Foot_IDLC
                AnimationName       = #(MODEL)_U_IBFB
                AnimationMode       = ONCE
                AnimationPriority   = 5
            End
            Animation = Foot_IDLD
                AnimationName       = #(MODEL)_U_IBFC
                AnimationMode       = ONCE
                AnimationPriority   = 5
            End
            Animation = Foot_IDLE
                AnimationName       = #(MODEL)_U_IBFD
                AnimationMode       = ONCE
                AnimationPriority   = 5
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End



        AnimationState   =  SELECTED
            StateName                =    STATE_Selected_Sword
            Animation                =    ATNB
                AnimationName        =    #(MODEL)_U_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") end
            EndScript
        End




        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName    = #(MODEL)_U_ATNA
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = #(MODEL)_U_ATNA
                AnimationMode            = ONCE_BACKWARDS
            End
            Flags                        = START_FRAME_LAST
        End
  End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = 340
    ShroudClearingRange              = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorCurufin
    Hotkey                            = CONTROLBAR:NoldorCurufinHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorCurufinCommandSet
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY CurufinSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType            = AutoResolveUnit_Hero
    AutoResolveCombatChain         = AutoResolve_HeroCombatChain

    AutoResolveBody                = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor                      = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon                    = AutoResolve_ElrondWeapon
    End





    VoiceAttack                      = CurufinVoiceAttack
    VoiceAttackAir                   = CurufinVoiceAttack
    VoiceAttackCharge                = CurufinVoiceAttack
    VoiceAttackMachine               = CurufinVoiceAttack
    VoiceAttackStructure             = CurufinVoiceAttack
    VoiceGuard                       = CurufinVoiceMove
    VoiceMove                        = CurufinVoiceMove
    VoiceMoveWhileAttacking          = CurufinVoiceMove
    VoicePriority                    = 85
    VoiceSelect                      = CurufinVoiceSelect
    VoiceSelectBattle                = CurufinVoiceSelect

    SoundImpact                      = ImpactHorse

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance            = 250
        TauntAndPointUpdateDelay         = 1000
        AddEmotion                       = Terror_Base
        AddEmotion                       = Doom_Base

        AddEmotion                       = UncontrollableFear_Base


        AddEmotion                       = Point_Base
        AddEmotion                       = Taunt_Base
         AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                       = Alert_Base
        AddEmotion                       = CheerForAboutToCrush_Base
     End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 2000
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 54
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                    = 1.0
        ShockStandingTime              = 3000
        ShockStunnedTimeLow            = 1000
        ShockStunnedTimeHigh           = 1200
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.4
        DestructionDelay         = 8000
        Sound                 = INITIAL ElrondVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 7
        HitReactionLifeTimer2         = 15
        HitReactionLifeTimer3         = 10

        HitReactionThreshold1         = 0.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership5Update
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                              = 300
        ObjectFilter                       = ANY -HERO +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_RageoftheNorthEnabler
        SpecialPowerTemplate               = SpecialAbilityRageoftheNorth
        TriggeredBy                        = Upgrade_Level_1
    End

      Behavior = SpecialPowerModule ModuleTag_ARageoftheNorthStarter
        SpecialPowerTemplate               = SpecialAbilityRageoftheNorth
        StartsPaused                       = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_RageoftheNorthUpdate
        SpecialPowerTemplate               = SpecialAbilityRageoftheNorth
        HeroAttributeModifier              = AngmarRageoftheNorth
        HeroEffectDuration                 = 20000
        UnpackTime                         = 200
        UnpackingVariation                 = 1
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate RageOfTheNorthAI
        CommandButtonName  = Command_CurufinRage
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End




    Scale         = 1.09
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 19.2
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 20
    ShadowSizeY     = 20
    ShadowTexture     = ShadowI
End


ChildObject NoldorCurufin_Summoned NoldorCurufin
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorCurufin
    CommandSet                   = NoldorCurufinCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorAmras







    SelectPortrait = HPAmras_Amrod
    ButtonImage    = HIAmras



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                      = euamras_amrod
            Skeleton                   = RULegolas_SKL
            WeaponLaunchBone           = PRIMARY ARROW
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = RULegolas_CHRB
                AnimationMode        = ONCE
            End
        End




        AnimationState        = STUNNED_FLAILING WEAPONLOCK_SECONDARY
            Animation           = FLYA
                AnimationName     = RULegolas_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End
        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = RULegolas_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        AnimationState        = DYING DEATH_2
            Animation           = FadingOut
                AnimationName     = RULegolas_CHRB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = RULegolas_DIEA
                AnimationMode     = ONCE
            End
            Animation           = DIEB
                AnimationName     = RULegolas_DIEB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = RULegolas_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
            Animation           = GUFaramir_GTPB
                AnimationName     = RULegolas_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End


        AnimationState        = STUNNED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDB
                AnimationName     = RULegolas_LNDB
                AnimationMode     = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RULegolas_IDLB
                AnimationMode                = LOOP
            End
        End



        AnimationState        = UNPACKING PACKING_TYPE_1
            Animation           = ATKA1
                AnimationName     = RULegolas_ATKA1
                AnimationMode     = ONCE
            End
            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End


        AnimationState        = PREPARING PACKING_TYPE_1
            Animation           = ATKA2
                AnimationName     = RULegolas_ATKA2
                AnimationMode     = LOOP
                AnimationSpeedFactorRange = 1.328 1.328
            End
            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState        = PACKING PACKING_TYPE_1
            Animation           = ATKA3
                AnimationName     = RULegolas_ATKA3
                AnimationMode     = LOOP
            End
            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        AnimationState                        = PREATTACK_A
            StateName                        = STATE_Firing
            Animation                        = ReadyToDrawn
                AnimationName                = RULegolas_ATKA1
                AnimationMode                = ONCE

                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 1.5 1.5
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End

        AnimationState                        = FIRING_OR_RELOADING_A
            StateName                        = STATE_Firing
            Animation                        = OneFrameOfShooting
                AnimationName                = RULegolas_ATKA2
                AnimationMode                = ONCE

                AnimationSpeedFactorRange    = 1.0 1.0
                AnimationBlendTime            = 0
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End








        AnimationState        = MOVING
            Animation           = RUNA
                AnimationName   = RULegolas_RUNA
                AnimationMode   = LOOP
                Distance        = 50
                AnimationBlendTime            = 10
            End
            Flags               = RANDOMSTART

            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBowWhileMoving") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        AnimationState                        = CONTINUOUS_FIRE_MEAN
            StateName                        = STATE_Firing
            Animation                        = HangFrameWhileCoasting
                AnimationName                = RULegolas_ATKA2
                AnimationMode                = MANUAL
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW
            StateName                        = STATE_Idle_Bow
            Animation                        = PutAwayArrow
                AnimationName                = RULegolas_ATKA3
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        AnimationState                =    EMOTION_CELEBRATING
            Animation           =    CHRA
                AnimationName   =    RULegolas_CHRA
                AnimationMode   =    ONCE
                AnimationPriority    =    10
            End
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
                AnimationPriority    =    5
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
            EndScript
        End


        AnimationState                =    RAISING_FLAG
            Animation           =    CHRA
                AnimationName   =    RULegolas_CHRA
                AnimationMode   =    ONCE
            End
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            Animation                =    ATNB
                AnimationName        =    RULegolas_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_SwitchToAttention") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End




        IdleAnimationState
            Animation           = IDLB
                AnimationName     = RULegolas_IDLB
                AnimationMode     = ONCE
                AnimationPriority    = 8
            End
            Animation           = IDLB
                AnimationName     = RULegolas_IDLB
                AnimationMode     = ONCE
                AnimationPriority    = 8
            End
            Animation           = IDLD
                AnimationName     = RULegolas_IDLD
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation           = IDLE
                AnimationName     = RULegolas_IDLE
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_SwitchFromAttention") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End



        TransitionState       = TRANS_SwitchToBow
            Animation           = STHB
                AnimationName     = RULegolas_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToSwords
            Animation           = STHA
                AnimationName     = RULegolas_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToBowWhileMoving
            Animation           = STHB
                AnimationName     = RULegolas_RUND
                AnimationMode     = ONCE
                Distance        = 50
            End
        End

        TransitionState       = TRANS_SwitchToSwordsWhileMoving
            Animation           = STHA
                AnimationName     = RULegolas_RUNE
                AnimationMode     = ONCE
                Distance        = 50
            End
        End

        TransitionState       = TRANS_SwitchToAttentionSword
            Animation           = ATNE
                AnimationName     = RULegolas_STHA
                AnimationMode     = ONCE
            End
        End


        TransitionState       = TRANS_SwitchToAttention
            Animation           = ATNA
                AnimationName     = RULegolas_ATNA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchFromAttention
            Animation           = ATND
                AnimationName     = RULegolas_ATND
                AnimationMode     = ONCE
            End
        End

    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = VISION_HERO_RANGED
    ShroudClearingRange               = SHROUD_CLEAR_RANGED_HERO
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorAmras
    Hotkey                            = CONTROLBAR:NoldorAmrasHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorAmrasCommandset
    CommandPoints                     = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY LegolasBow
        AutoChooseSources             = SECONDARY NONE
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_LegolasBody

    AutoResolveArmor
        Armor                         = AutoResolve_LegolasArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_LegolasWeapon
    End





    VoiceAttack                       = AmrasVoiceAttack
    VoiceAttackAir                    = AmrasVoiceAttack
    VoiceAttackCharge                 = AmrasVoiceAttack
    VoiceAttackMachine                = AmrasVoiceAttack
    VoiceAttackStructure              = AmrasVoiceAttack
    VoiceGuard                        = AmrasVoiceMove
    VoiceMove                         = AmrasVoiceMove
    VoiceMoveWhileAttacking           = AmrasVoiceMove
    VoicePriority                     = 85
    VoiceSelect                       = AmrasVoiceSelect
    VoiceSelectBattle                 = AmrasVoiceSelect

    SoundImpact                       = ImpactHorse

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNA    Frames:9 19
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNB    Frames:9 19
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUND    Frames:9 20
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNE    Frames:8 19
        AnimationSound = Sound:WeaponSwitchBowForLegolas   Animation:RULegolas_SKL.RULegolas_ATKB    Frames:0
        AnimationSound = Sound:WeaponSwitchBowForLegolas   Animation:RULegolas_SKL.RULegolas_ATKA1   Frames:0
        AnimationSound = Sound:BodyFallSoldier             Animation:RULegolas_SKL.RULegolas_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier             Animation:RULegolas_SKL.RULegolas_LNDB    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEA    Frames:48
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEB    Frames:89
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEC    Frames:64
    End

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 300
        TauntAndPointUpdateDelay        = 10000
        AddEmotion                      = Doom_Base



        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
         AddEmotion                     = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 1500
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = LegolasFunctions
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 58
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.40
        DestructionDelay         = 8000
        Sound                 = INITIAL ElvenWarriorVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight                   = 24
        SecondHeight                  = 24
        FirstPercentIndent            = 30%
        SecondPercentIndent           = 70%
        TumbleRandomly                = Yes
        CrushStyle                    = Yes
        DieOnImpact                   = Yes
        BounceCount                   = 1
        BounceDistance                = 40
        BounceFirstHeight             = 24
        BounceSecondHeight            = 24
        BounceFirstPercentIndent      = 20%
        BounceSecondPercentIndent     = 80%
        GroundHitFX                 = FX_ThrownRockGroundHit
        GroundBounceFX              = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 1993
        HitReactionLifeTimer2         = 1993
        HitReactionLifeTimer3         = 1993

        HitReactionThreshold1         = 5.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership6Update
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                             = 300
        ObjectFilter                      = ANY -HERO +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmrod_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArrowWindEnabler
        SpecialPowerTemplate               = SpecialAbilityArrowStorm
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_ArrowWindStarter
        SpecialPowerTemplate               = SpecialAbilityArrowStorm
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = Yes
    End

    Behavior = ArrowStormUpdate ModuleTag_ArrowWindUpdate
        SpecialPowerTemplate               = SpecialAbilityArrowStorm
        StartAbilityRange                  = 320.0
        UnpackTime                         = 1000
        PreparationTime                    = 200
        PersistentPrepTime                 = 600
        PackTime                           = 1200
        UnpackingVariation                 = 1
        ParalyzeDurationWhenCompleted      = 600
        ParalyzeDurationWhenAborted        = 800
        ApproachRequiresLOS                = Yes
        AwardXPForTriggering               = 0


        WeaponTemplate                     = LegolasBowArrowStorm
        TargetRadius                       = 120
        ShotsPerTarget                     = 1
        ShotsPerBurst                      = 3
        MaxShots                           = 50
        CanShootEmptyGround                = Yes
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate ArrowWindAI
        CommandButtonName  = Command_AmrasArrowStorm
        SpecialPowerAIType = AI_SPECIAL_POWER_LEGOLAS_ARROWWIND
        SpecialPowerRadius = 100
    End




    Scale         = 0.94
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 19.2
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 19
    ShadowSizeY     = 19
    ShadowTexture     = ShadowI
End


ChildObject NoldorAmras_Summoned NoldorAmras
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorAmras
    CommandSet                   = NoldorAmrasCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End




Object NoldorAmrod







    SelectPortrait = HPAmras_Amrod
    ButtonImage    = HIAmrod



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                      = euamrod_amras
            Skeleton                   = RULegolas_SKL
        End





        AnimationState                = USER_2
            Animation
                AnimationName        = RULegolas_CHRA
                AnimationMode        = ONCE
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = RULegolas_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End



        AnimationState        = DYING DEATH_2
            Animation           = FadingOut
                AnimationName     = RULegolas_CHRA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEC
                AnimationName     = RULegolas_DIEC
                AnimationMode     = ONCE
            End
        End



        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPC
                AnimationName     = RULegolas_GTPC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDA
                AnimationName     = RULegolas_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RULegolas_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RULegolas_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = PREPARING
            Animation
                AnimationName     = RULegolas_ATKA2
                AnimationMode     = LOOP
            End
            StateName           = STATE_Bow
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToBow") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End


        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKD
                AnimationName     = RULegolas_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKE
                AnimationName     = RULegolas_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKJ
                AnimationName     = RULegolas_ATKJ
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKK
                AnimationName     = RULegolas_ATKK
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End

            StateName           = STATE_Sword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_SwitchToSwords") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState        = PACKING_TYPE_1
            StateName         = HEALING
            Animation
            AnimationName         = RULegolas_CHRB
            AnimationMode         = Once
          End
        End




        AnimationState        = MOVING
            Animation           = RUNB
                AnimationName   = RULegolas_RUNB
                AnimationMode   = LOOP
                Distance        = 50
                AnimationBlendTime = 10
            End
            Flags               = RANDOMSTART

            StateName           = STATE_Sword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_SwitchToSwordsWhileMoving") end
                CurDrawableHideSubObject("arrow")
            EndScript
        End




        AnimationState                =    EMOTION_CELEBRATING
            Animation           =    CHRA
                AnimationName   =    RULegolas_CHRA
                AnimationMode   =    ONCE
                AnimationPriority    =    10
            End
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
                AnimationPriority    =    5
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    RAISING_FLAG
            Animation           =    CHRA
                AnimationName   =    RULegolas_CHRA
                AnimationMode   =    ONCE
            End
            Animation           =    CHRB
                AnimationName   =    RULegolas_CHRB
                AnimationMode   =    ONCE
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState  =    SELECTED
            StateName                =    SwordsAttn
            Animation                =    ATNF
                AnimationName        =    RULegolas_IDLJ
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwitchToAttentionSword") end
            EndScript
        End




        IdleAnimationState
            StateName           = STATE_Sword
            Animation           = IDLG
                AnimationName     = RULegolas_IDLB
                AnimationMode     = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
        if Prev == "SwordsAttn" then CurDrawableSetTransitionAnimState("TRANS_SwitchToSwordAttention") end
            EndScript
        End




        TransitionState       = TRANS_SwitchToAttentionSword
            Animation           = ATNE
                AnimationName     = RULegolas_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToSwordAttention
            Animation           = ATNE
                AnimationName     = RULegolas_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToAttention
            Animation           = ATNA
                AnimationName     = RULegolas_ATNA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchFromAttention
            Animation           = ATND
                AnimationName     = RULegolas_ATND
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToBow
            Animation           = STHB
                AnimationName     = RULegolas_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToSwords
            Animation           = STHA
                AnimationName     = RULegolas_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToBowWhileMoving
            Animation           = STHB
                AnimationName     = RULegolas_RUND
                AnimationMode     = ONCE
                Distance        = 50
            End
        End

        TransitionState       = TRANS_SwitchToSwordsWhileMoving
            Animation           = STHA
                AnimationName     = RULegolas_RUNE
                AnimationMode     = ONCE
                Distance        = 50
            End
        End

    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Imladris
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 200

    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent            = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:NoldorAmrod
    Hotkey                            = CONTROLBAR:NoldorAmrodHotkey

    CrushableLevel                    = 2
    CrusherLevel                      = 0

    CommandSet                        = NoldorAmrodCommandSet
    CommandPoints                    = 10





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY LegolasSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_LegolasBody

    AutoResolveArmor
        Armor                         = AutoResolve_LegolasArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_LegolasWeapon
    End





    VoiceAttack                       = AmrodVoiceAttack
    VoiceAttackAir                    = AmrodVoiceAttack
    VoiceAttackCharge                 = AmrodVoiceAttack
    VoiceAttackMachine                = AmrodVoiceAttack
    VoiceAttackStructure              = AmrodVoiceAttack
    VoiceGuard                        = AmrodVoiceMove
    VoiceMove                         = AmrodVoiceMove
    VoiceMoveWhileAttacking           = AmrodVoiceMove
    VoicePriority                     = 85
    VoiceSelect                       = AmrodVoiceSelect
    VoiceSelectBattle                 = AmrodVoiceSelect

    SoundImpact                       = ImpactHorse

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNA    Frames:9 19
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNB    Frames:9 19
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUND    Frames:9 20
        AnimationSound = Sound:FootstepDirtA               Animation:RULegolas_SKL.RULegolas_RUNE    Frames:8 19
        AnimationSound = Sound:WeaponSwitchBowForLegolas   Animation:RULegolas_SKL.RULegolas_ATKB    Frames:0
        AnimationSound = Sound:WeaponSwitchBowForLegolas   Animation:RULegolas_SKL.RULegolas_ATKA1   Frames:0
        AnimationSound = Sound:BodyFallSoldier             Animation:RULegolas_SKL.RULegolas_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier             Animation:RULegolas_SKL.RULegolas_LNDB    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEA    Frames:48
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEB    Frames:89
        AnimationSound = Sound:BodyFallGenericNoArmor      Animation:RULegolas_SKL.RULegolas_DIEC    Frames:64
    End

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 300
        TauntAndPointUpdateDelay        = 10000
        AddEmotion                      = Doom_Base



        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
         AddEmotion                     = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base


        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER GRAB_AND_DROP
    PathfindDiameter = 20.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = 1500
        PermanentlyKilledByFilter       = NONE
        DodgePercent                    = HERO_DODGE_PERCENT
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AutoHealBehavior ModuleTag_FeanorHealing
        StartsActive                    = Yes
        HealingAmount                   = HERO_HEAL_AMOUNT
        HealingDelay                    = 1000
        StartHealingDelay               = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat           = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        AILuaEventsList                 = LegolasFunctions
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 58
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes             = ALL -FADED
        SinkDelay             = 3000
        SinkRate             = 0.40
        DestructionDelay         = 8000
        Sound                 = INITIAL ElvenWarriorVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight                   = 24
        SecondHeight                  = 24
        FirstPercentIndent            = 30%
        SecondPercentIndent           = 70%
        TumbleRandomly                = Yes
        CrushStyle                    = Yes
        DieOnImpact                   = Yes
        BounceCount                   = 1
        BounceDistance                = 40
        BounceFirstHeight             = 24
        BounceSecondHeight            = 24
        BounceFirstPercentIndent      = 20%
        BounceSecondPercentIndent     = 80%
        GroundHitFX                 = FX_ThrownRockGroundHit
        GroundBounceFX              = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1         = 1993
        HitReactionLifeTimer2         = 1993
        HitReactionLifeTimer3         = 1993

        HitReactionThreshold1         = 5.0
        HitReactionThreshold2         = 25.0
        HitReactionThreshold3         = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FearlessForever
        TriggeredBy                    = Upgrade_Level_10
        AttributeModifier              = FearlessForever
    End

    Behavior = GrantUpgradeCreate ModuleTag_BuildHackUpgrade
       UpgradeToGrant                     = Upgrade_TestBuilding
       GiveOnBuildComplete                = Yes
    End











    Behavior = SpecialPowerModule ModuleTag_OnOathLeadership7Update
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = No
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                       = Yes
        BonusName                          = InseperableOnOath
        RefreshDelay                       = 2000
        Range                              = 300
        ObjectFilter                       = ANY -HERO +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroHealingEnabler_Level2
       SpecialPowerTemplate                = SpecialAbilityCreateAHeroHealing_Level2
       TriggeredBy                         = Upgrade_Level_1
    End

    Behavior = PlayerHealSpecialPower ModuleTag_CreateAHeroHealingPower_Level2
       SpecialPowerTemplate                = SpecialAbilityCreateAHeroHealing_Level2
       UpdateModuleStartsAttack            = Yes
       StartsPaused                        = Yes
       HealAffects                         = HERO
       HealAmount                          = 2000
       HealRadius                          = 150
       HealFX                              = FX_AmrodHealing
       InitiateSound                       = AragornAthelesEffect
       TriggerFX                           = FX_HaltetStand02
    End

    Behavior = SpecialAbilityUpdate ModuleTag_CreateAHeroHealingUpdate_Level2
       SpecialPowerTemplate                = SpecialAbilityCreateAHeroHealing_Level2
       UnpackTime                          = 1
       PreparationTime                     = 1
       PackTime                           = 3000
       UnpackingVariation                  = 5
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Behavior = AISpecialPowerUpdate AthelasAI
        CommandButtonName  = Command_AmrodHealing
        SpecialPowerAIType = AI_SPECIAL_POWER_SELFAOEHEALHEROS
    End




    Scale         = 0.94
    Geometry         = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight     = 19.2
    GeometryIsSmall     = Yes
    Shadow         = SHADOW_DECAL
    ShadowSizeX     = 19
    ShadowSizeY     = 19
    ShadowTexture     = ShadowI
End


ChildObject NoldorAmrod_Summoned NoldorAmrod
    IsTrainable                  = No
    CommandPoints                = 0
    EquivalentTo                 = NoldorAmrod
    CommandSet                   = NoldorAmrodCommandSet_Summoned
    KindOf                       = +SUMMONED

    Behavior = ModelConditionUpgrade ModuleTag_BuildHackUserFlag
       TriggeredBy                    = Upgrade_TestBuilding
       RequiresAllTriggers            = Yes
       AddTempConditionFlag           = ModelConditionState:USER_2
       TempConditionTime              = 1.6
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant             = 10
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 250000
        MaxLifetime              = 250000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes               = NONE +FADED
        FadeDelay                = 0
        FadeTime                 = 2500
        DestructionDelay         = 2500
        Sound                    = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags               = DEATH_2
    End
End

