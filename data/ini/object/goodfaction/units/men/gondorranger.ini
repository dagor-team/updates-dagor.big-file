Object GondorRanger


    SelectPortrait         = UPGondor_Ranger
    ButtonImage         = HIGondorRanger_Wotr

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes
        ParticlesAttachedToAnimatedBones = Yes


        LodOptions    = LOW
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_LOW
        End

        LodOptions    = MEDIUM
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_MED
        End

        LodOptions    = HIGH
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_HIGH
        End


        RandomTexture = guranger2.tga 0 guranger.tga
        RandomTexture = guranger.tga  0 guranger.tga






        DefaultModelConditionState
            Model                           = gbranger_skn
            Skeleton                        = GURanger_SKL
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = TERTIARY ARROW
            WeaponLaunchBone                = QUINARY ARROW
        End

        ModelConditionState                WEAPONSET_PLAYER_UPGRADE
            Model                           = gbranger_skn
            Skeleton                        = GURanger_SKL
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = SECONDARY ARROWNOCK
            WeaponLaunchBone                = TERTIARY ARROW
            WeaponLaunchBone                = QUINARY ARROW
        End

        #include "GondorRangerAnims.inc"



        AnimationState                       = DYING DEATH_5
            Animation                        = Die
                AnimationName                = GURanger_DIEA
                AnimationMode                = ONCE
            End
            EnteringStateFX                  = FX_UndeadModule
        End

    End


    Behavior = SubObjectsUpgrade ModuleTag_MakingTheUndeadModule
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects    = kuacolyte_skn
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side            = Men
    EditorSorting        = UNIT
    ThreatLevel        = 1.0
    ThingClass        = HORDE_UNIT
    CommandPoints        = 5
    BountyValue        = 5
    TransportSlotCount    = TRANSPORTSLOTCOUNT_UNIT
    ShockwaveResistance          = 20

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY     GondorRangerBowEdain
        Weapon        = TERTIARY    GondorRangerBowBombard
        Weapon        = QUINARY     MenLongShotFakeWeapon
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
        AutoChooseSources = QUINARY FROM_PLAYER FROM_SCRIPT
    End
    WeaponSet
        Conditions    = CLOSE_RANGE CONTESTING_BUILDING
        Weapon        = PRIMARY     GondorRangerBowEdain
        Weapon        = SECONDARY   GondorRangerSword
        Weapon        = TERTIARY    GondorRangerBowBombard
        Weapon        = QUINARY     MenLongShotFakeWeapon
        OnlyAgainst = PRIMARY STRUCTURE
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
        AutoChooseSources = QUINARY FROM_PLAYER FROM_SCRIPT
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainArcherArmor
        DamageFX        = NormalDamageFX
    End


    VisionRange        = 425
    ShroudClearingRange     = 475

    VisionSide = 35%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%


    DisplayName            = OBJECT:GondorRanger
    CrushableLevel        = 0
    CrushRevengeWeapon    = RangedInfantryCrushRevenge

    CommandSet            = GondorRangerCommandSet



    VoiceAttack                                = RangerVoiceAttack
    VoiceAttackAir                            = RangerVoiceAttack
    VoiceAttackCharge                        = RangerVoiceAttack
    VoiceAttackMachine                        = RangerVoiceAttack
    VoiceAttackStructure                    = RangerVoiceAttackBuilding
    VoiceEnterStateAttack                    = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackCharge                = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackMachine            = RangerVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure            = RangerVoiceEnterStateAttackBuilding
    VoiceCreated                            = RangerVoiceSalute
    VoiceFullyCreated                         = RangerVoiceSalute
    VoiceGuard                                = RangerVoiceMove
    VoiceMove                                = RangerVoiceMove
    VoiceMoveToCamp                            = RangerVoiceMoveCamp
    VoiceMoveWhileAttacking                    = RangerVoiceDisengage
    VoiceEnterStateMove                        = RangerVoiceEnterStateMove
    VoiceEnterStateMoveToCamp                = RangerVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking        = RangerVoiceEnterStateDisengage
    VoicePriority                            = 50
    VoiceRetreatToCastle                    = RangerVoiceRetreat
    VoiceEnterStateRetreatToCastle            = RangerVoiceEnterStateRetreat
    VoiceSelect                                = RangerVoiceSelectMS
    VoiceSelectBattle                         = RangerVoiceSelectBattle

    SoundImpact                                = ImpactHorse

    CrowdResponseKey = GoodMen

    UnitSpecificSounds
        VoiceGarrison                        = RangerVoiceGarrison


        VoiceEnterUnitElvenTransportShip    = DunedainVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DunedainVoiceCaptureBuilding
        VoiceMoveToTrees                    = RangerVoiceMoveTrees
        VoiceEnterStateMoveToTrees            = RangerVoiceEnterStateMoveTrees

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Ranger
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:ArrowDrawBow                        Animation:GURanger_SKL.GURanger_ATKD1    Frames:7
        AnimationSound = Sound:ArrowDrawBow                        Animation:GURanger_SKL.GURanger_ATKD2    Frames:17

        AnimationSound = Sound:SwordShingClean1ForHordes         Animation:GURanger_SKL.GURanger_STHA     Frames:10
        AnimationSound = Sound:SwordIntoScabbard1ForHordes        Animation:GURanger_SKL.GURanger_STHB     Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDA    Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDB    Frames:5

        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEA    Frames:50
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEB    Frames:51
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT ARCHER
    CamouflageDetectionMultiplier    = CAMOUFLAGE_DETECTION_DISTANCE_SHEDIUM

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 700
        MaxHealthDamaged  = 225
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End


    Behavior = WeaponSetUpgrade ModuleTag_WeaponSetUpgradeTag
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = SubObjectsUpgrade FireArrows_Upgrade
          TriggeredBy        = Upgrade_FireArrows
          ShowSubObjects    = FireArowTip ArrowNock
          HideSubObjects    = arrow
      End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS STEALTHED
        StopChaseDistance                = 562
        MoodAttackCheckRate                = 500
        HoldGroundCloseRangeDistance    = 40
        CanAttackWhileContained            = Yes
        AILuaEventsList                    =    RangerFunctions
        MinCowerTime                    =    4000
        MaxCowerTime                    =    6000
        AttackPriority                    =     AttackPriority_Archer
        BurningDeathTime                =    BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 24
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL -KNOCKBACK -FADED -EXTRA_3 -EXTRA_8
        SinkDelay            = 3000
        SinkRate            = 0.40
        DestructionDelay    = 15000
        Sound                = INITIAL HumanVoiceDie
        DeathFlags            = DEATH_1
    End

    Behavior = SlowDeathBehavior ModuleTag_Undead
        DeathTypes = NONE +EXTRA_3
        SinkDelay = 0
        SinkRate = 0
        DestructionDelay = 0
        DeathFlags = DEATH_5
        Sound = INITIAL HumanVoiceDie
        Weapon = FINAL EdainDeathforUndeadModule
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_2
        FX                    = INITIAL FX_UnSummonElvenAllies
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes            = NONE +KNOCKBACK
        SinkDelay            = 3000
        SinkRate            = 0.40
        DestructionDelay    = 15000
    End




    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End



    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = HordeMemberCollide ModuleTag_HMC

    End


    Scale = 1.05
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow                    = SHADOW_DECAL
    ShadowSizeX                = 19
    ShadowSizeY                = 19
    ShadowTexture            = ShadowI
End




ChildObject GondorRangerInn GondorRanger
    SelectPortrait = UPDunedainRanger
    EquivalentTo = GondorRanger_Summoned
    DisplayName = OBJECT:DunedainRanger
    CommandPoints = 6
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    Draw = W3DHordeModelDraw ModuleTag_01

        DefaultModelConditionState
            Model                            = Cine_GryRng
            Skeleton                        = GURanger_SKL
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = QUINARY ARROW
        End
        #include "GondorRangerAnims.inc"
    End




    VoiceAttack                                = DunedainVoiceAttack
    VoiceAttackAir                            = DunedainVoiceAttack
    VoiceAttackCharge                        = DunedainVoiceAttack
    VoiceAttackMachine                        = DunedainVoiceAttack
    VoiceAttackStructure                    = DunedainVoiceAttack
    VoiceCreated                            = DunedainVoiceSalute
    VoiceFullyCreated                         = DunedainVoiceSalute
    VoiceGuard                                = DunedainVoiceMove
    VoiceMove                                = DunedainVoiceMove
    VoiceMoveToCamp                            = DunedainVoiceMove
    VoiceMoveWhileAttacking                    = DunedainVoiceMove
    VoicePriority                            = 43
    VoiceRetreatToCastle                    = DunedainVoiceRetreat
    VoiceSelect                                = DunedainVoiceSelectMS
    VoiceSelectBattle                         = DunedainVoiceSelectBattle

    VoiceEnterStateAttack                    = DunedainVoiceEnterStateAttack
    VoiceEnterStateAttackCharge                = DunedainVoiceEnterStateAttack
    VoiceEnterStateAttackMachine            = DunedainVoiceEnterStateAttack
    VoiceEnterStateAttackStructure            = DunedainVoiceEnterStateAttack
    VoiceEnterStateMove                        = DunedainVoiceEnterStateMove
    VoiceEnterStateMoveToCamp                = DunedainVoiceEnterStateMove
    VoiceEnterStateMoveWhileAttacking        = DunedainVoiceEnterStateMove
    VoiceEnterStateRetreatToCastle            = DunedainVoiceEnterStateRetreat

    SoundImpact                                = ImpactHorse

    CrowdResponseKey = GoodMen

    UnitSpecificSounds
        VoiceCreatedFromInn                    = DunedainVoiceSalute-Inn
        VoiceEnterUnitElvenTransportShip    = DunedainVoiceMoveShip
        VoiceFullyCreatedFromInn             = DunedainVoiceSalute-Inn
        VoiceGarrison                        = DunedainVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = DunedainVoiceCaptureBuilding

        VoiceMoveToTrees                    = DunedainVoiceMoveForest
        VoiceEnterStateMoveToTrees            = DunedainVoiceEnterStateMoveForest

    End




    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL -KNOCKBACK -FADED
        SinkDelay            = 3000
        SinkRate            = 0.40
        DestructionDelay    = 15000
        Sound                = INITIAL HumanVoiceDie
        DeathFlags            = DEATH_1
    End

End


ChildObject GondorRanger_Summoned GondorRangerInn


    EquivalentTo                    = GondorRangerInn
    IsTrainable                        = No
    KindOf                            = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT ARCHER SUMMONED
    CommandPoints = 0


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End

      Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_2
        FX                    = INITIAL FX_UnSummonElvenAllies
        Sound                = INITIAL SpellGenericUnsummonFasterMS
    End

End


Object GondorRangersSummonEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 2000
        OCL                    = FINAL OCL_SpawnGondorRangers
    End
End

ChildObject GondorFaramirRanger_Summoned GondorRanger


    EquivalentTo                    = GondorRangerInn
    IsTrainable                        = No
    KindOf                            = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT ARCHER SUMMONED
    CommandPoints = 0


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End

      Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_2
        FX                    = INITIAL FX_UnSummonElvenAllies
        Sound                = INITIAL SpellGenericUnsummonFasterMS
    End

End


Object WaldlaeuferSummonEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 2000
        OCL                    = FINAL OCL_SpawnWaldlaeufer
    End
End

Object GondorRangerNoStealth

    SelectPortrait         = UPGondor_Ranger

    Draw = W3DHordeModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes


        LodOptions    = LOW
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_LOW
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_LOW
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_LOW
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_LOW
        End

        LodOptions    = MEDIUM
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_MED
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_MED
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_MED
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_MED
        End

        LodOptions    = HIGH
            AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_HIGH
            MaxRandomTextures        =    MAX_RANDOM_TEXTURES_HIGH
            MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_HIGH
            MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_HIGH
        End




        DefaultModelConditionState
            Model                            = GURanger_SKNM
            WeaponLaunchBone                = PRIMARY ARROW
        End

        ModelConditionState                WEAPONSET_PLAYER_UPGRADE
            Model                            = GURanger_SKNM
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = SECONDARY ARROWNOCK
            ParticleSysBone                    = FireArowTip arrowFire FollowBone:Yes
            ParticleSysBone                    = FireArowTip arrowFire FollowBone:Yes
        End



        ModelConditionState                WEAPONSET_TOGGLE_1
            Model                            = GURanger_SKNM
        End




        AnimationState                        = STUNNED_STANDING_UP
            Animation                        = GTPA
                AnimationName                = GURanger_SKL.GURanger_GTPA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.7 1.1
            End
        End

        AnimationState                        = PASSENGER
            Animation                        = FLLA
                AnimationName                = GURanger_SKL.GURanger_FLLA
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART
            StateName                        = Bow
        End

        AnimationState                        = THROWN_PROJECTILE
            Animation                        = FLYA
                AnimationName                = GURanger_SKL.GURanger_FLYA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = DYING SPLATTED
            Animation                        = Splattered
                AnimationName                = GURanger_SKL.GURanger_LNDA
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = STUNNED
            Animation                        = Stun
                AnimationName                = GURanger_SKL.GURanger_LNDA
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = DYING
            Animation                        = Die
                AnimationName                = GURanger_SKL.GURanger_DIEA
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = MOVING WEAPONSET_TOGGLE_1

            StateName                        = STATE_Run_Sword

            Animation                        = RunWithSword
                AnimationName                = GURanger_SKL.GURanger_RUNB
                AnimationMode                = LOOP
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End

        AnimationState                        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1

            StateName                        = STATE_Idle_Sword

            Animation                        = AttackWithSwordA
                AnimationName                = GURanger_SKL.GURanger_ATKA
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordB
                AnimationName                = GURanger_SKL.GURanger_ATKB
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End

        AnimationState                        = DYING WEAPONSET_TOGGLE_1

            StateName                        = STATE_Dead_Sword

            Animation                        = DieWithSword
                AnimationName                = GURanger_SKL.GURanger_DIEB
                AnimationMode                = ONCE
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End








        AnimationState                        = MOVING BACKING_UP WEAPONSET_PLAYER_UPGRADE

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = BackingUp
                AnimationName                = GURanger_SKL.GURanger_RUNC
                AnimationMode                = LOOP
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End

        AnimationState                        = MOVING DAMAGED WEAPONSET_PLAYER_UPGRADE

            StateName                        = STATE_Damaged_Walk_Bow

            ShareAnimation                    = Yes
            Animation                        = InjuredWalk
                AnimationName                = GURanger_SKL.GURanger_IWKA
                AnimationMode                = LOOP
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End

        AnimationState                        = MOVING PANICKING WEAPONSET_PLAYER_UPGRADE

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = RUNM
                AnimationName                = GURanger_SKL.GURanger_MFDA
                AnimationMode                = LOOP
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End

        AnimationState                        = MOVING WEAPONSET_PLAYER_UPGRADE

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = Run
                AnimationName                = GURanger_SKL.GURanger_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = .7 .7
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End

        AnimationState                        = MOVING BACKING_UP

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = BackingUp
                AnimationName                = GURanger_SKL.GURanger_RUNC
                AnimationMode                = LOOP
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End






















        AnimationState                        = MOVING PANICKING

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = RUNM
                AnimationName                = GURanger_SKL.GURanger_MFDA
                AnimationMode                = LOOP
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End

        AnimationState                        = MOVING

            StateName                        = STATE_Run_Bow

            ShareAnimation                    = Yes
            Animation                        = Run
                AnimationName                = GURanger_SKL.GURanger_RUNA
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = .7 .7
            End

            Flags                            = RANDOMSTART

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End



        AnimationState                        = PREATTACK_A

            StateName                        = STATE_Firing

            Animation                        = ReadyToDrawn
                AnimationName                = GURanger_SKL.GURanger_ATKD1
                AnimationMode                = ONCE

                AnimationBlendTime            = 0
            End
        End

        AnimationState                        = FIRING_A

            StateName                        = STATE_Firing

            Animation                        = OneFrameOfShooting
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = MANUAL
            End
        End

        AnimationState                        = RELOADING_A

            StateName                        = STATE_Firing

            Animation                        = LooseReloadDraw
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = ONCE

            End
        End

        AnimationState                        = CONTINUOUS_FIRE_MEAN

            StateName                        = STATE_Firing

            Animation                        = HangFrameWhileCoasting
                AnimationName                = GURanger_SKL.GURanger_ATKD2
                AnimationMode                = MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW

            StateName                        = STATE_Idle_Bow

            Animation                        = PutAwayArrow
                AnimationName                = GURanger_SKL.GURanger_ATKD3
                AnimationMode                = ONCE
            End
        End






        AnimationState                        = HIT_REACTION
            Animation                        = Hit_Level_1_a
                AnimationName                = GURanger_SKL.GURanger_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                        = EMOTION_AFRAID WEAPONSET_TOGGLE_1
            ShareAnimation                    = Yes
            Animation                        = &&FEAR WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_AFRAID
            ShareAnimation                    = Yes
            StateName                        = STATE_Afraid
            Animation                        = FERA
                AnimationName                = GURanger_SKL.GURanger_FERA
                AnimationMode                = LOOP
            End
            Animation                        = FERB
                AnimationName                = GURanger_SKL.GURanger_FERB
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation                        = &&TAUNT WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_TAUNTING
            ShareAnimation                    = Yes
            Animation                        = Taunting
                AnimationName                = GURanger_SKL.GURanger_TNTA
                AnimationMode                = ONCE
            End
            Animation                        = Taunting2
                AnimationName                = GURanger_SKL.GURanger_TNTB
                AnimationMode                = ONCE
            End
            Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = EMOTION_POINTING WEAPONSET_TOGGLE_1
            Animation                        = &&POINT WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1
                AnimationName                = GURanger_SKL.GURanger_PNTA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation                        = &&CHEER WITH SWORD&&
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = EMOTION_CELEBRATING
            ShareAnimation                    = Yes
            Animation                        = CHRA
                AnimationName                = GURanger_SKL.GURanger_CHRA
                AnimationMode                = Once
            End
            Animation                        = CHRB
                AnimationName                = GURanger_SKL.GURanger_CHRB
                AnimationMode                = Once
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = EMOTION_ALERT
            Animation                        = IdleBowA
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = ONCE
            End
        End


        AnimationState                        = SELECTED WEAPONSET_TOGGLE_1
            StateName                        = STATE_Idle_Sword

            Animation                        = SwordIdle
                AnimationName                = GURanger_SKL.GURanger_IDLB
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = SELECTED
            StateName                        = STATE_Idle_Bow

            Animation                        = selected
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = ONCE
            End
        End


        AnimationState                        = WEAPONSET_TOGGLE_1

            StateName                        = STATE_Idle_Sword

            Animation                        = SwordIdle
                AnimationName                = GURanger_SKL.GURanger_IDLB
                AnimationMode                = LOOP
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_Bow_To_Sword") end
            EndScript
        End
        AnimationState                        = WEAPONSET_PLAYER_UPGRADE

            StateName                        = STATE_Idle_Bow

            Animation                        = IdleBow
                AnimationName                = GURanger_SKL.GURanger_IDLA
                AnimationMode                = LOOP
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End
        IdleAnimationState
            StateName                        = STATE_Idle_Bow

            Animation                        = IdleBowG
                AnimationName                = GURanger_SKL.GURanger_IDLG
                AnimationMode                = ONCE
            End

            Animation                        = IdleBowF
                AnimationName                = GURanger_SKL.GURanger_IDLF
                AnimationMode                = ONCE
            End

            Flags                            = RESTART_ANIM_WHEN_COMPLETE

            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Run_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_Sword_To_Bow") end
            EndScript
        End


        TransitionState                        = TRANS_Bow_To_Sword
            Animation                        = DrawSwords
                AnimationName                = GURanger_SKL.GURanger_STHA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End

        TransitionState                        = TRANS_Sword_To_Bow
            Animation                        = DrawBow
                AnimationName                = GURanger_SKL.GURanger_STHB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End
    End



    Side = Men
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 1
    BountyValue = GONDOR_RANGER_BOUNTY_VALUE

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GondorRangerBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    GondorRangerSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = RangerArmor
        DamageFX        = NormalDamageFX
    End







    VisionRange = VISION_STANDARD_MELEE
    VisionSide = 35%
    VisionRear = 25%
    ShroudClearingRange = SHROUD_CLEAR_STANDARD

    DisplayName = OBJECT:GondorRanger
    CrushableLevel = 0
    CrushRevengeWeapon = RangedInfantryCrushRevenge

    CommandSet = GondorRangerCommandSet




    VoiceAttack                    = RangerVoiceAttack
    VoiceAttackAir                = RangerVoiceAttack
    VoiceAttackCharge                = RangerVoiceAttack
    VoiceAttackMachine            = RangerVoiceAttack
    VoiceAttackStructure            = RangerVoiceAttackBuilding
    VoiceEnterStateAttack            = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackCharge        = RangerVoiceEnterStateAttack
    VoiceEnterStateAttackMachine        = RangerVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure    = RangerVoiceEnterStateAttackBuilding
    VoiceCreated                = RangerVoiceSalute
    VoiceFullyCreated             = RangerVoiceSalute
    VoiceGuard                    = RangerVoiceMove
    VoiceMove                    = RangerVoiceMove
    VoiceMoveToCamp                = RangerVoiceMoveCamp
    VoiceMoveWhileAttacking            = RangerVoiceDisengage
    VoiceEnterStateMove            = RangerVoiceEnterStateMove
    VoiceEnterStateMoveToCamp        = RangerVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking    = RangerVoiceEnterStateDisengage
    VoicePriority                = 43
    VoiceRetreatToCastle            = RangerVoiceRetreat
    VoiceEnterStateRetreatToCastle    = RangerVoiceEnterStateRetreat
    VoiceSelect                    = RangerVoiceSelectMS
    VoiceSelectBattle             = RangerVoiceSelectBattle

    SoundImpact                    = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison            = RangerVoiceGarrison
    End



	EvaEventDamagedOwner	= UnitUnderAttack
	EvaEventDamagedFromShroudedSourceOwner = UnitUnderAttackFromShroudedUnit
	EvaEventDamagedByFireOwner  = GenericUnitBeingBurned
	EvaEventAmbushed = UnitAmbushed
	EvaEventSecondDamageFarFromFirstOwner = UnitUnderAttackAgain


	EvaEventSecondDamageFarFromFirstScanRange = 600
	EvaEventSecondDamageFarFromFirstTimeoutMS = 31000

    EvaEnemyObjectSightedEvent	= GenericEnemyUnitSighted

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Human Unit Infantry Ranger
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD1    Frames:7
        AnimationSound = Sound:ArrowDrawBow                    Animation:GURanger_SKL.GURanger_ATKD2    Frames:17

        AnimationSound = Sound:SwordShingClean1ForHordes         Animation:GURanger_SKL.GURanger_STHA     Frames:10
        AnimationSound = Sound:SwordIntoScabbard1ForHordes        Animation:GURanger_SKL.GURanger_STHB     Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDA    Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_LNDB    Frames:5

        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEA    Frames:50
        AnimationSound = Sound:BodyFallGenericNoArmor            Animation:GURanger_SKL.GURanger_DIEB    Frames:51
    End


    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP

    Body = ActiveBody ModuleTag_02
        MaxHealth         = GONDOR_RANGER_HEALTH
        MaxHealthDamaged  = GONDOR_RANGER_HEALTH_DAMAGED

    End


    Behavior = WeaponSetUpgrade ModuleTag_WeaponSetUpgradeTag
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        StopChaseDistance = 562
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 40
        CanAttackWhileContained    = Yes
        AILuaEventsList                =    RangerFunctions
        MinCowerTime                =    4000
        MaxCowerTime                =    6000
        AttackPriority                =     AttackPriority_Archer
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_INFANTRY_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_GOOD_INFANTRY_MEMBER_SPEED
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 24
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
        Sound = INITIAL HumanVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 15000
    End

    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 4
    GeometryMinorRadius = 4
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End