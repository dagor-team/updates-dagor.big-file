Object RohanOldMan

    SelectPortrait = HPOldMan
    ButtonImage    = HIOldMan

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Saruman

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        ExtraPublicBone = STAFFFX

        DefaultModelConditionState
            Model               = rutheokrpt
            Skeleton            = IUSaruman_SKL
        End


        IdleAnimationState
            StateName = Idle
            Animation = IDLB
                AnimationName       = IUSaruman_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 10
            End
            Animation = IDLC
                AnimationName       = IUSaruman_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 8
            End
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = FLYA
                AnimationName     = IUSaruman_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState            = DYING BURNINGDEATH DEATH_1
            Animation
                AnimationName    = IUSaruman_DIEB
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME DEATH_1
            Animation = DieAflame
                AnimationName     = IUSaruman_MFDA
                AnimationMode     = LOOP
            End
        End
        AnimationState        = DYING DEATH_1
            Animation = DieB
                AnimationName     = IUSaruman_DIEB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation = ByeBye
                AnimationName     = IUSaruman_IDLB
                AnimationMode     = LOOP
            End
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation
                AnimationName     = IUSaruman_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = IUSaruman_MFDA
                AnimationMode    = LOOP
                Distance        = 50
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUSaruman_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState                = PACKING_TYPE_1
            StateName                = Dominate
            Animation
                AnimationName        = IUSaruman_IDLB
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
        End


        AnimationState                = PACKING_TYPE_2
            StateName                = Spped_Craft
            Animation
                AnimationName        = IUSaruman_IDLB
                AnimationMode        = ONCE
            End
        End

        AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = IUSaruman_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART
        End


         AnimationState                = MOVING USING_SPECIAL_ABILITY
             Flags                    = RANDOMSTART
             Animation                = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
         End



         AnimationState            = MOVING BACKING_UP
            Animation            = BackingUp
                AnimationName    = IUSaruman_BAKA
                AnimationMode    = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState        = MOVING ATTACKING
             Animation              = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
        End

        AnimationState        = MOVING
             Animation                = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
        End


        AnimationState          = SPECIAL_WEAPON_ONE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_ATKB
                AnimationMode        = ONCE
            End
            FrameForPristineBonePositions = 27
        End


         AnimationState        =  SPECIAL_WEAPON_TWO
            StateName = Attacking
            Animation
                AnimationName       = IUSaruman_ATKB
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 27
        End


        AnimationState          = SPECIAL_WEAPON_THREE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        =    Yes
            End

            FrameForPristineBonePositions = 48
        End


        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = IUSaruman_ATKC
                AnimationName     = IUSaruman_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End

            Animation           = IUSaruman_ATKD
                AnimationName     = IUSaruman_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End
        End

        AnimationState = WAR_CHANT
            Animation = Chant
                AnimationName = IUSaruman_IDLB
                AnimationMode = LOOP
            End
        End

        AnimationState = EMOTION_TAUNTING
            Animation = Chant
                AnimationName = IUSaruman_IDLB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = EMOTION_CELEBRATING
            Animation = Chant
                AnimationName = IUSaruman_IDLB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = IUSaruman_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLC
                AnimationMode     = LOOP
            End
        End

        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    IUSaruman_IDLC
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATND
                AnimationName            =    IUSaruman_IDLC
                AnimationMode            =    ONCE
            End
        End


        AnimationState        = LEVELED
            Animation = Yippee
                AnimationName       = IUSaruman_IDLB
                AnimationMode       = ONCE
            End
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLC
                AnimationMode     = LOOP
            End
        End

        AnimationState = RAISING_FLAG
            Animation = Chant
                AnimationName = IUSaruman_TNTA
                AnimationMode = ONCE
            End
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    IUSaruman_IDLC
                AnimationMode        =    LOOP
                AnimationBlendTime  =   15
            End
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = SARUMAN_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost           = CTHEODENDAG_COST
    BuildTime           = VERY_WEAK_HERO_BUILDTIME
    MaxSimultaneousOfType    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO

    WeaponSet
        Conditions = None
    End

    ArmorSet
        Conditions      = None
        Armor           = VeryWeakHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue       = 1000
    DisplayName       = OBJECT:RohanOldMan
    RecruitText       = CONTROLBAR:RohanOldManRecruit
    ReviveText        = CONTROLBAR:RohanOldManRevive
    Hotkey            = CONTROLBAR:RohanOldManHotkey
    CrushableLevel    = 2
    CrusherLevel = 0

    CommandSet = RohanTheodenOldManCommandSet
    CommandPoints = 0




    VoiceCreated            = KorrumpierterVoiceRecruit
    VoiceFullyCreated       = KorrumpierterVoiceRecruit
    VoiceGuard              = KorrumpierterVoiceMove
    VoiceMove               = KorrumpierterVoiceMove
    VoiceMoveToCamp         = KorrumpierterVoiceMove
    VoicePriority           = 85
    VoiceSelect             = KorrumpierterVoiceSelect
    VoiceSelectBattle       = KorrumpierterVoiceSelect

    SoundImpact             = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison       = KorrumpierterVoiceMove
        VoiceEnterUnitElvenTransportShip    = KorrumpierterVoiceMove
        VoiceInitiateCaptureBuilding        = KorrumpierterVoiceMove
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner     = TheodenDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKB    Frames:39 104
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKC     Frames:43 92
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKD     Frames:13 29 55
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATRA    Frames:9 20 31 43 55 67
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:20
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:34
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_GTPA    Frames:51 75 113 139
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_HITA    Frames:12
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLC    Frames:116 188
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLD    Frames:43
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_LNDA    Frames:4
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_MFDA    Frames:10 19 29 39 48 57 66
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNA    Frames:11 22 34 46 57 69
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNB    Frames:10 23 36 49 62 75
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTA    Frames:36 49 103 123
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTB    Frames:24 111
    End



    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE NOTIFY_OF_PREATTACK ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER IGNORES_SELECT_ALL
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius               = EMOTION_CHEER_RADIUS
        MaxHealth                 = CTHEODENDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
        BurningDeathBehavior      = Yes
        BurningDeathFX            = FX_InfantryBurningFlame
        CheerRadius               = EMOTION_CHEER_RADIUS
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 4000
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 4000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIOldMan

        RespawnRules =            AutoSpawn:No    Cost:CTHEODENDAG_COST        Time:VERY_WEAK_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_SarumanHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        AttackPriority              = AttackPriority_Infantry
        BurningDeathTime            = BURNINGDEATH_DURATION_INFANTRY
	AILuaEventsList             = RohanTheodenFunctions
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance               = 300
        TauntAndPointUpdateDelay            = 10000
        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 42
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 32
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed     = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult 		= 1.0
        ShockStandingTime       = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL KorrumpierterVoiceDie
        ShadowWhenDead = No
        DeathFlags = DEATH_1
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 3000
        HitReactionThreshold1 = 5.0
    End






    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive        	= Yes
        BonusName           	= TheodenvonRohan
        RefreshDelay        	= 2000
        Range               	= 200
        ObjectFilter        	= ANY +CAVALRY +INFANTRY -STRUCTURE -DOZER -SHIP -HERO -MACHINE -TROLL -RohanSpeerwerfer_Slaved ALLIES
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = No
    End





    Behavior = SpecialPowerModule ModuleTag_VerbannungStarter
        SpecialPowerTemplate     = SpecialAbilityVerbannungExil
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_VerbannungUpdate
        SpecialPowerTemplate     = SpecialAbilityVerbannungExil
        SkipContinue             = Yes
        UnpackTime               = 1100
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 500
        MustFinishAbility        = Yes
        AwardXPForTriggering     = 0
        StartAbilityRange        = 200
        SpecialWeapon            = VerbannungExilWeapon
        WhichSpecialWeapon       = 3
    End







    Behavior                    = OCLSpecialPower ModuleTag_AusbeutesteuerSpecialPower
        SpecialPowerTemplate    = SpecialAbilityAusbeutesteuer
        OCL                     = OCL_SpawnAusbeutesteuer
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = No
    End





	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MightyRageStarter
		SpecialPowerTemplate			= SpecialAbilityTheodenTraitorofRohan
	End

	Behavior = SpecialPowerModule ModuleTag_DainMightyRageDummy
		SpecialPowerTemplate			= SpecialAbilityTheodenTraitorofRohan
		StartsPaused				= No
		UpdateModuleStartsAttack		= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
		SpecialPowerTemplate			= SpecialAbilityTheodenTraitorofRohan
		StartAbilityRange			= 150
		TriggerSpecialPower			= ModuleTag_MightyRageBuff	TARGETPOS
	End

	Behavior = SpecialPowerModule ModuleTag_MightyRageBuff
		SpecialPowerTemplate			= SpecialAbilityActivateeDummy
		AttributeModifier			= RohanVerraterModifier
		AttributeModifierRange			= 75
		AttributeModifierAffects		= NONE +RohanPeasant +RohanPeasant1 +RohanPeasant2 +RohanPeasant3 +RohanPeasant4 +RohanPeasantHorde +RohanPeasant_modneu +RohanPeasant1_modneu +RohanPeasant2_modneu +RohanPeasant3_modneu +RohanPeasant4_modneu +RohanPeasantHorde_modneu ALLIES
	End






    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate      = SpecialAbilityTheodenRuckzug
        UpdateModuleStartsAttack  = Yes
        StartsPaused = No
        AttributeModifier = TheodenRuckzug
        AttributeModifierRange = 300
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +INFANTRY +CAVALRY +RohanOldMan
        AttributeModifierFX = FX_TheodenRuckzug
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenRuckzug
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GorthaurEnabler
        SpecialPowerTemplate         = SpecialAbilityToggleSauronGestaltenSauron
		TriggeredBy                     = Upgrade_RuhmdesKonigsUpgrade
    End

	Behavior = SpecialPowerModule ModuleTag_KillOldManStarter
         SpecialPowerTemplate           = SpecialAbilityToggleSauronGestaltenSauron
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_KillOldMan
         SpecialPowerTemplate           = SpecialAbilityToggleSauronGestaltenSauron
         MountedTemplate                = RohanTheoden
         SynchronizeTimerOnSpecialPower = SpecialAbilityTheodenRuckzug SpecialAbilityTheodenTraitorofRohan SpecialAbilityAusbeutesteuer SpecialAbilityVerbannungExil
         UnpackTime                     = 100
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

	Behavior = QueueProductionExitUpdate ModuleTag_Grima
        UnitCreatePoint         = X:-25.0 Y:0.0 Z:0.0
        NaturalRallyPoint       = X:-25 Y:0.0 Z:0.0
        ExitDelay               = 300
        NoExitPath              = Yes
    End

    Behavior = SpawnBehavior ModuleTag_SpawnGrima
        SpawnNumber             = 1
        InitialBurst            = 1
        SpawnTemplateName       = IsengardWormTongue_Mod_Slaved
        SpawnReplaceDelay       = 15000
        FadeInTime              = 1000
        SpawnInsideBuilding     = Yes
    End




	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGiveXPAoE
        CommandButtonName = Command_SpecialAbilityVerbannungExil
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate RoyalGuardAI
        CommandButtonName = Command_SpecialAbilityTheodenVerraterRohans
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityTheodenruckzug
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Scale 		    = 0.96
    Geometry                = CYLINDER
    GeometryMajorRadius     = 8.0
    GeometryMinorRadius     = 8.0
    GeometryHeight          = 19.2
    GeometryIsSmall         = Yes

    Shadow                  = SHADOW_DECAL
    ShadowSizeX             = 19
    ShadowSizeY             = 19
    ShadowTexture           = ShadowI
End

Object RohanTheoden

    SelectPortrait = HPTheodenNew
    ButtonImage    = HIKingTheoden

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

      OkToChangeModelColor = Yes
      StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model    = RUTheoden_SKA
            Skeleton = RUTheoden_SKL
        End

        ModelConditionState = WORLD_BUILDER
            Model    = RUTheoden_SKA
            Skeleton = RUTheoden_SKL
        End

        ModelConditionState = MOUNTED
            Model    = RUTheoden_HRA
            Skeleton = RUHHs_Theo_SKL
            WeaponLaunchBone    = PRIMARY PASSENGERBONE
        End

        AnimationState                = MOUNTED DEBUG
            Animation
                AnimationName       = RUHHs_Theo_IDLA
                AnimationMode       = ONCE
            End
            ParticleSysBone = BAT_HHEAD glowHorseGold FollowBone:Yes
            ParticleSysBone = B_HHIPL glowHorseRearGold FollowBone:Yes
            ParticleSysBone = BAT_SPINE2 glowGold FollowBone:Yes
        End



        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    MOUNTED DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED DYING DEATH_2
            Animation                =    ByeBye
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End

        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                        =    PACKING_TYPE_2 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    MOUNTED ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = MOUNTED LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = MOUNTED EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED DEATH_1
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_1
            Animation                        =    RUTheoden_DIEA
                AnimationName                =    RUTheoden_DIEA
                AnimationMode                =    ONCE
            End
            Animation                        =    RUTheoden_DIEB
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_2
            Animation                        =    ByeBye
                AnimationName                =    RUTheoden_IDLA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes
            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE
            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes
            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes
            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUTheoden_SPCB
                AnimationSpeedFactorRange    =    1.1666 1.1666
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
            Animation                        =    SPCD
                AnimationName                =    RUTheoden_SPCC
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                = Rohan
    EditorSorting       = UNIT
    ThreatLevel         = THEODEN_THREAT_LEVEL
    ThingClass          = CHARACTER_UNIT
    BuildCost           = THEODENDAG_COST
    BuildTime           = SILMARIL_HERO_BUILDTIME
    DisplayMeleeDamage  = THEODENDAG_DAMAGE
    TransportSlotCount  = TRANSPORTSLOTCOUNT_HERO
    MaxSimultaneousOfType = 1


    WeaponSet
        Conditions = NONE
        Weapon = PRIMARY    TheodenSwordMod
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions = MOUNTED
        Weapon = PRIMARY    TheodenSwordMod
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End


    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = MOUNTED
        Armor           = StrongRohanHeroArmorMounted
        DamageFX        = NormalDamageFX
    End

    VisionRange           = 250
    ShroudClearingRange   = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue    	= ROHAN_THEODEN_BOUNTY_VALUE
    DisplayName    	= OBJECT:RohanTheoden
    RecruitText    	= CONTROLBAR:RohanTheodenRecruit
    ReviveText     	= CONTROLBAR:RohanTheodenRevive
    Hotkey         	= CONTROLBAR:RohanTheodenHotkey
    CrusherLevel   	= 0
    MountedCrusherLevel = 1
    CrushableLevel 	= 3
    MountedCrushableLevel = 2

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback 	= 40
    CrushZFactor   	= 1.0

    CommandSet 		= RohanTheodenCommandSetEnd
    CommandPoints 	= 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_AragornBody

    AutoResolveArmor
        Armor = AutoResolve_AragornArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_AragornWeapon
    End

    AutoResolveLeadership = AutoResolve_AragornBonus



    VoiceAttack              = TheodenVoiceAttack
    VoiceAttackCharge        = TheodenVoiceAttackCharge
    VoiceAttackStructure     = TheodenVoiceAttackBuilding
    VoiceCreated             = TheodenVoiceSalute
    VoiceFullyCreated        = TheodenVoiceSalute
    VoiceFear                = TheodenVoiceHelpMe
    VoiceGuard               = TheodenVoiceMove
    VoiceMove                = TheodenVoiceMove
    VoiceMoveToCamp          = TheodenVoiceMoveCamp
    VoicePriority            = 90
    VoiceSelect              = TheodenVoiceSelectMS
    VoiceSelectBattle        = TheodenVoiceSelectBattle

    SoundCrushing            = RohirrimCrushing
    SoundImpact              = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                     = TheodenVoiceGarrison
        VoiceEnterUnitElvenTransportShip  = TheodenVoiceMove
        VoiceInitiateCaptureBuilding      = TheodenVoiceMove
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove            = TheodenVoiceMoveMounted
            VoiceSelect          = TheodenVoiceSelectMountedMS
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner     = TheodenDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        	Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA        	Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27

        AnimationSound = Sound:TauntHumanHitShield    	Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31

        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier        	Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1

        AnimationSound = Sound:HorseMoveFootsteps       Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps       Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps       Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps       Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            	Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        	Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        	Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        	Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        	Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                  = EMOTION_CHEER_RADIUS
        MaxHealth                    = THEODENDAG_HEALTH
        PermanentlyKilledByFilter    = NONE
        DodgePercent                 = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                   = DYING
        DeathAnimationTime          = 4000
        RespawnAnim                 = LEVELED
        RespawnAnimationTime        = 4000
        AutoRespawnAtObjectFilter   = NONE +CASTLE_KEEP
        ButtonImage                 = HIKingTheoden

        RespawnRules =    AutoSpawn:No           Cost:THEODENDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = 300
        TauntAndPointUpdateDelay    = 1000

        AddEmotion            = Doom_Base
        AddEmotion            = Point_Base
        AddEmotion            = Taunt_Base
        AddEmotion            = CheerIdle_Base
        AddEmotion            = CheerBusy_Base
        AddEmotion            = Alert_Base
        AddEmotion            = CheerForAboutToCrush_Base
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

     Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        HoldGroundCloseRangeDistance  = 40
        AILuaEventsList               = RohanTheodenFunctions
    End

; ----------------------------------------------------------------------
; Ring Fonction Eorl
; ----------------------------------------------------------------------

    Behavior = SpecialPowerModule ModuleTag_VerfuhrteToggleStarterEorl
		SpecialPowerTemplate        	= SpecialAbilityGandalfVerfuhrte
		UpdateModuleStartsAttack    	= Yes
		StartsPaused                	= No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerfuhrteUpdateEorl
		SpecialPowerTemplate           	= SpecialAbilityGandalfVerfuhrte
		MountedTemplate                	= RohanTheoden_modEorl
		SynchronizeTimerOnSpecialPower 	= SpecialAbilityToggleMounted SpecialAbilityKingsFavor SpecialAbilityTheodenGloriousCharge2
		UnpackTime                     	= OBJECT_TOGGLE_TIME
		PreparationTime                	= 0
		PackTime                       	= 0
		OpacityTarget                  	= .0
		AwardXPForTriggering           	= 0
		IgnoreFacingCheck              	= Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingannehmen2
        TriggeredBy                 	= Upgrade_SauronSilmarilArrive Upgrade_RingHero Upgrade_FortressRingHero
        RequiresAllTriggers             = Yes
        GetUpgradeCommandButtonName 	= Command_SpecialAbilityGandalfVerfuhrte
    End

; ----------------------------------------------------------------------
; Ring Function Theoden
; ----------------------------------------------------------------------

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroStarter
		SpecialPowerTemplate           	= SpecialAbilityGandalfGeprufte
		UpdateModuleStartsAttack       	= Yes
		StartsPaused                   	= No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_SilmarilHero
		SpecialPowerTemplate           	= SpecialAbilityGandalfGeprufte
		MountedTemplate                	= RohanTheoden_modRingHero
		SynchronizeTimerOnSpecialPower 	= SpecialAbilityTheodenGloriousCharge2 SpecialAbilityTheodenHerold SpecialAbilityStundedesRuhms
		UnpackTime                     	= OBJECT_TOGGLE_TIME
		PreparationTime                	= 0
		PackTime                       	= 0
		OpacityTarget                  	= .0
		AwardXPForTriggering           	= 0
		IgnoreFacingCheck              	= Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandSilmarilHero
        TriggeredBy                     = Upgrade_TheodenSilmarilOption
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGlorfindelRingSwitch
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingablehnenForKI
        TriggeredBy                     = Upgrade_ObjectUnderAIControl Upgrade_RingHero Upgrade_FortressRingHero
        RequiresAllTriggers             = Yes
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGlorfindelRingSwitch
    End

    Behavior = CitadelSlaughterHordeContain ModuleTag_SlaughterMe
        PassengerFilter              	= NONE +TheDroppedRing
        ObjectStatusOfContained      	= UNSELECTABLE ENCLOSED
        ContainMax                   	= 1
        AllowEnemiesInside           	= No
        AllowAlliesInside            	= Yes
        AllowNeutralInside           	= No
        AllowOwnPlayerInsideOverride 	= Yes
        EntryOffset                  	= X:0.0 Y:0.0 Z:0.0
        EntryPosition                	= X:0.0 Y:0.0 Z:0.0
        ExitOffset                   	= X:0.0 Y:0.0 Z:0.0
        StatusForRingEntry           	= HOLDING_THE_RING
        UpgradeForRingEntry          	= Upgrade_RingHero Upgrade_FortressRingHero
        ObjectToDestroyForRingEntry  	= NONE +TheDroppedRing
        FXForRingEntry               	= FX_OneRingFlare
    End

    Behavior = CommandSetUpgrade ModueTag_RohanChoice
        TriggeredBy    					= Upgrade_RingHero Upgrade_FortressRingHero
        ConflictsWith  					= Upgrade_ObjectUnderAIControl
        CommandSet     					= RohanTheodenCommandSet_SilmarilChoice
    End

    Behavior = ModelConditionUpgrade ModulTag_RingHeroMC
        TriggeredBy         			= Upgrade_RingHero Upgrade_FortressRingHero
        RequiresAllTriggers 			= Yes
        AddConditionFlags   			= ONE_RING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly 					= Yes
        StuffToPickUp 					= NONE +TheDroppedRing
        ScanRange 						= 3000
        ScanIntervalSeconds 			= 0.5
    End

    Behavior = CommandSetUpgrade ModueTag_RohanChoiceNormalCommandset
        TriggeredBy    	= Upgrade_SauronSilmarilArrive
        ConflictsWith  	= Upgrade_ObjectUnderAIControl
        CommandSet     	= RohanTheodenCommandSetEnd
    End

    Behavior = CommandSetUpgrade ModueTag_Level3CommandSetSilmaril
        TriggeredBy     = Upgrade_Level_3
        ConflictsWith  	= Upgrade_RingHero Upgrade_FortressRingHero
        CommandSet      = RohanTheodenCommandSetEnd3
    End

    Behavior = CommandSetUpgrade ModueTag_Level5CommandSetSilmaril
        TriggeredBy     = Upgrade_Level_5
        ConflictsWith  	= Upgrade_RingHero Upgrade_FortressRingHero
        CommandSet      = RohanTheodenCommandSetEnd5
    End
	
	Behavior = CommandSetUpgrade ModueTag_Level7CommandSetSilmaril
        TriggeredBy     = Upgrade_Level_7
        ConflictsWith  	= Upgrade_RingHero Upgrade_FortressRingHero
        CommandSet      = RohanTheodenCommandSetEnd7
    End

    Behavior = CommandSetUpgrade ModueTag_Level10CommandSetSilmaril
        TriggeredBy     = Upgrade_Level_10
        ConflictsWith  	= Upgrade_RingHero Upgrade_FortressRingHero
        CommandSet      = RohanTheodenCommandSetEnd10
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 300
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = TheodenHamaModifier
        AllowFilter             = ANY +RohanHama ALLIES
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = ROHAN_MOUNTED_HERO_SPEED
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseEnabler
        SpecialPowerTemplate 		= SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      	= SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  	= Yes
         StartsPaused              	= No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate     	= SpecialAbilityToggleMounted
         UnpackTime                	= ROHAN_MOUNT_TIME
         PreparationTime           	= 1
         PersistentPrepTime        	= 250
         PackTime                  	= ROHAN_MOUNT_TIME
         OpacityTarget             	= .3
         AwardXPForTriggering      	= 0
         TriggerInstantlyOnCreate  	= No
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FactionLeaderLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_FactionLeaderLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FactionLeaderLeadership
        StartsActive     = Yes
        BonusName        = FactionLeaderGlobalLeadership
        RefreshDelay     = 2000
        Range            = 625
        ObjectFilter     = ROHAN_LEADERSHIP_UNITS_OBF
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_1
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ROHAN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership3
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_3
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ROHAN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership5
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_5
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ROHAN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership7a
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_7
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ROHAN_LEADERSHIP_HEROES_OBF ;ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership7b
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_7
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ROHAN_LEADERSHIP_HEROES_OBF ;ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10a
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ROHAN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10b
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ROHAN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10d
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ROHAN_LEADERSHIP_HEROES_OBF ;ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10e
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ROHAN_LEADERSHIP_HEROES_OBF ;ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
        SpecialPowerTemplate = SpecialAbilityKingsFavor
        TriggeredBy = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate        = SpecialAbilityKingsFavor
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
        SpecialPowerTemplate        = SpecialAbilityKingsFavor
        UnpackingVariation          = 2
        StartAbilityRange           = 300.0
        LevelFX                     = FX_LevelUp
        Experience                  = 200
        RadiusEffect                = 150
        AcceptanceFilter            = KINGSFAVOR_OBJECTFILTER
        UnpackTime                  = 3000
        PreparationTime             = 0
        FreezeAfterTriggerDuration  = 2000
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Held
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_HeldUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_Bonus2
        TriggeredBy = Upgrade_Level_5
        AttributeModifier = HeldvonHelmsKlamm
    End

    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy       = Upgrade_Level_5
        UpgradeTexture    = rutheoden_start.tga 0 rutheoden.tga
        ShowSubObjects    = HELM GEAR HEAD02
        HideSubObjects    = HEAD01 MANTEL
    End


; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler2
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge2
        TriggeredBy = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate2
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge2
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge2
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation2
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge2
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler3
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge3
        TriggeredBy = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate3
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge3
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge3
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation3
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge3
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler4
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge4
        TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate4
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge4
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge4
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation4
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge4
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End
	
; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler5
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge5
        TriggeredBy = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate5
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge5
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge5
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation5
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge5
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End	

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = TheodenExilDestroyWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End


    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL TheodenVoiceDie
        DeathFlags = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGiveXPAoEFavorAI
        CommandButtonName = Command_SpecialAbilityKingsFavorEdainTheo
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 200.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityTheodenGloriousChargeEdain
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry             = CYLINDER
    GeometryMajorRadius  = 8.0
    GeometryHeight       = 25
    GeometryIsSmall      = Yes

    Shadow               = SHADOW_DECAL
    ShadowSizeX          = 19
    ShadowSizeY          = 19
    ShadowTexture        = ShadowI
End


ChildObject RohanTheoden_modEorl RohanTheoden

    EquivalentTo  = RohanTheoden

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 6500
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIKingTheoden
        RespawnAsTemplate            = RohanTheoden

        RespawnRules =            AutoSpawn:No    Cost:THEODENDAG_COST        Time:STRONG_HERO_RESPAWNTIME        Health:100%
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End



    Behavior = CommandSetUpgrade ModueTag_RohanChoice
        TriggeredBy    = Upgrade_RingHero Upgrade_FortressRingHero
        ConflictsWith  = Upgrade_ObjectUnderAIControl
        CommandSet     = RohanTheodenCommandSet_SilmarilChoiceSecondEorl
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroEnablerEorl
        SpecialPowerTemplate 		= SpecialAbilityToggleSauronGestaltenSauron
	TriggeredBy			= Upgrade_RingHero
    End

    Behavior = SpecialPowerModule ModuleTag_VerfuhrteToggleStarterEorlSecond
         SpecialPowerTemplate           = SpecialAbilityToggleSauronGestaltenSauron
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerfuhrteUpdateEorlSecond
         SpecialPowerTemplate           = SpecialAbilityToggleSauronGestaltenSauron
         MountedTemplate                = RohanTheoden_modRingHero
         SynchronizeTimerOnSpecialPower = SpecialAbilityToggleMounted SpecialAbilityKingsFavor SpecialAbilityTheodenGloriousCharge2
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingannehmen2
        TriggeredBy                     = Upgrade_RingHero Upgrade_FortressRingHero
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGandalfderWeie
    End
End




ChildObject RohanTheodenCavalry RohanTheoden

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDrawInWorldBuilder
         OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model    = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = RUHHs_Theo_M
        End
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate = Yes
         UnpackTime              = ROHAN_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = ROHAN_MOUNT_TIME
         OpacityTarget           = .3
         AwardXPForTriggering    = 0
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: HorseWhinny50Percent Animation: GUGdfHrs_SKL.GUGdfHrs_IDLC Frames: 0
    End

    ShadowSizeX = 30
    ShadowSizeY = 21
End

ChildObject RohanTheoden_mod_MM RohanTheoden
    CommandPoints = 0
End


Object RohanTheoden_mod_Summoned

    SelectPortrait = HPTheodenNew
    ButtonImage    = HIKingTheoden

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW


      OkToChangeModelColor = Yes

        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model    = RUTheoden_SKA
            Skeleton = RUTheoden_SKL
        End

        ModelConditionState = WORLD_BUILDER
            Model    = RUTheoden_SKA
            Skeleton = RUTheoden_SKL
        End

        ModelConditionState = MOUNTED
            Model    = RUTheoden_HRA
            Skeleton = RUHHs_Theo_SKL
            WeaponLaunchBone    = PRIMARY PASSENGERBONE
        End



        AnimationState                = MOUNTED DEBUG
            Animation
                AnimationName       = RUHHs_Theo_IDLA
                AnimationMode       = ONCE
            End
            ParticleSysBone = BAT_HHEAD glowHorseGold FollowBone:Yes
            ParticleSysBone = B_HHIPL glowHorseRearGold FollowBone:Yes
            ParticleSysBone = BAT_SPINE2 glowGold FollowBone:Yes
        End





        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End



        AnimationState                =    MOUNTED DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End



        AnimationState                =    MOUNTED DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED DYING DEATH_2
            Animation                =    ByeBye
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End




        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End

        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                        =    PACKING_TYPE_2 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    MOUNTED ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = MOUNTED LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = MOUNTED EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED DEATH_1
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_1
            Animation                        =    RUTheoden_DIEA
                AnimationName                =    RUTheoden_DIEA
                AnimationMode                =    ONCE
            End
            Animation                        =    RUTheoden_DIEB
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_2
            Animation                        =    ByeBye
                AnimationName                =    RUTheoden_IDLA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUTheoden_SPCB
                AnimationSpeedFactorRange    =    1.1666 1.1666
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
            Animation                        =    SPCD
                AnimationName                =    RUTheoden_SPCC
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End


    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = THEODEN_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost           = THEODENDAG_COST
    BuildTime           = SILMARIL_HERO_BUILDTIME
    DisplayMeleeDamage = THEODENDAG_DAMAGE
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    MaxSimultaneousOfType = 1

    WeaponSet
        Conditions = NONE
        Weapon = PRIMARY    TheodenSwordMod
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions = MOUNTED
        Weapon = PRIMARY    TheodenSwordMod
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = MOUNTED
        Armor           = StrongRohanHeroArmorMounted
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = ROHAN_THEODEN_BOUNTY_VALUE
    DisplayName = OBJECT:RohanTheoden
    RecruitText = CONTROLBAR:RohanTheodenRecruit
    ReviveText    = CONTROLBAR:RohanTheodenRevive
    Hotkey        = CONTROLBAR:RohanTheodenHotkey
    CrusherLevel = 0
    MountedCrusherLevel = 1
    CrushableLevel = 3
    MountedCrushableLevel = 2

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor = 1.0

    CommandSet = RohanTheodenCommandSetEnd_Summoned
    IsTrainable = No
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_AragornBody

    AutoResolveArmor
        Armor = AutoResolve_AragornArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_AragornWeapon
    End

    AutoResolveLeadership = AutoResolve_AragornBonus





    VoiceAttack             = TheodenVoiceAttack
    VoiceAttackCharge       = TheodenVoiceAttackCharge
    VoiceAttackStructure    = TheodenVoiceAttackBuilding
    VoiceCreated            = TheodenVoiceSalute
    VoiceFullyCreated       = TheodenVoiceSalute
    VoiceFear               = TheodenVoiceHelpMe
    VoiceGuard              = TheodenVoiceMove
    VoiceMove               = TheodenVoiceMove
    VoiceMoveToCamp         = TheodenVoiceMoveCamp
    VoicePriority           = 90
    VoiceSelect             = TheodenVoiceSelectMS
    VoiceSelectBattle       = TheodenVoiceSelectBattle

    SoundCrushing           = RohirrimCrushing
    SoundImpact             = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                       = TheodenVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = TheodenVoiceMove
        VoiceInitiateCaptureBuilding        = TheodenVoiceMove
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove            = TheodenVoiceMoveMounted
            VoiceSelect          = TheodenVoiceSelectMountedMS
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner     = TheodenDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA        Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27

        AnimationSound = Sound:TauntHumanHitShield    Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier        Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1

        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER SUMMONED
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                = EMOTION_CHEER_RADIUS
        MaxHealth                  = THEODENDAG_HEALTH
        PermanentlyKilledByFilter  = NONE
        DodgePercent               = HERO_DODGE_PERCENT
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant = 5
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = 300
        TauntAndPointUpdateDelay    = 1000

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

     Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        HoldGroundCloseRangeDistance = 40
        AILuaEventsList              = RohanTheodenFunctions
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 300
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = TheodenHamaModifier
        AllowFilter             = ANY +RohanHama ALLIES
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = ROHAN_MOUNTED_HERO_SPEED
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseEnabler
        SpecialPowerTemplate = SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes
         StartsPaused              = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UnpackTime                = ROHAN_MOUNT_TIME
         PreparationTime           = 1
         PersistentPrepTime        = 250
         PackTime                  = ROHAN_MOUNT_TIME
         OpacityTarget             = .3
         AwardXPForTriggering      = 0
         TriggerInstantlyOnCreate  = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_1
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership3
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_3
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership5
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_5
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership7a
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_7
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership7b
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_7
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10a
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10b
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10c
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10d
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10e
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Held
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_HeldUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_Bonus2
        TriggeredBy = Upgrade_Level_5
        AttributeModifier = HeldvonHelmsKlamm
    End

    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy       = Upgrade_Level_5
        UpgradeTexture    = rutheoden_start.tga 0 rutheoden.tga
        ShowSubObjects    = HELM GEAR HEAD02
        HideSubObjects    = HEAD01 MANTEL
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge2
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate      = SpecialAbilityTheodenGloriousCharge2
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
        AttributeModifier = TheodenRohanGloriousCharge
        AttributeModifierRange = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects = ANY +CAVALRY +HERO
        AttributeModifierFX = FX_TheodenGloriousChargeFX2
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge2
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End







    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = TheodenExilDestroyWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL TheodenVoiceDie
        DeathFlags = DEATH_1
    End
    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 180000
        MaxLifetime      = 180000
        DeathType        = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGiveXPAoEFavorAI
        CommandButtonName = Command_SpecialAbilityKingsFavorEdainTheo
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 200.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityTheodenGloriousChargeEdain
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry             = CYLINDER
    GeometryMajorRadius  = 8.0
    GeometryHeight       = 25
    GeometryIsSmall      = Yes

    Shadow               = SHADOW_DECAL
    ShadowSizeX          = 19
    ShadowSizeY          = 19
    ShadowTexture        = ShadowI
End




Object RohanTheoden_modRingHero


    SelectPortrait = HPTheodenRing
    ButtonImage    = HITheoden_Ring

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Theoden

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes
        DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

        DefaultModelConditionState
            Model            = RUTheoden_RING
            Skeleton         = RUTheoden_SKL
            ParticleSysBone  = B_SWORDBONE SaronRingSpark FollowBone:Yes
        End

        ModelConditionState  = MOUNTED
            Model            = RUTheoden_HRING
            Skeleton         = RUHHs_Theo_SKL
            WeaponLaunchBone = PRIMARY PASSENGERBONE
            ParticleSysBone  = B_SWORDBONE SaronRingSpark FollowBone:Yes
        End

        ModelConditionState  = WEAPONSET_HERO_MODE
            Model    	     = RUTheoden_RING
            ParticleSysBone  = BAT_RIBS BladeMasterElessar FollowBone:Yes
        End

        AnimationState                = MOUNTED DEBUG
            Animation
                AnimationName       = RUHHs_Theo_IDLA
                AnimationMode       = ONCE
            End
            ParticleSysBone = BAT_HHEAD glowHorseGold FollowBone:Yes
            ParticleSysBone = B_HHIPL glowHorseRearGold FollowBone:Yes
            ParticleSysBone = BAT_SPINE2 glowGold FollowBone:Yes
        End


        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End



        AnimationState                =    MOUNTED DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    MOUNTED DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED DYING DEATH_2
            Animation                =    ByeBye
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End




        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End
        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                        =    PACKING_TYPE_2 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    MOUNTED ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = MOUNTED LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = MOUNTED EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED DEATH_1
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_1
            Animation                        =    RUTheoden_DIEA
                AnimationName                =    RUTheoden_DIEA
                AnimationMode                =    ONCE
            End
            Animation                        =    RUTheoden_DIEB
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING DEATH_2
            Animation                        =    ByeBye
                AnimationName                =    RUTheoden_IDLA
                AnimationMode                =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUTheoden_SPCB
                AnimationSpeedFactorRange    =    1.1666 1.1666
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
            Animation                        =    SPCD
                AnimationName                =    RUTheoden_SPCC
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End


    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side 		= Rohan
    EditorSorting 	= UNIT
    ThreatLevel 	= THEODEN_THREAT_LEVEL
    ThingClass 		= CHARACTER_UNIT
    BuildCost           = THEODENDAG_COST
    BuildTime           = SILMARIL_HERO_BUILDTIME
    DisplayMeleeDamage 	= SILMARIL_HERO_DAMAGE
    TransportSlotCount 	= TRANSPORTSLOTCOUNT_HERO
    MaxSimultaneousOfType = 1

    WeaponSet
        Conditions        = NONE
        Weapon 		  = PRIMARY TheodenSwordModSilmaril
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions  	  = MOUNTED
        Weapon 		  = PRIMARY TheodenSwordModSilmaril
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = PLAYER_UPGRADE
        Weapon            = PRIMARY TheodenSword_HelmsMight
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_HERO_MODE
        Weapon            = PRIMARY TheodenSwordModSilmaril
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = SilmarilHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = SilmarilHeroMountedArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue   = ROHAN_THEODEN_BOUNTY_VALUE
    DisplayName   = OBJECT:RohanTheoden
    RecruitText   = CONTROLBAR:RohanTheodenRecruit
    ReviveText    = CONTROLBAR:RohanTheodenRevive
    Hotkey        = CONTROLBAR:RohanTheodenHotkey
    CrusherLevel  = 0
    MountedCrusherLevel = 1
    CrushableLevel = 4
    MountedCrushableLevel = 2

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent  = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor   = 1.0

    CommandSet    = RohanTheodenCommandSetRing
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_AragornBody

    AutoResolveArmor
        Armor = AutoResolve_AragornArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_AragornWeapon
    End

    AutoResolveLeadership = AutoResolve_AragornBonus



    VoiceAttack             = TheodenVoiceAttack
    VoiceAttackCharge       = TheodenVoiceAttackCharge
    VoiceAttackStructure    = TheodenVoiceAttackBuilding
    VoiceCreated            = TheodenVoiceSalute
    VoiceFullyCreated       = TheodenVoiceSalute
    VoiceFear               = TheodenVoiceHelpMe
    VoiceGuard              = TheodenVoiceMove
    VoiceMove               = TheodenVoiceMove
    VoiceMoveToCamp         = TheodenVoiceMoveCamp
    VoicePriority           = 95
    VoiceSelect             = TheodenVoiceSelectMS
    VoiceSelectBattle       = TheodenVoiceSelectBattle

    SoundCrushing           = RohirrimCrushing
    SoundImpact             = ImpactHorse
    UnitSpecificSounds
        VoiceGarrison    	 	   = TheodenVoiceGarrison
        VoiceEnterUnitElvenTransportShip   = TheodenVoiceMove
        VoiceInitiateCaptureBuilding       = TheodenVoiceMove
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove            = TheodenVoiceMoveMounted
            VoiceSelect          = TheodenVoiceSelectMountedMS
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner     = TheodenDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA          Animation:RUTheoden_SKL.RUTheoden_RUNA      Frames:5 16
        AnimationSound = Sound:FootstepDirtA          Animation:RUTheoden_SKL.RUTheoden_RUNB      Frames:4 12 20 27

        AnimationSound = Sound:TauntHumanHitShield    Animation:RUTheoden_SKL.RUTheoden_CHRB      Frames:21 31

        AnimationSound = Sound:BodyFallGenericNoArmor Animation:RUTheoden_SKL.RUTheoden_DIEA      Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor Animation:RUTheoden_SKL.RUTheoden_DIEB      Frames:19
        AnimationSound = Sound:BodyFallSoldier        Animation:RUTheoden_SKL.RUTheoden_LNDA      Frames:1

        AnimationSound = Sound:HorseMoveFootsteps     Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps     Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps     Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps     Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End



    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                = EMOTION_CHEER_RADIUS
        MaxHealth                  = THEODENDAG_HEALTH
        PermanentlyKilledByFilter  = NONE
        DodgePercent               = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 6500
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIKingTheoden
        RespawnAsTemplate            = RohanTheoden

        RespawnRules =            AutoSpawn:No    Cost:THEODENDAG_COST        Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = 300
        TauntAndPointUpdateDelay     = 1000

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

     Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = DozerAIUpdate ModuleTag_01
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        HoldGroundCloseRangeDistance = 40
        AILuaEventsList    	     = RohanTheodenFunctions
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 300
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = TheodenHamaModifier
        AllowFilter             = ANY +RohanHama ALLIES
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = ROHAN_MOUNTED_HERO_SPEED
    End


    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = RohanTheodenChangeCommandSetRing
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = RohanTheodenCommandSetRing
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        ObeyRechageOnTrigger    = Yes
    End

      Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = No
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = TheodenHerugrimRing
        HeroEffectDuration      = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseEnabler
        SpecialPowerTemplate = SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes
         StartsPaused              = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         UnpackTime              = ROHAN_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = ROHAN_MOUNT_TIME
         OpacityTarget           = .3
         AwardXPForTriggering    = 0
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10a
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_1
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10b
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_3
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10c
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_5
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10d
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan7
        TriggeredBy         = Upgrade_Level_7
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership10e
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
        SpecialPowerTemplate        = SpecialAbilityKingsFavorRing
        TriggeredBy 		    = Upgrade_Level_4
    End

     Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate        = SpecialAbilityKingsFavorRing
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

     Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
        SpecialPowerTemplate        = SpecialAbilityKingsFavorRing
        UnpackingVariation          = 2
        StartAbilityRange           = 300.0
        LevelFX                     = FX_LevelUp
        Experience                  = 800
        RadiusEffect                = 200
        AcceptanceFilter            = KINGSFAVOR_OBJECTFILTER
        UnpackTime                  = 3000
        PreparationTime             = 0
        FreezeAfterTriggerDuration  = 2000
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Held
        SpecialPowerTemplate 	  = SpecialAbilityFakeLeadership2
        TriggeredBy 	     	  = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_HeldUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_Bonus2
        TriggeredBy 	  	  = Upgrade_Level_1
        AttributeModifier 	  = HeldvonHelmsKlamm
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate = SpecialAbilityTheodenGloriousCharge2
        TriggeredBy 	     = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge2
        UpdateModuleStartsAttack     = Yes
        StartsPaused 		     = Yes
        AttributeModifier            = TheodenRohanGloriousCharge
        AttributeModifierRange       = 400
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +CAVALRY +HERO
        AttributeModifierFX          = FX_TheodenGloriousChargeFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge2
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End





    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = TheodenExilDestroyWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End





    Behavior = SubObjectsUpgrade Armor_ShowRing
        TriggeredBy       = Upgrade_AllFactionUpgrade
        UpgradeTexture    = rutheoden_start.tga 0 rutheoden.tga
        ShowSubObjects    = HELM GEAR HEAD02 MANTEL
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Eorl
        SpecialPowerTemplate = SpecialAbilityFakeLeadership3
        TriggeredBy 	     = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_EorlUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_EorlsExperience
        TriggeredBy 	  = Upgrade_Level_1
        AttributeModifier = EorlsExperienceModifier
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_EorlsExperienceHeroes
        StartsActive        = No
        BonusName           = EorlsExperienceModifierHeroes
        TriggeredBy         = Upgrade_Level_10
        RequiresAllTriggers = Yes
        RefreshDelay        = 2000
        Range               = 300
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HelmsMight
        SpecialPowerTemplate = SpecialAbilityFakeLeadership4
        TriggeredBy 	     = Upgrade_Level_4
    End

    Behavior = SpecialPowerModule ModuleTag_HelmsMightUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership4
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_HelmsMight2
        TriggeredBy         = Upgrade_Level_4
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy         = Upgrade_Level_4
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ThengelsLegacy
        SpecialPowerTemplate = SpecialAbilityFakeLeadership5
        TriggeredBy 	     = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_ThengelsLegacyUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership5
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_ThengelsVermachtnisMalus
        TriggeredBy         = Upgrade_Level_7
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_InvurnableLevel1
        TriggeredBy     = Upgrade_Level_7
        StartsActive    = No
        BonusName       = AragornWeierBaum
        RefreshDelay    = 3000
        Range           = 40
        ObjectFilter    = NONE +HERO -RohanTheoden_modRingHero -RohanTheodenCavalry_modRingHero ALLIES
        RunWhileDead    = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_InvurnableLevel17
        TriggeredBy     = Upgrade_Level_15
        StartsActive    = No
        BonusName       = AragornWeierBaum
        RefreshDelay    = 3000
        Range           = 80
        ObjectFilter    = NONE +HERO -RohanTheoden_modRingHero -RohanTheodenCavalry_modRingHero ALLIES
        RunWhileDead    = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BregosGlory
        SpecialPowerTemplate = SpecialAbilityFakeLeadership6
        TriggeredBy 	     = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_BregosGloryUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership6
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = AttributeModifierUpgrade ModuleTag_BregosRuhmMalus
        TriggeredBy         = Upgrade_Level_10
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhma
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmb
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmc
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmd
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhme
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_10
        RefreshDelay        = 2000
        Range               = 400
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmGlobal1
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_15
        RefreshDelay        = 2000
        Range               = GLOBAL_LEADERSHIP_RANGE
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmGlobal2
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_15
        RefreshDelay        = 2000
        Range               = GLOBAL_LEADERSHIP_RANGE
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmGlobal3
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan5
        TriggeredBy         = Upgrade_Level_15
        RefreshDelay        = 2000
        Range               = GLOBAL_LEADERSHIP_RANGE
        ObjectFilter        = ANY +INFANTRY +CAVALRY -HERO -STRUCTURE -DOZER -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmGlobal4
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan1
        TriggeredBy         = Upgrade_Level_15
        RefreshDelay        = 2000
        Range               = GLOBAL_LEADERSHIP_RANGE
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BregosRuhmGlobal5
        StartsActive        = No
        BonusName           = TheodenKonigvonRohan3
        TriggeredBy         = Upgrade_Level_15
        RefreshDelay        = 2000
        Range               = GLOBAL_LEADERSHIP_RANGE
        ObjectFilter        = ANY +HERO -CAVALRY -DOZER -STRUCTURE -MACHINE -TROLL ALLIES
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL TheodenVoiceDie
        DeathFlags = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End




    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList    = OCL_TheOneRing
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_TheodenToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 25
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End


ChildObject RohanTheodenCavalry_modRingHero RohanTheoden_modRingHero

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDrawInWorldBuilder

        OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model    = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = RUHHs_Theo_M
        End
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate     = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate = Yes
         UnpackTime               = ROHAN_MOUNT_TIME
         PreparationTime          = 1
         PersistentPrepTime       = 250
         PackTime                 = ROHAN_MOUNT_TIME
         OpacityTarget            = .3
         AwardXPForTriggering     = 0
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: HorseWhinny50Percent Animation: GUGdfHrs_SKL.GUGdfHrs_IDLC Frames: 0
    End

    ShadowSizeX = 30
    ShadowSizeY = 21
End