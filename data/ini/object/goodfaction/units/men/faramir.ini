Object GondorFaramir

    SelectPortrait = HPFaramir2
    ButtonImage    = HIFaramir

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    ExtraPublicBone = arrow
    ExtraPublicBone = PASSENGERBONE

     DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

        DefaultModelConditionState
            Model               = GUFaramir_SKNA
            WeaponLaunchBone    = PRIMARY arrow
        End

        ModelConditionState     = MOUNTED
            Model               = gufrmhrsha_skn
            WeaponLaunchBone    = PRIMARY PASSENGERBONE
        End

        AnimationState                        =    PACKING_TYPE_2 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SKL.RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SKL.RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End



        AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
            StateName          =    CaptainPower
            Animation           = GUFaramir_CHRC
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End

        AnimationState        = PACKING_TYPE_2
            StateName          =    STATE_CaptainBow
            Animation           = GUFaramir_CHRD
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.75 0.75
            End
        End


        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED DYING SPLATTED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                =    MOUNTED DYING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                =    MOUNTED PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End



        AnimationState        =  MOUNTED FIRING_OR_PREATTACK_A ATTACKING_STRUCTURE
            StateName = Attacking
            Animation = attackinga  building while mounted.
                AnimationName           = RUHHs_Theo_SKL.RUHHs_Theo_ATKA
                AnimationMode       = ONCE
                UseWeaponTiming = Yes
            End
        End


        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = MountedRunAndFire
                AnimationName       = RUHHs_Theo_SKL.RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        = Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState                        =   SPECIAL_WEAPON_THREE
            StateName                        =    SPELL
            Animation                =    AttackA
                AnimationName                =    RUHHs_Theo_SKL.RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState                        =   MOUNTED SPECIAL_WEAPON_THREE
            StateName                        =    SPELL
            Animation                =    AttackA
                AnimationName                =    RUHHs_Theo_SKL.RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.5 1.5
            End

        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.5 1.5
            End

        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange    = 0.55 0.55
            End

        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End
             Flags                    =    RANDOMSTART

        End


        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "STATE_CaptainMounted" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End
        End


        AnimationState = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationPriority    =    30
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End

            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUFaramir_IDLC
                AnimationMode                = LOOP
            End
        End





        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            StateName           = STATE_Bow

            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = USER_1



            Animation           = GUFaramir_POSA
                AnimationName     = GUFaramir_SKL.GUFaramir_POSA
                AnimationMode     = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End


        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.47 1.47
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End


        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB

                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
        End



        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode     = MANUAL
            End
        End



        AnimationState            = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA

                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
        End



        AnimationState                    =    PREATTACK_A
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode            =    ONCE


            End
        End

        AnimationState                    =    FIRING_OR_RELOADING_A
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    ONCE

                AnimationSpeedFactorRange = 1.1 1.1

            End
        End


        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW

            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode                = ONCE
            End
        End



        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
        End


        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
        End



        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End



        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTC
                AnimationMode        =    ONCE
            End
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTD
                AnimationMode        =    ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End




        AnimationState                    = SELECTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Selected_Sword

            Animation                    = ATNE
                AnimationName            = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
        End


        AnimationState                =    EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                =    STATE_READY
            Animation                =    ready
                AnimationName        =    GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    STATE_Selected_Bow

            Animation                =    ATNB
                AnimationName        =    GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow"    then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
        End





        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = STATE_Idle_Sword

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority        = 20
                AnimationBlendTime  = 15
            End

            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            Animation                   = IDLG
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLG
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End

        IdleAnimationState
            StateName           = STATE_Idle_Bow

            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End



        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName        = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA

                AnimationName    = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode    = ONCE
            End
        End


        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End

        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_Schmiedekunst
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = USER_8
            Model           = exldrspimla
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Men
    EditorSorting = UNIT
    ThreatLevel = FARAMIR_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost = FARAMIRDAG_COST
    BuildTime = MEDIUM_HERO_BUILDTIME
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = FARAMIRDAG_DAMAGE
    DisplayRangedDamage = FARAMIRDAG_RANGED

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    FaramirBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    FaramirSword_Neu
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1
        Weapon            = PRIMARY    FaramirSword_Neu
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1 WEAPONSET_HERO_MODE
        Weapon            = PRIMARY    FaramirSwordHeroMode
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End


    ArmorSet
        Conditions      = None
        Armor           = MediumHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = MediumHeroArmorMounted
        DamageFX        = NormalDamageFX
    End
	
    ArmorSet
        Conditions      = PLAYER_UPGRADE MOUNTED
        Armor           = StrongHeroArmorMounted
        DamageFX        = NormalDamageFX
    End


    VisionRange = 450
    ShroudClearingRange = 500

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = GONDOR_FARAMIR_BOUNTY_VALUE
    DisplayName = OBJECT:GondorFaramir
    RecruitText = CONTROLBAR:GondorFaramirRecruit
    ReviveText    = CONTROLBAR:GondorFaramirRevive
    Hotkey        = CONTROLBAR:GondorFaramirHotkey
    CrusherLevel = 0
    MountedCrusherLevel = 1
    CrushableLevel = 2
    MountedCrushableLevel = 2

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor = 1.0

    CommandSet = GondorFaramirModCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_FaramirBody

    AutoResolveArmor
        Armor = AutoResolve_FaramirArmor
    End

    AutoResolveWeapon
       Weapon = AutoResolve_FaramirWeapon
    End

    VoiceAttack                = FaramirRangerVoiceAttack
    VoiceAttackAir                = FaramirRangerVoiceAttack
    VoiceAttackCharge            = FaramirRangerVoiceAttackCharge
    VoiceAttackMachine        = FaramirRangerVoiceAttack
    VoiceAttackStructure        = FaramirRangerVoiceAttackBuilding
    VoiceCreated            = FaramirRangerVoiceSalute
    VoiceFullyCreated         = FaramirRangerVoiceSalute
    VoiceMove                = FaramirRangerVoiceMove
    VoiceMoveToCamp            = FaramirRangerVoiceMoveCamp
    VoiceMoveWhileAttacking        = FaramirRangerVoiceDisengage
    VoicePriority            = 85
    VoiceRetreatToCastle        = FaramirRangerVoiceRetreat
    VoiceSelect                = FaramirRangerVoiceSelectMS
    VoiceSelectBattle         = FaramirRangerVoiceSelectBattle
    VoiceGuard                = FaramirRangerVoiceMove

    SoundImpact                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison        = FaramirRangerVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = FaramirRangerVoiceMove
        VoiceInitiateCaptureBuilding        = FaramirRangerVoiceMove
        VoiceMoveToTrees    = FaramirRangerVoiceMoveTrees
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceAttack                = FaramirKnightVoiceAttack
            VoiceAttackCharge            = FaramirKnightVoiceAttackCharge
            VoiceAttackMachine        = FaramirKnightVoiceAttackBuilding
            VoiceAttackStructure        = FaramirKnightVoiceAttackBuilding
            VoiceFear                 = FaramirKnightVoiceHelpMe
            VoiceMove                = FaramirKnightVoiceMove
            VoiceMoveToCamp            = FaramirKnightVoiceMoveCamp
            VoiceMoveWhileAttacking        = FaramirKnightVoiceDisengage
            VoiceRetreatToCastle        = FaramirKnightVoiceRetreat
            VoiceSelect                = FaramirKnightVoiceSelectMS
            VoiceSelectBattle         = FaramirKnightVoiceSelectBattle
            VoiceGuard                = FaramirKnightVoiceMove
            SoundImpact                = ImpactHorse

            VoicePriority            = 85

            UnitSpecificSounds
                VoiceGarrison        = FaramirKnightVoiceMove
                VoiceMoveToTrees    = FaramirKnightVoiceMove
            End
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"
    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner                    = FaramirDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero

    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2

        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL        Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA        Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1        Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1        Frames:0

        AnimationSound = Sound:HorseWhinny50Percent    Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC        Frames:0

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA        Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA        Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA        Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA        Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA        Frames:42
    End

    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_SHEDIUM


    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius               = EMOTION_CHEER_RADIUS
        MaxHealth                 = FARAMIRDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                = DYING
        DeathAnimationTime        = 5000
        RespawnAnim                = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                = HIFaramir

        RespawnRules =    AutoSpawn:No           Cost:FARAMIRDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
    End


    Behavior = AutoHealBehavior ModuleTag_FaramirHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate           = 500
        AILuaEventsList               = FaramirFunctions
        HoldGroundCloseRangeDistance  = 41
        CanAttackWhileContained       = Yes
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 60
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FinrodBonus
        TriggeredBy       = Upgrade_RaiseShield
        AttributeModifier = FinarfinRingModifierHero
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseWoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        TriggeredBy                 = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_WoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FaramirRangerVoiceWoundingArrow
        StartsPaused                = Yes
        OnTriggerRechargeSpecialPower = SpecialAbilitySalemeGiftfalleauslegen
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        SkipContinue                = Yes
        UnpackTime                  = 2000
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = FARAMIR_WOUNDING_ARROW_RANGE
        ApproachRequiresLOS         = Yes
        SpecialWeapon               = FaramirWoundArrow
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoundArrowAutoAbility
        SpecialAbility              = SpecialAbilityWoundArrow
		ForbiddenStatus 	    = INSIDE_GARRISON
        MaxScanRange                = FARAMIR_WOUNDING_ARROW_RANGE
        Query                       = 1 ANY ENEMIES +MONSTER +HERO +AngmarThrallMaster +AngmarThrallMasterBanner +AngmarThrallMasterAxeBanner +AngmarThrallMasterWolfBanner +AngmarNecromancerBanner +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir +GondorGwaihir_Summoned +ElvenFortressEagle +KhamulFellBeast +MorgomirFellBeast +Drogoth +Drogoth
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BewiesenerWertEnabler
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        TriggeredBy             = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_BewiesenerWertStarter
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        StartsPaused            = Yes
        OnTriggerRechargeSpecialPower = SpecialAbilityWoundArrow
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_BewiesenerWertUpdate
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        HeroAttributeModifier   = BewiesenerWertModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBewiesenerWertMaster
        SpecialAbility          = SpecialAbilitySalemeGiftfalleauslegen
        MaxScanRange            = 30
        Query                   = 1 ANY ENEMIES +INFANTRY +CAVALRY +HERO -STRUCTURE
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership1
        StartsActive     = Yes
        BonusName        = FurstvonIthilienInfanterie
        TriggeredBy      = Upgrade_Level_5
        RefreshDelay     = 2500
        Range            = 200

        ObjectFilter     = ANY +INFANTRY -CAVALRY -HERO -MACHINE -SHIP -DOZER -STRUCTURE SAME_PLAYER
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership3
        StartsActive     = Yes
        BonusName        = FurstvonIthilienKavallerie
        TriggeredBy      = Upgrade_Level_5
        RefreshDelay     = 2500
        Range            = 200

        ObjectFilter     = ANY +CAVALRY -INFANTRY -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End

    Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
        InvisibilityNugget
            InvisibilityType    = CAMOUFLAGE
            DetectionRange      = ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
        End
        UpdatePeriod            = 1000
        Broadcast               = Yes
        BroadcastRange          = 270
        BroadcastObjectFilter   = ANY +GondorRanger ALLIES
        StartsActive            = Yes
        RequiredUpgrades        = Upgrade_Level_3
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseHorseToggle
        SpecialPowerTemplate        = SpecialAbilityToggleMounted
        TriggeredBy                 = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate       = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack   = Yes
         StartsPaused               = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         UnpackTime              = GOOD_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = GOOD_MOUNT_TIME
         OpacityTarget            = .3
         AwardXPForTriggering    = 0
    End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CrownAragornEnabler
        SpecialPowerTemplate         = SpecialAbilityCrownOfGondor
        TriggeredBy                  = Upgrade_Level_8
    End

    Behavior = SpecialPowerModule ModuleTag_CrownAragornSpecialPowerModule
        SpecialPowerTemplate         = SpecialAbilityCrownOfGondor
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_CrownAragorn
        SpecialPowerTemplate         = SpecialAbilityCrownOfGondor
        UnpackTime                   = 2000
        PackTime                     = 2000
        MustFinishAbility            = Yes
        AwardXPForTriggering         = 0
        StartAbilityRange            = 150
        ApproachRequiresLOS          = Yes
        SpecialWeapon                = FaramirCrownsAragornWeapon
        WhichSpecialWeapon           = 3
	End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainSummonEnabler
        SpecialPowerTemplate  = SpecialAbilityFaramirHinterhalt
        TriggeredBy           = Upgrade_Level_10
        ObeyRechageOnTrigger  = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFaramirHinterhalt
        OCL                   = OCL_SpawnGondorRangersModEgg
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = GondorFaramirModCommandSet_Sword
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = GondorFaramirModCommandSet
    End

    Behavior = SpecialEnemySenseUpdate ModuleTag_StingSeesOrcs
        SpecialEnemyFilter = ANY +PIKE ENEMIES
        ScanRange = 80
        ScanInterval = 2000
    End

    ;Behavior = CommandSetUpgrade ModueTag_CommandSetKingCrowned
      ;  TriggeredBy         = Upgrade_Level_8
		;ConflictsWith		= Upgrade_ObjectUnderAIControl
       ; CommandSet          = GondorFaramirModCommandSet2
   ; End
	
	;Behavior = CommandSetUpgrade ModueTag_CommandSetKingCrowned2
       ; TriggeredBy         = Upgrade_KingOfGondor
		;ConflictsWith		= Upgrade_ObjectUnderAIControl
       ; CommandSet          = GondorFaramirModCommandSet
   ; End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_Level_3 Upgrade_ObjectUnderAIControl
        RequiresAllTriggers         = Yes
        GetUpgradeCommandButtonName = Command_ToggleFaramirDismountedMod
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade2
        TriggeredBy = Upgrade_DisMountAI Upgrade_ObjectUnderAIControl
        RequiresAllTriggers = Yes
        GetUpgradeCommandButtonName = Command_ToggleFaramirDismountedMod
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler02
	SpecialPowerTemplate = SpecialAbilityKingsFavor
	TriggeredBy = Upgrade_Level_9
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule02
        SpecialPowerTemplate		= SpecialAbilityKingsFavor
        StartsPaused			= Yes
	UpdateModuleStartsAttack	= Yes
        InitiateSound			= FaramirKnightVoiceCaptain
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor02
	SpecialPowerTemplate		= SpecialAbilityKingsFavor
	UnpackingVariation		= 2
	StartAbilityRange		= 200.0
        LevelFX				= FX_LevelUp
	Experience			= 500
	RadiusEffect			= 200
	AcceptanceFilter		= NO_LEVEL_UPS_FOR_FIRST_AGE_UNITS_OBF EVIL_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF GOOD_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF
	PreparationTime			= 1
	FreezeAfterTriggerDuration	= 2000
    End

    Behavior = AutoAbilityBehavior ModuleTag_KingsFavorAutoAbility02
	SpecialAbility	= SpecialAbilityKingsFavor
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 200
	Query		= 10 ANY +CAVALRY -INFANTRY -STRUCTURE -CASTLE_KEEP -BASE_FOUNDATION -HERO -MOVE_ONLY -DOZER -SUMMONED ALLIES
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FaramirSpeechThing
        SpecialPowerTemplate        = SpecialAbilityRousingSpeech
        TriggeredBy                    = Upgrade_Level_3
    End
    Behavior = SpecialPowerModule ModuleTag_10
        SpecialPowerTemplate      = SpecialAbilityRousingSpeech
        UpdateModuleStartsAttack  = Yes
        InitiateSound             = TheodenRousingSpeech
        StartsPaused                = Yes
    End
    Behavior = RousingSpeechUpdate ModuleTag_11
        SpecialPowerTemplate    = SpecialAbilityRousingSpeech
        RequiredConditions        = MOUNTED
        StartAbilityRange        = 1.0
        UpdateInterval            = 500
        ApproachRequiresLOS        = No
        BonusRadius                = 250
        SpeechDuration          = 2500
        LeaderFX                = FX_TheodenSpeechFX
        FollowerFX                = FX_TheodenFollowerFX
        CreateWave                = Yes
        WaveWidth                = 50
        ModifierName            = RohanCharge
    End

    Behavior = HeroDie ModuleTag_HeroDeath
        SpecialPowerTemplate = SpecialAbilitySmite
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
        TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = 107
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 2533
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 30000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL FaramirRangerVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1500
        HitReactionLifeTimer2 = 1500
        HitReactionLifeTimer3 = 1500
        HitReactionThreshold1 = 5.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
        FastHitsResetReaction = Yes    If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
    End


    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = FaramirRetterObjectDestroyWeapon
            FireDelay = 2000
            OneShot = Yes
        End
    End

    Behavior = ObjectCreationUpgrade ModuleTag_RetterObject
        TriggeredBy     = Upgrade_RaiseSchmiedekunst
        Delay           = 0
        ThingToSpawn    = RetterObjectFaramir
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
	SpecialPowerTemplate = SpecialAbilityKingsFavor
	TriggeredBy = Upgrade_Level_9
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate		= SpecialAbilityKingsFavor
        StartsPaused			= Yes
	UpdateModuleStartsAttack	= Yes
        InitiateSound			= FaramirKnightVoiceCaptain
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
	SpecialPowerTemplate		= SpecialAbilityKingsFavor
	UnpackingVariation		= 2
	StartAbilityRange		= 200.0
        LevelFX				= FX_LevelUp
	Experience			= 500
	RadiusEffect			= 200
	AcceptanceFilter		= NO_LEVEL_UPS_FOR_FIRST_AGE_UNITS_OBF EVIL_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF GOOD_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF
	UnpackTime			= 2000
	PreparationTime			= 1
	FreezeAfterTriggerDuration	= 2000
    End

    Behavior = AutoAbilityBehavior ModuleTag_KingsFavorAutoAbility
	SpecialAbility	= SpecialAbilityKingsFavor
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 200
	Query		= 10 ANY +CAVALRY -INFANTRY -STRUCTURE -CASTLE_KEEP -BASE_FOUNDATION -HERO -MOVE_ONLY -DOZER -SUMMONED ALLIES
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WachpostenerrichtenEnabler
        SpecialPowerTemplate        = SpecialAbilityFestplatzMirkwood
        TriggeredBy                 = Upgrade_Level_6
    End

    Behavior = OCLSpecialPower ModuleTag_WachpostenerrichtenSpecialPower
        SpecialPowerTemplate        = SpecialAbilityFestplatzMirkwood
        OCL                         = OCL_FaramirSummonForbiddenPool
        CreateLocation              = CREATE_AT_LOCATION
        StartsPaused                = Yes
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate        = 10
        DetectionRange       = 200
        CancelOneRingEffect  = No
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate AToggleWeaponAI
        CommandButtonName = Command_ToggleFaramirWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Behavior = AISpecialPowerUpdate SpecialPowerFaramirGiveXPAoE
        CommandButtonName = Command_SpecialAbilityCaptainOfGondor
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_FaramirBewiesenerWert
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate SpecialWoundingArrowAoE
        CommandButtonName = Command_SpecialAbilityWoundArrowMod
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate ToggleMountedAI
        CommandButtonName = Command_ToggleFaramirDismountedMod
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate SummonTower_AI
        CommandButtonName  = Command_FaramirSummonForbiddenPool
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight        = 25
    GeometryIsSmall        = Yes

    Shadow                = SHADOW_DECAL
    ShadowSizeX            = 20
    ShadowSizeY            = 20
    ShadowTexture        = ShadowI
End


Object GondorFaramir_forFaramirMap

    SelectPortrait = HPFaramirEdain
    ButtonImage = HIFaramir

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Boromir

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    ExtraPublicBone = arrow
    ExtraPublicBone = PASSENGERBONE

     DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

        DefaultModelConditionState
            Model               = GUFaramir_SKNA
            WeaponLaunchBone    = PRIMARY arrow
        End

        AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
            StateName          =    CaptainPower
            Animation           = GUFaramir_CHRC
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = PACKING_TYPE_2
            StateName          =    STATE_CaptainBow
            Animation           = GUFaramir_CHRD
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.75 0.75
            End
        End




        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End

            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUFaramir_IDLC
                AnimationMode                = LOOP
            End
        End





        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            StateName           = STATE_Bow

            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = USER_1



            Animation           = GUFaramir_POSA
                AnimationName     = GUFaramir_SKL.GUFaramir_POSA
                AnimationMode     = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End






        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.149 1.149
            End

            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKF
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.47 1.47
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End



        AnimationState        = MOVING USER_4
            StateName           = Slaughter
            Flags               = RANDOMSTART

            Animation           = GUFaramir_ATKE
                AnimationName     = GUFaramir_SKL.GUFaramir_ATKE
                AnimationMode     = LOOP
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
            EndScript
        End


        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB

                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
        End



        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode     = MANUAL
            End
        End



        AnimationState            = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA

                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
        End



        AnimationState                    =    PREATTACK_A
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode            =    ONCE


            End
        End

        AnimationState                    =    FIRING_OR_RELOADING_A
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    ONCE

                AnimationSpeedFactorRange = 1.1 1.1

            End
        End


        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW

            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode                = ONCE
            End
        End









        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
        End





        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
        End



        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End



        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTC
                AnimationMode        =    ONCE
            End
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTD
                AnimationMode        =    ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End




        AnimationState                    = SELECTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Selected_Sword

            Animation                    = ATNE
                AnimationName            = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
        End


        AnimationState                =    EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                =    STATE_READY
            Animation                =    ready
                AnimationName        =    GUFaramir_SKL.GUFaramir_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    STATE_Selected_Bow

            Animation                =    ATNB
                AnimationName        =    GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow"    then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
        End





        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = STATE_Idle_Sword

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority        = 20
                AnimationBlendTime  = 15
            End

            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            Animation                   = IDLG
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLG
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End

            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End

        IdleAnimationState
            StateName           = STATE_Idle_Bow

            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End



        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName        = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA

                AnimationName    = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode    = ONCE
            End
        End


        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End

        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Men
    EditorSorting = UNIT
    ThreatLevel = FARAMIR_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
      BuildCost = FARAMIRDAG_COST
      BuildTime = MEDIUM_HERO_BUILDTIME

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = FARAMIRDAG_DAMAGE
    DisplayRangedDamage = FARAMIRDAG_RANGED

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    FaramirBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    FaramirSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = MediumHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 450
    ShroudClearingRange = 500

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue   = GONDOR_FARAMIR_BOUNTY_VALUE
    DisplayName   = OBJECT:GondorFaramir
    RecruitText   = CONTROLBAR:GondorFaramirRecruit
    ReviveText    = CONTROLBAR:GondorFaramirRevive
    Hotkey        = CONTROLBAR:GondorFaramirHotkey
    CrusherLevel  = 0
    CrushableLevel = 2


    CommandSet = GondorFaramirCommandSet_forFaramirMap
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_BoromirBody

    AutoResolveArmor
        Armor = AutoResolve_BoromirArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_BoromirWeapon
    End

    AutoResolveLeadership = AutoResolve_BoromirBonus





    VoiceAttack                = FaramirRangerVoiceAttack
    VoiceAttackAir                = FaramirRangerVoiceAttack
    VoiceAttackCharge            = FaramirRangerVoiceAttackCharge
    VoiceAttackMachine        = FaramirRangerVoiceAttack
    VoiceAttackStructure        = FaramirRangerVoiceAttackBuilding
    VoiceMove                = FaramirRangerVoiceMove
    VoiceMoveToCamp            = FaramirRangerVoiceMoveCamp
    VoiceMoveWhileAttacking        = FaramirRangerVoiceDisengage
    VoicePriority            = 85
    VoiceRetreatToCastle        = FaramirRangerVoiceRetreat
    VoiceSelect                = FaramirRangerVoiceSelectMS
    VoiceSelectBattle         = FaramirRangerVoiceSelectBattle
    VoiceGuard                = FaramirRangerVoiceMove

    SoundImpact                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison        = FaramirRangerVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = FaramirRangerVoiceMove
        VoiceInitiateCaptureBuilding        = FaramirRangerVoiceMove
        VoiceMoveToTrees    = FaramirRangerVoiceMoveTrees
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceAttack                = FaramirKnightVoiceAttack
            VoiceAttackCharge            = FaramirKnightVoiceAttackCharge
            VoiceAttackMachine        = FaramirKnightVoiceAttackBuilding
            VoiceAttackStructure        = FaramirKnightVoiceAttackBuilding
            VoiceFear                 = FaramirKnightVoiceHelpMe
            VoiceMove                = FaramirKnightVoiceMove
            VoiceMoveToCamp            = FaramirKnightVoiceMoveCamp
            VoiceMoveWhileAttacking        = FaramirKnightVoiceDisengage
            VoiceRetreatToCastle        = FaramirKnightVoiceRetreat
            VoiceSelect                = FaramirKnightVoiceSelectMS
            VoiceSelectBattle         = FaramirKnightVoiceSelectBattle
            VoiceGuard                = FaramirKnightVoiceMove

            SoundImpact                = ImpactHorse

            VoicePriority            = 85

            UnitSpecificSounds
                VoiceGarrison        = FaramirKnightVoiceMove
                VoiceMoveToTrees    = FaramirKnightVoiceMove
            End
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"
    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner                    = FaramirDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero

    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA        Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier        Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_SHEDIUM


    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius               = EMOTION_CHEER_RADIUS
        MaxHealth                 = FARAMIRDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                = DYING
        DeathAnimationTime        = 5000
        RespawnAnim                = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                = HIFaramir

        RespawnRules =            AutoSpawn:No    Cost:FARAMIRDAG_COST        Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
    End


    Behavior = AutoHealBehavior ModuleTag_FaramirHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate           = 500

        HoldGroundCloseRangeDistance  = 41
        CanAttackWhileContained       = Yes
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 60
    End







    Behavior = WeaponChangeSpecialPowerModule THING
        SpecialPowerTemplate      = SpecialAbilityBerserkerLightTorch
        FlagsUsedForToggle        = WEAPONSET_TOGGLE_1
        ToggleOnAttributeModifier = WaffenwechselHeroModifier
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseWoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        TriggeredBy                 = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_WoundArrow
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = FaramirRangerVoiceWoundingArrow
        StartsPaused                = Yes
        OnTriggerRechargeSpecialPower = SpecialAbilitySalemeGiftfalleauslegen
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WoundArrowUpdate
        SpecialPowerTemplate        = SpecialAbilityWoundArrow
        SkipContinue                = Yes
        UnpackTime                  = 2000
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1
        AwardXPForTriggering        = 0
        StartAbilityRange           = FARAMIR_WOUNDING_ARROW_RANGE
        ApproachRequiresLOS         = Yes
        SpecialWeapon               = FaramirWoundArrow
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoundArrowAutoAbility
        SpecialAbility              = SpecialAbilityWoundArrow
		ForbiddenStatus 		    = INSIDE_GARRISON
        MaxScanRange            = FARAMIR_WOUNDING_ARROW_RANGE
        Query                      = 1 ANY ENEMIES +MONSTER +HERO +AngmarThrallMaster  +AngmarThrallMasterBanner  +AngmarThrallMasterAxeBanner   +AngmarThrallMasterWolfBanner  +AngmarNecromancerBanner +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir +GondorGwaihir_Summoned +ElvenFortressEagle +KhamulFellBeast +MorgomirFellBeast +Drogoth +Drogoth
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BewiesenerWertEnabler
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        TriggeredBy             = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_BewiesenerWertStarter
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        StartsPaused            = Yes
        OnTriggerRechargeSpecialPower = SpecialAbilityWoundArrow
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_BewiesenerWertUpdate
        SpecialPowerTemplate    = SpecialAbilitySalemeGiftfalleauslegen
        HeroAttributeModifier   = BewiesenerWertModifier
        HeroEffectDuration      = 20000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBewiesenerWertMaster
        SpecialAbility          = SpecialAbilitySalemeGiftfalleauslegen
        MaxScanRange            = 30
        Query                   = 1 ANY ENEMIES +INFANTRY +CAVALRY +HERO -STRUCTURE
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership1
        StartsActive     = YES
        BonusName        = FurstvonIthilienInfanterie
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2500
        Range            = 200

        ObjectFilter     = ANY +INFANTRY -CAVALRY -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership2
        StartsActive     = YES
        BonusName        = FurstvonIthilienInfanterieRanger
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2500
        Range            = 200

        ObjectFilter     = ANY +GondorRanger ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership3
        StartsActive     = YES
        BonusName        = FurstvonIthilienKavallerie
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2500
        Range            = 200

        ObjectFilter     = ANY +CAVALRY -INFANTRY -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End

    Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
        InvisibilityNugget
            InvisibilityType    = CAMOUFLAGE
            DetectionRange      = ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
        End
        UpdatePeriod            = 1000
        Broadcast               = Yes
        BroadcastRange          = 270
        BroadcastObjectFilter   = ANY +GondorRanger ALLIES
        StartsActive            = Yes
        RequiredUpgrades        = Upgrade_Level_3
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler01
	SpecialPowerTemplate = SpecialAbilityKingsFavor
	TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule01
        SpecialPowerTemplate		= SpecialAbilityKingsFavor
        StartsPaused			= Yes
	UpdateModuleStartsAttack	= Yes
        InitiateSound			= FaramirKnightVoiceCaptain
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor01
	SpecialPowerTemplate		= SpecialAbilityKingsFavor
	UnpackingVariation		= 2
	StartAbilityRange		= 200.0
        LevelFX				= FX_LevelUp
	Experience			= 500
	RadiusEffect			= 200
	AcceptanceFilter		= NO_LEVEL_UPS_FOR_FIRST_AGE_UNITS_OBF EVIL_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF GOOD_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF
	UnpackTime			= 2000
	PreparationTime			= 1
	FreezeAfterTriggerDuration	= 2000
    End

    Behavior = AutoAbilityBehavior ModuleTag_KingsFavorAutoAbility01
	SpecialAbility	= SpecialAbilityKingsFavor
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 200
	Query		= 10 ANY +CAVALRY -INFANTRY -STRUCTURE -CASTLE_KEEP -BASE_FOUNDATION -HERO -MOVE_ONLY -DOZER -SUMMONED ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainSummonEnabler
        SpecialPowerTemplate  = SpecialAbilityFaramirHinterhalt
        TriggeredBy           = Upgrade_Level_10
        ObeyRechageOnTrigger  = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        SpecialPowerTemplate  = SpecialAbilityFaramirHinterhalt
        OCL                   = OCL_SpawnGondorRangersModEgg
        CreateLocation        = CREATE_AT_LOCATION
        StartsPaused          = Yes


    End



    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = GondorFaramirModCommandSet_forFaramirMapSword
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = GondorFaramirCommandSet_forFaramirMap
    End


	;Behavior = SubObjectsUpgrade Armor_Upgrade
     ;   TriggeredBy               = Upgrade_Level_6
      ;  UpgradeTexture            = gufaramir.tga 0 gufaramirha.tga
		;UpgradeTexture            = gufaramir_m.tga 0 gufaramirha.tga
    ;End

    Behavior = HeroDie ModuleTag_HeroDeath
        SpecialPowerTemplate = SpecialAbilitySmite
    End



    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
        TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End



    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 2533
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 30000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL FaramirRangerVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1500
        HitReactionLifeTimer2 = 1500
        HitReactionLifeTimer3 = 1500

        HitReactionThreshold1 = 5.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0

        FastHitsResetReaction = Yes    If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate        = 10
        DetectionRange       = 200
        CancelOneRingEffect  = No
    End


    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End


    Behavior = AISpecialPowerUpdate AToggleWeaponAI
        CommandButtonName = Command_ToggleFaramirWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Behavior = AISpecialPowerUpdate SpecialPowerFaramirGiveXPAoE
        CommandButtonName = Command_SpecialAbilityCaptainOfGondor
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate SpecialWoundingArrowAoE
        CommandButtonName = Command_SpecialAbilityWoundArrowMod
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End



    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight        = 25
    GeometryIsSmall        = Yes

    Shadow                = SHADOW_DECAL
    ShadowSizeX            = 20
    ShadowSizeY            = 20
    ShadowTexture        = ShadowI
End

ChildObject GondorFaramirCavalry GondorFaramir

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDrawInWorldBuilder

     OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model    = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = GUFrmrHrs_SKN
        End
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate = Yes
         UnpackTime              = 2000
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = 2000
         OpacityTarget            = .3
         AwardXPForTriggering    = 0
    End
End