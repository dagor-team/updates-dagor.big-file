Object GondorArvedui

   SelectPortrait = HPArveduiPortrait
   ButtonImage    = HIArveduiIcon

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        RandomTexture = guarv_shield.tga  0 bfme_nival_shld_12.tga

        DefaultModelConditionState
            Model                = guarvedui_skc
            Skeleton             = CHHW_CG_U_SKL
            ModelAnimationPrefix = CHHW_CG
        End

		ModelConditionState =   USER_4
            ParticleSysBone = B_SWORDBONE ElendilNarsilLightMode FollowBone:Yes
            ;ParticleSysBone = NONE ElendilCoat FOLLOWBONE:YES
        End


		ModelConditionState          = USER_6
            Model                    = guarvedui_skc
            ParticleSysBone = BAT_RIBS BeregondBladeMaster FollowBone:Yes
            ParticleSysBone = B_SWORDBONE ElendilNarsilLightMode FollowBone:Yes
            ;ParticleSysBone = NONE ElendilCoat FOLLOWBONE:YES
        End




        ModelConditionState      = WEAPONSET_HERO_MODE
            Model                = guarvedui_skc
            Skeleton             = CHHW_CG_U_SKL
            ModelAnimationPrefix = CHHW_CG
        End



AnimationState        = STUNNED_FLAILING
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End


AnimationState        = DYING SPLATTED
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_DIEA
        AnimationMode     = ONCE
    End
End


AnimationState        = DYING DEATH_2
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_IDLA
        AnimationMode     = ONCE
    End
End




AnimationState        = STUNNED_STANDING_UP
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End


AnimationState        = STUNNED
    StateName           = STATE_Sword
    Animation           = GUHero_LNDA
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End





        AnimationState            = MOVING
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART

            Animation
                AnimationName   = #(MODEL)_U_RUNA
                AnimationSpeedFactorRange = 0.95 0.95
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
            EndScript
        End

        AnimationState            = MOVING WEAPONSET_HERO_MODE
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART
            Animation
                AnimationName   = #(MODEL)_U_SPCF
                AnimationSpeedFactorRange = 0.95 0.95
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
            EndScript
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = #(MODEL)_U_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A WEAPONSET_HERO_MODE
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = #(MODEL)_U_SPCF
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End





        AnimationState                = FIRING_OR_PREATTACK_A
            Animation
                AnimationName        = #(MODEL)_U_ATKA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation
                AnimationName        = #(MODEL)_U_ATKB
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End







        AnimationState = HIT_REACTION
            Animation
                AnimationName = #(MODEL)_U_HITA
                AnimationMode = ONCE
            End
        End



        AnimationState          =    SPECIAL_WEAPON_ONE
            StateName          =    Attacking
            Animation
                AnimationName =    #(MODEL)_U_TNTA
                AnimationMode =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = #(MODEL)_U_LVLA
                AnimationMode        = ONCE
            End
        End





        AnimationState                =    EMOTION_CELEBRATING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_CHRA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                =    EMOTION_TAUNTING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_TNTB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                = ENGAGED
            StateName                = STATE_ready
            Animation
                AnimationName        = #(MODEL)_U_IDLA
                AnimationMode        = ONCE
            End
        End



        IdleAnimationState
            StateName                = STATE_bored
            Animation = Foot_IDLB
                AnimationName       = #(MODEL)_U_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLC
                AnimationName       = #(MODEL)_U_IBFA
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if  Prev == "STATE_attention" or
                    Prev == "STATE_running" then CurDrawableSetTransitionAnimState("TRANS_attentionToBored") end
            EndScript
        End


        AnimationState                = SELECTED
            StateName                = STATE_attention
            Animation                = ATNE
                AnimationName        = #(MODEL)_U_ATNB
                AnimationMode        = LOOP
                AnimationBlendTime    = 5
                AnimationMustCompleteBlend = Yes
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_bored" then CurDrawableSetTransitionAnimState("TRANS_boredToAttention") end
            EndScript
        End


        TransitionState                = TRANS_boredToAttention
            Animation                = GUAragorn_ATND
                AnimationName        = #(MODEL)_U_ATND
                AnimationMode        = ONCE
            End
        End

        TransitionState                = TRANS_attentionToBored
            Animation                = GUAragorn_ATNC
                AnimationName        = #(MODEL)_U_ATNC
                AnimationMode        = ONCE
            End
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    Side = Arnor
    EditorSorting = UNIT
    ThreatLevel = 5.0
    ThingClass  = CHARACTER_UNIT
    TransportSlotCount = 1
    DisplayMeleeDamage = STRONG_HERO_DAMAGE
    HeroSortOrder = 20
    BuildCost = ARVEDUIDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME
    MaxSimultaneousOfType = 1

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ArnorArveduiSword
    End

    WeaponSet
        Conditions = WEAPONSET_HERO_MODE
        Weapon = PRIMARY    ArnorArveduiSword
    End

    ArmorSet
        Conditions        = None
        Armor             = VeryStrongHeroArmor
        DamageFX          = NormalDamageFX
    End

    VisionRange = 280
    ShroudClearingRange = 350
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue    = GONDOR_ARAGORN_BOUNTY_VALUE
    DisplayName    = OBJECT:ArnorArvedui
    RecruitText    = CONTROLBAR:ArnorArveduiRecruit
    Hotkey         = CONTROLBAR:ArnorArveduiHotkey
    CrusherLevel   = 0
    CrushableLevel = 3

    CommandSet     = ArnorArveduiModCommandSet
    CommandPoints  = 0



    VoiceAttack                 = ArveduiVoiceAttack
    VoiceAttackCharge           = ArveduiVoiceAttackCharge
    VoiceAttackMachine          = ArveduiVoiceAttack
    VoiceAttackStructure        = ArveduiVoiceAttackBuilding
    VoiceCreated                = ArveduiVoiceSalute
    VoiceFullyCreated           = ArveduiVoiceSalute
    VoiceFear                   = ArveduiVoiceHelpMe
    VoiceMove                   = ArveduiVoiceMove
    VoiceMoveToCamp             = ArveduiVoiceMoveCamp
    VoiceMoveWhileAttacking     = ArveduiVoiceHelpMe
    VoicePriority               = 95
    VoiceRetreatToCastle        = ArveduiVoiceMoveCamp
    VoiceSelect                 = ArveduiVoiceSelect
    VoiceSelectBattle           = ArveduiVoiceSelectBattle
    VoiceGuard                  = ArveduiVoiceMove

    SoundImpact                 = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                       = ArveduiVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = ArveduiVoiceMove
        VoiceInitiateCaptureBuilding        = ArveduiVoiceCaptureBuilding
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA           Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1      Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1      Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier         Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier         Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner        = IsildurDie

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End


    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
            CheerRadius               = EMOTION_CHEER_RADIUS
            MaxHealth                 = ARVEDUIDAG_HEALTH
            PermanentlyKilledByFilter = NONE
            DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
            DeathAnim                  = DYING
            DeathAnimationTime         = 3933
            RespawnAnim                = LEVELED
            RespawnAnimationTime       = 2000
            AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
            ButtonImage                = HIArveduiIcon

        RespawnRules =    AutoSpawn:No           Cost:ARVEDUIDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_AragornHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        AILuaEventsList               = ArveduiFunctions
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = 250
         TauntAndPointUpdateDelay    = 1000

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime    = 3333
        ShockStunnedTimeLow    = 1000
        ShockStunnedTimeHigh= 1200
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 22000
        Sound = INITIAL AragornVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End


    Behavior = CitadelSlaughterHordeContain ModuleTag_SlaughterMe
        PassengerFilter              = NONE +TheDroppedRing
        ObjectStatusOfContained      = UNSELECTABLE ENCLOSED
        ContainMax                   = 1
        AllowEnemiesInside           = No
        AllowAlliesInside            = Yes
        AllowNeutralInside           = No
        AllowOwnPlayerInsideOverride = Yes
        EnterSound                   = Isildur_RingReturned
        EntryOffset                  = X:0.0 Y:0.0 Z:0.0
        EntryPosition                = X:0.0 Y:0.0 Z:0.0
        ExitOffset                   = X:0.0 Y:0.0 Z:0.0
        StatusForRingEntry           = HOLDING_THE_RING
        UpgradeForRingEntry          = Upgrade_RingHero Upgrade_FortressRingHero
        ObjectToDestroyForRingEntry  = NONE +TheDroppedRing
        FXForRingEntry               = FX_OneRingFlare
    End
	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FactionLeaderLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_FactionLeaderLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = ModelConditionUpgrade ModulTag_RingHeroMC
        TriggeredBy         = Upgrade_RingHero Upgrade_FortressRingHero
        RequiresAllTriggers = Yes
        AddConditionFlags   = ONE_RING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp  = NONE +TheDroppedRing
        ScanRange      = 3000
        ScanIntervalSeconds = 0.5
    End



    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = No                     		  
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = Yes 		 
        BonusName        = ArveduiLeadershipMod		 
        RefreshDelay     = 2000
        Range            = 200				
        AntiCategory     = BUFF
        ObjectFilter     = ARNOR_LEADERSHIP_UNITS_OBF
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_BoromirLeadership2
        StartsActive    = Yes 	
        BonusName       = ArveduiLeadershipStructure
        RefreshDelay    = 2000
        Range           = 200
        ObjectFilter    = ANY +STRUCTURE -INFANTRY -CAVALRY -HERO -DOZER -MACHINE -SHIP ALLIES             
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        TriggeredBy             = Upgrade_Level_2
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier   = ArveduiWaffenmeisterBonus
        HeroEffectDuration      = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End

    Behavior = AutoAbilityBehavior ModuleTag_AragornBladeMasterAutoAbility
	SpecialAbility		= SpecialAbilityAragornBladeMaster
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= 150
	Query			= 15 ALL ENEMIES
	Query			= 1 ANY ENEMIES +HERO +MONSTER
   End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 100
        HitReactionLifeTimer2 = 1000
        HitReactionLifeTimer3 = 1993

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Diplomatische
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        TriggeredBy               = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_DiplomatischeUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = DiplomatischeBeziehungenWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End
	
	Behavior = CostModifierUpgrade ModuleTag_CostModifier
        LabelForPalantirString = GUI:INFANTRYDiscount
		TriggeredBy               = Upgrade_Level_3
        StartsActive = Yes
        ObjectFilter    = ANY +CAVALRY -HERO
        Percentage        =  -30%
      
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HaltetStandStarter
        SpecialPowerTemplate            = SpecialAbilityHaltetStand
        TriggeredBy                     = Upgrade_Level_8
        ObeyRechageOnTrigger            = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HaltetStandDummy
        SpecialPowerTemplate            = SpecialAbilityHaltetStand
        StartsPaused                    = Yes
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
        SpecialPowerTemplate            = SpecialAbilityHaltetStand
        StartAbilityRange               = 200
        TriggerSpecialPower             = ModuleTag_HaltetStandHeal        TARGETPOS
        TriggerSpecialPower             = ModuleTag_HaltetStandBuff        TARGETPOS
        TriggerSpecialPower             = ModuleTag_HaltetStandFavor       TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_HaltetStandHeal
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        HealAmount                      = 1.0
        HealAsPercent                   = Yes
        HealAffects                     = INFANTRY
        HealRadius                      = 120
        HealFX                          = FX_SpellHealUnitHealBuff
        InitiateSound                   = AragornAthelesEffect
        TriggerFX                       = FX_HaltetStand02
    End

    Behavior = SpecialPowerModule ModuleTag_HaltetStandBuff
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        AttributeModifier               = HaltetStandBeregondBuff
        AttributeModifierRange          = 120
        AttributeModifierAffects        = NONE +INFANTRY ALLIES
    End

    Behavior = LevelGrantSpecialPower ModuleTag_HaltetStandFavor
        SpecialPowerTemplate            = SpecialAbilityActivateeDummy
        UnpackingVariation              = 2
        StartAbilityRange               = 200.0
        LevelFX                         = FX_BeregondLevelUp
        Experience                      = 50
        RadiusEffect                    = 120
        AcceptanceFilter                = NONE +INFANTRY ALLIES
        UnpackTime                      = 3000
        PreparationTime                 = 0
        FreezeAfterTriggerDuration      = 2000
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HealingWeaponTrigger
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        TriggeredBy               = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_HealingWeaponUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = ObjectCreationUpgrade ModuleTag_HealingWeaponActive
        TriggeredBy  = Upgrade_Level_10
        GrantUpgrade = Upgrade_ArveduiHealingWeapon
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GeprufteEnabler
        SpecialPowerTemplate            = SpecialAbilityGandalfGeprufte
    End

    Behavior = SpecialPowerModule ModuleTag_GeprufteStarter
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Geprufte
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         MountedTemplate                = GondorArvedui_OneRing
         SynchronizeTimerOnSpecialPower = SpecialAbilitySchatzedesKonigsreichs SpecialAbilityHaltetStand SpecialAbilityAragornBladeMaster SpellBookPalantirNorden
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_RingHero
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGlorfindelRingSwitch
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_ArveduiGloreicherWiderstand
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGiveXPAoE
        CommandButtonName = Command_SpecialAbilityArveduiHaltetStand
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_ArveduiToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate SpecialPowerBoromirGiveXPAoE
        CommandButtonName = Command_SpecialAbilityArveduiSchatzedesKonigreichs
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 20
    ShadowSizeY = 20
    ShadowTexture = ShadowI
End

ChildObject GondorArveduiCavalry GondorArvedui

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDrawInWorldBuilder

              OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model    = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = GUFrmrHrs_SKN
        End
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate    = SpecialAbilityToggleMounted
         TriggerInstantlyOnCreate = Yes
         UnpackTime              = GOOD_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = GOOD_MOUNT_TIME
         OpacityTarget           = .3
         AwardXPForTriggering    = 0
    End
End

Object GondorArvedui_OneRing

   ButtonImage    = HIArveduiIcon
   SelectPortrait = HPArveduiPortrait

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        RandomTexture = guarv_shield.tga  0 bfme_nival_shld_12.tga

        DefaultModelConditionState
            Model                = guarvedui_skc
            Skeleton             = CHHW_CG_U_SKL
            ModelAnimationPrefix = CHHW_CG
        End

        ModelConditionState      = HERO
            Model                = guarvedui_skc
            Skeleton             = CHHW_CG_U_SKL
            ModelAnimationPrefix = CHHW_CG
            ParticleSysBone      = BAT_RIBS WellHealFX FollowBone:No
        End



AnimationState        = STUNNED_FLAILING
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_FLYA
        AnimationMode     = LOOP
    End
    Flags               = RANDOMSTART
End


AnimationState        = DYING SPLATTED
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End

AnimationState        = DYING
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_DIEA
        AnimationMode     = ONCE
    End
End


AnimationState        = DYING DEATH_2
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_IDLA
        AnimationMode     = ONCE
    End
End




AnimationState        = STUNNED_STANDING_UP
    StateName           = STATE_Sword
    Animation
        AnimationName     = #(MODEL)_U_GTPA
        AnimationMode     = ONCE
        AnimationSpeedFactorRange = 1.5 1.5
    End
End


AnimationState        = STUNNED
    StateName           = STATE_Sword
    Animation           = GUHero_LNDA
        AnimationName     = #(MODEL)_U_LNDA
        AnimationMode     = ONCE
    End
End





        AnimationState            = MOVING
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART

            Animation
                AnimationName   = #(MODEL)_U_RUNA
                AnimationSpeedFactorRange = 0.95 0.95
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
            EndScript
        End

        AnimationState            = MOVING WEAPONSET_HERO_MODE
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART
            Animation
                AnimationName   = #(MODEL)_U_SPCF
                AnimationSpeedFactorRange = 0.95 0.95
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
            EndScript
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = #(MODEL)_U_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A WEAPONSET_HERO_MODE
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = #(MODEL)_U_SPCF
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End





        AnimationState                = FIRING_OR_PREATTACK_A
            Animation
                AnimationName        = #(MODEL)_U_ATKA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation
                AnimationName        = #(MODEL)_U_ATKB
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End







        AnimationState = HIT_REACTION
            Animation
                AnimationName = #(MODEL)_U_HITA
                AnimationMode = ONCE
            End
        End



        AnimationState          =    SPECIAL_WEAPON_ONE
            StateName          =    Attacking
            Animation
                AnimationName =    #(MODEL)_U_TNTA
                AnimationMode =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = #(MODEL)_U_LVLA
                AnimationMode        = ONCE
            End
        End





        AnimationState                =    EMOTION_CELEBRATING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_CHRA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                =    EMOTION_TAUNTING
            Animation CHRA
                AnimationName        =    #(MODEL)_U_TNTA
                AnimationMode        =    ONCE
            End
            Animation CHRB
                AnimationName        =    #(MODEL)_U_TNTB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End





        AnimationState                = ENGAGED
            StateName                = STATE_ready
            Animation
                AnimationName        = #(MODEL)_U_IDLA
                AnimationMode        = ONCE
            End
        End



        IdleAnimationState
            StateName                = STATE_bored
            Animation = Foot_IDLB
                AnimationName       = #(MODEL)_U_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLC
                AnimationName       = #(MODEL)_U_IBFA
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if  Prev == "STATE_attention" or
                    Prev == "STATE_running" then CurDrawableSetTransitionAnimState("TRANS_attentionToBored") end
            EndScript
        End


        AnimationState                = SELECTED
            StateName                = STATE_attention
            Animation                = ATNE
                AnimationName        = #(MODEL)_U_ATNB
                AnimationMode        = LOOP
                AnimationBlendTime    = 5
                AnimationMustCompleteBlend = Yes
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_bored" then CurDrawableSetTransitionAnimState("TRANS_boredToAttention") end
            EndScript
        End


        TransitionState                = TRANS_boredToAttention
            Animation                = GUAragorn_ATND
                AnimationName        = #(MODEL)_U_ATND
                AnimationMode        = ONCE
            End
        End

        TransitionState                = TRANS_attentionToBored
            Animation                = GUAragorn_ATNC
                AnimationName        = #(MODEL)_U_ATNC
                AnimationMode        = ONCE
            End
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    Side = Arnor
    EditorSorting = UNIT
    ThreatLevel = 5.0
    ThingClass  = CHARACTER_UNIT
    TransportSlotCount = 1
    DisplayMeleeDamage = ARVEDUIDAG_DAMAGE
    HeroSortOrder = 20
    BuildCost = ARVEDUIDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME
    EquivalentTo                 = GondorArvedui
    MaxSimultaneousOfType        = 1
    VisionRange                  = 280
    ShroudClearingRange          = 350
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot    = 1.0%
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ArnorArveduiSword_Ring
    End

    WeaponSet
        Conditions = WEAPONSET_HERO_MODE
        Weapon = PRIMARY    ArnorArveduiSword_Ring
    End

    ArmorSet
        Conditions        = None
        Armor             = SilmarilHeroArmor
        DamageFX          = NormalDamageFX
    End

    VisionRange = 280
    ShroudClearingRange = 350

    BountyValue  = GONDOR_ARAGORN_BOUNTY_VALUE
    DisplayName  = OBJECT:ArnorArvedui
    RecruitText  = CONTROLBAR:ArnorArveduiRecruit
    Hotkey       = CONTROLBAR:ArnorArveduiHotkey
    CrusherLevel = 0
    CrushableLevel = 4

    CommandSet    = ArnorArveduiSilmarilCommandSet
    CommandPoints = 0



    VoiceAttack                 = ArveduiVoiceAttack
    VoiceAttackCharge           = ArveduiVoiceAttackCharge
    VoiceAttackMachine          = ArveduiVoiceAttack
    VoiceAttackStructure        = ArveduiVoiceAttackBuilding
    VoiceCreated                = SH_NineForMen
    VoiceFullyCreated           = SH_NineForMen
    VoiceFear                   = ArveduiVoiceHelpMe
    VoiceMove                   = ArveduiVoiceMove
    VoiceMoveToCamp             = ArveduiVoiceMoveCamp
    VoiceMoveWhileAttacking     = ArveduiVoiceHelpMe
    VoicePriority               = 95
    VoiceRetreatToCastle        = ArveduiVoiceMoveCamp
    VoiceSelect                 = ArveduiVoiceSelect
    VoiceSelectBattle           = ArveduiVoiceSelectBattle
    VoiceGuard                  = ArveduiVoiceMove

    SoundImpact                 = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                       = ArveduiVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = ArveduiVoiceMove
        VoiceInitiateCaptureBuilding        = ArveduiVoiceCaptureBuilding
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA           Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1      Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1      Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow         Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1        Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier         Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier         Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner      = IsildurDie

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End


    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO ARMY_SUMMARY HEAVY_MELEE_HITTER HERO
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
            CheerRadius               = EMOTION_CHEER_RADIUS
            MaxHealth                 = ARVEDUIDAG_HEALTH
            PermanentlyKilledByFilter = NONE
            DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
            DeathAnim                  = DYING
            DeathAnimationTime         = 3933
            RespawnAnim                = LEVELED
            RespawnAnimationTime       = 2000
            AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
            ButtonImage                = HIArveduiIcon
            RespawnAsTemplate          = GondorArvedui

            RespawnRules =            AutoSpawn:No    Cost:ARVEDUIDAG_COST        Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_AragornHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        AILuaEventsList               = ArveduiFunctions
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = 250
         TauntAndPointUpdateDelay    = 1000

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime    = 3333
        ShockStunnedTimeLow    = 1000
        ShockStunnedTimeHigh= 1200
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 22000
        Sound = INITIAL AragornVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End





     Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArnorArveduiSilmarilLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership
    End

    Behavior = SpecialPowerModule ModuleTag_ArnorArveduiSilmarilLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_ArnorArveduiSilmarilLeadership
        StartsActive     = Yes
        BonusName        = ArnorArveduiSilmarilLeadership
        RefreshDelay     = 2000
        Range            = 450
        ObjectFilter     = ALL NOT_FLYING_UNITS -AngbandMelkor -AngbandMelkor_WOR -AngbandAncalagon -TolinGaurhothTarMairon -TolinGaurhothTarMairon_WOR -AngbandAncalagon_WOR -AvatharUngoliant -AvatharUngoliant_WOR -ValinorYavanna_Summoned -ValinorYavanna -ValinorManwe -ValinorManwe_WOR -DoriathMelian -DoriathMelian_WOR -ValinorEonwe -ValinorEonwe_WOR -ValinorTulkas -ValinorTulkas_WOR -ValinorAule -ValinorAule_WOR -ValinorOrome -ValinorOrome_Summoned -ValinorHound -MordorGrond  -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End
	


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArnorArveduiSilmarilBuffStructureEnabler
		SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilBuffStructure
        TriggeredBy                 = Upgrade_Level_2
    End
	
    Behavior = SpecialPowerModule ModuleTag_ArnorArveduiSilmarilBuffStructureUpdate
        SpecialPowerTemplate       = SpecialAbilityArnorArveduiSilmarilBuffStructure
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        AttributeModifier          = ArnorArveduiSilmarilBuffStructure
        AttributeModifierRange     = 600
        AttributeModifierAffectsSelf  = No	
		AttributeModifierAffects   = NONE +STRUCTURE ALLIES
        AttributeModifierFX        = FX_ArnorArveduiSilmarilBuffStructureBlue
    End
	
    Behavior = SpecialAbilityUpdate ModuleTag_ArnorArveduiSilmarilBuffStructureAnimation
        UnpackTime              = 50
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityArnorArveduiSilmarilBuffStructure
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
     End



	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArnorArveduiSilmarilBladeEnabler
		SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilBlade
        TriggeredBy                 = Upgrade_Level_5
    End
    Behavior = SpecialPowerModule ModuleTag_ArnorArveduiSilmarilBladeUpdate
        SpecialPowerTemplate       = SpecialAbilityArnorArveduiSilmarilBlade
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        AttributeModifier          = ArnorArveduiSilmarilBlade
        AttributeModifierRange     = 300
        AttributeModifierAffectsSelf  = Yes	
		AttributeModifierAffects   = NONE
        AttributeModifierFX        = FX_ArnorArveduiSilmarilBlade
    End
    Behavior = SpecialAbilityUpdate ModuleTag_ArnorArveduiSilmarilBladeAnimation
        UnpackTime              = 50
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityArnorArveduiSilmarilBlade
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
     End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArnorArveduiSilmarilDebuffStructureEnabler
        SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilDebuffStructure
        TriggeredBy                 = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_ArnorArveduiSilmarilDebuffStructureStarter
        SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilDebuffStructure
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_ArnorArveduiSilmarilDebuffStructureMover
        SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilDebuffStructure
        StartAbilityRange           = 300
        TriggerSpecialPower         = ModuleTag_ArveduiSilmarilDebuffTrigger TARGETPOS
    End

    Behavior = SpecialPowerModule ModuleTag_ArnorArveduiSilmarilDebuffStructureTrigger
        SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilDebuffStructure
        AttributeModifier           = ArnorArveduiSilmarilDebuffStructure
        AttributeModifierRange      = 300
        AttributeModifierAffects    = NONE +STRUCTURE ENEMIES
        TriggerFX                   = FX_ArnorArveduiSilmarilDebuffStructureRed
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
        AntiCategory                = LEADERSHIP BUFF
    End

								

	Behavior                       = UnpauseSpecialPowerUpgrade ModuleTag_ArnorArveduiSilmarilSummonArmyEnabler
       SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilSummonArmy
       TriggeredBy                 = Upgrade_Level_10
    End

    Behavior                       = OCLSpecialPower ModuleTag_OCLArnorArveduiSilmarilSummonArmy
       SpecialPowerTemplate        = SpecialAbilityArnorArveduiSilmarilSummonArmy
       OCL                         = OCL_ArveduiSilmarilHelpEgg
	   TriggerFX                   = FX_ArnorGoldenFogSummon
       CreateLocation              = CREATE_AT_LOCATION
       StartsPaused                = Yes
    End









    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = MorchantBannzirkelEffect
            FireDelay = 0
            OneShot = No
        End
        HeroModeTrigger = Yes
    End

    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    
    

    
	
	
	
	
	
    






    
    
    
    

    
    
    
    
    

    
    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    

    
    
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate = SpecialAbilityKlingentanz
        TriggeredBy          = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_WordStarter
        SpecialPowerTemplate      = SpecialAbilityKlingentanz
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate
        SpecialPowerTemplate    = SpecialAbilityKlingentanz
        WhichSpecialWeapon      = 1
        SkipContinue            = Yes
        UnpackTime              = 1700
        PackTime                = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering    = 0
        StartAbilityRange       = 80.0
        SpecialWeapon           = ArveduiAussortierungWeapon
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WeissagungEnabler
        SpecialPowerTemplate        = SpecialAbilityMalbethWeissagung
        TriggeredBy                 = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_WeissagungStarter
        SpecialPowerTemplate        = SpecialAbilityMalbethWeissagung
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WeissagungUpdate
        SpecialPowerTemplate        = SpecialAbilityMalbethWeissagung
        WhichSpecialWeapon          = 5
        SkipContinue                = Yes
        UnpackTime                  = 1700
        PreparationTime             = 1
        PersistentPrepTime          = 1000
        PackTime                    = 1000
        AwardXPForTriggering        = 0
        StartAbilityRange           = 200
        MustFinishAbility           = Yes
        SpecialWeapon               = MalbethWeissagungWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_WeissagungAutoAbility
        SpecialAbility              = SpecialAbilityMalbethWeissagung
        MaxScanRange                = 250
        Query                       = 1 ANY +HERO ENEMIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HealingWeaponTrigger
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        TriggeredBy               = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_HealingWeaponUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = ObjectCreationUpgrade ModuleTag_HealingWeaponActive
        TriggeredBy  = Upgrade_Level_10
        GrantUpgrade = Upgrade_ArveduiHealingWeapon
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry
    End



    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End

    Behavior = FXListDie ModuleTag_AnnounceWeLostTheRing
       DeathFX              = GandalfAnnounceFortressDeathLostRingFX
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList        = OCL_TheOneRing
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_ArveduiToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_SpecialAbilityArveduiUnantastbar
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGiveXPAoE
        CommandButtonName = Command_SpecialAbilityArveduiEinzugserlass
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerBoromirGiveXPAoE
        CommandButtonName = Command_SpecialAbilityArveduiAussortierung
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate CrippleAI
        CommandButtonName = Command_SpecialAbilityMalbethWeissagung
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 20
    ShadowSizeY = 20
    ShadowTexture = ShadowI
End

Object ArveduiSilmarilHelpEgg

	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 3700			 
		OCL = FINAL OCL_ArveduiSilmarilHelp
	End
End

