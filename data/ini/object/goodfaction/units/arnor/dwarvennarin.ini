Object DwarvenNarin

    SelectPortrait = HPNarin
    ButtonImage    = HINarin

    DescriptionStrategic = CONTROLBAR:LW_ToolTipBuild_SupportHero

    Draw = W3DScriptedModelDraw ModuleTag_01

        RandomTexture = DwarvenRam_SEE_Narin.tga  0 DwarvenRam_SEE.tga

        DefaultModelConditionState
            Model               = dunarin_skn
            Skeleton            = KUOrcRider_SKL
        End

        AnimationState                =    STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName       =    KUOrcRider_FLYA
                AnimationMode       =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                =    DYING SPLATTED
            Animation                =    Land
                AnimationName       =    KUOrcRider_LNDA
                AnimationMode       =    ONCE
            End
        End


        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    KUOrcRider_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName       =    KUOrcRider_GTPA
                AnimationMode       =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End


        AnimationState                =    STUNNED
            Animation                =    Land
                AnimationName       =    KUOrcRider_LNDA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = KUOrcRider_IDLA
                AnimationMode                = LOOP
            End
        End




        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = KUOrcRider_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = KUOrcRider_RUNB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState                =    MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    KUOrcRider_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    KUOrcRider_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.4 0.4
            End

        End

        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    KUOrcRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOVING
            Animation                =    RunA
                AnimationName        =    KUOrcRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime  =    10
                AnimationPriority   = 5
            End
            Flags                    =    RANDOMSTART

        End


        AnimationState                =    TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation
                AnimationName        =    KUOrcRider_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_B
            Animation
                AnimationName        =    KUOrcRider_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End

    AnimationState        = ATTACKING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
    End

    AnimationState        = ATTACKING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
    End

        AnimationState                =    BETWEEN_FIRING_SHOTS_A
            Animation                =    BetweenFiringShots
                AnimationName        =    KUOrcRider_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        AnimationState                =    BETWEEN_FIRING_SHOTS_B
            Animation                =    BetweenFiringShots
                AnimationName        =    KUOrcRider_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End



        AnimationState                    = EMOTION_TAUNTING
            Animation                    = TNTA
                AnimationName            = KUOrcRider_TNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = Pointing1
                AnimationName            = KUOrcRider_PNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                   = CHRA
                AnimationName            = KUOrcRider_CHRA
                AnimationMode            = ONCE
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                            = EMOTION_ALERT
            StateName                            = STATE_ReadyMounted
            Animation                            = ALERT
                AnimationName                    = KUOrcRider_IDLA
                AnimationMode                    = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_SelectedMounted" then CurDrawableSetTransitionAnimState("Selected_to_ReadyMounted") end
            EndScript
        End

        AnimationState                    = RAISING_FLAG
            Animation                   = CHRA
                AnimationName            = KUOrcRider_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    KUOrcRider_ATNB
                AnimationMode        =    LOOP
            End
            StateName                = STATE_SelectedMounted
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_IdleMounted" then CurDrawableSetTransitionAnimState("Idle_to_SelectedMounted") end
                if Prev == "STATE_IdleMountedSpecial" then CurDrawableSetTransitionAnimState("IdleSpecial_to_SelectedMounted") end
                if Prev == "STATE_ReadyMounted" then CurDrawableSetTransitionAnimState("Ready_to_SelectedMounted") end
            EndScript
        End


        IdleAnimationState
            StateName                =    BORED
            Animation            =    IdleC
                AnimationName        =    KUOrcRider_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    20
            End
            Animation            =    IdleD
                AnimationName        =    KUOrcRider_IDLD
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    5
            End
            StateName            = STATE_IdleMounted
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_SelectedMounted" then CurDrawableSetTransitionAnimState("Selected_to_IdleMounted") end
            EndScript
        End



        TransitionState       = Selected_to_IdleMounted
            Animation           = ATNE

                AnimationName        =    KUOrcRider_ATNC
                AnimationMode        =    ONCE
            End
        End

        TransitionState       = Idle_to_SelectedMounted
            Animation           = ATNDgetready
                AnimationName     = KUOrcRider_ATNA
                AnimationMode   =    ONCE
            End
        End

        TransitionState       = Ready_to_SelectedMounted
            Animation           = ATND
                AnimationName     = KUOrcRider_ATNA
                AnimationMode   =    ONCE
            End
        End

        TransitionState       = Selected_to_ReadyMounted
            Animation           = ATNEReverse
                AnimationName     = MUGothWarg_ATNC
                AnimationMode   =    ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End




    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                  = Dwarves
    EditorSorting         = UNIT
    ThreatLevel           = DAIN_THREAT_LEVEL
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    BuildCost             = 800
    BuildTime             = WEAK_HERO_BUILDTIME
    DisplayMeleeDamage    = 250
    Scale                 = 0.88
    MaxSimultaneousOfType = 1

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY  DwarvenNarinWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions        = None
        Armor             = MediumHeroArmorMounted
        DamageFX          = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE
        Armor             = StrongHeroArmorMounted
        DamageFX          = NormalDamageFX
    End


    VisionRange         = 250
    ShroudClearingRange = 380

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     = 100
    DisplayName     = OBJECT:DwarvenNarin
    RecruitText     = CONTROLBAR:DwarvenNarinRecruit
    ReviveText      = CONTROLBAR:DwarvenNarinRevive
    Hotkey          = CONTROLBAR:DwarvenNarinHotkey
    CrusherLevel    = 1
    CrushableLevel  = 2

    CommandSet               = DwarvenNarinCommandSet
    CommandPoints            = 0

    Behavior = CommandSetUpgrade ModuleTag_GimliMithril
        TriggeredBy        = Upgrade_DwarvenMithrilMailHeroes
        CommandSet        = DwarvenNarinMithrilCommandSet
    End


    CrushWeapon              = HeroCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback           = 40
    CrushZFactor             = 1.0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_DainBody

    AutoResolveArmor
        Armor = AutoResolve_DainArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DainWeapon
    End




            VoiceAttack                             = NarinVoiceAttack
            VoiceAttackAir                          = NarinVoiceAttack
            VoiceAttackCharge                       = NarinVoiceAttack
            VoiceAttackMachine                      = NarinVoiceAttack
            VoiceAttackStructure                    = NarinVoiceAttack
            VoiceCreated                            = NarinVoiceSelect
            VoiceFullyCreated                       = NarinVoiceSelect
            VoiceFear                               = NarinVoiceHelp
            VoiceGuard                              = NarinVoiceMove
            VoiceMove                               = NarinVoiceMove
            VoiceMoveToCamp                         = NarinVoiceMove
            VoiceMoveWhileAttacking                 = NarinVoiceMove
            VoicePriority                           = 80
            VoiceRetreatToCastle                    = NarinVoiceRetreat
            VoiceSelect                             = NarinVoiceSelect
            VoiceSelectBattle                       = NarinVoiceSelectinBattle

            SoundImpact                             = ImpactHorse

            UnitSpecificSounds
                VoiceEnterUnitElvenTransportShip    = NarinVoiceMove
                VoiceEnterUnitMordorMumakil         = NarinVoiceMove
                VoiceEnterUnitSlaughterHouse        = NarinVoiceMove
                VoiceEnterUnitTransportShip         = NarinVoiceMove
                VoiceGarrison                       = NarinVoiceMove
                VoiceInitiateCaptureBuilding        = NarinVoiceMove
            End


    CrowdResponseKey = DwarfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Unit Infantry Hero
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_RUNA     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TNL1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TNR1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TRNL     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TRNR     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_ACCL     Frames:0
        AnimationSound = Sound:WargTauntFootstep        Animation:KUOrcRider_TNTA     Frames:7 12 64 73
        AnimationSound = Sound:BoarWhinny               Animation:KUOrcRider_TNTA     Frames:7
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNTA     Frames:25
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RUNA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNL1     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNR1     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ACCL     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ATNA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ATND     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_GTPA     Frames:5 101
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_HWLA     Frames:15
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RDYA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RDYB     Frames:5
        AnimationSound = Sound:BodyFallOrc              Animation:KUOrcRider_DIEB    Frames:10
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:KUOrcRider_DIEB    Frames:45
        AnimationSound = Sound:BodyFallOrc              Animation:KUOrcRider_LNDA    Frames:1 17
        AnimationSound = Sound:BodyFallGeneric1         Animation:KUOrcRider_DIEC    Frames:16
        AnimationSound = Sound:BodyFallGeneric1         Animation:KUOrcRider_DIEC    Frames:30
        AnimationSound = Sound:BoarWhinny               Animation:KUOrcRider_DIEC    Frames:6
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = DelayedDeathBody ModuleTag_DelayedDeathBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = MEDIUM_HERO_HEALTH
        MaxHealthDamaged                = 900
        MaxHealthReallyDamaged          = 400
        DelayedDeathTime                = 10000
        DelayedDeathPrerequisiteUpgrade = Upgrade_EisernerWille
        PermanentlyKilledByFilter       = NONE
        DodgePercent                 = HERO_DODGE_PERCENT
    End

    Behavior = LifetimeUpdate ModuleTag_LifeTime
        WaitForWakeUp = Yes
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                      = DYING
        DeathAnimationTime             = 4100
        RespawnAnim                    = LEVELED
        RespawnAnimationTime           = 2000
        AutoRespawnAtObjectFilter      = NONE +CASTLE_KEEP
        ButtonImage                    = HINarin

        RespawnRules =    AutoSpawn:No           Cost:1500      Time:WEAK_HERO_RESPAWNTIME        Health:100%
   End


    Behavior = AutoHealBehavior ModuleTag_DainHealing
        StartsActive            = Yes
        HealingAmount            = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay        = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat    = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        HoldGroundCloseRangeDistance    = 60
        AILuaEventsList                 = DwarvenHeroFunctions
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 200
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = DainRachefeldzugUnitModifier
        AllowFilter             = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

    LocomotorSet
        Locomotor = WargLocomotor
        Condition = SET_NORMAL
        Speed     = 110
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
        AllowBouncing           = No
        ShockStunnedTimeLow     = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime       = 2600
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes           = ALL -KNOCKBACK
        SinkDelay            = 3000
        SinkRate             = 0.40
        DestructionDelay     = 8000
        Sound                = INITIAL NarinVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes          = NONE +KNOCKBACK
        SinkDelay           = 3000
        SinkRate            = 0.40
        DestructionDelay    = 8000
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
         TauntAndPointUpdateDelay    =    1000
        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2200
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 1.0
        HitReactionThreshold2 = 2500.0
        HitReactionThreshold3 = 5000.0
    End





    Behavior = AttributeModifierAuraUpdate ModuleTag_BoteLeadership
        StartsActive             = No
        BonusName                = NarinBoteLeadership
        TriggeredBy              = Upgrade_Level_1
        RefreshDelay             = 2000
        Range                    = 200
        ObjectFilter             = ANY +HERO +MADE_OF_METAL DWARVENRAMRIDERS ALLIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KampfbefehlUnpause
        SpecialPowerTemplate         = SpecialAbilityNarinKampfbefehl
        TriggeredBy                  = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule SwiftMarch_KampfbefehlModuleTag
        SpecialPowerTemplate         = SpecialAbilityNarinKampfbefehl
        AttributeModifier            = NarinKampfbefehlModifier
        AttributeModifierRange       = 90
        AttributeModifierAffects     = ANY +IronHillsScoutBanner +IronHillsScoutHorde +IronHillsScoutHordeWedgeFormation +DwarvenNarin +BelegostRider +BelegostRiderBanner ALLIES
        AttributeModifierAffectsSelf = Yes
        TriggerFX                    = FX_NarinKampfbefehlStart
        UpdateModuleStartsAttack     = No
        StartsPaused                 = Yes
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WaffenstillstandEnabler
        SpecialPowerTemplate     = SpecialAbilityNarinWaffenstillstand
        TriggeredBy              = Upgrade_Level_6
    End

    Behavior = SpecialPowerModule ModuleTag_WaffenstillstandStarter
        SpecialPowerTemplate     = SpecialAbilityNarinWaffenstillstand
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
        InitiateSound            = NarinVoiceAttack
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WaffenstillstandUpdate
        SpecialPowerTemplate     = SpecialAbilityNarinWaffenstillstand
        SkipContinue             = Yes
        UnpackTime               = 1100
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 500
        MustFinishAbility        = Yes
        AwardXPForTriggering     = 0
        StartAbilityRange        = LURTZ_CRIPPLE_RANGE_ABILTY_START
        SpecialWeapon            = NarinWaffenstillstandWeapon
        WhichSpecialWeapon       = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_WaffenstillstandAutoAbility
        SpecialAbility           = SpecialAbilityNarinWaffenstillstand
        MaxScanRange             = LURTZ_CRIPPLE_RANGE_ABILTY_START
        Query                    = 1 NONE +HERO +MONSTER ENEMIES
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AllianzEnabler
        SpecialPowerTemplate     = SpecialAbilityNarinAllianz
        TriggeredBy              = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_AllianzStarter
        SpecialPowerTemplate     = SpecialAbilityNarinAllianz
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_AllianzUpdate
        SpecialPowerTemplate     = SpecialAbilityNarinAllianz
        SkipContinue             = Yes
        UnpackTime               = 1100
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 500
        MustFinishAbility        = Yes
        AwardXPForTriggering     = 0
        StartAbilityRange        = 100000
        SpecialWeapon            = NarinAllianzWeapon
        WhichSpecialWeapon       = 1
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_DwarvenMithrilMailHeroes
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_DwarvenMithrilMailHeroes
        UpgradeTexture  = dunarin.tga 0 dunarin_ha.tga
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
        SpecialPowerTemplate           = SpecialAbilityKingsFavor
        TriggeredBy                    = Upgrade_DwarvenMithrilMailHeroes
    End

    Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate        = SpecialAbilityKingsFavor
        StartsPaused                = Yes
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
        SpecialPowerTemplate        = SpecialAbilityKingsFavor
        UnpackingVariation            = 2
        StartAbilityRange            = 200.0
        Experience                    = 150
        RadiusEffect                = 100
        AcceptanceFilter            = NO_LEVEL_UPS_FOR_FIRST_AGE_UNITS_OBF EVIL_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF GOOD_LEVEL_UPS_FOR_ALL_OTHER_UNITS_OBF
        LevelFX                        = FX_LevelUp
        UnpackTime                    = 2000
        PreparationTime                = 1
        FreezeAfterTriggerDuration    = 2500
    End

; --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_SpecialAbilityNarinDainsBote
        SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
        SpecialPowerRadius = 50
        SpecialPowerRange = 50
    End

    Behavior = AISpecialPowerUpdate SpecialPowerBoromirGiveXPAoE
        CommandButtonName = Command_SpecialAbilityNarinKampfbefehl
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate CrippleAI
        CommandButtonName = Command_SpecialAbilityNarinWaffenstillstand
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Behavior = AISpecialPowerUpdate MightyRageAI
        CommandButtonName = Command_SpecialAbilityNarinAllianz
        SpecialPowerAIType = AI_SPECIAL_POWER_HEAL_AOE
        SpecialPowerRadius = 200.0
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 5.6
    GeometryMinorRadius = 5.6
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End

