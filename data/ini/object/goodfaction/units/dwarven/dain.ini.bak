Object DwarvenDain_mod

    SelectPortrait = HPKingDain2
    ButtonImage    = HIDainnew2

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_01

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes


        DefaultModelConditionState
            Model               = DUDainbotfa_SKN
            Skeleton            = DUDain_SKL
            WeaponLaunchBone    = TERTIARY AXE02
        End

        ModelConditionState     = MOUNTED
            Model               = DUDainboar_SKN
            Skeleton            = KUOrcRider_SKL
        End

        ModelConditionState = WEAPONSET_TOGGLE_3
            Model               = DUDainbotfa_SKN
            Skeleton            = DUDain_SKL
            ParticleSysBone     = BAT_HEAD Slayer FollowBone:Yes
            WeaponLaunchBone    = TERTIARY AXE02
        End

        AnimationState              =    STUNNED_FLAILING MOUNTED
            Animation               =    JustDie
                AnimationName       =    KUOrcRider_FLYA
                AnimationMode       =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                =    DYING SPLATTED MOUNTED
            Animation                =    Land
                AnimationName       =    KUOrcRider_LNDA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                =    DYING MOUNTED
            Animation                =    JustDie
                AnimationName        =    KUOrcRider_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP MOUNTED
            Animation                =    StandUp
                AnimationName       =    KUOrcRider_GTPA
                AnimationMode       =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED MOUNTED
            Animation                =    Land
                AnimationName       =    KUOrcRider_LNDA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = KUOrcRider_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = KUOrcRider_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A MOUNTED
            Animation           = TrotAndFire
                AnimationName       = KUOrcRider_RUNB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState                =    MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    MOVING ACCELERATE MOUNTED
            Animation                =    Accelerate
                AnimationName        =    KUOrcRider_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE MOUNTED
            Animation                =    Decelerate
                AnimationName        =    KUOrcRider_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.4 0.4
            End

        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    KUOrcRider_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOVING MOUNTED
            Animation                =    RunA
                AnimationName        =    KUOrcRider_RUNA
                AnimationMode        =    LOOP
                AnimationBlendTime  =    10
                AnimationPriority   = 5
            End
            Flags                    =    RANDOMSTART

        End


        AnimationState                =    TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    TURN_RIGHT MOUNTED
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A MOUNTED
            Animation
                AnimationName        =    KUOrcRider_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_B MOUNTED
            Animation
                AnimationName        =    KUOrcRider_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
            Animation
                AnimationName        =    KUOrcRider_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
                AnimationBlendTime  =    10
            End
        End

    AnimationState        = ATTACKING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    KUOrcRider_TRNL
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
    End

    AnimationState        = ATTACKING TURN_RIGHT MOUNTED
            Animation                =    TurnRight
                AnimationName        =    KUOrcRider_TRNR
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange = 2.0 2.0
            End
    End

        AnimationState                =    BETWEEN_FIRING_SHOTS_A MOUNTED
            Animation                =    BetweenFiringShots
                AnimationName        =    KUOrcRider_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End

        AnimationState                =    BETWEEN_FIRING_SHOTS_B MOUNTED
            Animation                =    BetweenFiringShots
                AnimationName        =    KUOrcRider_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =   10
            End
        End



        AnimationState                    = EMOTION_TAUNTING MOUNTED
            Animation                    = TNTA
                AnimationName            = KUOrcRider_TNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART
        End
        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = KUOrcRider_PNTA
                AnimationMode            = LOOP
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                    = EMOTION_CELEBRATING MOUNTED
            Animation                   = CHRA
                AnimationName            = KUOrcRider_CHRA
                AnimationMode            = ONCE
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                            = EMOTION_ALERT MOUNTED
            StateName                            = STATE_ReadyMounted
            Animation                            = ALERT
                AnimationName                    = KUOrcRider_IDLA
                AnimationMode                    = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_SelectedMounted" then CurDrawableSetTransitionAnimState("Selected_to_ReadyMounted") end
            EndScript
        End

        AnimationState                    = RAISING_FLAG MOUNTED
            Animation                   = CHRA
                AnimationName            = KUOrcRider_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                =    SELECTED MOUNTED
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    KUOrcRider_ATNB
                AnimationMode        =    LOOP
            End
            StateName                = STATE_SelectedMounted
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_IdleMounted" then CurDrawableSetTransitionAnimState("Idle_to_SelectedMounted") end
                if Prev == "STATE_IdleMountedSpecial" then CurDrawableSetTransitionAnimState("IdleSpecial_to_SelectedMounted") end
                if Prev == "STATE_ReadyMounted" then CurDrawableSetTransitionAnimState("Ready_to_SelectedMounted") end
            EndScript
        End


        AnimationState                = MOUNTED
            Animation            =    IdleC
                AnimationName        =    KUOrcRider_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    20
            End
            Animation            =    IdleD
                AnimationName        =    KUOrcRider_IDLD
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
                AnimationPriority   =    5
            End
            StateName            = STATE_IdleMounted
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_SelectedMounted" then CurDrawableSetTransitionAnimState("Selected_to_IdleMounted") end
            EndScript
        End



        TransitionState       = Selected_to_IdleMounted
            Animation           = ATNE

                AnimationName        =    KUOrcRider_ATNC
                AnimationMode        =    ONCE
            End
        End

        TransitionState       = Idle_to_SelectedMounted
            Animation           = ATNDgetready
                AnimationName     = KUOrcRider_ATNA
                AnimationMode   =    ONCE
            End
        End

        TransitionState       = Ready_to_SelectedMounted
            Animation           = ATND
                AnimationName     = KUOrcRider_ATNA
                AnimationMode   =    ONCE
            End
        End

        TransitionState       = Selected_to_ReadyMounted
            Animation           = ATNEReverse
                AnimationName     = MUGothWarg_ATNC
                AnimationMode   =    ONCE
            End
        End






        IdleAnimationState
            StateName                =    BORED
            Animation           = IDLB
                AnimationName     = DUDain_IDLB
                AnimationMode     = ONCE
                AnimationPriority = 10
            End
            Animation           = IDLF
                AnimationName     = DUDain_IDLC
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            Animation           = IDLF
                AnimationName     = DUDain_IDLD
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            Animation           = IDLF
                AnimationName     = DUDain_IDLE
                AnimationMode     = ONCE
                AnimationPriority = 2
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End


        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    DUDain_FLYA
                AnimationName                =    DUDain_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED
            Animation                        =    DUDain_LNDA
                AnimationName                =    DUDain_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING
            Animation                        =    DUDain_DTHA
                AnimationName                =    DUDain_DTHA
                AnimationMode                =    ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = DUDain_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    DUDain_GTPA
                AnimationName                =    DUDain_GTPA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    DUDainDUDainLNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = DUDain_RUNB
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUDain_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName     = DUDain_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    DUDain_RUNB
                AnimationName                =    DUDain_RUNB
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10

            End
        End

        AnimationState                        =    MOVING
            Animation                        =    DUDain_RUNA
                AnimationName                =    DUDain_RUNA
                AnimationMode                =    LOOP

            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = DUDain_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = DUDain_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    DUDain_CHRA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    DUDain_TNTA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    DUDain_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    DUDain_CHRA
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    DUDain_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    DUDain_ATNA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    DUDain_ATNC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    DUDain_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    DUDain_ATNC
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    DUDain_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    DUDain_ATNC
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End
    End


    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING DECELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                  = Dwarves
    EditorSorting         = UNIT
    ThreatLevel           = DAIN_THREAT_LEVEL
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    BuildCost             = DAINDAG_COST
    BuildTime             = STRONG_HERO_BUILDTIME
    ShockwaveResistance   = SHOCKWAVE_RESISTANCE_STRONG
    DisplayMeleeDamage    = DAINDAG_DAMAGE
    Scale                 = 0.88
    HeroSortOrder         = 40

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY  DwarvenDainAxeMod
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions            = WEAPONSET_TOGGLE_3
        Weapon                = PRIMARY        DwarvenDainAxeMod_RoteAxt
        Weapon                = SECONDARY      DwarvenDainAxeMod
        OnlyAgainst           = SECONDARY      STRUCTURE
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions        = None
        Armor             = StrongHeroArmor
        DamageFX          = NormalDamageFX
    End

    ArmorSet
        Conditions        = MOUNTED
        Armor             = StrongHeroArmorMounted
        DamageFX          = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE
        Armor             = VeryStrongHeroArmor
        DamageFX          = NormalDamageFX
    End

    ArmorSet
        Conditions        = PLAYER_UPGRADE MOUNTED
        Armor             = VeryStrongHeroArmorMounted
        DamageFX          = NormalDamageFX
    End

    VisionRange         = 250
    ShroudClearingRange = 360

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     	= DWARVEN_DAIN_BOUNTY_VALUE
    DisplayName     	= OBJECT:DwarvenDain
    RecruitText     	= CONTROLBAR:DwarvenDainRecruit
    ReviveText      	= CONTROLBAR:DwarvenDainRevive
    Hotkey          	= CONTROLBAR:DwarvenDainHotkey
    CrusherLevel    	= 0
    MountedCrusherLevel = 1
    CrushableLevel      = 2
    MountedCrushableLevel = 2

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CommandSet    = DainCommandSetMod
    CommandPoints = 0


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_DainBody

    AutoResolveArmor
        Armor = AutoResolve_DainArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DainWeapon
    End

    AutoResolveLeadership = AutoResolve_DainBonus




    VoiceAttack							= DainIHVoiceAttack
	VoiceAttackCharge				= DainIHVoiceAttackCharge
	VoiceAttackMachine						= DainIHVoiceAttack
	VoiceAttackStructure					= DainIHVoiceAttackBuilding
	VoiceFear 							= DainIHVoiceHelpMe
	VoiceGuard							= DainIHVoiceMove
	VoiceMove							= DainIHVoiceMove
	VoiceMoveToCamp							= DainIHVoiceMoveCamp
	VoiceMoveWhileAttacking					= DainIHVoiceDisengage
	VoicePriority							= 72
	VoiceRetreatToCastle					= DainIHVoiceRetreat
	VoiceSelect							= DainIHVoiceSelect
	VoiceSelectBattle 					= DainIHVoiceSelectBattle

	SoundImpact							= ImpactHorse

	UnitSpecificSounds
		VoiceGarrison					= DainIHVoiceMoveGarrison
		VoiceEnterUnitElvenTransportShip	= DainIHVoiceMoveShip
		VoiceInitiateCaptureBuilding		= DainIHVoiceCaptureBuilding
		VoiceInitiateCaptureBuilding           = DainHobbitVoiceMove
	End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove        = DainHobbitVoiceMove
            VoiceSelect        = DainHobbitVoiceSelect
            SoundMoveLoop    = DainBoarVoxAmbientLoop
        End
    End

    CrowdResponseKey = DwarfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Unit Infantry Hero
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:DUDain_SKL.DUDain_RUNA    Frames:3 14
        AnimationSound = Sound:FootstepDirtA            Animation:DUDain_SKL.DUDain_RUNB    Frames:3 12
        AnimationSound = Sound:BodyFallSoldier          Animation:DUDain_SKL.DUDain_LNDA    Frames:4
        AnimationSound = Sound:BodyFallSoldier          Animation:DUDain_SKL.DUDain_DIEA    Frames:11
        AnimationSound = Sound:BodyFallSoldier          Animation:DUDain_SKL.DUDain_DIEC    Frames:59
        AnimationSound = Sound:BodyFallSoldier          Animation:DUDAIN_SKL.DUDAIN_DTHA    Frames:73
        AnimationSound = Sound:SwordIntoGroundQuiet     Animation:DUDAIN_SKL.DUDAIN_IDLE    Frames:61
        AnimationSound = Sound:TauntHumanHitShield      Animation:DUDAIN_SKL.DUDAIN_SPCA    Frames:25 50
        AnimationSound = Sound:TauntHumanHitShield      Animation:DUDAIN_SKL.DUDAIN_TNTA    Frames:28 43

        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_RUNA     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TNL1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TNR1     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TRNL     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_TRNR     Frames:0
        AnimationSound = Sound:WargMoveFootsteps        Animation:KUOrcRider_ACCL     Frames:0
        AnimationSound = Sound:WargTauntFootstep        Animation:KUOrcRider_TNTA     Frames:7 12 64 73
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNTA     Frames:25
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RUNA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNL1     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_TNR1     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ACCL     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ATNA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_ATND     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_GTPA     Frames:5 101
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_HWLA     Frames:15
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RDYA     Frames:5
        AnimationSound = Sound:WargSaddleFoleySingles   Animation:KUOrcRider_RDYB     Frames:5
        AnimationSound = Sound:BodyFallOrc              Animation:KUOrcRider_DIEB     Frames:10
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:KUOrcRider_DIEB     Frames:45
        AnimationSound = Sound:BodyFallOrc              Animation:KUOrcRider_LNDA     Frames:1 17
        AnimationSound = Sound:BodyFallGeneric1         Animation:KUOrcRider_DIEC     Frames:16
        AnimationSound = Sound:BodyFallGeneric1         Animation:KUOrcRider_DIEC     Frames:30
        AnimationSound = Sound:BoarWhinny               Animation:KUOrcRider_TNTA     Frames:7
        AnimationSound = Sound:BoarWhinny               Animation:KUOrcRider_DIEC     Frames:6
    End


    RadarPriority    = UNIT
    KindOf           = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT HERO ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = DelayedDeathBody ModuleTag_DelayedDeathBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = DAINDAG_HEALTH
        MaxHealthDamaged                = 2000
        MaxHealthReallyDamaged          = 100
        PermanentlyKilledByFilter       = NONE
	    DodgePercent                 = HERO_DODGE_PERCENT
    End

    Behavior = LifetimeUpdate ModuleTag_LifeTime
        WaitForWakeUp = Yes
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                      = DYING
        DeathFX                        = FX_DainDieToRespawn
        DeathAnimationTime             = 4100
        RespawnAnim                    = LEVELED
        RespawnAnimationTime           = 2000
        AutoRespawnAtObjectFilter      = NONE +CASTLE_KEEP
        ButtonImage                    = HIDainnew2

        RespawnRules =    AutoSpawn:No           Cost:DAINDAG_COST       Time:STRONG_HERO_RESPAWNTIME        Health:100%
   End

     Behavior = AutoHealBehavior ModuleTag_AthelasHealing
        StartsActive                   = Yes
        ButtonTriggered                = Yes
        HealingAmount                  = ATHELAS_HEAL_AMOUNT
        Radius                         = 200
        HealOnlyOthers                 = No
        SingleBurst                    = Yes
        UnitHealPulseFX                = FX_DainMightyRage
        KindOf                         = INFANTRY CAVALRY
    End

    Behavior = AutoHealBehavior ModuleTag_DainHealing
        StartsActive             = Yes
        HealingAmount            = HERO_HEAL_AMOUNT
        HealingDelay             = 1000
        StartHealingDelay        = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat    = Yes
    End

    Behavior = AutoHealBehavior ModuleTag_ElvenGiftHealing
        StartsActive                = No
        TriggeredBy                 = Upgrade_ElvenGift
        HealingAmount               = ELVEN_GIFT_REGEN_AMOUNT
        HealingDelay                = ELVEN_GIFT_REGEN_DELAY
        StartHealingDelay           = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat       = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        HoldGroundCloseRangeDistance    = 60
        AILuaEventsList                 = DwarvenDainIronHillsFunctions
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 200
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = DainRachefeldzugUnitModifier
        AllowFilter             = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End
	
    Behavior = GrantUpgradeCreate ModuleTag_EnableCirithUngol
        UpgradeToGrant      = Upgrade_RoyalguardDisMount
        GiveOnBuildComplete = Yes
    End

    LocomotorSet
        Locomotor = RohanGimliLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_DWARF_HERO_SPEED
    End

    LocomotorSet
        Locomotor = WargLocomotor
        Condition = SET_MOUNTED
        Speed     = 110
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult              = 1.0
        AllowBouncing            = No
        ShockStunnedTimeLow      = 1400
        ShockStunnedTimeHigh     = 2400
        ShockStandingTime        = 2600
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL -KNOCKBACK
        SinkDelay             = 3000
        SinkRate              = 0.40
        DestructionDelay      = 8000
        Sound                 = INITIAL DainVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes            = NONE +KNOCKBACK
        SinkDelay             = 3000
        SinkRate              = 0.40
        DestructionDelay      = 8000
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
        TauntAndPointUpdateDelay     =    1000
        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2200
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 1.0
        HitReactionThreshold2 = 2500.0
        HitReactionThreshold3 = 5000.0
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate = SpecialAbilityDainBarukKhazad
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate      = SpecialAbilityDainBarukKhazad
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        AttributeModifier 	  = DwarvenDainLangerMarsch
        AttributeModifierRange    = 180
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects  = DWARF_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY
        AttributeModifierFX 	  = FX_DainLongMarchAura
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1
        SpecialPowerTemplate    = SpecialAbilityDainBarukKhazad
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
    End

    Behavior = AutoAbilityBehavior ModuleTag_BladeOfPurityAutoAbility
		SpecialAbility		= SpecialAbilityDainBarukKhazad
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= 200
		Query			= 5 ALL ENEMIES
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainLeadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                 = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_DainLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = Yes
        BonusName        = DainBonusIronHills
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = DWARF_LEADERSHIP_UNITS_OBF ;GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FactionLeaderLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_FactionLeaderLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FactionLeaderLeadership
        StartsActive     = Yes
        BonusName        = FactionLeaderGlobalLeadership
        RefreshDelay     = 2000
        Range            = 625
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EberEnabler
        SpecialPowerTemplate       = SpecialAbilityToggleMounted
        TriggeredBy                = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_EberToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes
         StartsPaused              = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_EberToggle
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UnpackTime                = GOOD_MOUNT_TIME
         PreparationTime           = 1
         PersistentPrepTime        = 250
         PackTime                  = GOOD_MOUNT_TIME
         OpacityTarget             = .3
         AwardXPForTriggering      = 0
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DainSummonEnabler
        SpecialPowerTemplate     = SpecialAbilityDainSummonRoyalGuard
        TriggeredBy              = Upgrade_Level_3
    End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPower
        SpecialPowerTemplate     = SpecialAbilityDainSummonRoyalGuard
        OCL                      = OCL_SpawnDainDwarvenEgg
        CreateLocation           = CREATE_AT_LOCATION
        TriggerFX                = FX_BalinExpedition
        StartsPaused             = Yes
    End






    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = DainRachefeldzugWeapon
            FireDelay  = 0
            OneShot    = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_RachefeldzugEnabler
        SpecialPowerTemplate     = SpecialAbilityKingofDunharg
        TriggeredBy              = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_RachefeldzugStarter
        SpecialPowerTemplate     = SpecialAbilityKingofDunharg
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
		TriggerFX              = FX_IndestructibleWill
		;TriggerSound	= ToTheKing
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_RachefeldzugUpdate
        SpecialPowerTemplate     = SpecialAbilityKingofDunharg
        UnpackingVariation       = 1
        UnpackTime               = 1800
        PackTime                 = 1600
        AwardXPForTriggering     = 0
        HeroAttributeModifier    = DainHallenSelfModifier
        HeroEffectDuration       = 30000
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_StreitmachtEnabler
        SpecialPowerTemplate     = SpecialAbilityStreitmachtderZwergenreiche
        TriggeredBy              = Upgrade_Level_10
    End

    Behavior = OCLSpecialPower ModuleTag_StreitmachtOCLSpecialPower
        SpecialPowerTemplate     = SpecialAbilityStreitmachtderZwergenreiche
        OCL                      = OCL_SpawnDwarvenEgg
        CreateLocation           = CREATE_AT_LOCATION
        TriggerFX                = FX_BalinExpedition
        StartsPaused             = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EisenbergeEnabler
        SpecialPowerTemplate     = SpecialAbilitySalemeSpawnHasharin
        TriggeredBy              = Upgrade_Level_10
    End

    Behavior = OCLSpecialPower ModuleTag_EisenbergeOCLSpecialPower
        SpecialPowerTemplate     = SpecialAbilitySalemeSpawnHasharin
        OCL                      = OCL_SpawnBeistandEisenbergeEgg
        CreateLocation           = CREATE_AT_LOCATION
        TriggerFX                = FX_BalinExpedition
        StartsPaused             = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate = SpecialAbilityGimliHeroMode
        TriggeredBy 	     = Upgrade_DwarvenMithrilMailHeroes
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        Duration                = 30000
        AttributeModifier       = DainIronHillsRedAxe
        WeaponSetFlags          = WEAPONSET_TOGGLE_3
        StartsPaused            = Yes
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = CommandSetUpgrade ModueTag_MithrilMailCommandSet
        TriggeredBy      = Upgrade_DwarvenMithrilMailHeroes
        CommandSet       = DainCommandSetModMithrilMail
    End

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_DwarvenMithrilMailHeroes
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_DwarvenMithrilMailHeroes
        UpgradeTexture  = dudainbotfa.tga 0 dudainbotfa_ha.tga
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MithrilMineKampagne
        SpecialPowerTemplate = SpecialAbilitySpellbookMithrilhemd
        TriggeredBy 	     = Upgrade_ElvenGift
    End

    Behavior = SpecialPowerModule ModuleTag_MithrilMineUpdateKampagne
        SpecialPowerTemplate      = SpecialAbilitySpellbookMithrilhemd
        UpdateModuleStartsAttack  = No
        StartsPaused 		  = Yes
    End

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithrilKampagne
        TriggeredBy     = Upgrade_ElvenGift
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchselKampagne
        TriggeredBy     = Upgrade_ElvenGift
        UpgradeTexture  = dudain.tga 0 dudain_ha.tga
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityDwarvenDainLangerMarsch
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_SpecialAbilityDainEberMount
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate RoyalGuardAI
        CommandButtonName = Command_SpecialAbilityDainSummonBattelwagon
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornOathBreakers
        CommandButtonName = Command_SpecialAbilityStreitmachtderZwergenreiche
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 100.0
    End

    Behavior = AISpecialPowerUpdate IgniteAI
        CommandButtonName = Command_SpecialAbilityRachefeldzug
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate SummonAlliesHotWL1AI
        CommandButtonName = Command_SpecialAbilityStreitmachtderEisenberge
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 5.6
    GeometryMinorRadius = 5.6
    GeometryHeight      = 16.0
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End

ChildObject DwarvenDain DwarvenDain_mod
End