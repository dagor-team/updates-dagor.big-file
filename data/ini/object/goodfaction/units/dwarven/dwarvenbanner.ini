Object DwarvenBanner

    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01

        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        RandomTexture = eudwarfaxe.tga 0 eudwarfaxe.tga
        RandomTexture = eudwarfaxe1.tga 0 eudwarfaxe.tga
        RandomTexture = eudwarfaxe2.tga 0 eudwarfaxe.tga
        RandomTexture = eudwarfgua.tga 0 eudwarfgua.tga
        RandomTexture = eudwarfgua2.tga 0 eudwarfgua.tga
        RandomTexture = eudwarfgua_c.tga 0 eudwarfgua_c.tga
        RandomTexture = eudwarfgua2.tga 0 eudwarfgua_c.tga
        RandomTexture = duphalanx_01.tga 0 duphalanx_01.tga
        RandomTexture = duphalanx_011.tga 0 duphalanx_01.tga
        RandomTexture = duphalanx_012.tga 0 duphalanx_01.tga


        DefaultModelConditionState
            Model               = DUGuaBan_SKN
            Skeleton            = DUAxDBan_SKL
        End

        ModelConditionState = USER_2
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End

        ModelConditionState = USER_3
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End

        ModelConditionState = USER_4
            Model = DUGuaBan_SKN
        End

        ModelConditionState = USER_5
            Model = DUAxDBan_SKN
        End

        ModelConditionState = USER_6
            Model = DUPhaBan_SKN
        End

        ModelConditionState = USER_7
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model = GUBanner_SKN
            Skeleton = GUBanner_SKL
        End

        AnimationState                =    FREEFALL USER_3
            Animation                =    free fall
                AnimationName        =    GUBanner_FLLA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    STUNNED_FLAILING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                = DYING USER_3 DEATH_1
            Animation
                AnimationName        = GUBanner_IDLA
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH USER_3
            Animation
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                = DYING DEATH_1
            Animation
                AnimationName        = DUAxDBan_IDLB
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    DUAxDBan_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    DYING SPLATTED USER_3
            Animation                =    splatted
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    DYING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = DUAxDBan_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP USER_3
            Animation                =    StandUp
                AnimationName        =    GUBanner_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED USER_3
            Animation                =    Land
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
            End
        End






        AnimationState                =    DEATH_2 USER_3
            Animation                =    JustDie
                AnimationName       =    GUBanner_DIEA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = BURNINGDEATH USER_3
            Animation
                AnimationName                = GUBanner_MFDA
                AnimationMode                = LOOP
                Distance                    = 50
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUAxDBan_MFDA
                AnimationMode                = LOOP
                Distance                    = 90
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBanner_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = MOVING BACKING_UP USER_3
            Animation                    = BACKING UP
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
            End
        End


        AnimationState = MOVING ENGAGED USER_3
            Animation = Moving_Engaged
                AnimationName = GUBanner_RUNC
                AnimationMode = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING USER_3
            Animation                =    RunA
                AnimationName        =    GUBanner_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    FIRING_OR_PREATTACK_A USER_3
            Animation                =    AttackA1
                AnimationName        =    GUBanner_ATKA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUAxDBan_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    DUAxDBan_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End



        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = DUAxDBan_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

                AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = DUAxDBan_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUAxDBan_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING ALTERNATE_FORMATION PASSENGER_VARIATION_1
            Animation                = RunningSlowerInAFighterAlternateFormation
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .5 .5
            End
            Flags                    = RANDOMSTART

        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = GUBanner_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID USER_3
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End
        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    DUAxDBan_FERA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID USER_3
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = DUAxDBan_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING USER_3
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = DUAxDBan_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING USER_3
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = DUAxDBan_PNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = ONCE
                AnimationBlendTime        = 74
                AnimationMustCompleteBlend = Yes
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT USER_3
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End

        End
        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = DUAxDBan_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    =    SELECTED USER_3
            StateName                    =    STATE_Selected_User_3
            Animation                    =    AtAttention
                AnimationName            =    GUBanner_ATNB
                AnimationMode            =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_User3" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected3") end
            EndScript
        End



        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = DUAxDBan_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState                    =    USER_3
            StateName                    =    State_User3
            Animation                    =    IdleB
                AnimationName            =    GUBanner_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_User_3" then CurDrawableSetTransitionAnimState("TRANS_Selected3_To_Idle") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    DUAxDBan_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    GUBanner_ATNC
                AnimationMode            =    ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.88

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = GOOD_REGULAR_SWORDS
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = GOOD_REGULAR_SWORDS_HEAVY_ARMOR
        DamageFX        = NormalDamageFX
    End
	Behavior = AttributeModifierUpgrade ModuleTag_MithrilMailBonus
       	TriggeredBy       = Upgrade_DwarvenMithrilMail
       	AttributeModifier = DwarvenMithrilMailBonus
   	End	

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBanner

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = DWARVEN_BANNER_BOUNTY_VALUE

    CommandSet        = EmptyCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 650
        MaxHealthDamaged  = 300
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection



        MorphCondition        = UnitType:DwarvenGuardian                ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenHammertrager            ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenRunenmeister            ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenEreborDefender          ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenMinerMod                ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenGuardian_Summoned       ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenAxeThrower              ModelState:"USER_5"
        MorphCondition        = UnitType:DwarvenAxeThrower_Summoned     ModelState:"USER_5"
        MorphCondition        = UnitType:DwarvenBow                     ModelState:"USER_5"
        MorphCondition        = UnitType:DwarvenPhalanx                 ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenPhalanx_Summoned        ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenKhazadDumWaechter       ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenDaleFighter             ModelState:"USER_3"
        MorphCondition        = UnitType:DwarvenMenOfDale               ModelState:"USER_3"
        MorphCondition        = UnitType:ThalPike                       ModelState:"USER_3"
        MorphCondition        = UnitType:ThalElite                      ModelState:"USER_3"
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

ChildObject DwarvenBanner_Summoned DwarvenBanner
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = DwarvenBanner

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = DAIN_SUMMON_TIMEOUT
        MaxLifetime        = DAIN_SUMMON_TIMEOUT
        DeathType        = FADED
    End
End


Object DwarvenIronHillsBanner

    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01

        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes


        DefaultModelConditionState
            Model    = duironbann_skn
            Skeleton = DUAxDBan_SKL
        End

        ModelConditionState = USER_4
            Model    = duironbann_skn
        End

        ModelConditionState = USER_6
            Model    = duironbann_skn
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model    = duironbann_skn
            Skeleton = GUBanner_SKL
        End



        AnimationState                =    FREEFALL USER_3
            Animation                =    free fall
                AnimationName        =    GUBanner_FLLA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    STUNNED_FLAILING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                = DYING USER_3 DEATH_1
            Animation
                AnimationName        = GUBanner_IDLA
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH USER_3
            Animation
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                = DYING DEATH_1
            Animation
                AnimationName        = DUAxDBan_IDLB
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    DUAxDBan_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    DYING SPLATTED USER_3
            Animation                =    splatted
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    DYING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = DUAxDBan_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP USER_3
            Animation                =    StandUp
                AnimationName        =    GUBanner_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED USER_3
            Animation                =    Land
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
            End
        End






        AnimationState                =    DEATH_2 USER_3
            Animation                =    JustDie
                AnimationName       =    GUBanner_DIEA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = BURNINGDEATH USER_3
            Animation
                AnimationName                = GUBanner_MFDA
                AnimationMode                = LOOP
                Distance                    = 50
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUAxDBan_MFDA
                AnimationMode                = LOOP
                Distance                    = 90
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBanner_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = MOVING BACKING_UP USER_3
            Animation                    = BACKING UP
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
            End
        End


        AnimationState = MOVING ENGAGED USER_3
            Animation = Moving_Engaged
                AnimationName = GUBanner_RUNC
                AnimationMode = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING USER_3
            Animation                =    RunA
                AnimationName        =    GUBanner_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    FIRING_OR_PREATTACK_A USER_3
            Animation                =    AttackA1
                AnimationName        =    GUBanner_ATKA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUAxDBan_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    DUAxDBan_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End



        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = DUAxDBan_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

                AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = DUAxDBan_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUAxDBan_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING ALTERNATE_FORMATION PASSENGER_VARIATION_1
            Animation                = RunningSlowerInAFighterAlternateFormation
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .5 .5
            End
            Flags                    = RANDOMSTART

        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = GUBanner_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID USER_3
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End
        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    DUAxDBan_FERA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID USER_3
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = DUAxDBan_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING USER_3
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = DUAxDBan_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING USER_3
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = DUAxDBan_PNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = ONCE
                AnimationBlendTime        = 74
                AnimationMustCompleteBlend = Yes
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT USER_3
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End

        End
        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = DUAxDBan_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    =    SELECTED USER_3
            StateName                    =    STATE_Selected_User_3
            Animation                    =    AtAttention
                AnimationName            =    GUBanner_ATNB
                AnimationMode            =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_User3" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected3") end
            EndScript
        End



        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = DUAxDBan_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState                    =    USER_3
            StateName                    =    State_User3
            Animation                    =    IdleB
                AnimationName            =    GUBanner_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_User_3" then CurDrawableSetTransitionAnimState("TRANS_Selected3_To_Idle") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    DUAxDBan_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    GUBanner_ATNC
                AnimationMode            =    ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw FX
        ModelConditionState = NONE
            Model           = exdwrunefx
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.93
    ShockwaveResistance          = 35

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainHeavyInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainHeavyInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainHeavyInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBannerIronHills

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 5

    CommandSet        = EmptyCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 600
        MaxHealthDamaged  = 300
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = SubObjectsUpgrade ModuleTag_ROT
        TriggeredBy       = Upgrade_ZwergenschmiedRuhm
        ShowSubObjects    = ROT
    End

    Behavior = SubObjectsUpgrade ModuleTag_WEIS
        TriggeredBy       = Upgrade_ZwergenschmiedReichtum
        ShowSubObjects    = WEIS
    End

    Behavior = SubObjectsUpgrade ModuleTag_BLAU
        TriggeredBy       = Upgrade_ZwergenschmiedSchutz
        ShowSubObjects    = BLAU
    End

    Behavior = SubObjectsUpgrade ModuleTag_GOLD
        TriggeredBy       = Upgrade_ZwergenschmiedEhre
        ShowSubObjects    = GOLD
    End



    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe02
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        UpgradeTexture    = EUDwarfGua_r.tga 0 eudwarfgua_rHA.tga
        UpgradeTexture    = EUDwarfGua_fire.tga 0 eudwarfgua_rHA.tga
        RecolorHouse      = No
        ExcludeSubobjects = Forged_Blade REDAXE
    End


    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeGuardian
        TriggeredBy       = Upgrade_DwarvenMithrilMail
        UpgradeTexture    = EUDwarfGua_r.tga 0 eudwarfgua_rHI.tga
        UpgradeTexture    = EUDwarfGua_fire.tga 0 eudwarfgua_rHI.tga
        RecolorHouse      = No
        ExcludeSubobjects = Forged_Blade REDAXE
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection



        MorphCondition        = UnitType:DwarvenGuardianIronHills              ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenPhalanxIronHills               ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenCrossbowIronHills              ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenIronBreaker                      ModelState:"USER_4"
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End



Object DwarvenEreborBanner

    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = duerbnr_skn
            Skeleton            = GUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model               = duerbnr_skn
            Skeleton            = GUBanner_SKL
        End



        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUArcher_IDLA
                AnimationMode                = LOOP
            End
        End





        AnimationState                        = PASSENGER
            Animation                        = Wiggle
                AnimationName                = GUBanner_FLLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = GUBanner_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    GUBanner_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUBanner_ATRA
                AnimationMode       = LOOP

            End
            Flags               = RANDOMSTART
        End





        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = GUBanner_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = DYING BURNINGDEATH DEATH_1
            Animation
                AnimationName    = GUBanner_DIEA
                AnimationMode    = ONCE
                AnimationBlendTime = 10

            End
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation           = LNDA
                AnimationName     = GUBanner_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_1
            Animation           = DIEA
                AnimationName     = GUBanner_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation           = ByeBye
                AnimationName     = GUBanner_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = GUBanner_MFDA
                AnimationMode    = LOOP
                Distance        = 40
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUBanner_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUBanner_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUBanner_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = GUBanner_RUNC
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = GUBanner_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End













        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End


        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = GUBanner_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    RURrmBnr_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    RURrmBnr_ATNC
                AnimationMode            =    ONCE
            End
        End


    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.72
    ShockwaveResistance          = 35

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainHeavyInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainHeavyInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainHeavyInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBannerIronHills

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 5

    CommandSet        = EmptyCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 600
        MaxHealthDamaged  = 300
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection

    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        ShowSubObjects    = ARMOR
        UpgradeTexture    = duersoldier.tga 0 duersoldier_ha.tga
        RecolorHouse      = No
        ExcludeSubobjects = Forged_Blade MASK
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object DwarvenBreitschulternBanner


    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01

        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model     = duelban_skn
            Skeleton  = IUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model     = duelban_skn
            Skeleton  = IUBanner_SKL
        End

        ModelConditionState = USER_4
            Model     = duelban_skn
            Skeleton  = IUBanner_SKL
        End

        ModelConditionState = USER_6
            Model     = duelban_skn
            Skeleton  = IUBanner_SKL
        End

		IdleAnimationState
			Animation = IDLD
				AnimationName = IUBanner_IDLD
				AnimationMode = ONCE
				AnimationPriority = 5
				AnimationBlendTime  = 15
			End
			Flags               = RESTART_ANIM_WHEN_COMPLETE
			StateName = Idle
		    BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "CloseRange"	then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
				if Prev == "STATE_Selected"	then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") return end
			EndScript
		End

		AnimationState							= PASSENGER
			Animation							= Grabbed
				AnimationName					= IUBanner_FLLA
				AnimationMode					= LOOP
			End
		End

		AnimationState							= FREEFALL
			Animation							= Falling
				AnimationName					= IUBanner_FLYB
				AnimationMode					= LOOP
				AnimationBlendTime				= 10
			End
		End





					AnimationState						= CLIMBING
						StateName						= STATE_Climbing
						Animation						= Climbing
							AnimationName				= MUCorBnr_WALB
							AnimationMode				= LOOP
							AnimationBlendTime			= 10
						End
						BeginScript
							Prev = CurDrawablePrevAnimationState()
							if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing") return end
							if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToClimbing") return end
						EndScript
					End
					TransitionState = Trans_RunningToClimbing
						Animation = Transition
							AnimationName = MUCorBnr_WALA
							AnimationMode = ONCE
						End
					End

					AnimationState						= RAPPELLING
						StateName						= STATE_Rappelling
						Animation						= Rapelling
							AnimationName				= MUCorBnr_WALD
							AnimationMode				= LOOP
							AnimationBlendTime			= 10
						End
						BeginScript
							Prev = CurDrawablePrevAnimationState()
							if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToRappelling") return end
							if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
						EndScript
					End
					TransitionState = Trans_RunningToRappelling
						Animation = Transition
							AnimationName = MUCorBnr_WALC
							AnimationMode = ONCE
						End
					End


		AnimationState 							= STUNNED_FLAILING
 			Animation 							= Flying
				AnimationName 					= IUBanner_FLYB
	      			AnimationMode 					= LOOP
			End
      			Flags = RANDOMSTART
    		End

			AnimationState			= DYING BURNINGDEATH
				Animation
					AnimationName	= IUBanner_DIEA
					AnimationMode	= ONCE
					AnimationBlendTime = 10
				End
				Animation
					AnimationName	= IUBanner_DIEB
					AnimationMode	= ONCE
					AnimationBlendTime = 10
				End
				Animation
					AnimationName	= IUBanner_DIEC
					AnimationMode	= ONCE
					AnimationBlendTime = 10
				End
			End

    		AnimationState							= DYING SPLATTED
 			Animation						= Splattered_On_Ground_1
				AnimationName					= IUBanner_LNDA
				AnimationMode					= ONCE
			End
    		End

     AnimationState = DYING AFLAME
			Animation = Flaming_Death
	      AnimationName = MUHarOvr_MFDA
		    AnimationMode = ONCE
			End
    End

    AnimationState = DYING WEAPONSTATE_CLOSE_RANGE
			Animation = Dying_1
	      AnimationName = IUBanner_DIEC
		    AnimationMode = ONCE
			End
			Animation = Dying_2
	      AnimationName = IUBanner_DIED
		    AnimationMode = ONCE
			End
    End

    AnimationState = DYING
			Animation = Dying_1
	      AnimationName = IUBanner_DIEA
		    AnimationMode = ONCE
			End
			Animation = Dying_2
	      AnimationName = IUBanner_DIEB
		    AnimationMode = ONCE
			End
    End

	AnimationState			= BURNINGDEATH
		Animation
			AnimationName	= IUBanner_MFDA
			AnimationMode	= LOOP
			Distance		= 40
		End
	End

	AnimationState						= PARALYZED
		Animation
			AnimationName				= IUBanner_IDLA
			AnimationMode				= LOOP
		End
	End

	AnimationState  = COMING_OUT_OF_FACTORY
		Animation = Being_Built
			AnimationName		= IUBanner_RUNB
			AnimationMode		= LOOP
			AnimationBlendTime	= 0
		End
	End



	AnimationState = MOVING FIRING_OR_PREATTACK_A
		Animation = TrotAndFire
			AnimationName = IUBanner_RUNB
			AnimationMode = LOOP
		End
		Flags = RANDOMSTART
    End


	AnimationState = MOVING BACKING_UP
		Animation				= BackingUp
			AnimationName		= IUBanner_BAKA
			AnimationMode		= LOOP
			AnimationSpeedFactorRange 1.5 1.5
		End
		Flags = RANDOMSTART
	End

	AnimationState = MOVING EMOTION_TERROR
		Animation = Moving
			AnimationName = IUBanner_RUNA
		    AnimationMode = LOOP
		End
		StateName = Moving
		Flags = RANDOMSTART
    End

	AnimationState				=	MOVING DAMAGED
		Flags					=	RANDOMSTART
		Animation				=	IWKA
			AnimationName		=	IUBanner_IWKA
			AnimationMode		=	LOOP
		End
	End

    AnimationState = MOVING
			Animation = Moving
	      AnimationName = IUBanner_RUNA
		    AnimationMode = LOOP
			End
			StateName = Moving
			Flags = RANDOMSTART

						BeginScript
							Prev = CurDrawablePrevAnimationState()
							if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRunning") return end
							if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToRunning") return end
						EndScript

    End
						TransitionState = Trans_ClimbingToRunning
							Animation = Transition
								AnimationName = MUCorBnr_WALC
								AnimationMode = ONCE
							End
						End
						TransitionState = Trans_RappellingToRunning
							Animation = Transition
								AnimationName = MUCorBnr_WALE
								AnimationMode = ONCE
							End
						End

	AnimationState = STUNNED_STANDING_UP
 			Animation = Standing_Back_Up
				AnimationName = IUBanner_GTPA
	      AnimationMode = ONCE
	      AnimationSpeedFactorRange = 1.5 1.5
			End
    End

    AnimationState = STUNNED
 			Animation = Splattered_On_Ground_1
				AnimationName = IUBanner_LNDA
	      AnimationMode = ONCE
			End
    End



    TransitionState = Trans_Idle_To_Sword
			Animation = Transition
	      AnimationName = IUBanner_STHA
		    AnimationMode = ONCE
			End
    End

    TransitionState = Trans_Moving_To_Sword
			Animation = Transition
			  AnimationName = IUBanner_STHC
				AnimationMode = ONCE
			End
    End

    TransitionState = Trans_Sword_To_Idle
		Animation = Transition
			AnimationName = IUBanner_STHB
		    AnimationMode = ONCE
		End
    End





	AnimationState = FIRING_OR_PREATTACK_A
		Animation = ATKA1
			AnimationName = IUBanner_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		StateName = CloseRange
	End

	AnimationState = FIRING_OR_PREATTACK_A USER_4
		Animation = ATKA1
			AnimationName = IUBanner_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		StateName = CloseRange
	End

	AnimationState = FIRING_OR_PREATTACK_A USER_6
		Animation = ATKA1
			AnimationName = IUBanner_ATKA
			AnimationMode = ONCE
			UseWeaponTiming		= Yes
		End
		StateName = CloseRange
	End

    AnimationState = WAR_CHANT
		Animation = Chant
			AnimationName = IUBanner_IDLC
			AnimationMode = LOOP
		End
	End

	AnimationState							= EMOTION_AFRAID
		Animation							= FERA
			AnimationName					= IUBanner_FERA
			AnimationMode					= LOOP
		End
		Flags = RANDOMSTART
	End
	AnimationState							= EMOTION_TAUNTING
		Animation							= TNTA
			AnimationName					= IUBanner_IDLC
			AnimationMode					= LOOP
		End
	End

	AnimationState							= EMOTION_CELEBRATING
		Animation                           = CHRA
			AnimationName					= IUBanner_CHRA
			AnimationMode					= ONCE
		End
	End

	AnimationState							= EMOTION_ALERT
		Animation							= ALERT
			AnimationName					= IUBanner_IDLB
			AnimationMode					= LOOP
		End
		Flags								= RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
	End

    AnimationState = WEAPONSTATE_CLOSE_RANGE
 		Animation = Close_Range_Idle
				AnimationName = IUBanner_IDLB
				AnimationMode = ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "Moving" then CurDrawableSetTransitionAnimState("Trans_Moving_To_Sword") return end
			if Prev == "Idle"   then CurDrawableSetTransitionAnimState("Trans_Idle_To_Sword") return end
		EndScript
		StateName = CloseRange
    End

	AnimationState							= RAISING_FLAG
		Animation                           = CHRA
			AnimationName					= IUBanner_CHRA
			AnimationMode					= LOOP
		End
	End

   	AnimationState        = SELECTED
		StateName           = STATE_Selected
		Animation = IDLA
			AnimationName = IUBanner_IDLA
			AnimationMode = LOOP
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
			if Prev == "CloseRange"	then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
		EndScript
	End



	TransitionState					=	TRANS_Idle_to_Selected
		Animation					=	ATNA
			AnimationName			=	IUBanner_ATNA
			AnimationMode			=	ONCE
		End
	End

	TransitionState					=	TRANS_Selected_to_Idle
		Animation					=	ATNB
			AnimationName			=	IUBanner_ATNB
			AnimationMode			=	ONCE
		End
	End


	TransitionState					=	TRANS_Idle_to_Selected2
		Animation					=	ATNA
			AnimationName			=	IUWargBnr_ATND
			AnimationMode			=	ONCE
		End
	End

	TransitionState					=	TRANS_Selected_to_Idle2
		Animation					=	ATNA
			AnimationName			=	IUWargBnr_ATNE
			AnimationMode			=	ONCE
		End
	End
End

	Draw = W3DScriptedModelDraw DustEffects
	    DefaultModelConditionState
	      Model = None
	    End
	    IdleAnimationState
	    End
	    AnimationState = WADING
			ParticleSysBone = None FootstepSlash
	    End
	    AnimationState = MOVING ACCELERATE USER_2
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState = MOVING DECELERATE USER_2
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState = MOVING ACCELERATE
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState = MOVING DECELERATE
			ParticleSysBone = None GenericSiegeTrailDust
	    End
	    AnimationState = MOVING EMOTION_TERROR
	    End
	    AnimationState = MOVING
	    End
	End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.75
    ShockwaveResistance          = 35

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainHeavyInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainHeavyInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainHeavyInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBannerEredLuin

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 6

    CommandSet        = DwarvenGuardianBreitschulternCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:IUBanner_SKL.IUBanner_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:IUBanner_SKL.IUBanner_DIEB     Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 600
        MaxHealthDamaged  = 300
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection



        MorphCondition        = UnitType:DwarvenGuardianBreitschultern      ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenEreborDefender              ModelState:"USER_4"
        MorphCondition        = UnitType:DwarvenPhalanxBreitschultern       ModelState:"USER_6"
        MorphCondition        = UnitType:DwarvenCrossbow                    ModelState:"USER_6"
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End


    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        ShowSubObjects    = ERLN_H_ARMOR
        HideSubObjects    = ERLN_H1 ERLN_H2 ERLN_H3
        UpgradeTexture    = duelsoldier.tga 0 duelsoldier_ha.tga
        RecolorHouse      = Yes
        ExcludeSubobjects = Forged_Blade AXE02
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End



Object ThalBanner


    SelectPortrait         = UPThalSword

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = DUGuaBan_SKN
            Skeleton            = DUAxDBan_SKL
        End

        ModelConditionState = USER_2
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End

        ModelConditionState = USER_3
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End


        ModelConditionState = USER_4
            Model = DUGuaBan_SKN
        End


        ModelConditionState = USER_5
            Model = DUAxDBan_SKN
        End


        ModelConditionState = USER_6
            Model = DUPhaBan_SKN
        End

        ModelConditionState = USER_7
            Model = DUDALEBN
            Skeleton = GUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model = GUBanner_SKN
            Skeleton = GUBanner_SKL
        End



        AnimationState                =    FREEFALL USER_3
            Animation                =    free fall
                AnimationName        =    GUBanner_FLLA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    STUNNED_FLAILING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                = DYING USER_3 DEATH_1
            Animation
                AnimationName        = GUBanner_IDLA
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH USER_3
            Animation
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                = DYING DEATH_1
            Animation
                AnimationName        = DUAxDBan_IDLB
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    DUAxDBan_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    DYING SPLATTED USER_3
            Animation                =    splatted
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    DYING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = DUAxDBan_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP USER_3
            Animation                =    StandUp
                AnimationName        =    GUBanner_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED USER_3
            Animation                =    Land
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
            End
        End






        AnimationState                =    DEATH_2 USER_3
            Animation                =    JustDie
                AnimationName       =    GUBanner_DIEA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = BURNINGDEATH USER_3
            Animation
                AnimationName                = GUBanner_MFDA
                AnimationMode                = LOOP
                Distance                    = 50
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUAxDBan_MFDA
                AnimationMode                = LOOP
                Distance                    = 90
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBanner_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = MOVING BACKING_UP USER_3
            Animation                    = BACKING UP
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
            End
        End


        AnimationState = MOVING ENGAGED USER_3
            Animation = Moving_Engaged
                AnimationName = GUBanner_RUNC
                AnimationMode = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING USER_3
            Animation                =    RunA
                AnimationName        =    GUBanner_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    FIRING_OR_PREATTACK_A USER_3
            Animation                =    AttackA1
                AnimationName        =    GUBanner_ATKA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUAxDBan_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    DUAxDBan_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End



        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = DUAxDBan_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

                AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = DUAxDBan_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUAxDBan_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING ALTERNATE_FORMATION PASSENGER_VARIATION_1
            Animation                = RunningSlowerInAFighterAlternateFormation
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .5 .5
            End
            Flags                    = RANDOMSTART

        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = GUBanner_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID USER_3
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End
        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    DUAxDBan_FERA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID USER_3
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = DUAxDBan_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING USER_3
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = DUAxDBan_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING USER_3
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = DUAxDBan_PNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = ONCE
                AnimationBlendTime        = 74
                AnimationMustCompleteBlend = Yes
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT USER_3
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End

        End
        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = DUAxDBan_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    =    SELECTED USER_3
            StateName                    =    STATE_Selected_User_3
            Animation                    =    AtAttention
                AnimationName            =    GUBanner_ATNB
                AnimationMode            =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_User3" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected3") end
            EndScript
        End



        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = DUAxDBan_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState                    =    USER_3
            StateName                    =    State_User3
            Animation                    =    IdleB
                AnimationName            =    GUBanner_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_User_3" then CurDrawableSetTransitionAnimState("TRANS_Selected3_To_Idle") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    DUAxDBan_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    GUBanner_ATNC
                AnimationMode            =    ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    ShockwaveResistance          = 25

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainHeavyInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainHeavyInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainHeavyInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBanner

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 5
    CommandSet        = EmptyCommandSet




    VoiceAttack                             = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackCharge                       = MenOfDaleInfantryVoiceAttackChargeSwordsmen
    VoiceAttackMachine                      = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackStructure                    = MenOfDaleVoiceAttackBuilding
    VoiceCreated                            = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceFullyCreated                       = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceGuard                              = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMove                               = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveToCamp                         = MenOfDaleVoiceMoveCamp
    VoiceMoveToHigherGround                 = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveWhileAttacking                 = MenOfDaleInfantryVoiceDisengageSwordsmen
    VoicePriority                           = 45
    VoiceRetreatToCastle                    = MenOfDaleVoiceRetreat
    VoiceSelect                             = MenOfDaleVoiceSelectMSSwordsmen
    VoiceSelectBattle                       = MenOfDaleInfantryVoiceSelectBattleSwordsmen

    VoiceEnterStateAttack                   = MenOfDaleInfantryVoiceEnterStateAttackSwordsmen
    VoiceEnterStateAttackCharge             = MenOfDaleInfantryVoiceEnterStateAttackChargeSwordsmen
    VoiceEnterStateAttackMachine            = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure          = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                     = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveToCamp               = MenOfDaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveToHigherGround       = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveWhileAttacking       = MenOfDaleInfantryVoiceEnterStateDisengageSwordsmen
    VoiceEnterStateRetreatToCastle          = MenOfDaleVoiceEnterStateRetreat


    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceCreatedFromInn                 = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceEnterUnitElvenTransportShip    = MenOfDaleVoiceMoveShip
        VoiceFullyCreatedFromInn            = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceGarrison                       = MenOfDaleInfantryVoiceMoveGarrisonSwordsmen
        VoiceInitiateCaptureBuilding        = MenOfDaleVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 500
        MaxHealthDamaged  = 250
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection



        MorphCondition        = UnitType:DwarvenDaleFighter             ModelState:"USER_3"
        MorphCondition        = UnitType:DwarvenMenOfDale               ModelState:"USER_3"
        MorphCondition        = UnitType:ThalPike                       ModelState:"USER_3"
        MorphCondition        = UnitType:ThalElite                      ModelState:"USER_3"
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1 TUBE01
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object DwarvenLaketownBanner



    SelectPortrait         =    UPLaketownSwordmen

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model    = dulaketown_bnr
            Skeleton = RUTheoden_SKL
        End




        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING
            Animation                        =    RUTheoden_DIEA
                AnimationName                =    RUTheoden_DIEA
                AnimationMode                =    ONCE
            End
            Animation                        =    RUTheoden_DIEB
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUTheoden_SPCB
                AnimationSpeedFactorRange    =    1.1666 1.1666
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
            Animation                        =    SPCD
                AnimationName                =    RUTheoden_SPCC
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    ShockwaveResistance          = 25

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    ShroudClearingRange = 475
    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    DisplayName = OBJECT:DwarvenGeneral

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = 800
    BuildTime         = STRONG_BUILDTIME
    BountyValue       = 5
    CommandSet        = EmptyCommandSet




    VoiceAttack                             = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackCharge                       = MenOfDaleInfantryVoiceAttackChargeSwordsmen
    VoiceAttackMachine                      = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackStructure                    = MenOfDaleVoiceAttackBuilding
    VoiceCreated                            = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceFullyCreated                       = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceGuard                              = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMove                               = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveToCamp                         = MenOfDaleVoiceMoveCamp
    VoiceMoveToHigherGround                 = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveWhileAttacking                 = MenOfDaleInfantryVoiceDisengageSwordsmen
    VoicePriority                           = 45
    VoiceRetreatToCastle                    = MenOfDaleVoiceRetreat
    VoiceSelect                             = MenOfDaleVoiceSelectMSSwordsmen
    VoiceSelectBattle                       = MenOfDaleInfantryVoiceSelectBattleSwordsmen

    VoiceEnterStateAttack                   = MenOfDaleInfantryVoiceEnterStateAttackSwordsmen
    VoiceEnterStateAttackCharge             = MenOfDaleInfantryVoiceEnterStateAttackChargeSwordsmen
    VoiceEnterStateAttackMachine            = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure          = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                     = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveToCamp               = MenOfDaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveToHigherGround       = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveWhileAttacking       = MenOfDaleInfantryVoiceEnterStateDisengageSwordsmen
    VoiceEnterStateRetreatToCastle          = MenOfDaleVoiceEnterStateRetreat


    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceCreatedFromInn                 = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceEnterUnitElvenTransportShip    = MenOfDaleVoiceMoveShip
        VoiceFullyCreatedFromInn            = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceGarrison                       = MenOfDaleInfantryVoiceMoveGarrisonSwordsmen
        VoiceInitiateCaptureBuilding        = MenOfDaleVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA           Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27
        AnimationSound = Sound:TauntHumanHitShield     Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier         Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 500
        MaxHealthDamaged  = 250
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority             =     AttackPriority_Infantry
        AILuaEventsList            =    GondorFighterFunctions
        BurningDeathTime           =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = DwarfGuardianVoiceBullRush
    End


    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = 50
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 50
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate              = 15000
        MeleeFreeUnitSpawnTime     = 30000
        DiedRespawnTime            = 15000
        MeleeFreeBannerReSpawnTime = 30000

        BannerMorphFX              = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX                = FX_HordeResurrection
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End



    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object DwarvenThalBanner



    SelectPortrait         =    UPThalSwordmen

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model    = dudale_gen
            Skeleton = RUTheoden_SKL
        End




        IdleAnimationState
            StateName                =    BORED
            Animation                =    IDLB
                AnimationName        =    RUTheoden_IDLB
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Animation                =    IDLD
                AnimationName        =    RUTheoden_IDLD
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Animation                =    IDLE
                AnimationName        =    RUTheoden_IDLE
                AnimationMode        =    ONCE
                AnimationPriority    =    1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToBored") end
                if Prev == "READY"        then CurDrawableSetTransitionAnimState("Transition_ReadyToBored") end
            EndScript
        End

        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUTheoden_FLYA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                        =    STUNNED_FLAILING
            Flags                            =    RANDOMSTART
            Animation                        =    RUTheoden_FLYA
                AnimationName                =    RUTheoden_FLYA
                AnimationMode                =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
        End


        AnimationState                        =    DYING SPLATTED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End
        AnimationState                        =    DYING
            Animation                        =    RUTheoden_DIEA
                AnimationName                =    RUTheoden_DIEA
                AnimationMode                =    ONCE
            End
            Animation                        =    RUTheoden_DIEB
                AnimationName                =    RUTheoden_DIEB
                AnimationMode                =    ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUTheoden_IDLB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End



        AnimationState                        =    STUNNED_STANDING_UP
            Animation                        =    RUTheoden_GTPA
                AnimationName                =    RUTheoden_GTPA
                AnimationMode                =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState                        =    STUNNED
            Animation                        =    RUTheoden_LNDA
                AnimationName                =    RUTheoden_LNDA
                AnimationMode                =    ONCE
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUTheoden_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        =    FIRING_OR_PREATTACK_A
            Animation                        =    ATKA
                AnimationName                =    RUTheoden_ATKA
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKB
                AnimationName                =    RUTheoden_ATKB
                AnimationMode                =    ONCE

            End
            Animation                        =    ATKC
                AnimationName                =    RUTheoden_ATKC
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
            Animation                        =    ATKD
                AnimationName                =    RUTheoden_ATKD
                AnimationMode                =    ONCE
                UseWeaponTiming                =    Yes

            End
        End

        AnimationState                        =    MOVING ATTACKING
            Animation                        =    RUTheoden_RUNB
                AnimationName                =    RUTheoden_RUNB
                AnimationSpeedFactorRange    =    0.4 0.4
                AnimationMode                =    LOOP
                AnimationBlendTime            =   10
                Distance                    =    30
            End
        End

        AnimationState                        =    MOVING
            Animation                        =    RUTheoden_RUNA
                AnimationName                =    RUTheoden_RUNA
                AnimationMode                =    LOOP
                Distance                    =    30
            End
        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUTheoden_SPCB
                AnimationSpeedFactorRange    =    1.1666 1.1666
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
            Animation                        =    SPCD
                AnimationName                =    RUTheoden_SPCC
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End


        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            Animation                        = Hit_Level_1_a
                AnimationName                = RUTheoden_HITA
                AnimationMode                = ONCE
            End
        End



        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUTheoden_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_ALERT
            StateName                =    READY
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED"        then CurDrawableSetTransitionAnimState("Transition_BoredToReady") end
                if Prev == "SELECTED"    then CurDrawableSetTransitionAnimState("Transition_SelectedToReady") end
            EndScript
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    RUTheoden_CHRA
                AnimationMode        =    ONCE
            End
            Animation                =    CHRB
                AnimationName        =    RUTheoden_CHRB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUTheoden_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "BORED" then CurDrawableSetTransitionAnimState("Transition_BoredToSelected") end
                if Prev == "READY" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
                if Prev == "SPELL" then CurDrawableSetTransitionAnimState("Transition_ReadyToSelected") end
            EndScript
        End

        TransitionState Transition_BoredToReady
            Animation                =    ready
                AnimationName        =    RUTheoden_IDLA
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_ReadyToBored
            Animation                =    IDLC
                AnimationName        =    RUTheoden_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    20
            End
        End

        TransitionState Transition_BoredToSelected
            Animation                =    ATNA
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToBored
            Animation                =    ATNE
                AnimationName        =    RUTheoden_ATNE
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_SelectedToReady
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState Transition_ReadyToSelected
            Animation                =    ATNC
                AnimationName        =    RUTheoden_ATNA
                AnimationMode        =    ONCE_BACKWARDS
            End
            Flags = START_FRAME_LAST
        End
    End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    ShroudClearingRange = 475
    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%


    DisplayName = OBJECT:DwarvenGeneral

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = 800
    BuildTime         = STRONG_BUILDTIME
    BountyValue       = 5
    CommandSet        = EmptyCommandSet




    VoiceAttack                             = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackCharge                       = MenOfDaleInfantryVoiceAttackChargeSwordsmen
    VoiceAttackMachine                      = MenOfDaleInfantryVoiceAttackSwordsmen
    VoiceAttackStructure                    = MenOfDaleVoiceAttackBuilding
    VoiceCreated                            = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceFullyCreated                       = MenOfDaleInfantryVoiceSaluteSwordsmen
    VoiceGuard                              = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMove                               = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveToCamp                         = MenOfDaleVoiceMoveCamp
    VoiceMoveToHigherGround                 = MenOfDaleInfantryVoiceMoveSwordsmen
    VoiceMoveWhileAttacking                 = MenOfDaleInfantryVoiceDisengageSwordsmen
    VoicePriority                           = 45
    VoiceRetreatToCastle                    = MenOfDaleVoiceRetreat
    VoiceSelect                             = MenOfDaleVoiceSelectMSSwordsmen
    VoiceSelectBattle                       = MenOfDaleInfantryVoiceSelectBattleSwordsmen

    VoiceEnterStateAttack                   = MenOfDaleInfantryVoiceEnterStateAttackSwordsmen
    VoiceEnterStateAttackCharge             = MenOfDaleInfantryVoiceEnterStateAttackChargeSwordsmen
    VoiceEnterStateAttackMachine            = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure          = MenOfDaleVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                     = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveToCamp               = MenOfDaleVoiceEnterStateMoveCamp
    VoiceEnterStateMoveToHigherGround       = MenOfDaleInfantryVoiceEnterStateMoveSwordsmen
    VoiceEnterStateMoveWhileAttacking       = MenOfDaleInfantryVoiceEnterStateDisengageSwordsmen
    VoiceEnterStateRetreatToCastle          = MenOfDaleVoiceEnterStateRetreat


    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceCreatedFromInn                 = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceEnterUnitElvenTransportShip    = MenOfDaleVoiceMoveShip
        VoiceFullyCreatedFromInn            = MenOfDaleInfantryVoiceSaluteSwordsmen
        VoiceGarrison                       = MenOfDaleInfantryVoiceMoveGarrisonSwordsmen
        VoiceInitiateCaptureBuilding        = MenOfDaleVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA           Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27
        AnimationSound = Sound:TauntHumanHitShield     Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier         Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 500
        MaxHealthDamaged  = 240
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority             =     AttackPriority_Infantry
        AILuaEventsList            =    GondorFighterFunctions
        BurningDeathTime           =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = DwarfGuardianVoiceBullRush
    End


    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = 50
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 50
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate              = 15000
        MeleeFreeUnitSpawnTime     = 30000
        DiedRespawnTime            = 15000
        MeleeFreeBannerReSpawnTime = 30000

        BannerMorphFX              = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX                = FX_HordeResurrection
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End



    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy       = Upgrade_HeavyArmor
        UpgradeTexture    = dudalesoldier.tga 0 dudalesoldier_ha.tga
        RecolorHouse      = Yes
        ExcludeSubobjects = Forged_Blade
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object DwarvenEredMithrinBanner


    SelectPortrait         = UPMithrinGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes


        DefaultModelConditionState
            Model               = dumiguaban_skn
            Skeleton            = DUAxDBan_SKL
        End

        ModelConditionState = USER_1
            Model               = dumiguaban_skn
            Skeleton            = DUAxDBan_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model               = dumiguaban_skn
            Skeleton            = GUBanner_SKL
        End



        AnimationState                =    FREEFALL USER_3
            Animation                =    free fall
                AnimationName        =    GUBanner_FLLA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    STUNNED_FLAILING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                = DYING USER_3 DEATH_1
            Animation
                AnimationName        = GUBanner_IDLA
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH USER_3
            Animation
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                = DYING DEATH_1
            Animation
                AnimationName        = DUAxDBan_IDLB
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    DUAxDBan_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    DYING SPLATTED USER_3
            Animation                =    splatted
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    DYING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = DUAxDBan_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP USER_3
            Animation                =    StandUp
                AnimationName        =    GUBanner_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED USER_3
            Animation                =    Land
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
            End
        End






        AnimationState                =    DEATH_2 USER_3
            Animation                =    JustDie
                AnimationName       =    GUBanner_DIEA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = BURNINGDEATH USER_3
            Animation
                AnimationName                = GUBanner_MFDA
                AnimationMode                = LOOP
                Distance                    = 50
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUAxDBan_MFDA
                AnimationMode                = LOOP
                Distance                    = 90
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBanner_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = MOVING BACKING_UP USER_3
            Animation                    = BACKING UP
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
            End
        End


        AnimationState = MOVING ENGAGED USER_3
            Animation = Moving_Engaged
                AnimationName = GUBanner_RUNC
                AnimationMode = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING USER_3
            Animation                =    RunA
                AnimationName        =    GUBanner_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    FIRING_OR_PREATTACK_A USER_3
            Animation                =    AttackA1
                AnimationName        =    GUBanner_ATKA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUAxDBan_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    DUAxDBan_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End



        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = DUAxDBan_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

                AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = DUAxDBan_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUAxDBan_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING ALTERNATE_FORMATION PASSENGER_VARIATION_1
            Animation                = RunningSlowerInAFighterAlternateFormation
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .5 .5
            End
            Flags                    = RANDOMSTART

        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = GUBanner_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID USER_3
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End
        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    DUAxDBan_FERA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID USER_3
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = DUAxDBan_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING USER_3
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = DUAxDBan_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING USER_3
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = DUAxDBan_PNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = ONCE
                AnimationBlendTime        = 74
                AnimationMustCompleteBlend = Yes
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT USER_3
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End

        End
        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = DUAxDBan_IDLA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = RAISING_FLAG USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    =    SELECTED USER_3
            StateName                    =    STATE_Selected_User_3
            Animation                    =    AtAttention
                AnimationName            =    GUBanner_ATNB
                AnimationMode            =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_User3" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected3") end
            EndScript
        End



        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = DUAxDBan_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState                    =    USER_3
            StateName                    =    State_User3
            Animation                    =    IdleB
                AnimationName            =    GUBanner_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_User_3" then CurDrawableSetTransitionAnimState("TRANS_Selected3_To_Idle") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    DUAxDBan_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    GUBanner_ATNC
                AnimationMode            =    ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw FX
        ModelConditionState = NONE
            Model           = exdwrunefx
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.88
    ShockwaveResistance          = 35

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    ShroudClearingRange = 350
    VisionRange         = 200

    DisplayName = OBJECT:DwarvenBannerEredMithrin

    CrusherLevel          = 0
    CrushableLevel        = 0
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon    = BasicInfantryCrushRevenge
    CrushWeapon           = KnightCrush

    BuildCost         = 800
    BuildTime         = STRONG_BUILDTIME
    BountyValue       = 8
    CommandSet        = EmptyCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 600
        MaxHealthDamaged  = 300
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End

    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe02
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        UpgradeTexture    = EUDwarfGua_r.tga 0 eudwarfgua_rHA.tga
        UpgradeTexture    = EUDwarfGua_fire.tga 0 eudwarfgua_rHA.tga
        RecolorHouse      = No
        ExcludeSubobjects = Forged_Blade REDAXE
    End


    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeGuardian
        TriggeredBy       = Upgrade_DwarvenMithrilMail
        UpgradeTexture    = EUDwarfGua_r.tga 0 eudwarfgua_rHI.tga
        UpgradeTexture    = EUDwarfGua_fire.tga 0 eudwarfgua_rHI.tga
        RecolorHouse      = No
        ExcludeSubobjects = Forged_Blade REDAXE
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate              = 12000
        MeleeFreeUnitSpawnTime     = 24000
        DiedRespawnTime            = 12000
        MeleeFreeBannerReSpawnTime = 24000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection

        MorphCondition  = UnitType:DwarvenGuardianEredMithrin   Locomotor:SET_COMBO   ModelState:"USER_1"
        MorphCondition  = UnitType:DwarvenEredMithrinHunter     Locomotor:SET_COMBO   ModelState:"USER_1"
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object DwarvenArkenguardBanner


    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = duerarkbnr_skn
            Skeleton            = GUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model               = duerarkbnr_skn
            Skeleton            = GUBanner_SKL
        End




        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUArcher_IDLA
                AnimationMode                = LOOP
            End
        End





        AnimationState                        = PASSENGER
            Animation                        = Wiggle
                AnimationName                = GUBanner_FLLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = GUBanner_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    GUBanner_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUBanner_ATRA
                AnimationMode       = LOOP

            End
            Flags               = RANDOMSTART
        End





        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = GUBanner_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = DYING BURNINGDEATH DEATH_1
            Animation
                AnimationName    = GUBanner_DIEA
                AnimationMode    = ONCE
                AnimationBlendTime = 10

            End
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation           = LNDA
                AnimationName     = GUBanner_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = GUBanner_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_1
            Animation           = DIEA
                AnimationName     = GUBanner_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation           = ByeBye
                AnimationName     = GUBanner_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = GUBanner_MFDA
                AnimationMode    = LOOP
                Distance        = 40
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = GUBanner_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = GUBanner_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = GUBanner_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = GUBanner_RUNC
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = GUBanner_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End













        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange    = 0.9 1.1
            End
        End


        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = GUBanner_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    RURrmBnr_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    RURrmBnr_ATNC
                AnimationMode            =    ONCE
            End
        End








    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.75
    ShockwaveResistance          = 50

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions             = None
        Weapon                = PRIMARY    DwarvenArkenguardMace
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY    DwarvenArkenguardMace
        Weapon                = SECONDARY  DwarvenArkenguardMaceHeroMode
        AutoChooseSources     = SECONDARY NONE
        ShareWeaponReloadTime = Yes
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBannerArkenGuard

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 8
    CommandSet        = EmptyCommandSet





    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39


    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 850
        MaxHealthDamaged     = 360
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    GondorFighterFunctions
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End


      Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound                = DwarfGuardianVoiceBullRush
    End
    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KampfkunstEnabler
        SpecialPowerTemplate = SpecialAbilityZwergischeKampfkunst
        TriggeredBy          = Upgrade_AllFactionUpgrade
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KampfkunstPowerUpdate
        SpecialPowerTemplate = SpecialAbilityZwergischeKampfkunst
        Duration             = 15000
        AttributeModifier    = ZwergischeKampfkunstBonus
        LockWeaponSlot       = SECONDARY
        StartsPaused         = No
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object DwarvenUnburntBanner


    SelectPortrait         = UPDwarvenGuardian


    Draw = W3DScriptedModelDraw DrawFloor_V1

        OkToChangeModelColor = No
        StaticModelLODMode = No


        DefaultModelConditionState
            Model     = duelunbbnr_skn
            Skeleton  = IUBanner_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model     = duelunbbnr_skn
            Skeleton  = IUBanner_SKL
        End


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        IdleAnimationState
            Animation = IDLD
                AnimationName = IUBanner_IDLD
                AnimationMode = ONCE
                AnimationPriority = 5
                AnimationBlendTime  = 15
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
            StateName = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "CloseRange"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
                if Prev == "STATE_Selected"    then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") return end
            EndScript
        End

        AnimationState                            = PASSENGER
            Animation                            = Grabbed
                AnimationName                    = IUBanner_FLLA
                AnimationMode                    = LOOP
            End
        End

        AnimationState                            = FREEFALL
            Animation                            = Falling
                AnimationName                    = IUBanner_FLYB
                AnimationMode                    = LOOP
                AnimationBlendTime                = 10
            End
        End

        AnimationState                             = STUNNED_FLAILING
             Animation                             = Flying
                AnimationName                     = IUBanner_FLYB
                      AnimationMode                     = LOOP
            End
               Flags = RANDOMSTART
          End

        AnimationState            = DYING BURNINGDEATH
            Animation
                AnimationName    = IUBanner_DIEA
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
            Animation
                AnimationName    = IUBanner_DIEB
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
            Animation
                AnimationName    = IUBanner_DIEC
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
            Animation
                AnimationName    = IUBanner_DIED
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
        End

           AnimationState                            = DYING SPLATTED
             Animation                        = Splattered_On_Ground_1
                AnimationName                    = IUBanner_LNDA
                AnimationMode                    = ONCE
            End
           End

     AnimationState = DYING AFLAME
            Animation = Flaming_Death
          AnimationName = MUHarOvr_MFDA
            AnimationMode = ONCE
            End
    End

    AnimationState = DYING WEAPONSTATE_CLOSE_RANGE
            Animation = Dying_1
          AnimationName = IUBanner_DIEC
            AnimationMode = ONCE
            End
            Animation = Dying_2
          AnimationName = IUBanner_DIED
            AnimationMode = ONCE
            End
    End

    AnimationState = DYING
            Animation = Dying_1
          AnimationName = IUBanner_DIEA
            AnimationMode = ONCE
            End
            Animation = Dying_2
          AnimationName = IUBanner_DIEB
            AnimationMode = ONCE
            End
    End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = IUBanner_MFDA
                AnimationMode    = LOOP
                Distance        = 40
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUBanner_IDLD
                AnimationMode                = LOOP
            End
        End


    AnimationState  = COMING_OUT_OF_FACTORY
        Animation = Being_Built
            AnimationName        = IUBanner_RUNB
            AnimationMode        = LOOP
            AnimationBlendTime    = 0
        End
    End



    AnimationState = MOVING FIRING_OR_PREATTACK_A
        Animation = TrotAndFire
            AnimationName = IUBanner_RUNB
            AnimationMode = LOOP
        End
        Flags = RANDOMSTART

    End


    AnimationState = MOVING BACKING_UP
        Animation                = BackingUp
            AnimationName        = IUBanner_BAKA
            AnimationMode        = LOOP
            AnimationSpeedFactorRange 1.5 1.5
        End
        Flags = RANDOMSTART
    End

    AnimationState = MOVING EMOTION_TERROR
        Animation = Moving
            AnimationName = IUBanner_RUNA
            AnimationMode = LOOP
        End
        StateName = Moving
        Flags = RANDOMSTART

    End

    AnimationState                =    MOVING DAMAGED
        Flags                    =    RANDOMSTART
        Animation                =    IWKA
            AnimationName        =    IUBanner_IWKA
            AnimationMode        =    LOOP
        End
    End

    AnimationState = MOVING
            Animation = Moving
          AnimationName = IUBanner_RUNA
            AnimationMode = LOOP
            End
            StateName = Moving
            Flags = RANDOMSTART

    End

    AnimationState = STUNNED_STANDING_UP
             Animation = Standing_Back_Up
                AnimationName = IUBanner_GTPA
          AnimationMode = ONCE
          AnimationSpeedFactorRange = 1.5 1.5
            End
    End

    AnimationState = STUNNED
             Animation = Splattered_On_Ground_1
                AnimationName = IUBanner_LNDA
          AnimationMode = ONCE
            End
    End

    TransitionState = Trans_Idle_To_Sword
            Animation = Transition
          AnimationName = IUBanner_STHA
            AnimationMode = ONCE
            End
    End

    TransitionState = Trans_Moving_To_Sword
            Animation = Transition
              AnimationName = IUBanner_STHC
                AnimationMode = ONCE
            End
    End

    TransitionState = Trans_Sword_To_Idle
        Animation = Transition
            AnimationName = IUBanner_STHB
            AnimationMode = ONCE
        End
    End





    AnimationState = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
        Animation = ATKA1
            AnimationName = IUBanner_ATKA
            AnimationMode = ONCE
            UseWeaponTiming        = Yes
        End
        StateName = CloseRange
    End

    AnimationState = WAR_CHANT
        Animation = Chant
            AnimationName = IUBanner_IDLC
            AnimationMode = LOOP
        End
    End




    AnimationState                            = EMOTION_AFRAID
        Animation                            = FERA
            AnimationName                    = IUBanner_FERA
            AnimationMode                    = LOOP
        End
        Flags = RANDOMSTART
    End
    AnimationState                            = EMOTION_TAUNTING
        Animation                            = TNTA
            AnimationName                    = IUBanner_IDLC
            AnimationMode                    = LOOP
        End
    End

   AnimationState                            = EMOTION_CELEBRATING
        Animation                           = CHRA
            AnimationName                    = IUBanner_CHRA
            AnimationMode                    = LOOP
        End
    End

    AnimationState                            = EMOTION_ALERT
        Animation                            = ALERT
            AnimationName                    = IUBanner_IDLB
            AnimationMode                    = LOOP
        End
        Flags                                = RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
    End

    AnimationState = WEAPONSTATE_CLOSE_RANGE
         Animation = Close_Range_Idle
                AnimationName = IUBanner_IDLB
                AnimationMode = ONCE
        End
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            if Prev == "Moving" then CurDrawableSetTransitionAnimState("Trans_Moving_To_Sword") return end
            if Prev == "Idle"   then CurDrawableSetTransitionAnimState("Trans_Idle_To_Sword") return end
        EndScript
        StateName = CloseRange
    End

    AnimationState                            = RAISING_FLAG
        Animation                           = CHRA
            AnimationName                    = IUBanner_CHRA
            AnimationMode                    = LOOP
        End
    End

       AnimationState        = SELECTED
        StateName           = STATE_Selected
        Animation = IDLA
            AnimationName = IUBanner_IDLA
            AnimationMode = LOOP
        End

        BeginScript
            Prev = CurDrawablePrevAnimationState()
            if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            if Prev == "CloseRange"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
        EndScript
    End



    TransitionState                    =    TRANS_Idle_to_Selected
        Animation                    =    ATNA
            AnimationName            =    IUBanner_ATNA
            AnimationMode            =    ONCE
        End
    End

    TransitionState                    =    TRANS_Selected_to_Idle
        Animation                    =    ATNB
            AnimationName            =    IUBanner_ATNB
            AnimationMode            =    ONCE
        End
    End

  End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.75
    ShockwaveResistance          = 50

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxeEdain
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenBannerUnburnt

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 8
    CommandSet        = DwarvenGuardianBreitschulternCommandSet




    VoiceAttack                                = DwarfGuardianVoiceAttack
    VoiceAttackCharge                        = DwarfGuardianVoiceAttackCharge
    VoiceAttackMachine                        = DwarfGuardianVoiceAttack
    VoiceAttackStructure                    = DwarfGuardianVoiceAttackBuilding
    VoiceCreated                            = DwarfGuardianVoiceSalute
    VoiceFullyCreated                         = DwarfGuardianVoiceSalute
    VoiceGuard                                = DwarfGuardianVoiceMove
    VoiceMove                                = DwarfGuardianVoiceMove
    VoiceMoveToCamp                            = DwarfGuardianVoiceMoveCamp
    VoiceMoveWhileAttacking                    = DwarfGuardianVoiceDisengage
    VoicePriority                            = 15
    VoiceRetreatToCastle                    = DwarfGuardianVoiceRetreat
    VoiceSelect                                = DwarfGuardianVoiceSelectMS
    VoiceSelectBattle                         = DwarfGuardianVoiceSelectBattle










    SoundImpact                                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                        = DwarfGuardianVoiceMoveGarrison
        VoiceEnterUnitElvenTransportShip    = DwarfGuardianVoiceMoveShip
        VoiceInitiateCaptureBuilding        = DwarfGuardianVoiceCaptureBuilding

    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth            = 850
        MaxHealthDamaged     = 400
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate         = 500
        AttackPriority              = AttackPriority_Infantry
        AILuaEventsList             = GondorFighterFunctions
        BurningDeathTime            = BURNINGDEATH_DURATION_INFANTRY
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = DwarfGuardianVoiceBullRush
    End

    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeHeavyArmor
        TriggeredBy       = Upgrade_HeavyArmor
        ShowSubObjects    = ERLN_H_ARMOR
        HideSubObjects    = ERLN_H1 ERLN_H2 ERLN_H3
        UpgradeTexture    = duelsoldier.tga 0 duelsoldier_ha.tga
        RecolorHouse      = Yes
        ExcludeSubobjects = Forged_Blade AXE02
    End


    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeGuardian
        TriggeredBy       = Upgrade_DwarvenMithrilMail
        ShowSubObjects    = ERLN_H_ARMOR
        HideSubObjects    = ERLN_H1 ERLN_H2 ERLN_H3
        UpgradeTexture    = duelsoldier.tga 0 duelsoldier_ha.tga
        RecolorHouse      = Yes
        ExcludeSubobjects = Forged_Blade AXE02
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

