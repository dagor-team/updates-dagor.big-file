Object DwarvenBrand

    SelectPortrait = HPBrand
    ButtonImage    = HIBrand

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_01_

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model               = DUBrand_BOW
            WeaponLaunchBone    = PRIMARY arrow
        End

       ModelConditionState      = WEAPONSET_TOGGLE_1
            Model               = DUBrand_SWD
        End




        AnimationState        = PACKING_TYPE_2 WEAPONSET_TOGGLE_1
            StateName          =    CaptainPower
            Animation           = GUFaramir_CHRC
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = PACKING_TYPE_2
            StateName          =    STATE_CaptainBow
            Animation           = GUFaramir_CHRD
                AnimationName     = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.75 0.75
            End
        End




        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_FLYB
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYB
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = STUNNED_FLAILING
            StateName           = STATE_Bow
            Animation           = GUFaramir_FLYA
                AnimationName     = GUFaramir_SKL.GUFaramir_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            StateName           = STATE_Bow
            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_DIEA
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEA
                AnimationMode     = ONCE
            End

            Animation           = GUFaramir_DIEB
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEB
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING
            StateName           = STATE_Bow
            Animation           = GUFaramir_DIEC
                AnimationName     = GUFaramir_SKL.GUFaramir_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUFaramir_IDLC
                AnimationMode                = LOOP
            End
        End





        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = GUFaramir_GTPB
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPB
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            StateName           = STATE_Bow
            Animation           = GUFaramir_GTPA
                AnimationName     = GUFaramir_SKL.GUFaramir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword

            Animation           = GUFaramir_LNDB
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            StateName           = STATE_Bow

            Animation           = GUFaramir_LNDA
                AnimationName     = GUFaramir_SKL.GUFaramir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = STATE_Bow
            Animation
                AnimationName           = GUFaramir_SKL.GUFaramir_ATKC
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 59
            BeginScript
                CurDrawableShowSubObject("arrow")
            EndScript
        End






        AnimationState        = MOVING WEAPONSET_TOGGLE_1 FIRING_OR_PREATTACK_A
            Animation           = TrotAndFire
                AnimationName       = GUFaramir_SKL.GUFaramir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            StateName = RunAndSwing
        End

        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKS1
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.15 1.15
            End
            Animation           = ATKE
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKS2
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
                AnimationSpeedFactorRange = 1.15 1.15
            End
            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKS3
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.15 1.15
            End
            Animation           = ATKF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATKS4
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.15 1.15
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
            EndScript
        End





        AnimationState            = MOVING WEAPONSET_TOGGLE_1
            StateName           = STATE_RunningSword
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNB
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNB

                AnimationSpeedFactorRange = 0.85 0.85
                Distance        = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_RunningBow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Running") end
            EndScript
        End



        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            StateName           = STATE_Sword
            Animation           = ATKD
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLS
                AnimationMode     = MANUAL
            End
        End



        AnimationState            = MOVING
            StateName           = STATE_RunningBow
            Flags               = RANDOMSTART


            Animation           = GUFaramir_RUNA
                AnimationName   = GUFaramir_SKL.GUFaramir_RUNA

                AnimationSpeedFactorRange = 0.85 0.85
                Distance = 28
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_RunningSword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Running") end
            EndScript
        End



        AnimationState                    =    PREATTACK_A
            StateName                    =    STATE_Firing
            Animation                    =    ReadyToDrawn
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA1
                AnimationMode            =    ONCE


            End
        End

        AnimationState                    =    FIRING_OR_RELOADING_A
            StateName                    =    STATE_Firing
            Animation                    =    LooseReloadDraw
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    ONCE

                AnimationSpeedFactorRange = 1.1 1.1

            End
        End


        AnimationState                    =    CONTINUOUS_FIRE_MEAN
            Animation                    =    HangFrameWhileCoasting
                AnimationName            =    GUFaramir_SKL.GUFaramir_ATKA2
                AnimationMode            =    MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW

            Animation                        = PutAwayArrow
                AnimationName                = GUFaramir_SKL.GUFaramir_ATKA3
                AnimationMode                = ONCE
            End
        End









        AnimationState = EMOTION_ALERT HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_d
                AnimationName = GUFaramir_SKL.GUFaramir_HITD
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_b
                AnimationName = GUFaramir_SKL.GUFaramir_HITB
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_c
                AnimationName = GUFaramir_SKL.GUFaramir_HITC
                AnimationMode = ONCE
            End
        End





        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRC
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        = ONCE
            End
        End



        AnimationState                =    EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRS
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End



        AnimationState                =    EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTC
                AnimationMode        =    ONCE
            End
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_TNTD
                AnimationMode        =    ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    EMOTION_TAUNTING
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End




        AnimationState                    = SELECTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Selected_Sword

            Animation                    = ATNE
                AnimationName            = GUFaramir_SKL.GUFaramir_ATNE
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedSword") return end
            EndScript
        End


        AnimationState                =    EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                =    STATE_READY
            Animation                =    ready
                AnimationName        =    GUFaramir_SKL.GUFaramir_IDLS
                AnimationMode        =    LOOP
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName        =    GUFaramir_SKL.GUFaramir_CHRD
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    STATE_Selected_Bow

            Animation                =    ATNB
                AnimationName        =    GUFaramir_SKL.GUFaramir_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Idle_Bow"    then CurDrawableSetTransitionAnimState("TRANS_BoredToSelectedBow") return end
                if Prev == "STATE_CaptainBow" then CurDrawableSetTransitionAnimState("TRANS_CaptainBowToSelectedBow") end
            EndScript
        End





        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = STATE_Idle_Sword

            Animation                   = IDLE
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLE
                AnimationMode           = LOOP
                AnimationPriority        = 20
                AnimationBlendTime  = 15
            End
            Animation                   = IDLF
                AnimationName           = GUFaramir_SKL.GUFaramir_IDLF
                AnimationMode           = LOOP
                AnimationPriority        = 1
            End
            BeginScript
                CurDrawableHideSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword") end
                if Prev == "STATE_Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredSword") end
            EndScript
        End

        IdleAnimationState
            StateName           = STATE_Idle_Bow

            Animation           = IdleBow
                AnimationName     = GUFaramir_SKL.GUFaramir_IDLC
                AnimationMode     = ONCE
                AnimationBlendTime  = 15
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow") end
                if Prev == "STATE_Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBoredBow") end
            EndScript
        End



        TransitionState = TRANS_BoredToSelectedSword
            Animation = ANTD
                AnimationName        = GUFaramir_SKL.GUFaramir_ANTD
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_SelectedToBoredSword
            Animation            = ATNF
                AnimationName    = GUFaramir_SKL.GUFaramir_ATNF
                AnimationMode    = ONCE
            End
        End

        TransitionState = TRANS_BoredToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_CaptainBowToSelectedBow
            Animation = ATNC
                AnimationName        = GUFaramir_SKL.GUFaramir_ATNC
                AnimationMode        = ONCE
                AnimationBlendTime    = 10
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        TransitionState = TRANS_SelectedToBoredBow
            Animation            = ATNA

                AnimationName    = GUFaramir_SKL.GUFaramir_ATND
                AnimationMode    = ONCE
            End
        End


        TransitionState       = TRANS_BowToSword
            Animation           = GUFaramir_STHA
                AnimationName     = GUFaramir_SKL.GUFaramir_STHA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwordToBow
            Animation           = GUFaramir_STHB
                AnimationName     = GUFaramir_SKL.GUFaramir_STHB
                AnimationMode     = ONCE
            End
        End

        TransitionState               = TRANS_BowToSword_Running
            Animation               = DrawSwords
                AnimationName       = GUFaramir_SKL.GUFaramir_STHD
                AnimationMode       = ONCE
            End
        End

        TransitionState               = TRANS_SwordToBow_Running
            Animation               = DrawBow
                AnimationName       = GUFaramir_SKL.GUFaramir_STHC
                AnimationMode       = ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                  = Dwarves
    EditorSorting         = UNIT
    ThreatLevel           = 650
    ThingClass            = CHARACTER_UNIT
    BuildCost             = BRANDDAG_COST
    BuildTime             = MEDIUM_HERO_BUILDTIME
    ShockwaveResistance   = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount    = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage    = BRANDDAG_DAMAGE
    DisplayRangedDamage   = BRANDDAG_RANGED
    CommandPoints         = 0

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    DwarvenBardLangbogen
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1
        Weapon            = PRIMARY    BardSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_HERO_MODE
        Weapon            = PRIMARY    DwarvenBardLangbogen
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1 WEAPONSET_HERO_MODE
        Weapon            = PRIMARY    BardSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions        = None
        Armor             = MediumHeroArmor
        DamageFX          = NormalDamageFX
    End


    VisionRange            = VISION_HERO_RANGED
    ShroudClearingRange    = SHROUD_CLEAR_RANGED_HERO

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue            = GONDOR_FARAMIR_BOUNTY_VALUE
    DisplayName            = OBJECT:DwarvenBrand
    RecruitText            = CONTROLBAR:DwarvenBrandRecruit
    ReviveText             = CONTROLBAR:DwarvenBrandRevive
    Hotkey                 = CONTROLBAR:DwarvenBrandHotkey
    CrushableLevel         = 2

    CommandSet             = DwarvenBrandCommandSet

    HeroSortOrder          = 30



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ThranduilBody

    AutoResolveArmor
        Armor = AutoResolve_ThranduilArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ThranduilWeapon
    End




    VoiceAttack               = CptDaleVoiceAttack
    VoiceAttackAir            = CptDaleVoiceAttack
    VoiceAttackCharge         = CptDaleVoiceAttackCharge
    VoiceAttackMachine        = CptDaleVoiceAttack
    VoiceAttackStructure      = CptDaleVoiceAttackBuilding
    VoiceCreated              = CptDaleVoiceSalute
    VoiceFullyCreated         = CptDaleVoiceSalute
    VoiceMove                 = CptDaleVoiceMove
    VoiceMoveToCamp           = CptDaleVoiceMoveCamp
    VoiceMoveWhileAttacking   = CptDaleVoiceMove
    VoicePriority             = 85
    VoiceRetreatToCastle      = CptDaleVoiceMoveCamp
    VoiceSelect               = CptDaleVoiceSelect
    VoiceSelectBattle         = CptDaleVoiceSelectBattle
    VoiceGuard                = CptDaleVoiceMove

    SoundImpact               = ImpactHorse


    UnitSpecificSounds
        VoiceGarrison                     = CptDaleVoiceGarrison
        VoiceEnterUnitElvenTransportShip  = CptDaleVoiceMove
        VoiceInitiateCaptureBuilding      = CptDaleVoiceMove
        VoiceMoveToTrees                  = CptDaleVoiceAttack
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA             Animation:GUFaramir_SKL.GUFaramir_RUNA        Frames:2 12
        AnimationSound = Sound:FootstepDirtA             Animation:GUFaramir_SKL.GUFaramir_RUNB        Frames:2 12

        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_ATKC        Frames:18

        AnimationSound = Sound:SwordShingClean1          Animation:GUFaramir_SKL.GUFaramir_STHA        Frames:21
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:11
        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_STHB        Frames:28

        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:2
        AnimationSound = Sound:WeaponSwitchBow           Animation:GUFaramir_SKL.GUFaramir_STHC        Frames:3
        AnimationSound = Sound:SwordShingClean1          Animation:GUFaramir_SKL.GUFaramir_STHD        Frames:6

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEA        Frames:88
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEB        Frames:85
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUFaramir_SKL.GUFaramir_DIEC        Frames:49
        AnimationSound = Sound:BodyFallSoldier           Animation:GUFaramir_SKL.GUFaramir_LNDA        Frames:3
        AnimationSound = Sound:BodyFallSoldier           Animation:GUFaramir_SKL.GUFaramir_LNDB        Frames:2
    End

    CrowdResponseKey = GoodMen

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance                = 200
        TauntAndPointUpdateDelay            = 2000
        PointAt                                = ANY +HERO
        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End



    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER ARAGORN
    PathfindDiameter = 40.0
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                  = EMOTION_CHEER_RADIUS
        MaxHealth                    = BRANDDAG_HEALTH
        PermanentlyKilledByFilter    = NONE
        DodgePercent                 = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 3000
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIBrand

        RespawnRules =    AutoSpawn:No           Cost:BRANDDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
   End


    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        HoldGroundCloseRangeDistance    = 60
        AILuaEventsList                 = DwarvenBrandFunctions
    End

	#include "..\..\..\includes\DwarvenRunesHeroes.inc"




    Behavior = SpecialPowerModule ModuleTag_LeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_LeadershipFighter
        StartsActive              = Yes
        BonusName                 = DwarvenBrandLeadershipSoldier
        RefreshDelay              = 2000
        Range                     = 150
        ObjectFilter              = ANY +DwarvenThalSwordman +DwarvenThalSwordmanHorde +DwarvenThalPikeman +DwarvenThalPikemanHorde +DwarvenThalBowman +DwarvenThalBowmanHorde ALLIES
    End

    Behavior = WeaponChangeSpecialPowerModule THING
        SpecialPowerTemplate      = SpecialAbilityBerserkerLightTorch
        FlagsUsedForToggle        = WEAPONSET_TOGGLE_1
        ToggleOnAttributeModifier = WaffenwechselHeroModifier
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BrandsFalkeEnabler
        SpecialPowerTemplate         = SpecialPowerBrandFalke
        TriggeredBy                  = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_BrandsFalkeSpecialStarter
        UpdateModuleStartsAttack     = No
        SpecialPowerTemplate         = SpecialPowerBrandFalke
        StartsPaused                 = Yes
        AttributeModifier            = BrandFalkeModifier
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = NONE +DwarvenBrand
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_BrandsFalkeSpecialUpdate
        SpecialPowerTemplate         = SpecialPowerBrandFalke
        UnpackTime                   = 2000
        PackTime                     = 3000
        AwardXPForTriggering         = 0
        MustFinishAbility            = Yes
    End

    Behavior = ObjectCreationUpgrade MaketheFalke
        TriggeredBy                  = Upgrade_RaiseShield
        Delay                        = 500.0
        ThingToSpawn                 = BrandsFalke
        Offset                       = X:0.0 Y:1.0 Z:20.0
        FadeInTime                   = 200
    End

    Behavior = SlaveWatcherBehavior WatchTheFalke
        RemoveUpgrade                = Upgrade_RaiseShield
        LetSlaveLive                 = Yes
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EntschlossenheiEnabler
        SpecialPowerTemplate      = SpecialAbilityWargreiterHeulen
        TriggeredBy               = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_EntschlossenheitStarter
        SpecialPowerTemplate      = SpecialAbilityWargreiterHeulen
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_EntschlossenheitUpdate
        SpecialPowerTemplate      = SpecialAbilityWargreiterHeulen
        UnpackingVariation        = 1
        UnpackTime                = 0
        PackTime                  = 0
        AwardXPForTriggering      = 0
        HeroAttributeModifier     = BrandEntschlossenheitModifier
        HeroEffectDuration        = 30000
    End

    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName  = BrandEntschlossenheitWeapon
            FireDelay   = 0
            OneShot     = No
        End
        HeroModeTrigger = Yes
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_HERO_MODE
        WeaponToggleCommandSet    = DwarvenBrandCommandSet_Entschlossenheit
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_UnpauseBeastArrow
        SpecialPowerTemplate        = SpecialAbilityDaleBeastSlayerArrow
        TriggeredBy                 = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_BeastArrow
        SpecialPowerTemplate        = SpecialAbilityDaleBeastSlayerArrow
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = CptDaleVoiceBlackArrow
        StartsPaused                = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BeastArrowUpdate
        SpecialPowerTemplate        = SpecialAbilityDaleBeastSlayerArrow
        SkipContinue                = Yes
        UnpackTime                  = 1600
        PreparationTime             = 2
        PackTime                    = 850
        AwardXPForTriggering        = 0
        StartAbilityRange           = 400
        ApproachRequiresLOS         = Yes
        SpecialWeapon               = BrandSchwarzerPfeilWeapon
        WhichSpecialWeapon          = 1
    End

    Behavior = AutoAbilityBehavior ModuleTag_BeastArrowAutoAbility
        SpecialAbility              = SpecialAbilityDaleBeastSlayerArrow
        MaxScanRange                = 400
        Query                       = 1 ANY ENEMIES +Smaug +Smaug_Summoned
        Query                       = 1 ANY ENEMIES +HERO
        Query                       = 1 ANY ENEMIES +MONSTER
    End

    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag2
        FireWeaponNugget
            WeaponName  = BrandGroupObjectWeapon
            FireDelay   = 20000
            OneShot     = No
        End
    End

    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus25
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 1
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier25
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus50
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 2
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier50
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus75
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 3
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier75
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus100
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 4
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier100
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus125
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 5
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier125
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus150
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 6
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier150
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus175
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 7
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier175
    End
    Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus200
        UpdateRate            = 1000
        HordeMemberFilter     = NONE +BrandGroupObject
        Count                 = 8
        Radius                = 999999999
        RubOffRadius          = 5.0
        AlliesOnly            = Yes
        AttributeModifier     = BrandGroupModifier200
    End



    Behavior = AutoHealBehavior ModuleTag_LegolasHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP                     = Yes
    End

    LocomotorSet
        Locomotor = ElvenThranduilLocomotor
        Condition = SET_NORMAL
        Speed     = 46
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL CptDaleVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight                   = 24
        SecondHeight                  = 24
        FirstPercentIndent            = 30%
        SecondPercentIndent           = 70%
        TumbleRandomly                = Yes

        CrushStyle                    = Yes
        DieOnImpact                   = Yes
        BounceCount                   = 1
        BounceDistance                = 40
        BounceFirstHeight             = 24
        BounceSecondHeight            = 24
        BounceFirstPercentIndent      = 20%
        BounceSecondPercentIndent     = 80%

        GroundHitFX                   = FX_ThrownRockGroundHit
        GroundBounceFX                = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 1993
        HitReactionLifeTimer2 = 1993
        HitReactionLifeTimer3 = 1993

        HitReactionThreshold1 = 5.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_BrandsFalkeSummon
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate AToggleWeaponAI
        CommandButtonName = Command_ToggleBrandWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Behavior = AISpecialPowerUpdate ThornOfVengeanceAI
        CommandButtonName = Command_SpecialAbilityBrandSchwarzerPfeil
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object BrandGroupObjectHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT

    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = No
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList             = InfantryFunctions
        AttackPriority              = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload          = BrandGroupObject 1
        Slots                   = 1
        PassengerFilter         = NONE +INFANTRY
        RankInfo                = RankNumber:1 UnitType:BrandGroupObject Position:X:10 Y:0
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 1
    End

End

Object BrandGroupObject

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    KindOf    = PRELOAD CAN_CAST_REFLECTIONS PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK GRAB_AND_DROP INFANTRY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_011
        MaxHealth        = 1000
        InitialHealth    = 1000
    End

    ArmorSet
        Conditions      = None
        Armor           = AttachIntrigeArmor
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 200
    End
End

Object BrandsFalke


  ButtonImage         = HIFalke
  SelectPortrait      = HPFalke

  Draw = W3DScriptedModelDraw ModuleTag_01

    StaticModelLODMode = Yes
    RandomTexture = DUFalke.tga 0 CUBird01.tga


    DefaultModelConditionState
      Model               = CUBird_flya
    End

    IdleAnimationState
      Animation = Idle
        AnimationName       = CUBird_flya.CUBird_flya
        AnimationMode       = LOOP
        AnimationSpeedFactorRange    = 1.5 1.5
                AnimationBlendTime  = 5
      End
      Flags               = RANDOMSTART
    End

      AnimationState          = DYING DEATH_1
          Animation
              AnimationName   = CUBird_flya.CUBird_flya
              AnimationMode   = LOOP
        AnimationSpeedFactorRange    = 2.0 2.0
        AnimationBlendTime    = 10
          End
          Flags               = RANDOMSTART
      End

        AnimationState                = JUST_BUILT
            StateName                = State_JustBuilt
          Animation
              AnimationName   = CUBird_flya.CUBird_flya
              AnimationMode   = LOOP
        AnimationSpeedFactorRange    = 2.0 2.0
                AnimationBlendTime    = 0
            End
        End

    AnimationState        = MOVING EMOTION_ALERT
      Animation = Moving
        AnimationName       = CUBird_flya.CUBird_flya
        AnimationMode       = LOOP
        AnimationSpeedFactorRange    = 2.0 2.0
                AnimationBlendTime  = 5
      End
      Flags               = RANDOMSTART
    End

    AnimationState        = MOVING
      Animation = Moving
        AnimationName       = CUBird_flya.CUBird_flya
        AnimationMode       = LOOP
        AnimationSpeedFactorRange    = 2.0 2.0
                AnimationBlendTime  = 5
      End
      Flags               = RANDOMSTART
    End

    AnimationState        = EMOTION_ALERT
      Animation = Moving
        AnimationName       = CUBird_flya.CUBird_flya
        AnimationMode       = LOOP
        AnimationSpeedFactorRange    = 1.5 1.5
                AnimationBlendTime  = 0
      End
      Flags               = RANDOMSTART
    End

  End


    Side                = Dwarves
    EditorSorting       = UNIT
    ThreatLevel         = 0.0
    CommandPoints       = 0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE
    VisionRange         = 200.0
    DisplayName         = OBJECT:BrandsFalke
    CommandSet          = DwarvenBrandsFalkeCommandSet



    EvaEnemyObjectSightedEvent = None
    VoiceMove              = CarcVoiceMove
    VoicePriority          = 70
    VoiceSelect            = CarcVoiceSelect
    VoiceGuard             = CarcVoiceMove
    SoundMoveStart         = CarcVoiceSelect
    SoundAmbient           = CarcVoiceSelect



    RadarPriority = UNIT
    KindOf = SELECTABLE NO_COLLIDE MONSTER MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION IGNORES_SELECT_ALL DO_NOT_CLASSIFY HERO SUMMONED NOT_AUTOACQUIRABLE UNATTACKABLE

    SelectionPriority = SELECTION_PRIORITY_CREBAIN

    Body = ActiveBody ModuleTag_02
       MaxHealth       = 1.0
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior      ModuleTag_PhysicsBehavior
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership1
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        TriggeredBy               = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate1
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Aura
        StartsActive     = Yes
        RefreshDelay     = 2000
        Range            = 150
        TargetEnemy      = Yes
        AntiCategory     = LEADERSHIP BUFF
        BonusName        = GenericDebuff
        ObjectFilter     = ANY +MONSTER -INFANTRY -CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End






    Behavior = WeaponChangeSpecialPowerModule SpaherModuleTag
        SpecialPowerTemplate      = SpecialAbilityBerserkerLightTorch
        FlagsUsedForToggle        = WEAPONSET_TOGGLE_1
        ToggleOnAttributeModifier = BrandFalkeSpahenModifier
    End


    LocomotorSet
        Locomotor = CrowLocomotor
        Condition = SET_NORMAL
        Speed     = 105
    End


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 60000
        MaxLifetime        = 60000
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange      = 300
        DetectionRate       = 500
        CancelOneRingEffect = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = 300
        TauntAndPointUpdateDelay    = 1000
        AddEmotion                  = Alert_Base
    End


  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -FADED
    SinkDelay = 3000
    SinkRate = 0.40
    DestructionDelay = 5500
    DeathFlags = DEATH_1
  End

  Behavior = SlowDeathBehavior ModuleTag_05a
    DeathTypes = NONE +FADED
    FadeDelay = 0
    FadeTime = 1500
    DestructionDelay = 1500
    Sound = INITIAL SpellGenericUnsummonFasterMS
    DeathFlags = DEATH_2
  End

  Behavior = SquishCollide ModuleTag_06
  End


  Scale = 0.67
  Geometry = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryHeight = 0.8
  GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 10
  ShadowSizeY = 10
  ShadowTexture = ShadowI
  ShadowOverrideLODVisibility = Yes
End

