Object DwarvenOrocarni

    SelectPortrait     = UPHammertrager
    ButtonImage        = HIHammertrager_Wotr

    Draw = W3DHordeModelDraw ModuleTag_01

        OkToChangeModelColor = Yes
        StaticModelLODMode   = No
        WadingParticleSys    = WaterRipplesTrail

        DefaultModelConditionState
            Model            = duaxewing_skna
            Skeleton         = RUGimli_SKL
            WeaponLaunchBone = TERTIARY AXE02
        End

        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = RUGimli_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.3 0.5
            End
            Flags               = RANDOMSTART
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDB
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = RUGimli_DIEA
                AnimationMode     = ONCE
            End
            Animation           = DIEC
                AnimationName     = RUGimli_DIEC
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = RUGimli_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = duaxewing_idlea
                AnimationMode                = LOOP
            End
        End

    AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUGimli_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                =    MOVING ATTACKING
            Animation                =    RUNB
                AnimationName        =    RUGimli_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                =    MOVING
            Animation                =    RUNA
                AnimationName        =    RUGimli_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        =  FIRING_OR_PREATTACK_C
            Animation           = SPCA
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE
            End
            FrameForPristineBonePositions = 42

            BeginScript
                CurDrawableShowSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        =  FIRING_OR_PREATTACK_B
            Animation           = ATKA
                AnimationName     = RUGimli_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKC
                AnimationName     = RUGimli_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = RUGimli_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUGimli_CHRB
                AnimationMode        = ONCE
            End
        End

        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRA
                AnimationName   = RUGimli_CHRA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState            = EMOTION_TAUNTING
            Animation           = TNTA
                AnimationName   = RUGimli_TNTA
                AnimationMode   = ONCE
            End
            Animation           = TNTB
                AnimationName   = RUGimli_TNTB
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT
            Animation                    = Ready
                AnimationName            = duaxewing_idlea
                AnimationMode            = LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                CurDrawableHideSubObject("AXE02")
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript

        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = RUGimli_CHRA
                AnimationMode   = LOOP
            End
        End



        AnimationState                =    SELECTED
            StateName                =    AtAttentionIdle
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =     duaxewing_atneb
                AnimationMode        =    LOOP
            End
            BeginScript
                CurDrawableHideSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End



        IdleAnimationState
            StateName                = STATE_Idle
            Animation           = IDLB
                AnimationName     = duaxewing_idleb
                AnimationMode     = ONCE
                AnimationPriority = 20
            End
            Animation           = IDLD
                AnimationName     = duaxewing_idled
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            BeginScript
                CurDrawableHideSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End




        TransitionState       = TRANS_EndDwarfToss
            Animation           = TOS4
                AnimationName     = RUGimli_TOS4
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SelectedToIdle
            Animation           = ATNC
                AnimationName     = duaxewing_atnec
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =     duaxewing_atnea
                AnimationMode        =    ONCE
            End
        End

        TransitionState = TRANS_AboutToHitGround_To_Idle
            Animation = SplashAtEndOfJump
                AnimationName = RUGimli_LEPC
                AnimationMode = ONCE

            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"



    Side               = Dwarves
    EditorSorting      = UNIT
    ThreatLevel        = 1.0
    ThingClass         = HORDE_UNIT
    CommandPoints      = 5
    BountyValue        = 8
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT
    ShockwaveResistance = 40


    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY     DwarvenIronBreakerAxe
        Weapon                = SECONDARY   DwarvenIronBreakerAxeHeroMode
        Weapon                = TERTIARY    DwarvenZealotBoomAxeThrownEdain
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY FROM_PLAYER FROM_SCRIPT
        ShareWeaponReloadTime = Yes
    End



    ArmorSet
        Conditions      = None
        Armor           = EdainInfantryArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = EdainInfantryHeavyArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = EdainInfantryMithrilArmor
        DamageFX        = NormalDamageFX
    End


    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 250

    DisplayName                   = OBJECT:DwarvenOrocarniHorde
    CrushableLevel                = 0
    CrusherLevel                  = 0

    CrushRevengeWeapon            = BasicInfantryCrushRevenge

    CommandSet                    = DwarvenIronBreakerCommandSet




    VoiceAttack                       = AxtschwingerVoiceAttack
    VoiceAttackCharge                 = AxtschwingerVoiceAttack
    VoiceAttackMachine                = AxtschwingerVoiceAttack
    VoiceAttackStructure              = AxtschwingerVoiceAttack
    VoiceCreated                      = AxtschwingerVoiceRecruit
    VoiceFullyCreated                 = AxtschwingerVoiceRecruit
    VoiceGuard                        = AxtschwingerVoiceMove
    VoiceMove                         = AxtschwingerVoiceMove
    VoiceMoveToCamp                   = AxtschwingerVoiceMove
    VoiceMoveWhileAttacking           = AxtschwingerVoiceMove
    VoicePriority                     = 65
    VoiceRetreatToCastle              = AxtschwingerVoiceMove
    VoiceSelect                       = AxtschwingerVoiceSelect
    VoiceSelectBattle                 = AxtschwingerVoiceSelect


    SoundImpact                       = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                          = AxtschwingerVoiceMove
        VoiceEnterUnitElvenTransportShip       = AxtschwingerVoiceMove
        VoiceInitiateCaptureBuilding           = AxtschwingerVoiceMove
        VoiceEnterStateInitiateCaptureBuilding = AxtschwingerVoiceMove
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End


    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA             Animation:RUGimli_SKL.RUGimli_RUNA    Frames:3 14
        AnimationSound = Sound:FootstepDirtA             Animation:RUGimli_SKL.RUGimli_RUNB    Frames:3 12
        AnimationSound = Sound:BodyFallSoldier           Animation:RUGimli_SKL.RUGimli_LNDA    Frames:2
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUGimli_SKL.RUGimli_DIEA    Frames:11
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUGimli_SKL.RUGimli_DIEC    Frames:59
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK GRAB_AND_DROP PATH_THROUGH_EACH_OTHER


    Body = DelayedDeathBody ModuleTag_DelayedDeathBody
        CheerRadius                      = EMOTION_CHEER_RADIUS
        MaxHealth                        = 1300
        MaxHealthDamaged                 = 600
        MaxHealthReallyDamaged           = 75
        DelayedDeathTime                 = 15000
        DelayedDeathPrerequisiteUpgrade  = Upgrade_LastStandZwerge
        PermanentlyKilledByFilter        = NONE
        BurningDeathBehavior             = Yes
        BurningDeathFX                   = FX_InfantryBurningFlame
    End


    Behavior LifetimeUpdate LifetimeTag
        WaitForWakeUp    =    Yes
    End



    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagGuardian
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = SubObjectsUpgrade ForgedBlade_UpgradeGuardian
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End

    Behavior = SubObjectsUpgrade SiegeHammer_UpgradeGuardian
        TriggeredBy       = Upgrade_DwarvenMithrilMail
        HideSubObjects    = AXE02
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End
	
    Behavior = ObjectCreationUpgrade ModuleTag_MithrilMailPalantirFix
        TriggeredBy  = Upgrade_TechnologyDwarvenMithrilMail
        GrantUpgrade = Upgrade_HeavyArmor
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    DwarvenGuardianFunctions
        MinCowerTime                =    3000
        MaxCowerTime                =    5000
        AttackPriority                =     AttackPriority_Cavalry
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HordeMemberCollide ModuleTag_HMC
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL -KNOCKBACK -FADED -EXTRA_8
        SinkDelay            = 3000
        SinkRate            = 0.90
        DestructionDelay    = 15000
        Sound                = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes            = NONE +KNOCKBACK
        SinkDelay            = 3000
        SinkRate            = 0.60
        DestructionDelay    = 10000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_2
        Sound = INITIAL SpellGenericUnsummonMS
    End


    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        TriggeredBy             = Upgrade_ObjectLevel2
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        Duration                = 20000
        AttributeModifier       = SchlachterSlayer
        LockWeaponSlot          = SECONDARY
        StartsPaused            = Yes
    End


    Behavior = SpecialPowerModule ModuleTag_ZealotBoomAxeStarter
        SpecialPowerTemplate        = SpecialAbilityZealotBoomAxe
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ZealotBoomAxeWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityZealotBoomAxe
        WhichSpecialWeapon         = 1
        PackTime                   = 2500
        StartAbilityRange          = 200
        SpecialWeapon              = DwarvenZealotBoomAxeRangeFinder
        ApproachUntilMembersInRange = Yes
        TriggerSound               = AxtschwingerVoiceAttack
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityZealotBoomAxe
        SpecialAbility          = SpecialAbilityZealotBoomAxe
        MaxScanRange            = 150
        Query                   = 5 ANY ENEMIES +INFANTRY
    End


    Scale = 0.88
    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight        = 19.2
    GeometryIsSmall        = No

    Shadow            = SHADOW_DECAL
    ShadowSizeX            = 19
    ShadowSizeY            = 19
    ShadowTexture        = ShadowI
End


Object DwarvenOrocarniBanner

    SelectPortrait         = UPDwarvenGuardian

    Draw = W3DScriptedModelDraw ModuleTag_01


        ExtraPublicBone = Glow
        ExtraPublicBone = Adornment
        ExtraPublicBone = Streamers

        OkToChangeModelColor = Yes
        StaticModelLODMode = Yes

        RandomTexture = duereborban.tga 0 dueisenban.tga

        DefaultModelConditionState
            Model       = DUEisenBan_SKN
            Skeleton    = DUAxDBan_SKL
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model = GUBanner_SKN
            Skeleton = GUBanner_SKL
        End



        AnimationState                =    FREEFALL USER_3
            Animation                =    free fall
                AnimationName        =    GUBanner_FLLA
                AnimationMode        =    LOOP
            End
        End


        AnimationState                =    STUNNED_FLAILING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                = DYING USER_3 DEATH_1
            Animation
                AnimationName        = GUBanner_IDLA
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH USER_3
            Animation
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                = DYING DEATH_1
            Animation
                AnimationName        = DUAxDBan_IDLB
                AnimationMode        = LOOP
            End
        End
        AnimationState                =    DYING BURNINGDEATH
            Animation
                AnimationName        =    DUAxDBan_DIEA
                AnimationMode        =    ONCE
                AnimationBlendTime    =    10
            End
        End

        AnimationState                =    DYING SPLATTED USER_3
            Animation                =    splatted
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =    DYING USER_3
            Animation                =    JustDie
                AnimationName        =    GUBanner_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = DIEA
                AnimationName     = DUAxDBan_DIEA
                AnimationMode     = ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP USER_3
            Animation                =    StandUp
                AnimationName        =    GUBanner_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED USER_3
            Animation                =    Land
                AnimationName        =    GUBanner_LNDA
                AnimationMode        =    ONCE
            End
        End






        AnimationState                =    DEATH_2 USER_3
            Animation                =    JustDie
                AnimationName       =    GUBanner_DIEA
                AnimationMode       =    ONCE
            End
        End

        AnimationState                        = BURNINGDEATH USER_3
            Animation
                AnimationName                = GUBanner_MFDA
                AnimationMode                = LOOP
                Distance                    = 50
            End
        End
        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = DUAxDBan_MFDA
                AnimationMode                = LOOP
                Distance                    = 90
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBanner_IDLA
                AnimationMode                = LOOP
            End
        End



        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR USER_3
            Animation                    = TerrorFromTheSky
                AnimationName            = GUBanner_RUNB
                AnimationMode            = LOOP
            End
        End


        AnimationState                    = MOVING BACKING_UP USER_3
            Animation                    = BACKING UP
                AnimationName            = GUBanner_BAKA
                AnimationMode            = LOOP
            End
        End


        AnimationState = MOVING ENGAGED USER_3
            Animation = Moving_Engaged
                AnimationName = GUBanner_RUNC
                AnimationMode = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING USER_3
            Animation                =    RunA
                AnimationName        =    GUBanner_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    FIRING_OR_PREATTACK_A USER_3
            Animation                =    AttackA1
                AnimationName        =    GUBanner_ATKA
                AnimationMode        =    ONCE
            End
        End




        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = DUAxDBan_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        IdleAnimationState
            Animation                =    IdleB
                AnimationName        =    DUAxDBan_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
                AnimationPriority = 1
            End
            StateName           = Idle
        End



        AnimationState                    = MOVING EMOTION_TERROR BACKING_UP
            Animation                    = Terror
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationSpeedFactorRange 1.5 1.5
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY
            Animation                    = TerrorFromTheSky
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = MOVING EMOTION_TERROR
            Animation                    = Terror
                AnimationName            = DUAxDBan_RUNA
                AnimationMode            = LOOP
            End
        End


        AnimationState        = STUNNED_FLAILING
            Animation           = StunFlail
                AnimationName     = DUAxDBan_FLYA
                AnimationMode      = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

                AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = DUAxDBan_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = DUAxDBan_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = DUAxDBan_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming      = Yes
            End
            StateName           = Attack
        End

        AnimationState  = COMING_OUT_OF_FACTORY
            Animation = Being_Built
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        End

        AnimationState                    = MOVING BACKING_UP
            Animation                    = BackingUp
                AnimationName            = DUAxDBan_BAKA
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End
            Flags                        = RANDOMSTART
        End

        AnimationState                = MOVING ALTERNATE_FORMATION PASSENGER_VARIATION_1
            Animation                = RunningSlowerInAFighterAlternateFormation
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .5 .5
            End
            Flags                    = RANDOMSTART

        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = DUAxDBan_RUNA
                AnimationMode        = LOOP
                AnimationSpeedFactorRange = .8 .8
            End
            Flags                    = RANDOMSTART

        End



        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = GUBanner_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID USER_3
            Animation                    =    Apprehensive
                AnimationName            =    GUBanner_APPA
                AnimationMode            =    LOOP
            End
        End
        AnimationState                    =    EMOTION_ALERT EMOTION_AFRAID
            Animation                    =    Apprehensive
                AnimationName            =    DUAxDBan_FERA
                AnimationMode            =    LOOP
            End
        End



        AnimationState                    = EMOTION_AFRAID USER_3
            Animation                    = FERA
                AnimationName            = GUBanner_FERA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_AFRAID
            Animation                    = FERA
                AnimationName            = DUAxDBan_FERA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_TAUNTING USER_3
            Animation                    = Taunting
                AnimationName            = GUBanner_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End
        AnimationState                    = EMOTION_TAUNTING
            Animation                    = Taunting
                AnimationName            = DUAxDBan_TNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_POINTING USER_3
            Animation                    = &&POINT&&
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End
        End
        AnimationState                    = EMOTION_POINTING
            Animation                    = &&POINT&&
                AnimationName            = DUAxDBan_PNTA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_CELEBRATING USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = ONCE
                AnimationBlendTime        = 74
                AnimationMustCompleteBlend = Yes
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_CELEBRATING
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End



        AnimationState                    = EMOTION_ALERT USER_3
            Animation                    = IDLA
                AnimationName            = GUBanner_IDLA
                AnimationMode            = LOOP
            End

        End
        AnimationState                    = EMOTION_ALERT
            Animation                    = IDLA
                AnimationName            = DUAxDBan_IDLA
                AnimationMode            = LOOP
            End





        End

        AnimationState                    = RAISING_FLAG USER_3
            Animation                    = CheerA
                AnimationName            = GUBanner_CHRA
                AnimationMode            = LOOP
            End
        End


        AnimationState                    =    SELECTED USER_3
            StateName                    =    STATE_Selected_User_3
            Animation                    =    AtAttention
                AnimationName            =    GUBanner_ATNB
                AnimationMode            =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_User3" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected3") end
            EndScript
        End



        AnimationState                    = RAISING_FLAG
            Animation                    = CHRA
                AnimationName            = DUAxDBan_CHRA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = SELECTED
            StateName                    = STATE_Selected
            Animation                    = ATNB
                AnimationName            = DUAxDBan_ATNB
                AnimationMode            = LOOP
                AnimationBlendTime        = 15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_To_Selected") end
            EndScript
        End

        AnimationState                    =    USER_3
            StateName                    =    State_User3
            Animation                    =    IdleB
                AnimationName            =    GUBanner_IDLB
                AnimationMode            =    LOOP
                AnimationBlendTime        =    15
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected_User_3" then CurDrawableSetTransitionAnimState("TRANS_Selected3_To_Idle") end
            EndScript
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    DUAxDBan_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected3
            Animation                    =    ATNA
                AnimationName            =    GUBanner_ATNA
                AnimationMode            =    ONCE
            End
        End


        TransitionState                    =    TRANS_Selected3_to_Idle
            Animation                    =    ATNC
                AnimationName            =    GUBanner_ATNC
                AnimationMode            =    ONCE
            End
        End

    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0
    Scale = 0.88
    ShockwaveResistance          = 40

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY    DwarvenGuardianAxe
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = DwarfInfantryArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = DwarfInfantryHeavyArmor

    End
    ArmorSet
        Conditions      = PLAYER_UPGRADE_2
        Armor           = DwarfInfantryMithrilArmor

    End

    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 2.0%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    ShroudClearingRange = 300

    DisplayName = OBJECT:DwarvenOrocarniBanner

    CrusherLevel = 0
    CrushableLevel = 0
    MountedCrusherLevel = 1
    MountedCrushableLevel = 3
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = KnightCrush

    BuildCost         = DWARVEN_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = 8

    CommandSet        = EmptyCommandSet




    VoiceAttack                       = AxtschwingerVoiceAttack
    VoiceAttackCharge                 = AxtschwingerVoiceAttack
    VoiceAttackMachine                = AxtschwingerVoiceAttack
    VoiceAttackStructure              = AxtschwingerVoiceAttack
    VoiceCreated                      = AxtschwingerVoiceRecruit
    VoiceFullyCreated                 = AxtschwingerVoiceRecruit
    VoiceGuard                        = AxtschwingerVoiceMove
    VoiceMove                         = AxtschwingerVoiceMove
    VoiceMoveToCamp                   = AxtschwingerVoiceMove
    VoiceMoveWhileAttacking           = AxtschwingerVoiceMove
    VoicePriority                     = 57
    VoiceRetreatToCastle              = AxtschwingerVoiceMove
    VoiceSelect                       = AxtschwingerVoiceSelect
    VoiceSelectBattle                 = AxtschwingerVoiceSelect


    SoundImpact                       = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                          = AxtschwingerVoiceMove
        VoiceEnterUnitElvenTransportShip       = AxtschwingerVoiceMove
        VoiceInitiateCaptureBuilding           = AxtschwingerVoiceMove
        VoiceEnterStateInitiateCaptureBuilding = AxtschwingerVoiceMove
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = Dwarf

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Dwarf_Guardian
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_LNDA    Frames:5
        AnimationSound = Sound:BodyFallGeneric1        Animation:DUAXDBAN_SKL.DUAXDBAN_DIEA    Frames:39
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 1500
        MaxHealthDamaged  = 700
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority             = AttackPriority_Infantry
        AILuaEventsList            = GondorFighterFunctions
        BurningDeathTime           = BURNINGDEATH_DURATION_INFANTRY
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeStarter
        SpecialPowerTemplate        = SpecialAbilityDwarvenCharge
        UpdateModuleStartsAttack    = Yes
        InitiateSound               = DwarfGuardianVoiceBullRush
    End

    #include "..\..\..\includes\DwarvenChargeUpdate.inc"

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf                     = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance             = 150
        FearScanDistance             = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanSpecialChargeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_SLOW_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL DwarfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End



    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection

    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes            = NONE +FADED
        FadeDelay            = 0
        FadeTime            = 5000
        DestructionDelay    = 5000
        DeathFlags            = DEATH_1
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End


    Behavior = BezierProjectileBehavior ModuleTag_08
        FirstHeight = 24
        SecondHeight = 24
        FirstPercentIndent = 30%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes
        DieOnImpact = Yes
        BounceCount = 1
        BounceDistance = 40
        BounceFirstHeight = 24
        BounceSecondHeight = 24
        BounceFirstPercentIndent = 20%
        BounceSecondPercentIndent = 80%

        GroundHitFX       = FX_ThrownRockGroundHit
        GroundBounceFX    = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow Glow1
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagHeavyArmor
        TriggeredBy     = Upgrade_HeavyArmor
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTagAxe
        TriggeredBy     = Upgrade_DwarvenMithrilMail
        ArmorSetFlag    = PLAYER_UPGRADE_2
    End



    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End

Object DwarvenOrocarniHorde

    ButtonImage        = HIHammertrager_Wotr
    SelectPortrait    = UPHammertrager

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUDFG
        End
    End

    Side = Dwarves
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:DwarvenOrocarniHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DwarvenOrocarniHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DwarvenOrocarniHorde

    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY     NormalMeleeHordeRangefinder
        Weapon                = SECONDARY   NormalMeleeHordeRangefinder
        Weapon                = TERTIARY    DwarvenZealotBoomAxeRangeFinder
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources     = SECONDARY NONE
        AutoChooseSources     = TERTIARY FROM_PLAYER FROM_SCRIPT
        ShareWeaponReloadTime = Yes
    End

    MaxSimultaneousOfType           = 3

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 650
    BuildTime = STRONG_BUILDTIME
    VisionRange = 250
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    FormationWidth = 1
    FormationDepth = 1

    CrushableLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 120
    ThreatBreakdown DwarvenGuardianHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000

        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                = DwarvenOrocarni 10
        Slots                    = 10
        PassengerFilter                = NONE +INFANTRY
        ShowPips                = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0

        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = DwarvenOrocarniBanner
        BannerCarrierPosition    = UnitType:DwarvenOrocarni   Pos:X:50.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DwarvenOrocarni Position:X:30 Y:0              Position:X:30 Y:20              Position:X:30 Y:-20              Position:X:30 Y:40              Position:X:30 Y:-40
        RankInfo = RankNumber:2 UnitType:DwarvenOrocarni Position:X:10 Y:0              Position:X:10 Y:20              Position:X:10 Y:-20              Position:X:10 Y:40              Position:X:10 Y:-40


        RanksToReleaseWhenAttacking        = 1 2

        MeleeAttackLeashDistance        = 50
        BackUpMinDelayTime            = 1
        BackUpMaxDelayTime            = 3000
        BackUpMinDistance            = 1
        BackUpMaxDistance            = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 60.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor     = NormalChargeMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
    End
	
    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_FAST_MEMBER_SPEED
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    CommandSet = DwarvenOrocarniHordeCommandSet

    Behavior = CommandSetUpgrade ModuleTag_MithrilCommandSet
        TriggeredBy       = Upgrade_TechnologyDwarvenMithrilMail
        CommandSet        = DwarvenOrocarniHordeCommandSet_Mithril
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        TriggeredBy             = Upgrade_ObjectLevel2
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        Duration                = 20000
        AttributeModifier       = SchlachterSlayer
        LockWeaponSlot          = SECONDARY
        StartsPaused            = Yes
    End


    Behavior = SpecialPowerModule ModuleTag_ZealotBoomAxeStarter
        SpecialPowerTemplate        = SpecialAbilityZealotBoomAxe
        UpdateModuleStartsAttack    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ZealotBoomAxeWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityZealotBoomAxe
        WhichSpecialWeapon          = 1
        PackTime                    = 2500
        StartAbilityRange           = 200
        SpecialWeapon               = DwarvenZealotBoomAxeRangeFinder
        ApproachUntilMembersInRange = Yes
        TriggerSound                = DwarfZerkVoiceLeap
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityZealotBoomAxe
        SpecialAbility          = SpecialAbilityZealotBoomAxe
        MaxScanRange            = 150
        Query                   = 5 ANY ENEMIES +INFANTRY
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_DwarvenMithrilMail
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality16
        TriggeredBy = Upgrade_LastStandZwerge
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality17
        TriggeredBy = Upgrade_HeavyArmor
    End
	
    Behavior = AISpecialPowerUpdate DwarvenGuardianHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_DwarvenGuardianHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_DwarvenGuardianArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_DwarvenGuardianUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_DwarvenGuardianWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End