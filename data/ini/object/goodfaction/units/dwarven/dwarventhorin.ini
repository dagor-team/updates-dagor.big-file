Object DwarvenThorin

    SelectPortrait = HPKingThorin
    ButtonImage    = HIThorin2 ;HIKingThorin

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Dain

    Draw = W3DScriptedModelDraw ModuleTag_01

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        DefaultModelConditionState
            Model                       = euthorin_trav
        End

        ModelConditionState             = USER_2
            Model                       = euthorin_gold
        End

		ModelConditionState = USER_10
            ParticleSysBone = BAT_RIBS WillofDurinLight FollowBone:Yes
        End
		
		ModelConditionState = USER_7
            ParticleSysBone = BAT_RIBS GCglowforking FollowBone:Yes
        End


        IdleAnimationState
            StateName = Idle
            Animation           = IDLB
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLB
                AnimationMode     = ONCE
                AnimationPriority   = 20
            End
            Animation           = IDLD
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLD
                AnimationMode     = ONCE
                AnimationPriority   = 1
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        TransitionState       = Trans_None_To_Sword
            Animation           = GUBoromir_STHA
                AnimationName     = GUBoromir_SKL.GUBoromir_STHA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = Trans_Sword_To_None
            Animation           = GUBoromir_STHB
                AnimationName     = GUBoromir_SKL.GUBoromir_STHB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = GUBoromir_FLYA
                AnimationName     = GUBoromir_SKL.GUBoromir_FLYA
                AnimationMode     = LOOP
            End
        End




        AnimationState        = DYING SPLATTED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = GUBoromir_SKL.GUBoromir_MFDA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = GUBoromir_DTHA
                AnimationName     = GUBoromir_SKL.GUBoromir_DTHA
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBoromir_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GUBoromir_GTPA
                AnimationName     = GUBoromir_SKL.GUBoromir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = PACKING_TYPE_2
            StateName          =    CaptainPower
            Animation           = GUBoromir_CHRA
                AnimationName     = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = SPECIAL_WEAPON_THREE
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword

            Animation           = GUBoromir_WLKA
                AnimationName     = GUBoromir_SKL.GUBoromir_WLKA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING WANDER

            Animation           = GUBoromir_WLKA
                AnimationName     = GUBoromir_SKL.GUBoromir_WLKA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUBoromir_SKL.GUBoromir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = MOVING

            Flags               = RANDOMSTART
            Animation           = GUBoromir_RUNB
                AnimationName     = GUBoromir_SKL.GUBoromir_RUNA
                AnimationMode     = LOOP
            End
        End



        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = ATKA
                AnimationName     = GUBoromir_SKL.GUBoromir_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName    = GUBoromir_SKL.GUBoromir_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = GUBoromir_ATD1
                AnimationName     = GUBoromir_SKL.GUBoromir_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATND
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATNE
                AnimationMode            =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    GUBoromir_SKL.GUBoromir_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End


        AnimationState            = EMOTION_TAUNTING
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
        End

        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            =  GUBoromir_SKL.GUBoromir_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End



        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = GUBoromir_SKL.GUBoromir_HITA
                AnimationMode = ONCE
            End
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_LightController
        DefaultModelConditionState
            Model                       = None
        End
        ModelConditionState = SPECIAL_ENEMY_NEAR USER_1
            Model                       = euthoringlow
            Shadow                      = SHADOW_ADDITIVE_DECAL_DYNAMIC
            ShadowSizeX                 = 100
            ShadowSizeY                 = 100
            ShadowTexture               = EXFrodoStingGlow
            ShadowOpacityStart          = 0
            ShadowOpacityFadeInTime     = 1000
            ShadowOpacityPeak           = 255
            ShadowOpacityFadeOutTime    = 1000
            ShadowOpacityEnd            = 0
            ShadowOverrideLODVisibility = Yes
        End
        AttachToBoneInAnotherModule     = B_SWORDBONE
    End


    Draw = W3DScriptedModelDraw Icon2
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw FX
        ModelConditionState = NONE
            Model           = exdwrunefx
        End
    End




    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side                 = Dwarves
    EditorSorting        = UNIT
    ThreatLevel          = DAIN_THREAT_LEVEL
    TransportSlotCount   = TRANSPORTSLOTCOUNT_HERO
    BuildCost            = THORINDAG_COST
    BuildTime            = STRONG_HERO_BUILDTIME
    DisplayMeleeDamage   = THORINDAG_DAMAGE
    HeroSortOrder        = 40
    Scale                = 0.75

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY  ThorinSword
    End
	
	WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon     = PRIMARY  ThorinOrcrist
    End


    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = VeryStrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange            = 200
    ShroudClearingRange = 350

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     = DWARVEN_DAIN_BOUNTY_VALUE
    DisplayName = OBJECT:DwarvenThorin
    RecruitText = CONTROLBAR:DwarfenThorinRecruit
    ReviveText    = CONTROLBAR:DwarfenThorinRevive
    Hotkey        = CONTROLBAR:ThorinHotkey
    CrushableLevel    = 3

    CommandSet  = ThorinCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_DainBody

    AutoResolveArmor
        Armor = AutoResolve_DainArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_DainWeapon
    End

    AutoResolveLeadership = AutoResolve_DainBonus




            VoiceAttack                 = ThorinVoiceAttack
            VoiceAttackAir              = ThorinVoiceAttack
            VoiceAttackCharge           = ThorinVoiceAttack
            VoiceAttackMachine          = ThorinVoiceAttack
            VoiceAttackStructure        = ThorinVoiceAttack
            VoiceCreated                = ThorinVoiceRecruit
            VoiceFullyCreated           = ThorinVoiceRecruit
            VoiceFear                   = ThorinVoiceHelp
            VoiceGuard                  = ThorinVoiceMove
            VoiceMove                   = ThorinVoiceMove
            VoiceMoveToCamp             = ThorinVoiceMove
            VoiceMoveWhileAttacking     = ThorinVoiceMove
            VoicePriority               = 95
            VoiceRetreatToCastle        = ThorinVoiceMove
            VoiceSelect                 = ThorinVoiceSelect
            VoiceSelectBattle           = ThorinVoiceSelect

            SoundImpact                 = ImpactHorse

            UnitSpecificSounds
            VoiceEnterUnitElvenTransportShip   = ThorinVoiceMove
            VoiceEnterUnitMordorMumakil        = ThorinVoiceMove
            VoiceEnterUnitSlaughterHouse       = ThorinVoiceMove
            VoiceEnterUnitTransportShip        = ThorinVoiceMove
            VoiceGarrison                      = ThorinVoiceMove
            VoiceInitiateCaptureBuilding       = ThorinVoiceMove
            End

    CrowdResponseKey = DwarfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Unit Infantry Hero
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDainVoxTauntLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDainVoxCheerLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA           Animation:GUBoromir_SKL.GUBoromir_RUNA     Frames:10 22
        AnimationSound = Sound:FootstepDirtA           Animation:GUBoromir_SKL.GUBoromir_RUNB     Frames:10 22
        AnimationSound = Sound:FootstepDirtA           Animation:GUBoromir_SKL.GUBoromir_ATRA     Frames:11 23 35 47
        AnimationSound = Sound:FootstepDirtA           Animation:GUBoromir_SKL.GUBoromir_MFDA     Frames:8 20 31 41
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUBoromir_SKL.GUBoromir_DTHA     Frames:116
        AnimationSound = Sound:BodyFallSoldier         Animation:GUBoromir_SKL.GUBoromir_LNDA     Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:GUBoromir_SKL.GUBoromir_SPCE     Frames:82
    End


    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT HERO ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                     = EMOTION_CHEER_RADIUS
        MaxHealth                       = THORINDAG_HEALTH
        PermanentlyKilledByFilter 		= NONE
        DodgePercent               		= HERO_DODGE_PERCENT
    End
	

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                 = DYING
        DeathAnimationTime        = 4100
        RespawnAnim               = LEVELED
        RespawnAnimationTime      = 2000
        AutoRespawnAtObjectFilter = NONE +CASTLE_KEEP
        ButtonImage               = HIThorin2 ;HIKingThorin
        RespawnAsTemplate         = DwarvenThorin

        RespawnRules =    AutoSpawn:No           Cost:3600       Time:STRONG_HERO_RESPAWNTIME        Health:100%
   End

    Behavior = AutoHealBehavior ModuleTag_DainHealing
        StartsActive            = Yes
        HealingAmount           = HERO_HEAL_AMOUNT
        HealingDelay            = 1000
        StartHealingDelay       = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat   = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        HoldGroundCloseRangeDistance  = 60
        AILuaEventsList               = ThorinFunctions
    End

    LocomotorSet
        Locomotor = RohanGimliLocomotor
        Condition = SET_NORMAL
        Speed     = EREDLUIN_DWARF_HERO_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult                = 1.0
        AllowBouncing            = No
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 2600
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL -KNOCKBACK
        SinkDelay            = 3000
        SinkRate            = 0.40
        DestructionDelay    = 8000
        Sound                = INITIAL ThorinVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = SlowDeathBehavior ModuleTag_07
        DeathTypes            = NONE +KNOCKBACK
        SinkDelay            = 3000
        SinkRate            = 0.40
        DestructionDelay    = 8000
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
        TauntAndPointUpdateDelay    =    1000
        AddEmotion            =    Doom_Base

        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base

        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2200
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 1.0
        HitReactionThreshold2 = 2500.0
        HitReactionThreshold3 = 5000.0
    End

;--------------------------------------------------------------------------------------------------------

	Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                    = No
        TriggeredBy                        = Upgrade_Level_3 Upgrade_TestBuilding_2
		RequiresAllTriggers				   = Yes
        WhichSpecialPower                  = 1
        GenerateTerror                     = No
        GenerateFear                       = Yes
        EmotionPulseRadius                 = 100
        EmotionPulseInterval               = 1000
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = CommandSetUpgrade ModuleTag_CommandSetAI
        TriggeredBy    = Upgrade_ObjectUnderAIControl
        CommandSet     = ThorinKingCommandSet
    End

;--------------------------------------------------------------------------------------------------------

        Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ClanversammlungEnabler
            SpecialPowerTemplate     = SpecialAbilityDainClanversammlung
            TriggeredBy          = Upgrade_DwarvenMithrilMailHeroes Upgrade_DwarvenMithrilMailHeroes Upgrade_Level_5
            RequiresAllTriggers  = Yes   
        End

    Behavior = OCLSpecialPower ModuleTag_OCLSpecialPowerClanversammlung
        SpecialPowerTemplate     = SpecialAbilityDainClanversammlung
        OCL                      = OCL_SpawnDainClanEgg
        CreateLocation           = CREATE_AT_LOCATION
        StartsPaused             = Yes
    End
	
;--------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_FactionLeaderLeadership
        StartsActive     = Yes
        BonusName        = FactionLeaderGlobalLeadership
        RefreshDelay     = 2000
        Range            = 625
        ObjectFilter     = DWARF_LEADERSHIP_UNITS_OBF
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
        StartsActive              = Yes
        BonusName                 = ThorinKonigderZwerge
        RefreshDelay              = 2000
        Range                     = 200
        AllowSelf                 = No
        ObjectFilter              = ANY +DwarvenOri +DwarvenBilbo +DwarvenMurin +DwarvenDrar +DwarvenThorinIII +DwarvenBombur +DwarvenDainErebor +DwarvenOin +DwarvenDwalin +DwarvenGloin_mod +DwarvenBalin +DwarvenDain +DwarvenDain_mod +DwarvenDurin2 +DwarvenDurin +RohanGimli +DwarvenGimli +RohanGimli +DwarvenGimliMod +DwarvenGimli -DwarvenCarc ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership11
        StartsActive              = Yes
        BonusName                 = ThorinKonigderZwergeSelf
        RefreshDelay              = 2000
        Range                     = 1
        AllowSelf                 = Yes
        ObjectFilter              = ANY +DwarvenThorin ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive              = Yes
        BonusName                 = ThorinKonigderZwergeUnits
        TriggeredBy               = Upgrade_BilboArkenstone
        RefreshDelay              = 2000
        Range                     = 200

        ObjectFilter              = ANY -HERO -GIMLI +INFANTRY +CAVALRY -MACHINE -IMMOBILE +DOZER -STRUCTURE -BASE_FOUNDATION -HORDE -DwarvenBattleWagon -RohanOathbreaker -MordorRamCrew +MordorWorker -IsengardRamCrew -IsengardBeserker -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde -GondorKnightsofDol -GondorKnightsofDolHorde -WildBabyDrake -WildBabyDrakeHorde -MordorBlackRider -MordorBlackRiderHorde -IsengardFanatic -IsengardBerserkerHorde ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_PillageAura
        StartsActive    = Yes
        BonusName       = ThorinPassiveOutlawLeadership
        RefreshDelay    = 2000
        Range           = 200
        AllowSelf       = Yes
        ObjectFilter    = ANY +HERO +INFANTRY +CAVALRY SAME_PLAYER
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = SpecialEnemySenseUpdate ModuleTag_StingSeesOrcs
        SpecialEnemyFilter = ALL
        ScanRange = 20
        ScanInterval = 2000
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy = Upgrade_TestBuilding_2
        CustomAnimAndDuration = AnimState:WEAPONSET_TOGGLE_1 AnimTime:0
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        Duration                = 30000
        AttributeModifier        = PalantirVision
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        StartsPaused            = No
    End

;--------------------------------------------------------------------------------------------------------

   Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Dwarves
      SpecialPowerTemplate      = SpecialAbilityThorinPin
      TriggeredBy               = Upgrade_Level_3
      ObeyRechageOnTrigger      = Yes
   End

   Behavior = SpecialPowerModule ModuleTag_DwarvesStarter
      SpecialPowerTemplate      = SpecialAbilityThorinPin
      UpdateModuleStartsAttack  = Yes
      StartsPaused              = Yes
      TriggerFX                 = FX_AttachSpy
   End

   Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_DwarvesUpdate
       SpecialPowerTemplate     = SpecialAbilityThorinPin
       SkipContinue             = Yes
       UnpackTime               = 1100
       PackTime                 = 500
       PersistentPrepTime       = 500
       AwardXPForTriggering     = 0
       StartAbilityRange        = 300
       ApproachRequiresLOS      = Yes
       SpecialWeapon            = ThorinKilliandFilliWeapon
       WhichSpecialWeapon       = 1
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroInvulnerabilityEnabler_Level2
        SpecialPowerTemplate         = SpecialAbilityCreateAHeroInvulnerability_Level2
        TriggeredBy                  = Upgrade_Level_7
        ObeyRechageOnTrigger         = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_CreateAHeroInvulnerabilityStarter_Level2
        SpecialPowerTemplate         = SpecialAbilityCreateAHeroInvulnerability_Level2
        UpdateModuleStartsAttack     = No
        StartsPaused                 = Yes
        AttributeModifier            = CreateAHeroInvulnerabilityBonus_Level1
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +INFANTRY +HERO ALLIES
        AttributeModifierFX          = FX_CreateAHeroInvulnerability_Start2
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CreateAHeroInvulnerabilityEnabler_Level3
        SpecialPowerTemplate         = SpecialAbilityCreateAHeroInvulnerability_Level3
        TriggeredBy                  = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_CreateAHeroInvulnerabilityStarter_Level3
        SpecialPowerTemplate         = SpecialAbilityCreateAHeroInvulnerability_Level3
        UpdateModuleStartsAttack     = No
        StartsPaused                 = Yes
        AttributeModifier            = CreateAHeroInvulnerabilityBonus_Level1
        AttributeModifierRange       = 200
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +DwarvenThorin +INFANTRY +HERO ALLIES
        AttributeModifierFX          = FX_CreateAHeroInvulnerability_Start2
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingDwarvesEnabler
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        TriggeredBy               = Upgrade_BilboArkenstone
    End

    Behavior = SpecialPowerModule ModuleTag_KingDwarvesUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = ModelConditionUpgrade ModuleTag_ShowGoldenThorin
        TriggeredBy               = Upgrade_BilboArkenstone
        AddConditionFlags         = USER_2
        Permanent                 = Yes
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArkensteinEnabler
        SpecialPowerTemplate      = SpecialAbilityThorinArkensteinRadius
        TriggeredBy               = Upgrade_BilboArkenstone Upgrade_Level_5
		RequiresAllTriggers		  = Yes
        ObeyRechageOnTrigger      = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ArkensteinStarter
        SpecialPowerTemplate      = SpecialAbilityThorinArkensteinRadius
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
		;TriggerSound	= DuBekar
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ArkensteinWeaponFireUpdate
        SpecialPowerTemplate      = SpecialAbilityThorinArkensteinRadius
        WhichSpecialWeapon        = 3
        SkipContinue              = Yes
        UnpackTime                = 1700
        PackTime                  = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering      = 0
        StartAbilityRange         = 80.0
        SpecialWeapon             = ThorinArkensteinWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_WordOfPowerAutoAbility
		SpecialAbility		= SpecialAbilityThorinArkensteinRadius
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
		Query			= 40 ALL ENEMIES
    End

;--------------------------------------------------------------------------------------------------------
	
	Behavior = SpecialPowerModule ModuleTag_HOFTW
        SpecialPowerTemplate          = SpecialAbilityThorinCurse
        StartsPaused                  = Yes
        UpdateModuleStartsAttack      = Yes
    End

    Behavior = CurseSpecialPower ModuleTag_HOFTWUPdate
        SpecialPowerTemplate          = SpecialAbilityThorinCurse
        CursePercentage               = 5.0%
        StartAbilityRange             = 6.0
        CursedFX                      = FX_SarumanDominateTargets
        TriggerFX                     = FX_CreateaHeroCurse
        UnpackTime                    = 0
        PreparationTime               = 0
        FreezeAfterTriggerDuration    = 0
    End
	
	Behavior = AutoAbilityBehavior ModuleTag_HOFTWAutoAbility
		SpecialAbility		= SpecialAbilityThorinCurse
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange		= 6
		Query			= 1 NONE +HERO ENEMIES
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_BilboArkenstone
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_BilboArkenstone
        UpgradeTexture  = duthorintravel2.tga 0 duthorintravel2_HA.tga
        UpgradeTexture  = duthoringold2.tga 0 duthoringold2_HA.tga
    End

;--------------------------------------------------------------------------------------------------------

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

   #include "..\..\..\includes\DwarvenRunesHeroes.inc"

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagMacht
        TriggeredBy       = Upgrade_OriMacht
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagZorn
        TriggeredBy       = Upgrade_OriZorn
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTagEhre
        TriggeredBy       = Upgrade_OriSchicksal
    End


    Behavior = SubObjectsUpgrade ModuleTag_BLAU
        TriggeredBy       = Upgrade_OriMacht
        ShowSubObjects    = BLAU
    End

    Behavior = SubObjectsUpgrade ModuleTag_WEIS
        TriggeredBy       = Upgrade_OriAusdauer
        ShowSubObjects    = WEIS
    End

    Behavior = SubObjectsUpgrade ModuleTag_ROT
        TriggeredBy       = Upgrade_OriZorn
        ShowSubObjects    = ROT
    End

    Behavior = SubObjectsUpgrade ModuleTag_GOLD
        TriggeredBy       = Upgrade_OriSchicksal
        ShowSubObjects    = GOLD
    End

    Behavior = ObjectCreationUpgrade MaketheDori
        TriggeredBy                  = Upgrade_RaiseShield
        Delay                        = 0.0
        ThingToSpawn                 = DwarvenDori_Summoned
        Offset                       = X:0.0 Y:20.0 Z:0.0
        FadeInTime                   = 0
    End

    Behavior = ObjectCreationUpgrade MaketheNori
        TriggeredBy                  = Upgrade_RaiseShield
        Delay                        = 0.0
        ThingToSpawn                 = DwarvenNori_Summoned
        Offset                       = X:0.0 Y:-20.0 Z:0.0
        FadeInTime                   = 0
    End

    Behavior = SlaveWatcherBehavior WatchTheEagle
        RemoveUpgrade                = Upgrade_RaiseShield
        LetSlaveLive                 = Yes
    End




    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate SlamAI
        CommandButtonName  = Command_SpecialAbilityThorinKilliundFilli
        SpecialPowerAIType  = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_STRUCTURES
        SpecialPowerRange   = 200
    End

    Behavior = AISpecialPowerUpdate AragornBladeMasterAI
        CommandButtonName = Command_ThorinEichenschild
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_ThorinGlanzdesArkensteins
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Geometry              = CYLINDER
    GeometryMajorRadius   = 5.6
    GeometryMinorRadius   = 5.6
    GeometryHeight        = 16.0
    GeometryIsSmall       = Yes

    Shadow                = SHADOW_DECAL
    ShadowSizeX           = 19
    ShadowSizeY           = 19
    ShadowTexture         = ShadowI
End

ChildObject DwarvenThorinKing DwarvenThorin
End

ChildObject DwarvenThorin_Kampagne DwarvenThorin

    Draw = W3DScriptedModelDraw ModuleTag_01

        OkToChangeModelColor    = Yes
        StaticModelLODMode      = Yes

        RandomTexture = duthorin_head_Kampa.tga  0 duthorin_head.tga


        DefaultModelConditionState
            Model                       = duthorins_film
            Skeleton                    = RUGimli_SKL
            WeaponLaunchBone            = TERTIARY AXE02
        End

        ModelConditionState             = SPECIAL_ENEMY_NEAR
            Model                       = duthorins_film
            Skeleton                    = RUGimli_SKL
            WeaponLaunchBone            = TERTIARY AXE02
        End

        ModelConditionState             = USER_1
            Model                       = duthorins_film
            Skeleton                    = RUGimli_SKL
            WeaponLaunchBone            = TERTIARY AXE02
        End

        ModelConditionState             = SPECIAL_ENEMY_NEAR USER_1
            Model                       = duthorins_film
            Skeleton                    = RUGimli_SKL
            Shadow                      = SHADOW_ADDITIVE_DECAL_DYNAMIC
            ShadowSizeX                 = 100
            ShadowSizeY                 = 100
            ShadowTexture               = EXFrodoStingGlow
            ShadowOpacityStart          = 0
            ShadowOpacityFadeInTime     = 1000
            ShadowOpacityPeak           = 255
            ShadowOpacityFadeOutTime    = 1000
            ShadowOpacityEnd            = 0
            ShadowOverrideLODVisibility = Yes
        End



        AnimationState        = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            Flags               = RANDOMSTART
            Animation           = mattock_flya
                AnimationName     = RUGimli_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = AxeShield_flya
                AnimationName     = RUGimli_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = DYING SPLATTED WEAPONSET_TOGGLE_1
            Animation           = mattock_LNDA
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING SPLATTED
            Animation           = Axeshield_LNDA
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING WEAPONSET_TOGGLE_1
            Animation           = mattock_DIEA
                AnimationName     = RUGimli_DIEA
                AnimationMode     = ONCE
            End
            Animation           = mattock_DIEC
                AnimationName     = RUGimli_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation           = Axeshield_DIEC
                AnimationName     = RUGimli_DIEC
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            Animation           = mattockgetupa
                AnimationName     = RUGimli_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = Axeshield_GTPA2
                AnimationName     = RUGimli_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End


        AnimationState        = STUNNED WEAPONSET_TOGGLE_1
            Animation           = mattock_land2
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = Axeshield_land2
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState                =    MOVING ATTACKING WEAPONSET_TOGGLE_1
            Animation                =    mattockrunattack
                AnimationName        =    RUGimli_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOVING ATTACKING
            Animation                =    Axeshieldrunattack
                AnimationName        =    RUGimli_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            ShareAnimation        = Yes
            Animation           = RunAndFiremattock
                AnimationName       = RUGimli_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFireAxeshield
                AnimationName       = RUGimli_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOVING WEAPONSET_TOGGLE_1
            Flags               = RANDOMSTART
            Animation           = mattockrunning
                AnimationName     = RUGimli_RUNA
                AnimationMode     = LOOP
            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = axeshieldrunning
                AnimationName     = RUGimli_RUNA
                AnimationMode     = LOOP
            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            Animation           = mattock_ATKA2
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = mattock_ATKB2
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = mattock_ATKC
                AnimationName    = RUGimli_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation             = DUDain_ATKA2
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation             = DUDain_ATKB2
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation             = ATKC
                AnimationName     = RUGimli_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = ATTACKING WEAPONSET_TOGGLE_1
            Animation           = ALERT_2
                AnimationName     = RUGimli_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = RUGimli_IDLA
                AnimationMode     = ONCE
            End
        End

        AnimationState                = LEVELED WEAPONSET_TOGGLE_1
            Animation                = LevelUpb
                AnimationName        = RUGimli_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUGimli_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = RAISING_FLAG WEAPONSET_TOGGLE_1
            Animation                = CHRA
                AnimationName        = RUGimli_CHRA
                AnimationMode        = LOOP
            End
        End

        AnimationState                = RAISING_FLAG
            Animation                = CHRA
                AnimationName        = RUGimli_CHRA
                AnimationMode        = LOOP
            End
        End

        AnimationState                = EMOTION_POINTING WEAPONSET_TOGGLE_1
            Animation                = CHRA
                AnimationName        = RUGimli_tntb
                AnimationMode        = LOOP
            End
        End

        AnimationState                = EMOTION_POINTING
            Animation                = CHRA
                AnimationName        = RUGimli_tntb
                AnimationMode        = LOOP
            End
        End

        AnimationState            = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            Animation           = CHRAb
                AnimationName   = RUGimli_CHRA
                AnimationMode   = LOOP
            End
            Animation           = CHRAb
                AnimationName   = RUGimli_CHRB
                AnimationMode   = LOOP
            End
        End

        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRAb
                AnimationName   = RUGimli_CHRA
                AnimationMode   = LOOP
            End
            Animation           = CHRAb
                AnimationName   = RUGimli_CHRB
                AnimationMode   = LOOP
            End
        End


        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            = RUGimli_TNTA
                AnimationMode            = ONCE
            End
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH WEAPONSET_TOGGLE_1
            Animation                    = Taunting
                AnimationName            = RUGimli_TNTA
                AnimationMode            = ONCE
            End
        End


        AnimationState        = EMOTION_ALERT WEAPONSET_TOGGLE_1
            Animation             = ALERT_1b
                AnimationName     = RUGimli_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = EMOTION_ALERT
            Animation             = ALERT_1
                AnimationName     = RUGimli_IDLA
                AnimationMode     = LOOP
            End
        End



        AnimationState        =  SPECIAL_WEAPON_ONE
            Animation           = ATKA
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
            End
            Animation           = ATKB
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
            End
            Animation           = ATKC
                AnimationName     = RUGimli_ATKC
                AnimationMode     = ONCE
            End
            ParticleSysBone = NONE GloinBlastSlam    FollowBone:Yes
        End


        ModelConditionState = SPECIAL_WEAPON_THREE
            Model                       = duthorink_film
            Skeleton                    = RUGimli_SKL
            Shadow                      = SHADOW_ADDITIVE_DECAL_DYNAMIC
            ShadowSizeX                 = 200
            ShadowSizeY                 = 200
            ShadowTexture               = EXGandalfGlow
            ShadowOpacityStart          = 0
            ShadowOpacityFadeInTime     = 1000
            ShadowOpacityPeak           = 255
            ShadowOpacityFadeOutTime    = 1000
            ShadowOpacityEnd            = 0
            ShadowOverrideLODVisibility = Yes
        End

        AnimationState        =  SPECIAL_WEAPON_THREE
            Animation           = TNTB
                AnimationName   = duthorin_spca
                AnimationMode   = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE WEAPONSET_TOGGLE_1
            Animation           = ATKA
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
            End
            Animation           = ATKB
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
            End
            Animation           = ATKC
                AnimationName     = RUGimli_ATKC
                AnimationMode     = ONCE
            End
            ParticleSysBone = NONE GloinBlastSlam    FollowBone:Yes
        End

        AnimationState        =  SPECIAL_WEAPON_THREE WEAPONSET_TOGGLE_1
            Animation           = TNTB
                AnimationName   = duthorin_spca
                AnimationMode   = ONCE
            End
        End




        AnimationState                =    SELECTED WEAPONSET_TOGGLE_1
            StateName                =    Selected_Mattock

            Animation                =    ATNBb
                AnimationName        =    DUThorin_SATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Mattock" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected_Mattock") end
            EndScript
        End

        AnimationState                =    SELECTED
            StateName                =    Selected_Axe

            Animation                =    ATNB
                AnimationName        =    DUGloine_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Sword" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected_Axe") end
            EndScript
        End

        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = Bored_Mattock
            Animation             = IDLB
                AnimationName     = DUThorin_SIDLA
                AnimationMode     = ONCE
                AnimationPriority = 15
            End
            Animation           = IDLB
                AnimationName     = DUThorin_SIDLB
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            Animation           = IDLB
                AnimationName     = DUThorin_SIDLC
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Animation           = IDLB
                AnimationName     = DUThorin_SIDLD
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected_Mattock" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle_Mattock") end
            EndScript
        End

        IdleAnimationState
            StateName = Bored_Axe
            Animation           = IDLB
                AnimationName     = DUThorina_IDLA
                AnimationMode     = ONCE
                AnimationPriority = 15
            End
            Animation           = IDLB
                AnimationName     = DUThorina_IDLB
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            Animation           = IDLB
                AnimationName     = DUThorina_IDLC
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Animation           = IDLB
                AnimationName     = DUThorina_IDLD
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle_Axe") end
            EndScript
        End

        TransitionState                    =    TRANS_Idle_to_Selected_Axe
            Animation                    =    ATNA
                AnimationName            =    DUThorina_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle_Axe
            Animation                    =    ATNC
                AnimationName            =    DUThorina_ATNC
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Idle_to_Selected_Mattock
            Animation                    =    ATNA
                AnimationName            =    DUThorin_SATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle_Mattock
            Animation                    =    ATNC
                AnimationName            =    DUThorin_SATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState = HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
            Animation = Hit_Level_1_ab
                AnimationName = RUGimli_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = RUGimli_HITA
                AnimationMode = ONCE
            End
        End
    End


    Draw = W3DScriptedModelDraw Icon2
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    Draw = W3DScriptedModelDraw FX
        ModelConditionState = NONE
            Model           = exdwrunefx
        End
    End

    CommandSet  = ThorinKampagneCommandSet


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MithrilMine
        SpecialPowerTemplate = SpecialAbilitySpellbookMithrilhemd
        TriggeredBy = Upgrade_ElvenGift
    End

    Behavior = SpecialPowerModule ModuleTag_MithrilMineUpdate
        SpecialPowerTemplate      = SpecialAbilitySpellbookMithrilhemd
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_ElvenGift
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_ElvenGift
        UpgradeTexture  = duthorin_torso2.tga 0 duthorin_torso.tga
    End
End

ChildObject DwarvenThorinKing_Kampagne DwarvenThorin_Kampagne
End