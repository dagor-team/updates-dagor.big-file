Object DwarvenNar

    SelectPortrait         = HPNar
    ButtonImage            = HINar

    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_Gloin

    Draw                        = W3DScriptedModelDraw ModuleTag_01

       OkToChangeModelColor        = No
       StaticModelLODMode          = No

        RandomTexture    = dunar.tga 0 eudwarfaxe.tga



        DefaultModelConditionState
            Model               = DUNar
            Skeleton            = RUGimli_SKL
            WeaponLaunchBone    = TERTIARY AXE02
        End

        ModelConditionState = WEAPONSET_TOGGLE_1
            Model               = DUNar
            Skeleton            = RUGimli_SKL
            ParticleSysBone =  BAT_HEAD NarSlayer FollowBone:Yes
        End







        AnimationState        = STUNNED_FLAILING
            Animation           = FLYA
                AnimationName     = RUGimli_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.3 0.5
            End
            Flags               = RANDOMSTART
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation           = LNDB
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING DEATH_1
            Animation           = DIEA
                AnimationName     = RUGimli_DIEA
                AnimationMode     = ONCE
            End
            Animation           = DIEC
                AnimationName     = RUGimli_DIEC
                AnimationMode     = ONCE
            End




            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = DYING DEATH_2
             Animation           = FadeOut
                AnimationName     = RUGimli_IDLB
                AnimationMode     = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GTPA
                AnimationName     = RUGimli_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED
            Animation           = LNDA
                AnimationName     = RUGimli_LNDA
                AnimationMode     = ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUGimli_IDLA
                AnimationMode                = LOOP
            End
        End






    AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUGimli_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End













































        AnimationState                =    MOVING ATTACKING
            Animation                =    RUNB
                AnimationName        =    RUGimli_RUNB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState                =    MOVING
            Animation                =    RUNA
                AnimationName        =    RUGimli_RUNA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End






        AnimationState        = UNPACKING PACKING_TYPE_1
            Animation           = SPCA
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE

            End
            FrameForPristineBonePositions = 42

            BeginScript
                CurDrawableShowSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End


        AnimationState        = PREPARING PACKING_TYPE_1
            Animation           = SPCA
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE

            End
            FrameForPristineBonePositions = 42

            BeginScript
                CurDrawableShowSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        = PACKING PACKING_TYPE_1
            Animation           = SPCA
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE

            End
            FrameForPristineBonePositions = 42

            BeginScript
                CurDrawableShowSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End



        AnimationState        = UNPACKING PACKING_TYPE_2
            Animation           = ATKA1
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE
            End
            StateName           = STATE_Bow
        End


        AnimationState        = PREPARING PACKING_TYPE_2
            Animation           = ATKA2
                AnimationName     = RUGimli_SPCA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange = 1.4 1.4
            End
            StateName           = STATE_Bow
        End

        AnimationState        = PACKING PACKING_TYPE_2
            Animation           = ATKA3
                AnimationName     = RUGimli_SPCA
                AnimationMode     = LOOP
            End
            StateName           = STATE_Bow
        End


        AnimationState        =  FIRING_OR_PREATTACK_C
            Animation           = SPCA
                AnimationName     = RUGimli_SPCA
                AnimationMode     = ONCE

            End
            FrameForPristineBonePositions = 42

            BeginScript
                CurDrawableShowSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        =  FIRING_OR_PREATTACK_B
            Animation           = ATKA
                AnimationName     = RUGimli_ATKD

                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End

        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation           = ATKA
                AnimationName     = RUGimli_ATKA
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKB
                AnimationName     = RUGimli_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
            Animation           = ATKC
                AnimationName     = RUGimli_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
            EndScript
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            Animation           = TNTA
                AnimationName   = RUGimli_TNTA
                AnimationMode   = ONCE
            End
            Animation           = TNTB
                AnimationName   = RUGimli_TNTB
                AnimationMode   = ONCE
            End
        End



        AnimationState            = SPECIAL_WEAPON_TWO UNPACKING
            Animation            = GettingReadyToLeap
                AnimationName    = RUGimli_LEPA
                AnimationMode   = ONCE
            End
        End

        AnimationState        =  ABOUT_TO_HIT
        StateName            = State_AboutToHitGround
            Animation           = Leap
                AnimationName     = RUGimli_LEPC
                AnimationMode     = ONCE

            End
        End


        AnimationState        = THROWN_PROJECTILE
            Animation           = LEPB
                AnimationName     = RUGimli_LEPB
                AnimationMode     = LOOP
                AnimationBlendTime = 20
            End
        End



















































        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = RUGimli_HITA
                AnimationMode = ONCE
            End
        End




        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = RUGimli_CHRB
                AnimationMode        = ONCE
            End
        End


        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRA
                AnimationName   = RUGimli_CHRA
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState            = EMOTION_TAUNTING
            Animation           = TNTA
                AnimationName   = RUGimli_TNTA
                AnimationMode   = ONCE
            End
            Animation           = TNTB
                AnimationName   = RUGimli_TNTB
                AnimationMode   = ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT
            Animation                    = Ready
                AnimationName            = RUGimli_IDLA
                AnimationMode            = LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                CurDrawableHideSubObject("AXE02")



                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript

        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = RUGimli_CHRA
                AnimationMode   = LOOP
            End
        End



        AnimationState                =    SELECTED
            StateName                =    AtAttentionIdle
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =     RUGimli_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                CurDrawableHideSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End



        IdleAnimationState
            StateName                = STATE_Idle
            Animation           = IDLB
                AnimationName     = RUGimli_IDLB
                AnimationMode     = ONCE
                AnimationPriority = 20
            End
            Animation           = IDLF
                AnimationName     = RUGimli_IDLF
                AnimationMode     = ONCE
                AnimationPriority = 5
            End
            Animation           = IDLD
                AnimationName     = RUGimli_IDLD
                AnimationMode     = ONCE
                AnimationPriority = 4
            End
            Animation           = IDLG
                AnimationName     = RUGimli_IDLG
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Animation           = IDLH
                AnimationName     = RUGimli_IDLH
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Animation           = IDLC
                AnimationName     = RUGimli_IDLC
                AnimationMode     = ONCE
                AnimationPriority = 3
            End
            Animation           = IDLE
                AnimationName     = RUGimli_IDLE
                AnimationMode     = ONCE
                AnimationPriority = 3
            End

            BeginScript
                CurDrawableHideSubObject("AXE02")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "DwarfToss" then CurDrawableSetTransitionAnimState("TRANS_EndDwarfToss") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
                if Prev == "State_AboutToHitGround" then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") end
            EndScript
        End




        TransitionState       = TRANS_EndDwarfToss
            Animation           = TOS4
                AnimationName     = RUGimli_TOS4
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SelectedToIdle
            Animation           = ATNC
                AnimationName     = RUGimli_ATNC
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.7 1.3
            End
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =     RUGimli_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState = TRANS_AboutToHitGround_To_Idle
            Animation = SplashAtEndOfJump
                AnimationName = RUGimli_LEPC
                AnimationMode = ONCE

            End
            Flags = MAINTAIN_FRAME_ACROSS_STATES
        End

    End




    Draw = W3DScriptedModelDraw ModuleTag_Paralyzed
        DefaultModelConditionState
            Model = None
        End
        AnimationState = DYING

        End
        AnimationState = EMOTION_UNCONTROLLABLY_AFRAID MOUNTED
            ParticleSysBone NONE StunMedium
        End
        AnimationState = EMOTION_UNCONTROLLABLY_AFRAID
            ParticleSysBone NONE StunSmall
        End
        AnimationState = EMOTION_TERROR MOUNTED
            ParticleSysBone NONE StunMedium
        End
        AnimationState = EMOTION_TERROR
            ParticleSysBone NONE StunSmall
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = GIMLI_THREAT_LEVEL
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    BuildCost           = WEAK_HERO_COST
    BuildTime           = WEAK_HERO_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    DisplayMeleeDamage = WEAK_HERO_DAMAGE
    HeroSortOrder = 40

    WeaponSet
        Conditions                = None
        Weapon                    = PRIMARY  NarAxeModWeapon
        Weapon                    = TERTIARY    RohanGimliAxeThrown
        AutoChooseSources        = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources        = TERTIARY NONE
        ShareWeaponReloadTime    = Yes
    End

    WeaponSet
        Conditions                = WEAPONSET_TOGGLE_1
        Weapon                    = SECONDARY  NarSuperAxeModWeapon
        Weapon                    = TERTIARY    RohanGimliAxeThrown
        AutoChooseSources        = SECONDARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources        = TERTIARY NONE
        ShareWeaponReloadTime    = Yes
    End

    ArmorSet
        Conditions      = None
        Armor           = WeakHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = MediumHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 340
    ShroudClearingRange = 340

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = ROHAN_GIMLI_BOUNTY_VALUE
    DisplayName = OBJECT:DwarvenNar
    RecruitText = CONTROLBAR:DwarvenNarRecruit
    Hotkey        = CONTROLBAR:DwarvenNarHotkey
    CrushableLevel = 2

    CommandSet  = DwarvenNarCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_GimliBody

    AutoResolveArmor
        Armor = AutoResolve_GimliArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GimliWeapon
    End






            VoiceAttack                             = NarVoiceAttack
            VoiceAttackAir                          = NarVoiceAttack
            VoiceAttackCharge                       = NarVoiceAttack
            VoiceAttackMachine                      = NarVoiceAttack
            VoiceAttackStructure                    = NarVoiceAttack
            VoiceFear                               = NarVoiceHelp
            VoiceGuard                              = NarVoiceMove
            VoiceMove                               = NarVoiceMove
            VoiceMoveToCamp                         = NarVoiceMove
            VoiceMoveWhileAttacking                 = NarVoiceMove
            VoicePriority                           = 85
            VoiceRetreatToCastle                    = NarVoiceRetreat
            VoiceSelect                             = NarVoiceSelect
            VoiceSelectBattle                       = NarVoiceSelectinBattle

            SoundImpact                             = ImpactHorse

            UnitSpecificSounds
                VoiceEnterUnitElvenTransportShip    = NarVoiceMove
                VoiceEnterUnitMordorMumakil         = NarVoiceMove
                VoiceEnterUnitSlaughterHouse        = NarVoiceMove
                VoiceEnterUnitTransportShip         = NarVoiceMove
                VoiceGarrison                       = NarVoiceMove
                VoiceInitiateCaptureBuilding        = NarVoiceMove
            End




    EvaEventDamagedOwner    = UnitUnderAttack
    EvaEventDamagedFromShroudedSourceOwner = UnitUnderAttackFromShroudedUnit
    EvaEventDamagedByFireOwner  = GenericUnitBeingBurned
    EvaEventAmbushed = UnitAmbushed
    EvaEventSecondDamageFarFromFirstOwner = UnitUnderAttackAgain


    EvaEventSecondDamageFarFromFirstScanRange = 600
    EvaEventSecondDamageFarFromFirstTimeoutMS = 31000

    EvaEnemyObjectSightedEvent    = GenericEnemyUnitSighted




    CrowdResponseKey = DwarfHero

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:RUGimli_SKL.RUGimli_RUNA    Frames:3 14
        AnimationSound = Sound:FootstepDirtA            Animation:RUGimli_SKL.RUGimli_RUNB    Frames:3 12

        AnimationSound = Sound:BodyFallSoldier            Animation:RUGimli_SKL.RUGimli_LNDA    Frames:2

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUGimli_SKL.RUGimli_DIEA    Frames:11
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUGimli_SKL.RUGimli_DIEC    Frames:59
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GIMLI HERO ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0




    Body                 = ActiveBody ModuleTag_Body
        MaxHealth             = WEAK_HERO_HEALTH
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        HoldGroundCloseRangeDistance = 60
    End

    LocomotorSet
        Locomotor = RohanGimliLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_DWARF_HERO_SPEED
    End

    Behavior = BezierProjectileBehavior ModuleTag_08

        FirstHeight = 50
        SecondHeight = 20
        FirstPercentIndent = 20%
        SecondPercentIndent = 70%
        TumbleRandomly = Yes

        CrushStyle = Yes






        BounceCount = 0

        FinalStuckTime = 1200

        GroundHitFX       = FX_GimliLeapLand
        GroundHitWeapon   = RohanGimliLeapWarheadMod
        PreLandingStateTime = 75
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LeapEnabler
        SpecialPowerTemplate     = SpecialAbilityGimliLeap
        TriggeredBy              = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_LeapStarter
        SpecialPowerTemplate     = SpecialAbilityGimliLeap
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
        InitiateSound            = GimliVoiceAttackLeap
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LeapUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliLeap
        UnpackTime              = 600
        PackTime                = 300
        AwardXPForTriggering    = 0
        StartAbilityRange       = 100.0
        SpecialWeapon           = RohanGimliLeapMod
        BusyForDuration         = 2000

        WhichSpecialWeapon      = 2
        TriggerSound            = GimliLeapVoice
    End




    #include "..\..\..\includes\CaptureBuilding.inc"








    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LamentEnabler
        SpecialPowerTemplate = SpecialAbilityDarkLordsLament
        TriggeredBy = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_LamentStarter
        SpecialPowerTemplate      = SpecialAbilityDarkLordsLament
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LamentWeaponFireUpdate
        SpecialPowerTemplate    = SpecialAbilityDarkLordsLament
        SpecialWeapon            = NarSchlachtschreiWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange        = 10.0

        SkipContinue            = Yes
        UnpackTime            = 1000
        PackTime            = 2000
        MustFinishAbility        = Yes
    End






    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
        StartsActive    = No
        BonusName       = ThrorsSchildwache1
        TriggeredBy     = Upgrade_Level_1
        RefreshDelay    = 2000
        Range           = 200
        ObjectFilter    = DWARF_LEADERSHIP_UNITS_OBF ;ANY +ARCHER -INFANTRY +CAVALRY -SHIP -MONSTER -DOZER -STRUCTURE -MACHINE -HERO ALLIES
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End








    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArrowWindEnabler
        SpecialPowerTemplate = SpecialAbilityArrowStorm
        TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_ArrowWindStarter
        SpecialPowerTemplate        = SpecialAbilityArrowStorm
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes

    End

    Behavior = ArrowStormUpdate ModuleTag_ArrowWindUpdate
        SpecialPowerTemplate    = SpecialAbilityArrowStorm
        StartAbilityRange       = 320.0

        UnpackTime              = 1000
        PreparationTime         = 200
        PersistentPrepTime      = 600
        PackTime                = 1200
        UnpackingVariation        = 2
        ParalyzeDurationWhenCompleted = 600
        ParalyzeDurationWhenAborted = 800

        ApproachRequiresLOS     = Yes

        AwardXPForTriggering    = 0


        WeaponTemplate  = NarAxeStormWeapon
        TargetRadius    = 120
        ShotsPerTarget  = 1
        ShotsPerBurst   = 4
        MaxShots        = 60
        CanShootEmptyGround = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        TriggeredBy             = Upgrade_Level_5
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate    = SpecialAbilityGimliHeroMode
        Duration                = 30000
        AttributeModifier       = SlayerGimliMod

        WeaponSetFlags          = WEAPONSET_TOGGLE_1
        StartsPaused            = Yes

    End


    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2200
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 1.0
        HitReactionThreshold2 = 2500.0
        HitReactionThreshold3 = 5000.0
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MithrilMine
        SpecialPowerTemplate = SpecialAbilitySpellbookMithrilhemd
        TriggeredBy = Upgrade_ElvenGift
    End

    Behavior = SpecialPowerModule ModuleTag_MithrilMineUpdate
        SpecialPowerTemplate      = SpecialAbilitySpellbookMithrilhemd
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_ElvenGift
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_ElvenGift
        UpgradeTexture  = dunar.tga 0 dunar_ha.tga
    End




    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        AllowBouncing = No
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 2600
    End

       Behavior                 = SlowDeathBehavior ModuleTag_85
           DeathTypes           = ALL -KNOCKBACK
           SinkDelay = 3000
           SinkRate = 0.40
           DestructionDelay = 8000
           Sound                = INITIAL NarVoiceDie
       End

    Behavior                 = SlowDeathBehavior ModuleTag_83
           DeathTypes           = NONE +KNOCKBACK
           SinkDelay            = 3000
           SinkRate             = 0.40
           DestructionDelay     = 8000
           Sound                = INITIAL NarVoiceDie
       End

    Behavior                 = SquishCollide ModuleTag_82

    End

    Behavior                 = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End


       Behavior                 = EmotionTrackerUpdate    Module_EmotionTracker
           TauntAndPointDistance            =    300
           TauntAndPointUpdateDelay        =    1000

        AddEmotion                =    Terror_Base
           AddEmotion                =    Doom_Base
           AddEmotion                =    UncontrollableFear_Base
           AddEmotion                =    Point_Base
           AddEmotion                =    Taunt_Base
           AddEmotion                =    CheerIdle_Base
           AddEmotion                =    CheerBusy_Base
           AddEmotion                =    Alert_Base
           AddEmotion                =    CheerForAboutToCrush_Base
       End


       Behavior                     = AutoHealBehavior ModuleTag_GloinHealing
           StartsActive            = Yes
           HealingAmount           = HERO_HEAL_AMOUNT
           HealingDelay            = 1000
           StartHealingDelay       = HERO_HEAL_DELAY
           HealOnlyIfNotInCombat   = Yes
       End

       Behavior                     = StancesBehavior ModuleTag_StancesBehavior
           StanceTemplate          = Hero
       End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Scale = 0.92
    Geometry = CYLINDER
    GeometryMajorRadius = 5.6
    GeometryMinorRadius = 5.6
    GeometryHeight = 16.0
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object DwarvenNar_AxeThrower

    SelectPortrait         = HPNar
    ButtonImage            = HINar

    DescriptionStrategic        = CONTROLBAR:LW_ToolTip_Gloin

    Draw                        = W3DScriptedModelDraw ModuleTag_01

       OkToChangeModelColor        = No
       StaticModelLODMode          = No

        RandomTexture    = dunar.tga 0 eudwarfaxe.tga



        DefaultModelConditionState
            Model               = DUNar_SKN
            Skeleton            = EUDwarfAxe_SKL
            WeaponLaunchBone    = PRIMARY Axe01
            WeaponLaunchBone    = TERTIARY Axe01
        End

        ModelConditionState     = WEAPONSET_HERO_MODE
            Model               = DUNar_SKN
            Skeleton            = EUDwarfAxe_SKL
            WeaponLaunchBone    = PRIMARY Axe01
            WeaponLaunchBone    = TERTIARY Axe01
            ParticleSysBone     = BIP01 SPINE1 NarSlayer FollowBone:Yes
        End





        AnimationState                        = PASSENGER
            Animation                        = Grabbed
                AnimationName                = EUDwarfAxe_FLLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = THROWN_PROJECTILE
            Animation                       = FlyA
                AnimationName                   = EUDwarfAxe_FLYA
                AnimationMode               = LOOP
            End
            Flags                           = RANDOMSTART
        End

        AnimationState                        = FREEFALL
            Animation                        = Falling
                AnimationName                = EUDwarfAxe_FLYA
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
            End
        End



        AnimationState                        = STUNNED_FLAILING
            Animation                       = FlyA
                AnimationName               = EUDwarfAxe_FLYA
                AnimationMode               = LOOP
                AnimationSpeedFactorRange    = 0.3 0.5
            End
            Flags                           = RANDOMSTART
        End

        AnimationState                        = DYING BURNINGDEATH
            Animation
                AnimationName                = EUDwarfAxe_DIEA
                AnimationMode                = ONCE
                AnimationBlendTime            = 10
            End
            Animation
                AnimationName                = EUDwarfAxe_DIEB
                AnimationMode                = ONCE
                AnimationBlendTime            = 10
            End
        End
        AnimationState                         = DYING SPLATTED
            Animation                         = Splatted_On_Ground
                AnimationName                 = EUDwarfAxe_LNDA
                AnimationMode                 = ONCE
            End
            EnteringStateFX                    = FX_OrcHitGround
        End

        AnimationState                        = DYING AFLAME
            Animation                        = MFDA
                AnimationName                = EUDwarfAxe_DIEA
                AnimationMode                = LOOP
            End
            Animation                        = MFDA
                AnimationName                = EUDwarfAxe_DIEB
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = DYING DEATH_2
            Animation
                AnimationName                = EUDwarfAxe_IDLB
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = DYING
            Animation                        = DIEA
                AnimationName                = EUDwarfAxe_DIEA
                AnimationMode                = ONCE
            End
            Animation                        = DIEB
                AnimationName                = EUDwarfAxe_DIEB
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = BURNINGDEATH
            Animation
                AnimationName                = EUDwarfAxe_MFDA
                AnimationMode                = LOOP
                Distance                    = 40
            End
        End
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = EUDwarfAxe_IDLA
                AnimationMode                = LOOP
            End
        End




        AnimationState                        = STUNNED_STANDING_UP
            Animation                        = GTPA
                AnimationName                = EUDwarfAxe_GTPA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End



        AnimationState            =     STUNNED
            Animation            =     Slatted_On_Ground
            AnimationName                 = EUDwarfAxe_LNDA
                AnimationMode                 = ONCE
            End
            EnteringStateFX                    = FX_OrcHitGround

       End






        AnimationState                        = MOVING EMOTION_TERROR EMOTION_LOOK_TO_SKY

            Animation                    = TerrorFromTheSky
                AnimationName            = EUDwarfAxe_RUNA
                AnimationMode            = LOOP
            End
            Animation                    = TerrorFromTheSky
                AnimationName            = EUDwarfAxe_RUNB
                AnimationMode            = LOOP
            End
            Flags = RANDOMSTART
        End
        AnimationState                        = MOVING EMOTION_TERROR

            Animation                        = TerrorFromTheSky
                AnimationName                = EUDwarfAxe_RUNA
                AnimationMode                = ONCE
            End
            Animation                        = TerrorFromTheSky
                AnimationName                = EUDwarfAxe_RUNB
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                        = MOVING BACKING_UP

            Animation                        = BAKA
                AnimationName                = EUDwarfAxe_BAKA
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState                        = MOVING PANICKING

            Animation                        = MFDA
                AnimationName                = EUDwarfAxe_RUNB
                AnimationMode                = LOOP
            End
            Flags                            = RANDOMSTART

        End

        AnimationState                        = MOVING ATTACKING
            ShareAnimation                    = Yes
            Animation                        = RUNA
                AnimationName                = EUDwarfAxe_RUNA
                AnimationMode                = LOOP
                Distance                    = 25
            End
            Flags                            = RANDOMSTART

        End

        AnimationState                        = MOVING CHARGING
            ShareAnimation                    = Yes
            Animation                        = RUNB
                AnimationName                = EUDwarfAxe_RUNB
                AnimationMode                = LOOP
                Distance                    = 30

            End
            Flags                            = RANDOMSTART

        End

        AnimationState                        = MOVING

            ShareAnimation                    = Yes
            Animation                        = RUNB
                AnimationName                = EUDwarfAxe_RUNA
                AnimationMode                = LOOP
                Distance                    = 30
            End
            Flags                            = RANDOMSTART

        End


        AnimationState                        = EMOTION_UNCONTROLLABLY_AFRAID
            Animation                        = FERA
                AnimationName                = EUDwarfAxe_FERA
                AnimationMode                = LOOP
            End
        End



        AnimationState                        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            Animation                        = ATKB
                AnimationName                = EUDwarfAxe_ATKB
                AnimationMode                = ONCE

                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            Animation                        = ATKA
                AnimationName                = EUDwarfAxe_ATKA
                AnimationMode                = ONCE

                UseWeaponTiming                = Yes
            End
            FrameForPristineBonePositions = 20
        End

        AnimationState                        = FIRING_OR_PREATTACK_C
            Animation                        = ATKA
                AnimationName                = EUDwarfAxe_ATKA
                AnimationMode                = ONCE

                UseWeaponTiming                = Yes
            End
        End



















        AnimationState                        = EMOTION_ALERT EMOTION_AFRAID
            Animation                        = APPA
                AnimationName                = GUManMocap_APPA
                AnimationMode                = ONCE
            End
            Animation                        = APPB
                AnimationName                = GUManMocap_APPB
                AnimationMode                = ONCE
            End
            Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                        = EMOTION_AFRAID
            Animation                        = FERA
                AnimationName                = EUDwarfAxe_FERA
                AnimationMode                = LOOP
            End
        End



        AnimationState                        = EMOTION_POINTING
            Animation                        = Pointing1
                AnimationName                = EUDwarfAxe_PNTA
                AnimationMode                = LOOP
            End
        End



        AnimationState                        = EMOTION_TAUNTING
            Animation                        = Taunting1
                AnimationName                = EUDwarfAxe_TNTA
                AnimationMode                = ONCE
            End
            Flags                            = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End



        AnimationState                        = EMOTION_CELEBRATING
            Animation                        = CHRA
                AnimationName                = EUDwarfAxe_CHRA
                AnimationMode                = ONCE
            End
            Animation                        = IDLD
                AnimationName                = EUDwarfAxe_IDLD
                AnimationMode                = ONCE
            End
            Flags                            =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = SPECIAL_WEAPON_TWO
            Animation                        = CHRA
                AnimationName                = EUDwarfAxe_CHRA
                AnimationMode                = ONCE
            End
            Animation                        = IDLD
                AnimationName                = EUDwarfAxe_IDLD
                AnimationMode                = ONCE
            End
        End




        AnimationState                        = EMOTION_ALERT
            Animation                        = ALERT_1
                AnimationName                = EUDwarfAxe_IDLA
                AnimationMode                = LOOP
                AnimationPriority            = 10
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = RAISING_FLAG
            Animation                        = CHRA
                AnimationName                = EUDwarfAxe_CHRA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = ATTACKING
            Animation
                AnimationName        = EUDwarfAxe_IDLA
                AnimationMode        = LOOP
            End
        End

        AnimationState        = ENGAGED
            Animation
                AnimationName        = EUDwarfAxe_IDLA
                AnimationMode        = LOOP
            End
        End


        AnimationState        = SELECTED
            StateName           = STATE_Selected
            Animation           = ATNB
                AnimationName     = EUDwarfAxe_ATNB
                AnimationMode     = LOOP
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle"
                then
                    CurDrawableSetTransitionAnimState("TRANS_IdleToSelected")
                end
                if CurDrawableModelcondition("ATTACKING")
                then
                    return "IDLA"
                else
                    return "ATNA"
                end
            EndScript

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToSelected") end
            EndScript
        End


        AnimationState                = WEAPONSET_PLAYER_UPGRADE
            StateName                = STATE_Idle
            Animation                = IDLB
                AnimationName       = EUDwarfAxe_IDLB
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                = IDLC
                AnimationName       = EUDwarfAxe_IDLC
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Animation                = IDLD
                AnimationName       = EUDwarfAxe_IDLD
                AnimationMode       = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End
            Flags                    = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
            EndScript
        End
        AnimationState                = USER_3
            StateName                = STATE_User_3
            Animation                = GUARD_STANCE
                AnimationName        = GUManMocap_IDLB
                AnimationMode        = LOOP
            End
        End
        IdleAnimationState
            StateName                = STATE_Idle
            Animation                = IDLB
                AnimationName       = EUDwarfAxe_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            Animation                = IDLC
                AnimationName       = EUDwarfAxe_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 1
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            Animation                = IDLD
                AnimationName       = EUDwarfAxe_IDLD
                AnimationMode       = ONCE
                AnimationPriority   = 1
                AnimationSpeedFactorRange = 0.9 1.1
                AnimationBlendTime    = 15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected" then CurDrawableSetTransitionAnimState("TRANS_SelectedToIdle") end
            EndScript
        End

        TransitionState       = TRANS_IdleToSelected
            Animation           = ATNA
                AnimationName     = EUDwarfAxe_ATNA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 0.9 1.0

            End
        End
        TransitionState        = TRANS_SelectedToIdle
            Animation            = ATNC
                AnimationName    = EUDwarfAxe_ATNC
                AnimationMode    = ONCE
                AnimationSpeedFactorRange = 0.9 1.0
            End
        End
    End




    Draw = W3DScriptedModelDraw ModuleTag_Paralyzed
        DefaultModelConditionState
            Model = None
        End
        AnimationState = DYING

        End
        AnimationState = EMOTION_UNCONTROLLABLY_AFRAID MOUNTED
            ParticleSysBone NONE StunMedium
        End
        AnimationState = EMOTION_UNCONTROLLABLY_AFRAID
            ParticleSysBone NONE StunSmall
        End
        AnimationState = EMOTION_TERROR MOUNTED
            ParticleSysBone NONE StunMedium
        End
        AnimationState = EMOTION_TERROR
            ParticleSysBone NONE StunSmall
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    Side = Dwarves
    EditorSorting = UNIT
    ThreatLevel = GLOIN_THREAT_LEVEL
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    BuildCost           = WEAK_HERO_COST
    BuildTime           = WEAK_HERO_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG

    HeroSortOrder = 40


     WeaponSet
        Conditions               = None
        Weapon                   = PRIMARY     DwarvenNarAxe
        AutoChooseSources        = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions               = WEAPONSET_HERO_MODE
        Weapon                   = SECONDARY   DwarvenNarSuperAxe
        AutoChooseSources        = SECONDARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions         = None
        Armor              = WeakHeroArmor
        DamageFX           = NormalDamageFX
    End

    ArmorSet
        Conditions         = PLAYER_UPGRADE
        Armor              = MediumHeroArmor
        DamageFX           = NormalDamageFX
    End

    VisionRange = 340
    ShroudClearingRange = 340

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = 30
    DisplayName = OBJECT:DwarvenNar
    RecruitText = CONTROLBAR:DwarvenNarRecruit
    Hotkey        = CONTROLBAR:DwarvenNarHotkey
    CrushableLevel = 2

    CommandSet  = DwarvenNarCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_GloinBody

    AutoResolveArmor
        Armor = AutoResolve_GloinArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GloinWeapon
    End






            VoiceAttack                             = NarVoiceAttack
            VoiceAttackAir                          = NarVoiceAttack
            VoiceAttackCharge                       = NarVoiceAttack
            VoiceAttackMachine                      = NarVoiceAttack
            VoiceAttackStructure                    = NarVoiceAttack
            VoiceFear                               = NarVoiceHelp
            VoiceGuard                              = NarVoiceMove
            VoiceMove                               = NarVoiceMove
            VoiceMoveToCamp                         = NarVoiceMove
            VoiceMoveWhileAttacking                 = NarVoiceMove
            VoicePriority                           = 95
            VoiceRetreatToCastle                    = NarVoiceRetreat
            VoiceSelect                             = NarVoiceSelect
            VoiceSelectBattle                       = NarVoiceSelectinBattle

            SoundImpact                             = ImpactHorse

            UnitSpecificSounds
                VoiceEnterUnitElvenTransportShip    = NarVoiceMove
                VoiceEnterUnitMordorMumakil         = NarVoiceMove
                VoiceEnterUnitSlaughterHouse        = NarVoiceMove
                VoiceEnterUnitTransportShip         = NarVoiceMove
                VoiceGarrison                       = NarVoiceMove
                VoiceInitiateCaptureBuilding        = NarVoiceMove
            End



    EvaEventDamagedOwner    = UnitUnderAttack
    EvaEventDamagedFromShroudedSourceOwner = UnitUnderAttackFromShroudedUnit
    EvaEventDamagedByFireOwner  = GenericUnitBeingBurned
    EvaEventAmbushed = UnitAmbushed
    EvaEventSecondDamageFarFromFirstOwner = UnitUnderAttackAgain


    EvaEventSecondDamageFarFromFirstScanRange = 600
    EvaEventSecondDamageFarFromFirstTimeoutMS = 31000

    EvaEnemyObjectSightedEvent    = GenericEnemyUnitSighted




    CrowdResponseKey = DwarfHero

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Dwarf Dwarf_Male Unit Infantry Hero
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionDwarfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGeneric1                Animation:EUDWARFAXE_SKL.EUDWARFAXE_LNDA    Frames:4
        AnimationSound = Sound:BodyFallGeneric1                Animation:EUDWARFAXE_SKL.EUDWARFAXE_DIEA    Frames:56

        AnimationSound = Sound:BodyFallGeneric1                Animation:EUDWARFAXE_SKL.EUDWARFAXE_DIEB    Frames:13
        AnimationSound = Sound:BodyFallGeneric1                Animation:EUDWARFAXE_SKL.EUDWARFAXE_DIEB    Frames:39
        AnimationSound = Sound:TauntDwarfHitShieldLoose        Animation:EUDWARFAXE_SKL.EUDWARFAXE_ATNA    Frames:21
        AnimationSound = Sound:TauntDwarfHitShieldLoose        Animation:EUDWARFAXE_SKL.EUDWARFAXE_TNTA    Frames:19 39
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT HERO ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER


    Body                 = ActiveBody ModuleTag_Body
        MaxHealth             = WEAK_HERO_HEALTH
    End

   Behavior                 = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        HoldGroundCloseRangeDistance     = 60

    End

    LocomotorSet
        Locomotor             = RohanGimliLocomotor
        Condition             = SET_NORMAL
        Speed                 = NORMAL_DWARF_HERO_SPEED
    End


    Behavior                 = BezierProjectileBehavior ModuleTag_08
        FirstHeight             = 50
        SecondHeight             = 20
        FirstPercentIndent         = 20%
        SecondPercentIndent         = 70%
        TumbleRandomly             = Yes
        CrushStyle             = Yes
        BounceCount             = 0
        FinalStuckTime             = 1200
        GroundHitFX               = FX_GimliLeapLand
        GroundHitWeapon           = RohanGimliLeapWarhead
        PreLandingStateTime         = 75
    End


    Behavior                 = AutoHealBehavior ModuleTag_ElvenGiftHealing
        StartsActive                    = No
        TriggeredBy                        = Upgrade_ElvenGift
        HealingAmount                    = ELVEN_GIFT_REGEN_AMOUNT
        HealingDelay                    = ELVEN_GIFT_REGEN_DELAY
        StartHealingDelay         = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat         = Yes
    End

    Behavior                 = AttributeModifierUpgrade ModuleTag_ElvenGiftBonus
        TriggeredBy             = Upgrade_ElvenGift
        AttributeModifier         = SpellBookElvenGifts
    End



    Behavior = SpecialPowerModule ModuleTag_CaptureBuilding
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End
    Behavior = SpecialAbilityUpdate ModuleTag_CaptureBuildingUpdate
        SpecialPowerTemplate        = SpecialAbilityCaptureBuilding
        StartAbilityRange            = 15.0
        UnpackTime                    = 1
        PreparationTime                = 15000
        PackTime                    = 1
        DoCaptureFX                    = Yes
    End







    Behavior = SpecialPowerModule ModuleTag_LamentStarter
        SpecialPowerTemplate      = SpecialAbilityDarkLordsLament
        UpdateModuleStartsAttack  = Yes
        StartsPaused          = No
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LamentWeaponFireUpdate
        SpecialPowerTemplate    = SpecialAbilityDarkLordsLament
        SpecialWeapon            = NarSchlachtschreiWeapon
        WhichSpecialWeapon        = 2
        StartAbilityRange        = 10.0

        SkipContinue            = Yes
        UnpackTime            = 1000
        PackTime            = 2000
        MustFinishAbility        = Yes
    End






    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
        StartsActive    = No
        BonusName       = ThrorsSchildwache1
        TriggeredBy     = Upgrade_Level_5
        RefreshDelay    = 2000
        Range           = 200
        ObjectFilter    = ANY +ARCHER -INFANTRY +CAVALRY -SHIP -MONSTER -DOZER -STRUCTURE -MACHINE -HERO ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive    = No
        BonusName       = ThrorsSchildwache2
        TriggeredBy     = Upgrade_Level_5
        RefreshDelay    = 2000
        Range           = 200
        ObjectFilter    = ANY +HERO -ARCHER -INFANTRY -CAVALRY -SHIP -MONSTER -DOZER -STRUCTURE -MACHINE ALLIES
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership2
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate2
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End








    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ArrowWindEnabler
        SpecialPowerTemplate = SpecialAbilityArrowStorm
        TriggeredBy = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_ArrowWindStarter
        SpecialPowerTemplate        = SpecialAbilityArrowStorm
        UpdateModuleStartsAttack    = Yes
        StartsPaused            = Yes

    End

    Behavior = ArrowStormUpdate ModuleTag_ArrowWindUpdate
        SpecialPowerTemplate    = SpecialAbilityArrowStorm
        StartAbilityRange       = 320.0

        UnpackTime              = 1000
        PreparationTime         = 200
        PersistentPrepTime      = 600
        PackTime                = 1200
        UnpackingVariation        = 1
        ParalyzeDurationWhenCompleted = 600
        ParalyzeDurationWhenAborted = 800

        ApproachRequiresLOS     = Yes

        AwardXPForTriggering    = 0


        WeaponTemplate  = NarAxeStormWeapon
        TargetRadius    = 120
        ShotsPerTarget  = 1
        ShotsPerBurst   = 4
        MaxShots        = 60
        CanShootEmptyGround = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_AragornBladeMasterEnabler
        SpecialPowerTemplate = SpecialAbilityAragornBladeMaster
        TriggeredBy = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_AragornBladeMasterStarter
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_AragornBladeMasterUpdate
        SpecialPowerTemplate    = SpecialAbilityAragornBladeMaster
        HeroAttributeModifier    = SlayerNar
        HeroEffectDuration        = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MithrilMine
        SpecialPowerTemplate = SpecialAbilitySpellbookMithrilhemd
        TriggeredBy = Upgrade_ElvenGift
    End

    Behavior = SpecialPowerModule ModuleTag_MithrilMineUpdate
        SpecialPowerTemplate      = SpecialAbilitySpellbookMithrilhemd
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = ArmorUpgrade ModuleTag_ArmorUpgradeMithril
        TriggeredBy     = Upgrade_ElvenGift
        ArmorSetFlag    = PLAYER_UPGRADE
    End

    Behavior = SubObjectsUpgrade ModuleTag_MithrilSkinwelchsel
        TriggeredBy     = Upgrade_ElvenGift
        UpgradeTexture  = dunar.tga 0 dunar_ha.tga
    End


       Behavior                 = PhysicsBehavior ModuleTag_81
           GravityMult          = 1.0
           AllowBouncing        = No
           ShockStunnedTimeLow  = 1400
           ShockStunnedTimeHigh = 2400
           ShockStandingTime    = 2600
       End

       Behavior                 = SlowDeathBehavior ModuleTag_85
           DeathTypes           = ALL -KNOCKBACK
           SinkDelay            = 3000
           SinkRate             = 0.40
           DestructionDelay     = 8000
           Sound                = INITIAL NarVoiceDie
       End

    Behavior                 = SlowDeathBehavior ModuleTag_83
           DeathTypes           = NONE +KNOCKBACK
           SinkDelay            = 3000
           SinkRate             = 0.40
           DestructionDelay     = 8000
           Sound                = INITIAL NarVoiceDie
       End

    Behavior                 = SquishCollide ModuleTag_82

    End

    Behavior                 = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End


       Behavior                 = EmotionTrackerUpdate    Module_EmotionTracker
           TauntAndPointDistance            =    300
           TauntAndPointUpdateDelay        =    1000

        AddEmotion                =    Terror_Base
           AddEmotion                =    Doom_Base
           AddEmotion                =    UncontrollableFear_Base
           AddEmotion                =    Point_Base
           AddEmotion                =    Taunt_Base
           AddEmotion                =    CheerIdle_Base
           AddEmotion                =    CheerBusy_Base
           AddEmotion                =    Alert_Base
           AddEmotion                =    CheerForAboutToCrush_Base
       End


       Behavior                     = AutoHealBehavior ModuleTag_GloinHealing
           StartsActive            = Yes
           HealingAmount           = HERO_HEAL_AMOUNT
           HealingDelay            = 1000
           StartHealingDelay       = HERO_HEAL_DELAY
           HealOnlyIfNotInCombat   = Yes
       End

       Behavior                     = StancesBehavior ModuleTag_StancesBehavior
           StanceTemplate          = Hero
       End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End



    Scale = 0.92
    Geometry = CYLINDER
    GeometryMajorRadius = 5.6
    GeometryMinorRadius = 5.6
    GeometryHeight = 16.0
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


