





Object SilvanArcher







    SelectPortrait = HPSilvanArcher
    ButtonImage    = HISilvanArcher



    Draw = W3DScriptedModelDraw ModuleTag_01_

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model                   = eusilvanar
            Skeleton        = EUThrndl_SKL
            WeaponLaunchBone        = PRIMARY ARROW
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:100
        End

        ModelConditionState = INVISIBLE_STEALTH
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:100
        End



        AnimationState        = STUNNED_FLAILING
            Animation
                AnimationName     = EUThrndl_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = DYING DEATH_2
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation
                AnimationName     = EUThrndl_DTHA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation
                AnimationName     = EUThrndl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            Animation
                AnimationName     = EUThrndl_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = EUThrndl_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState        = UNPACKING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA1
                AnimationMode     = ONCE
            End
        End


        AnimationState        = PREPARING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA1
                AnimationMode     = ONCE
            End
            Flags = START_FRAME_LAST
        End

        AnimationState        = PACKING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA3
                AnimationMode     = ONCE
            End
        End

        AnimationState        = PACKING PACKING_TYPE_1
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = PACKING_TYPE_2
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End


        AnimationState                        = PREATTACK_A
            Animation
                AnimationName                = EUThrndl_ATA1
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_RELOADING_A
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.5 1.5
            End
        End

        AnimationState        = MOVING
            Animation
                AnimationName   = EUThrndl_RUNA
                AnimationMode   = LOOP
                Distance        = 50
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.6 0.6
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        = CONTINUOUS_FIRE_MEAN
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = ONCE
            End
        End


        AnimationState = HIT_REACTION
            Animation
                AnimationName = EUThrndl_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState                = HIDDEN
            StateName                = Hidden
            Animation
                AnimationName        = EUThrndl_CLKB
                AnimationMode        = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToHidden") end
            EndScript
        End



        AnimationState                    = EMOTION_TAUNTING
            Animation
                AnimationName            = EUThrndl_TNTA
                AnimationMode            = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName   =    EUThrndl_CHRA
                AnimationMode   =    ONCE
                AnimationPriority    =    10
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = LEVELED
            Animation
                AnimationName                = EUThrndl_LVLA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.75 0.75
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName   =    EUThrndl_CHRA
                AnimationMode   =    LOOP
            End
        End


        AnimationState                =    SELECTED
            StateName                =    Selected
            Animation
                AnimationName        =    EUThrndl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_SwitchToAttention") end
                if Prev == "Hidden" then CurDrawableSetTransitionAnimState("TRANS_HiddenToIdle") end
            EndScript
        End


        IdleAnimationState
            Animation
                AnimationName     = EUThrndl_IDLA
                AnimationMode     = ONCE
                AnimationPriority    = 8
            End
            Animation
                AnimationName     = EUThrndl_IDLB
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLC
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLD
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLE
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            StateName           = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_SwitchFromAttention") end
                if Prev == "Hidden" then CurDrawableSetTransitionAnimState("TRANS_HiddenToIdle") end
            EndScript
        End

        TransitionState            = TRANS_HiddenToIdle
            Animation
                AnimationName        = EUThrndl_CLKA
                AnimationMode        = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End
        TransitionState            = TRANS_IdleToHidden
            Animation
                AnimationName        = EUThrndl_CLKA
                AnimationMode        = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToAttention
            Animation
                AnimationName     = EUThrndl_ATNA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchFromAttention
            Animation
                AnimationName     = EUThrndl_ATNC
                AnimationMode     = ONCE
            End
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Lothlorien
    EditorSorting                     = UNIT
    ThreatLevel                       = 1.0
    ThingClass                        = HORDE_UNIT
    TransportSlotCount                = TRANSPORTSLOTCOUNT_UNIT
    ShockwaveResistance               = 30

    VisionRange                       = 400
    ShroudClearingRange               = 420

    BountyValue                       = 8
    DisplayName                       = OBJECT:SilvanArcherHorde

    CrushableLevel                    = 0
    CrusherLevel                      = 0
    CrushRevengeWeapon                = BasicInfantryCrushRevenge

    CommandSet                        = SilvanArcherHordeCommandSet
    CommandPoints                     = 0





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY MirkwoodArcherSilverthornBowEdain
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = QuendiArcherArmorUpgrade
        DamageFX                      = NormalDamageFX
    End





    VoiceAttack                         = ElfMirkwoodVoiceAttack
    VoiceAttackAir                      = ElfMirkwoodVoiceAttack
    VoiceAttackCharge                   = ElfMirkwoodVoiceAttackCharge
    VoiceAttackMachine                  = ElfMirkwoodVoiceAttack
    VoiceAttackStructure                = ElfMirkwoodVoiceAttackBuilding
    VoiceCreated                        = ElfMirkwoodVoiceSalute
    VoiceFullyCreated                   = ElfMirkwoodVoiceSalute
    VoiceGuard                          = ElfMirkwoodVoiceMove
    VoiceMove                           = ElfMirkwoodVoiceMove
    VoiceMoveToCamp                     = ElfMirkwoodVoiceMoveCamp
    VoiceMoveToHigherGround             = ElfMirkwoodVoiceMoveHighGround
    VoiceMoveWhileAttacking             = ElfMirkwoodVoiceDisengage
    VoicePriority                       = 45
    VoiceRetreatToCastle                = ElfMirkwoodVoiceMoveRetreat
    VoiceSelect                         = ElfMirkwoodVoiceSelectMS
    VoiceSelectBattle                   = ElfMirkwoodVoiceSelectBattle

    VoiceEnterStateAttack               = ElfMirkwoodVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = ElfMirkwoodVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure      = ElfMirkwoodVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine        = ElfMirkwoodVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                 = ElfMirkwoodVoiceEnterStateMove
    VoiceEnterStateMoveToCamp           = ElfMirkwoodVoiceEnterStateMoveCamp
    VoiceEnterStateMoveToHigherGround   = ElfMirkwoodVoiceEnterStateMoveHighGround
    VoiceEnterStateMoveWhileAttacking   = ElfMirkwoodVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle      = ElfMirkwoodVoiceEnterStateRetreat

    MinZIncreaseForVoiceMoveToHigherGround  = 45

    SoundImpact                         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterStateInitiateCaptureBuilding  = ElfMirkwoodVoiceEnterStateCaptureBuilding
        VoiceEnterUnitElvenTransportShip = ElfMirkwoodVoiceMoveShip
        VoiceGarrison                   = ElfMirkwoodVoiceMoveGarrison
        VoiceInitiateCaptureBuilding    = ElfMirkwoodVoiceCaptureBuilding
        VoiceMoveToTrees                = ElfMirkwoodVoiceMoveForest
        VoiceEnterStateMoveToTrees      = ElfMirkwoodVoiceEnterStateMoveForest
    End

    CrowdResponseKey = Elf

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Elf_LorienWarrior
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    TauntAndPointDistance        = 200
    TauntAndPointUpdateDelay    = 2000
    PointAt                = ANY +HERO
    AddEmotion            = Doom_Base
    AddEmotion            = Point_Base
    AddEmotion            = Taunt_Base
     AddEmotion            = CheerIdle_Base
    AddEmotion            = CheerBusy_Base
    AddEmotion            = Alert_Base
    AddEmotion            = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARCHER GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT SUMMONED
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    Body = ActiveBody ModuleTag_02
        CheerRadius                  = EMOTION_CHEER_RADIUS
        MaxHealth                    = 900
        MaxHealthDamaged             = 400
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        CanAttackWhileContained        = Yes
        AILuaEventsList                = RohanArcherFunctions
        AttackPriority                =     AttackPriority_Archer
        BurningDeathTime                   = BURNINGDEATH_DURATION_INFANTRY
    End

     LocomotorSet
    Locomotor = ElvenThranduilLocomotor
    Condition = SET_NORMAL
    Speed     = NORMAL_ELVEN_FAST_MEMBER_SPEED
     End

    Behavior = PhysicsBehavior ModuleTag_04
    GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -KNOCKBACK -FADED
    SinkDelay = 3000
    SinkRate = 0.40
    DestructionDelay = 8000
    Sound = INITIAL ElfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End

    Behavior = SlowDeathBehavior ModuleTag_07
    DeathTypes = NONE +KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40
    DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight                   = 24
       SecondHeight                  = 24
       FirstPercentIndent            = 30%
       SecondPercentIndent           = 70%
       TumbleRandomly                = Yes
       CrushStyle                    = Yes
       DieOnImpact                   = Yes
       BounceCount                   = 1
       BounceDistance                = 40
       BounceFirstHeight             = 24
       BounceSecondHeight            = 24
       BounceFirstPercentIndent      = 20%
       BounceSecondPercentIndent     = 80%
       GroundHitFX                   = FX_ThrownRockGroundHit
       GroundBounceFX                = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
    HitReactionLifeTimer1 = 1993
    HitReactionLifeTimer2 = 1993
    HitReactionLifeTimer3 = 1993

    HitReactionThreshold1 = 5.0
    HitReactionThreshold2 = 25.0
    HitReactionThreshold3 = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType          = FADED
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End




    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End


Object SilvanArcher2







    SelectPortrait = HPSilvanArcher
    ButtonImage    = HISilvanArcher



    Draw = W3DScriptedModelDraw ModuleTag_01_

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model                   = eusilvanar
            Skeleton        = EUThrndl_SKL
            WeaponLaunchBone        = PRIMARY ARROW
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:HOLD PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:HOLD PersistID:100
        End

        ModelConditionState = INVISIBLE_STEALTH
            ParticleSysBone        = NONE Predator FollowBone:Yes Persist:SPAWN PersistID:100
            ParticleSysBone        = NONE Predator02 FollowBone:Yes Persist:SPAWN PersistID:100
        End



        AnimationState        = STUNNED_FLAILING
            Animation
                AnimationName     = EUThrndl_FLYA
                AnimationMode     = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = DYING DEATH_2
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING
            Animation
                AnimationName     = EUThrndl_DTHA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation
                AnimationName     = EUThrndl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState        = STUNNED
            Animation
                AnimationName     = EUThrndl_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = EUThrndl_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState        = UNPACKING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA1
                AnimationMode     = ONCE
            End
        End


        AnimationState        = PREPARING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA1
                AnimationMode     = ONCE
            End
            Flags = START_FRAME_LAST
        End

        AnimationState        = PACKING SPECIAL_WEAPON_ONE
            Animation
                AnimationName     = EUThrndl_ATA3
                AnimationMode     = ONCE
            End
        End

        AnimationState        = PACKING PACKING_TYPE_1
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = PACKING_TYPE_2
            Animation
                AnimationName     = EUThrndl_CHRA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End


        AnimationState                        = PREATTACK_A
            Animation
                AnimationName                = EUThrndl_ATA1
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
        End

        AnimationState                        = FIRING_OR_RELOADING_A
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.5 1.5
            End
        End

        AnimationState        = MOVING
            Animation
                AnimationName   = EUThrndl_RUNA
                AnimationMode   = LOOP
                Distance        = 50
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.6 0.6
            End
            Flags               = RANDOMSTART
        End



        AnimationState                        = CONTINUOUS_FIRE_MEAN
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = MANUAL
            End
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW
            Animation
                AnimationName                = EUThrndl_ATA2
                AnimationMode                = ONCE
            End
        End


        AnimationState = HIT_REACTION
            Animation
                AnimationName = EUThrndl_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState                = HIDDEN
            StateName                = Hidden
            Animation
                AnimationName        = EUThrndl_CLKB
                AnimationMode        = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_IdleToHidden") end
            EndScript
        End



        AnimationState                    = EMOTION_TAUNTING
            Animation
                AnimationName            = EUThrndl_TNTA
                AnimationMode            = ONCE
            End
        End

        AnimationState                =    EMOTION_CELEBRATING
            Animation
                AnimationName   =    EUThrndl_CHRA
                AnimationMode   =    ONCE
                AnimationPriority    =    10
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = LEVELED
            Animation
                AnimationName                = EUThrndl_LVLA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.75 0.75
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation
                AnimationName   =    EUThrndl_CHRA
                AnimationMode   =    LOOP
            End
        End


        AnimationState                =    SELECTED
            StateName                =    Selected
            Animation
                AnimationName        =    EUThrndl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_SwitchToAttention") end
                if Prev == "Hidden" then CurDrawableSetTransitionAnimState("TRANS_HiddenToIdle") end
            EndScript
        End


        IdleAnimationState
            Animation
                AnimationName     = EUThrndl_IDLA
                AnimationMode     = ONCE
                AnimationPriority    = 8
            End
            Animation
                AnimationName     = EUThrndl_IDLB
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLC
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLD
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            Animation
                AnimationName     = EUThrndl_IDLE
                AnimationMode     = ONCE
                AnimationPriority    = 1
            End
            StateName           = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_SwitchFromAttention") end
                if Prev == "Hidden" then CurDrawableSetTransitionAnimState("TRANS_HiddenToIdle") end
            EndScript
        End

        TransitionState            = TRANS_HiddenToIdle
            Animation
                AnimationName        = EUThrndl_CLKA
                AnimationMode        = ONCE_BACKWARDS
            End
            Flags                = START_FRAME_LAST
        End
        TransitionState            = TRANS_IdleToHidden
            Animation
                AnimationName        = EUThrndl_CLKA
                AnimationMode        = ONCE
            End
        End

        TransitionState       = TRANS_SwitchToAttention
            Animation
                AnimationName     = EUThrndl_ATNA
                AnimationMode     = ONCE
            End
        End

        TransitionState       = TRANS_SwitchFromAttention
            Animation
                AnimationName     = EUThrndl_ATNC
                AnimationMode     = ONCE
            End
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Lothlorien
    EditorSorting                     = UNIT
    ThreatLevel                       = 1.0
    ThingClass                        = HORDE_UNIT
    TransportSlotCount                = TRANSPORTSLOTCOUNT_UNIT
    ShockwaveResistance               = 30

    VisionRange                       = 400
    ShroudClearingRange               = 420
	
    BountyValue                       = 8
    DisplayName                       = OBJECT:SilvanArcherHorde

    CrushableLevel                    = 0
    CrusherLevel                      = 0
    CrushRevengeWeapon                = BasicInfantryCrushRevenge

    CommandSet                        = SilvanArcherHordeCommandSet
    CommandPoints                     = 12





     WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY MirkwoodArcherSilverthornBowEdain2
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End






    ArmorSet
        Conditions                    = None
        Armor                         = QuendiArcherArmorUpgrade
        DamageFX                      = NormalDamageFX
    End
	
	ArmorSet
        Conditions                = PLAYER_UPGRADE
        Armor                     = QuendiArcherArmorUpgrade2
        DamageFX                  = NormalDamageFX
    End





    VoiceAttack                         = ElfMirkwoodVoiceAttack
    VoiceAttackAir                      = ElfMirkwoodVoiceAttack
    VoiceAttackCharge                   = ElfMirkwoodVoiceAttackCharge
    VoiceAttackMachine                  = ElfMirkwoodVoiceAttack
    VoiceAttackStructure                = ElfMirkwoodVoiceAttackBuilding
    VoiceCreated                        = ElfMirkwoodVoiceSalute
    VoiceFullyCreated                   = ElfMirkwoodVoiceSalute
    VoiceGuard                          = ElfMirkwoodVoiceMove
    VoiceMove                           = ElfMirkwoodVoiceMove
    VoiceMoveToCamp                     = ElfMirkwoodVoiceMoveCamp
    VoiceMoveToHigherGround             = ElfMirkwoodVoiceMoveHighGround
    VoiceMoveWhileAttacking             = ElfMirkwoodVoiceDisengage
    VoicePriority                       = 45
    VoiceRetreatToCastle                = ElfMirkwoodVoiceMoveRetreat
    VoiceSelect                         = ElfMirkwoodVoiceSelectMS
    VoiceSelectBattle                   = ElfMirkwoodVoiceSelectBattle

    VoiceEnterStateAttack               = ElfMirkwoodVoiceEnterStateAttack
    VoiceEnterStateAttackCharge         = ElfMirkwoodVoiceEnterStateAttackCharge
    VoiceEnterStateAttackStructure      = ElfMirkwoodVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackMachine        = ElfMirkwoodVoiceEnterStateAttackBuilding
    VoiceEnterStateMove                 = ElfMirkwoodVoiceEnterStateMove
    VoiceEnterStateMoveToCamp           = ElfMirkwoodVoiceEnterStateMoveCamp
    VoiceEnterStateMoveToHigherGround   = ElfMirkwoodVoiceEnterStateMoveHighGround
    VoiceEnterStateMoveWhileAttacking   = ElfMirkwoodVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle      = ElfMirkwoodVoiceEnterStateRetreat

    MinZIncreaseForVoiceMoveToHigherGround  = 45

    SoundImpact                         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterStateInitiateCaptureBuilding  = ElfMirkwoodVoiceEnterStateCaptureBuilding
        VoiceEnterUnitElvenTransportShip = ElfMirkwoodVoiceMoveShip
        VoiceGarrison                   = ElfMirkwoodVoiceMoveGarrison
        VoiceInitiateCaptureBuilding    = ElfMirkwoodVoiceCaptureBuilding
        VoiceMoveToTrees                = ElfMirkwoodVoiceMoveForest
        VoiceEnterStateMoveToTrees      = ElfMirkwoodVoiceEnterStateMoveForest
    End

    CrowdResponseKey = Elf

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Elf Elf_Male Unit Infantry Elf_LorienWarrior
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    TauntAndPointDistance        = 200
    TauntAndPointUpdateDelay    = 2000
    PointAt                = ANY +HERO
    AddEmotion            = Doom_Base
    AddEmotion            = Point_Base
    AddEmotion            = Taunt_Base
     AddEmotion            = CheerIdle_Base
    AddEmotion            = CheerBusy_Base
    AddEmotion            = Alert_Base
    AddEmotion            = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARCHER GRAB_AND_DROP ATTACK_NEEDS_LINE_OF_SIGHT 
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_LONG

    Body = ActiveBody ModuleTag_02
        CheerRadius                  = EMOTION_CHEER_RADIUS
        MaxHealth                    = 900
        MaxHealthDamaged             = 400
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        CanAttackWhileContained        = Yes
        AILuaEventsList                = RohanArcherFunctions
        AttackPriority                =     AttackPriority_Archer
        BurningDeathTime                   = BURNINGDEATH_DURATION_INFANTRY
    End

     LocomotorSet
    Locomotor = ElvenThranduilLocomotor
    Condition = SET_NORMAL
    Speed     = NORMAL_ELVEN_FAST_MEMBER_SPEED
     End

    Behavior = PhysicsBehavior ModuleTag_04
    GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -KNOCKBACK -FADED
    SinkDelay = 3000
    SinkRate = 0.40
    DestructionDelay = 8000
    Sound = INITIAL ElfGenericVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HordeMemberCollide ModuleTag_HMC

    End

    Behavior = SlowDeathBehavior ModuleTag_07
    DeathTypes = NONE +KNOCKBACK
    SinkDelay = 3000
    SinkRate = 0.40
    DestructionDelay = 8000
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight                   = 24
       SecondHeight                  = 24
       FirstPercentIndent            = 30%
       SecondPercentIndent           = 70%
       TumbleRandomly                = Yes
       CrushStyle                    = Yes
       DieOnImpact                   = Yes
       BounceCount                   = 1
       BounceDistance                = 40
       BounceFirstHeight             = 24
       BounceSecondHeight            = 24
       BounceFirstPercentIndent      = 20%
       BounceSecondPercentIndent     = 80%
       GroundHitFX                   = FX_ThrownRockGroundHit
       GroundBounceFX                = FX_ThrownRockBounceHit
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
    HitReactionLifeTimer1 = 1993
    HitReactionLifeTimer2 = 1993
    HitReactionLifeTimer3 = 1993

    HitReactionThreshold1 = 5.0
    HitReactionThreshold2 = 25.0
    HitReactionThreshold3 = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VeterancyLeadership
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership
        TriggeredBy                  = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack     = No
        StartsPaused                 = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                 = No
        BonusName                    = FormenosArcherLeadership
        TriggeredBy                  = Upgrade_EliteHordeLvl2
        RefreshDelay                 = 2000
        Range                        = 200
        ObjectFilter                 = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End
	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Enabler
        SpecialPowerTemplate         = SpecialAbilityFormenosArcherRage
        TriggeredBy                  = Upgrade_EliteHordeLvl8
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_PowerUpdate
        SpecialPowerTemplate         = SpecialAbilityFormenosArcherRage
        Duration                     = 20000
        AttributeModifier            = FormenosArcherRage
        LockWeaponSlot               = SECONDARY
        StartsPaused                 = Yes
    End



	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FormenosArmorUpgradeEnabler
        SpecialPowerTemplate             = SpecialAbilityFakeLeadership2
        TriggeredBy                      = Upgrade_EliteHordeLvl5
    End

    Behavior = SpecialPowerModule ModuleTag_FormenosArmorUpgradeStarter
        SpecialPowerTemplate             = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack         = Yes
        StartsPaused                     = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                      = Upgrade_EliteHordeLvl5
        ArmorSetFlag                     = PLAYER_UPGRADE
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

	



    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 19
    ShadowSizeY = 19
    ShadowTexture = ShadowI
End



Object SilvanArcherHorde_not_summoned

    SelectPortrait = HPSilvanArcher
    ButtonImage    = HISilvanArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUMIA
        End
    End

    Side                             = Lothlorien
    EditorSorting                    = UNIT
    EmotionRange                     = 240
    DisplayName                      = OBJECT:SilvanArcherHorde
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_SilvanArcherHorde
    TransportSlotCount               = TRANSPORTSLOTCOUNT_SMALL_HORDE

    VisionRange                         = 350
    ShroudClearingRange                 = 420
    VisionSide                          = 35%
    VisionRear                          = 25%
    MaxVisionBonusPercent               = 300%
    VisionBonusTestRadius               = 200
    VisionBonusPercentPerFoot           = 2.0%

    CrushableLevel                      = 0
    CrusherLevel                        = 0
    CrushRevengeWeapon                  = BasicInfantryCrushRevenge

    CommandSet                     = SilvanArcherHordeCommandSet
    CommandPoints                  = 60
	BuildCost      = 1100
    BuildTime      = FirstAgeHordeBuildtime
	MaxSimultaneousOfType = 6
	WeaponSet
			Conditions = None
			Weapon = PRIMARY    MirkwoodArcherMissileHordeRangefinderEdainNew
			Weapon = SECONDARY  MirkwoodArcherMissileHordeRangefinderEdainNew
			Weapon = TERTIARY   MirkwoodArcherMissileHordeRangefinderBombard
			Weapon = QUATERNARY MirkwoodArcherMissileHordeRangefinderEdainNew
			AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
			AutoChooseSources = SECONDARY  FROM_PLAYER FROM_SCRIPT
			AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
			AutoChooseSources = QUATERNARY NONE
			ShareWeaponReloadTime = Yes
		End
   

    FormationWidth = 2
    FormationDepth = 1

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER LARGE_RECTANGLE_PATHFIND 

    ThreatLevel         = ELVEN_MIRKWOODARCHER_HORDE_THREAT
    ThreatBreakdown ElvenMirkwoodArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate                = 500
        MaxCowerTime                    = 5000
        MinCowerTime                    = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                 = InfantryFunctions
        AttackPriority                  = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload                 = SilvanArcher2 5
        Slots                          = 5
        PassengerFilter               = NONE +INFANTRY
        ShowPips                       = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset                   = X:0 Y:0
        MeleeBehavior                  = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:SilvanArcher2 Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime                = 1
        BackUpMaxDelayTime                = 3000
        BackUpMinDistance                = 1
        BackUpMaxDistance                = 3
        BackupPercentage                = 80%
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay        = 1000
        TauntAndPointExcluded           = NONE
        AfraidOf                       = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                 = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance                = 150
        FearScanDistance                = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion                        = Terror_Base
        AddEmotion                      = Doom_Base
        AddEmotion                      = UncontrollableFear_Base
        AddEmotion                      = FearIdle_Base
        AddEmotion                      = FearBusy_Base
        AddEmotion                      = Point_Base
        AddEmotion                      = OVERRIDE Taunt_Base
        End
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base
        AddEmotion                      = HeroCheerIdle_Base
        AddEmotion                      = HeroCheerBusy_Base
        AddEmotion                      = Alert_Base
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult             = 1.0
    End

    LocomotorSet
        Locomotor = NormalMeleeHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_FAST_MEMBER_SPEED
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType            = CAMOUFLAGE
            ForbiddenConditions         = TAKING_DAMAGE USING_ABILITY
            DetectionRange              = CAMOUFLAGE_RADIUS
            Options                     = ALLOW_NEAR_TREES
        End
        StartsActive                    = Yes
        UpdatePeriod                    = 2000
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_AllFactionUpgrade
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    ;Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
      ;  MinLifetime        = 120000
      ;  MaxLifetime        = 120000
      ;  DeathType          = FADED
    ;End




	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VeterancyLeadership
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership
        TriggeredBy                  = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack     = No
        StartsPaused                 = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                 = No
        BonusName                    = FormenosArcherLeadership
        TriggeredBy                  = Upgrade_EliteHordeLvl2
        RefreshDelay                 = 2000
        Range                        = 200
        ObjectFilter                 = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End
	
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Enabler
        SpecialPowerTemplate         = SpecialAbilityFormenosArcherRage
        TriggeredBy                  = Upgrade_EliteHordeLvl8
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_PowerUpdate
        SpecialPowerTemplate         = SpecialAbilityFormenosArcherRage
        Duration                     = 20000
        AttributeModifier            = FormenosArcherRage
        LockWeaponSlot               = SECONDARY
        StartsPaused                 = Yes
    End



	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FormenosArmorUpgradeEnabler
        SpecialPowerTemplate             = SpecialAbilityFakeLeadership2
        TriggeredBy                      = Upgrade_EliteHordeLvl5
    End

    Behavior = SpecialPowerModule ModuleTag_FormenosArmorUpgradeStarter
        SpecialPowerTemplate             = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack         = Yes
        StartsPaused                     = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                      = Upgrade_EliteHordeLvl5
        ArmorSetFlag                     = PLAYER_UPGRADE
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GlorfindelBladeOfPurityEnabler
        SpecialPowerTemplate          = SpecialAbilityGlorfindelBladeOfPurity
        TriggeredBy                   = Upgrade_EliteHordeLvl10
    End



    Geometry         = BOX
    GeometryMajorRadius     = 20.0
    GeometryMinorRadius     = 60.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No
End


Object SilvanArcherHorde

    SelectPortrait = HPSilvanArcher
    ButtonImage    = HISilvanArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEUMIA
        End
    End

    Side                             = Lothlorien
    EditorSorting                    = UNIT
    EmotionRange                     = 240
    DisplayName                      = OBJECT:SilvanArcherHorde
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_SilvanArcherHorde
    TransportSlotCount               = TRANSPORTSLOTCOUNT_SMALL_HORDE

    VisionRange                         = 350
    ShroudClearingRange                 = 420
    VisionSide                          = 35%
    VisionRear                          = 25%
    MaxVisionBonusPercent               = 300%
    VisionBonusTestRadius               = 200
    VisionBonusPercentPerFoot           = 2.0%

    CrushableLevel                      = 0
    CrusherLevel                        = 0
    CrushRevengeWeapon                  = BasicInfantryCrushRevenge

    CommandSet                     = SilvanArcherHordeCommandSet
    CommandPoints                  = 0

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    MirkwoodArcherMissileHordeRangefinderEdainNew
        Weapon = SECONDARY  MirkwoodArcherMissileHordeRangefinderEdainNew
        Weapon = TERTIARY   MirkwoodArcherMissileHordeRangefinderBombard
        Weapon = QUATERNARY MirkwoodArcherMissileHordeRangefinderEdainNew
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources = SECONDARY  FROM_PLAYER FROM_SCRIPT
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
        AutoChooseSources = QUATERNARY NONE
        ShareWeaponReloadTime = Yes
    End

    FormationWidth = 2
    FormationDepth = 1

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER LARGE_RECTANGLE_PATHFIND SUMMONED

    ThreatLevel         = ELVEN_MIRKWOODARCHER_HORDE_THREAT
    ThreatBreakdown ElvenMirkwoodArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle         = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate                = 500
        MaxCowerTime                    = 5000
        MinCowerTime                    = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                 = InfantryFunctions
        AttackPriority                  = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload                 = SilvanArcher 5
        Slots                          = 5
        PassengerFilter               = NONE +INFANTRY
        ShowPips                       = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset                   = X:0 Y:0
        MeleeBehavior                  = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:SilvanArcher Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime                = 1
        BackUpMaxDelayTime                = 3000
        BackUpMinDistance                = 1
        BackUpMaxDistance                = 3
        BackupPercentage                = 80%
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay        = 1000
        TauntAndPointExcluded           = NONE
        AfraidOf                       = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                 = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance                = 150
        FearScanDistance                = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion                        = Terror_Base
        AddEmotion                      = Doom_Base
        AddEmotion                      = UncontrollableFear_Base
        AddEmotion                      = FearIdle_Base
        AddEmotion                      = FearBusy_Base
        AddEmotion                      = Point_Base
        AddEmotion                      = OVERRIDE Taunt_Base
        End
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base
        AddEmotion                      = HeroCheerIdle_Base
        AddEmotion                      = HeroCheerBusy_Base
        AddEmotion                      = Alert_Base
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult             = 1.0
    End

    LocomotorSet
        Locomotor = NormalMeleeHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_FAST_MEMBER_SPEED
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType            = CAMOUFLAGE
            ForbiddenConditions         = TAKING_DAMAGE USING_ABILITY
            DetectionRange              = CAMOUFLAGE_RADIUS
            Options                     = ALLOW_NEAR_TREES
        End
        StartsActive                    = Yes
        UpdatePeriod                    = 2000
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_AllFactionUpgrade
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                = Upgrade_AllFactionUpgrade
        AttributeModifier          = FearlessForever
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType          = FADED
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End




    Geometry         = BOX
    GeometryMajorRadius     = 20.0
    GeometryMinorRadius     = 60.0
    GeometryHeight         = 10.0
    GeometryIsSmall     = No
End

