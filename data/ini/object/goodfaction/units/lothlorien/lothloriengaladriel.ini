Object LothlorienGaladriel

    SelectPortrait = HPGaladrielMod
    ButtonImage    = HIGaladrielne

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

      StaticModelLODMode   = Yes
      OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model           = EUGaldrlGd_SKN
        End

        ModelConditionState = HERO
            ParticleSysBone = B_HANDR TheElfRingSpark FollowBone:Yes
        End


        AnimationState            = USER_1
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
            Flags           = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            ParticleSysBone = B_HEAD VergesseneWorterWave
        End


        AnimationState                = USER_3
             StateName                = Attacking
             Animation                = EUGldrl_SPCB
             AnimationName            = EUGldrl_SKL.EUGldrl_SPCB
             AnimationMode            = ONCE
          End
            ParticleSysBone = NONE GaladrielBlastInitialCenter
            ParticleSysBone = NONE GaladrielBlastInitialVortex
            ParticleSysBone = NONE GaladrielBlastInitialWave
        End



        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLB
                AnimationMode        = ONCE
                AnimationPriority   = 15
            End
            Animation                = IDLC
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLC
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            Animation                = IDLD
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLD
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            StateName                = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_FLYA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = DYING SPLATTED
            Animation           = EUGaldrl_LNDA
                AnimationName     = RUEwnHrHrs_SKL.RUEwnHrHrs_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = EUGaldrl_DTHA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_DTHA
                AnimationMode     = ONCE
            End

            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation           = EUGaldrl_GTPA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = EUGaldrl_LNDA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End
        AnimationState        = MOVING WANDER
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = USER_4
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielEdainTerribleFuryFearBlast
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_RUNB
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE ONE_RING
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGaldrl_SKL.EUGaldrl_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode     = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGaldrl_SKL.EUGaldrl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_TNTA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_HITA
                AnimationMode = ONCE
            End
        End





        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNC
                AnimationMode            =    ONCE
            End
        End


        AnimationState            = SPECIAL_WEAPON_ONE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
        End


        AnimationState            = SPECIAL_WEAPON_THREE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw ModuleTag_ShieldBubble
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = WEAPONSET_HERO_MODE
            Model = exhealingm
        End
    End



    Side 		= Lothlorien
    EditorSorting 	= UNIT
    ThreatLevel 	= GALADRIEL_THREAT_LEVEL
    ThingClass 		= CHARACTER_UNIT
    MaxSimultaneousOfType    = 1
    DisplayRangedDamage = GALADRIELDAG_DAMAGE
    TransportSlotCount 	= TRANSPORTSLOTCOUNT_HERO
    BuildCost 		= GALADRIELDAG_COST
    BuildTime 		= SILMARIL_HERO_BUILDTIME

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    GaladrielAttack
        Weapon            = SECONDARY  GaladrielAttackStructure
		Weapon            = TERTIARY    GaladrielAttackMachine
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst       = SECONDARY   STRUCTURE
		OnlyAgainst       = TERTIARY    MACHINE
	End
	
    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange         = 250
    ShroudClearingRange = 400
    BountyValue         = ELVEN_GALADRIEL_BOUNTY_VALUE
    RecruitText         = CONTROLBAR:GaladrielRecruit
    ReviveText          = CONTROLBAR:GaladrielRevive
    Hotkey              = CONTROLBAR:GaladrielHotkey
    DisplayName         = OBJECT:ElvenGaladriel
    CrusherLevel        = 0
    CommandSet          = LothlorienGaladrielCommandSet
    CommandPoints       = 0
    CrushableLevel      = 3




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElrondWeapon
    End

    AutoResolveLeadership = AutoResolve_ElrondBonus




    VoiceAttack                                 = GaladrielModVoiceAttack
    VoiceAttackAir                              = GaladrielModVoiceAttack
    VoiceAttackCharge                           = GaladrielModVoiceAttack
    VoiceAttackMachine                          = GaladrielModVoiceAttack
    VoiceAttackStructure                        = GaladrielModVoiceAttack
    VoiceCreated                                = GaladrielModVoiceSalute
    VoiceFullyCreated                           = GaladrielModVoiceSalute
    VoiceFear                                   = GaladrielModVoiceHelpMe
    VoiceGuard                                  = GaladrielModVoiceMove
    VoiceMove                                   = GaladrielModVoiceMove
    VoiceMoveToCamp                             = GaladrielModVoiceMove
    VoicePriority                               = 95
    VoiceSelect                                 = GaladrielModVoiceSelect
    VoiceSelectBattle                           = GaladrielModVoiceSelect

    SoundImpact                                 = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip        = GaladrielModVoiceMove
        VoiceGarrison                           = GaladrielModVoiceMove
        VoiceInitiateCaptureBuilding            = GaladrielModVoiceMove
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_DTHA    Frames:15
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    EvaEventDieOwner = GaladrielDie



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO HEAVY_MELEE_HITTER ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM

    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                 = GALADRIELDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                    = DYING
        DeathAnimationTime           = 6500
        RespawnAnim                  = LEVELED
        RespawnAnimationTime         = 2000
        AutoRespawnAtObjectFilter    = NONE +CASTLE_KEEP
        ButtonImage                  = HIGaladrielne
        RespawnAsTemplate            = LothlorienGaladriel

        RespawnRules =    AutoSpawn:No           Cost:GALADRIELDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
  End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = GaladrielEdainFunctions
    End





    Behavior = CitadelSlaughterHordeContain ModuleTag_SlaughterMe
        PassengerFilter              = NONE +TheDroppedRing
        ObjectStatusOfContained      = UNSELECTABLE ENCLOSED
        ContainMax                   = 1
        AllowEnemiesInside           = No
        AllowAlliesInside            = Yes
        AllowNeutralInside           = No
        AllowOwnPlayerInsideOverride = Yes
        EnterSound                   = GaladrielRingEntscheidung
        EntryOffset                  = X:0.0 Y:0.0 Z:0.0
        EntryPosition                = X:0.0 Y:0.0 Z:0.0
        ExitOffset                   = X:0.0 Y:0.0 Z:0.0
        StatusForRingEntry           = HOLDING_THE_RING
        UpgradeForRingEntry          = Upgrade_RingHero Upgrade_FortressRingHero
        ObjectToDestroyForRingEntry  = NONE +TheDroppedRing
        FXForRingEntry               = FX_OneRingFlare
    End

    Behavior = ModelConditionUpgrade ModulTag_RingHeroMC
        TriggeredBy         = Upgrade_RingHero Upgrade_FortressRingHero
        RequiresAllTriggers = Yes
        AddConditionFlags   = ONE_RING
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = NONE +TheDroppedRing
        ScanRange = 3000
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_INFANTRY_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes           = ALL
        SinkDelay            = 5000
        SinkRate             = 10.0
        DestructionDelay     = 1800
        Sound                = INITIAL GaladrielVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Hero
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End


    Behavior = AutoHealBehavior ModuleTag_GaladrielHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1200
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_TaurielKampf
        EffectRadius            = 300
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = GaladrielTaurielModifier
        AllowFilter             = ANY +LothlorienTauriel ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FactionLeaderLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_FactionLeaderLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FactionLeaderLeadership
        StartsActive     = Yes
        BonusName        = FactionLeaderGlobalLeadership
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = LORIEN_LEADERSHIP_UNITS_OBF
    End





    Behavior = CommandSetUpgrade ModueTag_GaladrielChoice
        TriggeredBy    = Upgrade_RingHero Upgrade_FortressRingHero
        ConflictsWith  = Upgrade_ObjectUnderAIControl
        CommandSet     = LothlorienGaladrielCommandSet_SilmarilChoice
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FarsightUnpause
        SpecialPowerTemplate    = SpecialAbilityElrondFarsight
        TriggeredBy             = Upgrade_Level_1
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_FarsightOCL
        StartsPaused            = Yes
        SpecialPowerTemplate    = SpecialAbilityElrondFarsight
        OCL                     = OCL_SpecialPowerFarSeeing
        CreateLocation          = CREATE_AT_LOCATION
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = No
        BonusName        = GaladrielHerrindesGoldenenWaldes
        TriggeredBy      = Upgrade_Level_2
        RefreshDelay     = 2000
        Range            = 200

        ObjectFilter     = LORIEN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY +CAVALRY -MACHINE -SHIP -STRUCTURE -BASE_FOUNDATION -HERO ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HardenEnabler
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        TriggeredBy                  = Upgrade_Level_7
        ObeyRechageOnTrigger         = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HardenStarter
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_HardenWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        WhichSpecialWeapon           = 3
        MustFinishAbility        	 = Yes	
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 270
        SpecialWeapon                = BlickderweiﬂenFrauWeapon
        TriggerSound                 = LorienEffeckts2
		ChainedButton            	 = "Command_SpecialAbilityGaladrielStorm"
	End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LightningEnabler
        SpecialPowerTemplate        = SpecialAbilityGaladrielStorm
        TriggeredBy                 = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_LightningStrike
        SpecialPowerTemplate        = SpecialAbilityGaladrielStorm
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

	Behavior = ArrowStormUpdate ModuleTag_ShootLightningBolts
		SpecialPowerTemplate	= SpecialAbilityGaladrielStorm
        UnpackingVariation      = 3
        CanShootEmptyGround     = Yes
		FreezeAfterTriggerDuration   = 3000
        UnpackTime              = 2500
        PreparationTime         = 1
        PersistentPrepTime      = 500
        PackTime                = 1500
        ApproachRequiresLOS     = No
        AwardXPForTriggering    = 0
        WeaponTemplate  = GaladrielStormWeapon
        TargetRadius    = 70
        ShotsPerTarget  = 1
        ShotsPerBurst   = 3
        MaxShots        = 15
    End	

    Behavior = AutoAbilityBehavior ModuleTag_MachtCurunirsAutoAbility
        SpecialAbility               = SpecialAbilityGaladrielStorm
        MaxScanRange                 = #SUBTRACT( SARUMAN_LIGHTNING_RANGE 25 )
        Query                        = 1 ALL ENEMIES -STRUCTURE
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MagiedesgoldenenWaldesEnabler
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        TriggeredBy                = Upgrade_Level_9
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_MagiedesgoldenenWaldesStarter
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MagiedesgoldenenWaldesWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = MagiedesgoldenenWaldesWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_MagiedesgoldenenAutoAbility
        SpecialAbility             = SpecialAbilityMagiedesgoldenenWaldes
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLSpawnMarvelegEnabler
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       TriggeredBy                 = Upgrade_Level_5
       ObeyRechageOnTrigger        = Yes
    End

    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnMarveleg
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       OCL                         = OCL_DerRingNenya
       CreateLocation              = CREATE_AT_LOCATION
       StartsPaused                = Yes
       SetModelCondition           = ModelConditionState:USER_2
       SetModelConditionTime       = 2.1
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnMarvelegUpdate
        SpecialPowerTemplate       = SpecialAbilityDerRingNenya
        UnpackTime                 = 1
        PreparationTime            = 3
        PackTime                   = 2096
        AwardXPForTriggering       = 0
        FreezeAfterTriggerDuration = 0
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        TriggeredBy                = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_WordStarter
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        SetModelCondition          = ModelConditionState:USER_1
        SetModelConditionTime      = 9.0

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        WhichSpecialWeapon         = 2
        SkipContinue               = Yes
        UnpackTime                 = 3000
        PackTime                   = 1
        FreezeAfterTriggerDuration = 4000
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = GaladrielFXWDM
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityGaladrielWordOfPower
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ErinnerungEnabler
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        TriggeredBy                = Upgrade_Level_5
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ErinnerungStarter
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ErinnerungWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = ErinnerunganTelperionWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_ErinnerungAutoAbility
        SpecialAbility             = SpecialAbilityErinnerunganTelperion
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LichtEarendilsEnabler
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        TriggeredBy             = Upgrade_Level_7
    End

      Behavior = SpecialPowerModule ModuleTag_LichtEarendilsStarter
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_LichtEarendilsUpdate
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        HeroAttributeModifier   = GaladrielLichtEarendils
        HeroEffectDuration      = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End




    Behavior = SpecialPowerModule ModuleTag_RingannehmenStarter
         SpecialPowerTemplate           = SpecialAbilityGandalfVerfuhrte
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Ringannehmen
         SpecialPowerTemplate           = SpecialAbilityGandalfVerfuhrte
         MountedTemplate                = LothlorienGaladrielRingannehmen
         SynchronizeTimerOnSpecialPower = SpecialAbilityDerRingNenya SpecialAbilityElrondFarsight SpecialAbilityMagiedesgoldenenWaldes SpecialAbilityBlickderweiﬂenFrau
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingannehmen2_Fortress
        TriggeredBy                     = Upgrade_GaladrielRingannehmen Upgrade_RingHero
        RequiresAllTriggers             = Yes
		ConflictsWith					= Upgrade_ObjectUnderAIControl
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGandalfVerfuhrte
    End




    Behavior = SpecialPowerModule ModuleTag_RingablehnenStarter
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Ringablehnen
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         MountedTemplate                = LothlorienGaladrielRingablehnen
         SynchronizeTimerOnSpecialPower = SpecialAbilityDerRingNenya SpecialAbilityElrondFarsight SpecialAbilityMagiedesgoldenenWaldes SpecialAbilityBlickderweiﬂenFrau
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingablehnen2
        TriggeredBy                     = Upgrade_GaladrielRingablehnen Upgrade_RingHero
        RequiresAllTriggers             = Yes
		ConflictsWith					= Upgrade_ObjectUnderAIControl
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGandalfGeprufte
    End




    Behavior = SpecialPowerModule ModuleTag_RingannehmenStarter_AI
         SpecialPowerTemplate           = SpecialAbilityGandalfVerfuhrte
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Ringannehmen_AI
         SpecialPowerTemplate           = SpecialAbilityGandalfVerfuhrte
         MountedTemplate                = LothlorienGaladrielRingannehmen
         SynchronizeTimerOnSpecialPower = SpecialAbilityDerRingNenya SpecialAbilityElrondFarsight SpecialAbilityMagiedesgoldenenWaldes SpecialAbilityBlickderweiﬂenFrau
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingannehmen2_AI
        TriggeredBy                     = Upgrade_RingHero Upgrade_ObjectUnderAIControl
        RequiresAllTriggers             = Yes
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGandalfVerfuhrte
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AttributeModifierUpgrade ModuleTag_Bonus
        TriggeredBy       = Upgrade_GeschenkeLoriens
        AttributeModifier = GeschenkeGaladrielModifier
    End

    Behavior = ModelConditionUpgrade ModulTag_BonusTag
        TriggeredBy       = Upgrade_GeschenkeLoriens
        AddConditionFlags = HERO
        Permanent         = Yes
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP        = Yes
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI1
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 250000
        GrantUpgrade = Upgrade_GeschenkeLoriens
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate FarsightAI
        CommandButtonName = Command_SpecialAbilityGaladrielFarsight
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornAthelas
        CommandButtonName = Command_SpecialAbilityWordNenya
        SpecialPowerAIType = AI_SPECIAL_POWER_SELFAOEHEALHEROS
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_SpecialAbilityGaladrielWordOfPower
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityMagiedesgoldenenWaldes
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate ThunderboltAI
        CommandButtonName = Command_SpecialAbilityBlickderweiﬂenFrau
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

    Scale 		   = 0.95
    Geometry               = CYLINDER
    GeometryMajorRadius    = 8.0
    GeometryHeight         = 19.2
    GeometryIsSmall        = Yes

    Shadow                 = SHADOW_DECAL
    ShadowSizeX            = 12
    ShadowSizeY            = 12
    ShadowTexture          = ShadowI
End

Object LothlorienGaladrielRingannehmen

    SelectPortrait = HPGaladriel
    ButtonImage    = HIGaladrielRing

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    StaticModelLODMode   = Yes
    OkToChangeModelColor = Yes


        DefaultModelConditionState
            Model           = EUGaldrl_SKN
            ParticleSysBone = B_PELVIS GaladAura FollowBone:Yes
            ParticleSysBone = B_PELVIS GaladAura02 FollowBone:Yes
        End

        AnimationState            = USER_1
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
            Flags           = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            ParticleSysBone = B_HEAD VergesseneWorterWave
        End

        AnimationState                = USER_3
             StateName                = Attacking
             Animation                = EUGldrl_SPCB
             AnimationName            = EUGldrl_SKL.EUGldrl_SPCB
             AnimationMode            = ONCE
          End
            ParticleSysBone = NONE GaladrielBlastInitialCenter
            ParticleSysBone = NONE GaladrielBlastInitialVortex
            ParticleSysBone = NONE GaladrielBlastInitialWave
        End



        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLB
                AnimationMode        = ONCE
                AnimationPriority   = 15
            End
            Animation                = IDLC
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLC
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            Animation                = IDLD
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLD
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            StateName                = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_FLYA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = DYING SPLATTED
            Animation           = EUGaldrl_LNDA
                AnimationName     = RUEwnHrHrs_SKL.RUEwnHrHrs_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = EUGaldrl_DTHA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_DTHA
                AnimationMode     = ONCE
            End
            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation           = EUGaldrl_GTPA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = EUGaldrl_LNDA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End
        AnimationState        = MOVING WANDER
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = USER_4
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielEdainTerribleFuryFearBlast
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_RUNB
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNA
                AnimationMode     = LOOP
            End
        End



        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE ONE_RING
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGaldrl_SKL.EUGaldrl_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode     = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGaldrl_SKL.EUGaldrl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_TNTA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_HITA
                AnimationMode = ONCE
            End
        End





        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielTerribleFuryFearBlast
        End

        AnimationState            = SPECIAL_WEAPON_ONE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
            ParticleSysBone = NONE GaladrielWDMInitial02
            ParticleSysBone = NONE GaladrielWDMInitial03
        End

        AnimationState            = SPECIAL_WEAPON_THREE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
        End

    End



    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = GALADRIEL_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    MaxSimultaneousOfType    = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = GALADRIELDAG_DAMAGE
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    CrushableLevel = 4

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    GaladrielAttackOneRingWeapon
        Weapon            = SECONDARY  GaladrielAttackStructureOneRing
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst       = SECONDARY   STRUCTURE
    End

    ArmorSet
        Conditions      = None
        Armor           = SilmarilHeroHeavyArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    BountyValue = ELVEN_GALADRIEL_BOUNTY_VALUE
    RecruitText                     = CONTROLBAR:GaladrielRecruit
    ReviveText                    = CONTROLBAR:GaladrielRevive
    Hotkey                        = CONTROLBAR:GaladrielHotkey
    DisplayName = OBJECT:ElvenGaladriel
    CrusherLevel        = 0
    CommandSet = LothlorienGaladrielCommandSet_Ring
    CommandPoints = 0




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElrondWeapon
    End

    AutoResolveLeadership = AutoResolve_ElrondBonus





    VoiceAttack                                 = GaladrielModVoiceAttack
    VoiceAttackAir                                = GaladrielModVoiceAttack
    VoiceAttackCharge                             = GaladrielModVoiceAttack
    VoiceAttackMachine                             = GaladrielModVoiceAttack
    VoiceAttackStructure                         = GaladrielModVoiceAttack
    VoiceCreated                                = SH_ThreeForElves
    VoiceFullyCreated                             = SH_ThreeForElves
    VoiceFear                                    = GaladrielModVoiceHelpMe
    VoiceGuard                                    = GaladrielModVoiceMove
    VoiceMove                                     = GaladrielModVoiceMove
    VoiceMoveToCamp                             = GaladrielModVoiceMove
    VoicePriority                                = 95
    VoiceSelect                                 = GaladrielModVoiceSelect
    VoiceSelectBattle                              = GaladrielModVoiceSelect

    SoundImpact                                 = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip        = GaladrielModVoiceMove
        VoiceGarrison                            = GaladrielModVoiceMove
        VoiceInitiateCaptureBuilding            = GaladrielModVoiceMove
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_DTHA    Frames:15
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner = GaladrielDie


     EvaEnemyObjectSightedEvent = EnemyGaladrielSeen

    ClientUpdate = EvaAnnounceClientCreate ModuleTag_CreateAnnounce
        AnnouncementEventEnemy = EnemyGaladrielSeen
        AnnouncementEventAlly = None
        AnnouncementEventOwner = None

        OnlyIfVisible = Yes
        CountAsFirstSightedAnnoucement = Yes
        UseObjectsPosition = No
        CreateFakeRadarEvent = Yes
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO HEAVY_MELEE_HITTER SCARY ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    BuildCost = GALADRIELDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM

    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                 = GALADRIELDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 6500
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HIGaladrielne
        RespawnAsTemplate             = LothlorienGaladriel

        RespawnRules =    AutoSpawn:No          Cost:GALADRIELDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
   End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = GaladrielEdainFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_INFANTRY_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay            = 5000
        SinkRate            = 10.0
        DestructionDelay    = 1800
        Sound                = INITIAL GaladrielVoiceDie
        Weapon                = FINAL RingHeroDeathShockwave
    End

    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Hero
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = AutoHealBehavior ModuleTag_GaladrielHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1200
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = Yes
        BonusName        = GaladrieldunkleHerrinBuff
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2000
        Range            = 200

        ObjectFilter     = ANY +INFANTRY +CAVALRY -MACHINE -SHIP -STRUCTURE -BASE_FOUNDATION -HERO ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive     = Yes
        RefreshDelay     = 2000
        Range            = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        TargetEnemy      = Yes
        AntiCategory     = LEADERSHIP BUFF
        BonusName        = GaladrieldunkleHerrinDebuff
        ObjectFilter     = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End

    Behavior = RadiateFearUpdate ModuleTag_DreadVisageFear
        InitiallyActive                     = Yes
        WhichSpecialPower                   = 1
        GenerateFear                        = Yes
        EmotionPulseRadius                  = WITCHKING_DREADVISAGE_EFFECT_RADIUS
        EmotionPulseInterval                = 2000
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GaladrielTerribleFuryEnabler
        SpecialPowerTemplate       = SpecialAbilityScreech
        TriggeredBy                = Upgrade_Level_3
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_GaladrielTerribleFury
        SpecialPowerTemplate      = SpecialAbilityScreech
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        SetModelCondition         = ModelConditionState:USER_2
        SetModelConditionTime     = 3.2
        DisableDuringAnimDuration = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GaladrielTerribleFuryUpdate
        SpecialPowerTemplate        = SpecialAbilityScreech
        UnpackTime                  = 1
        AwardXPForTriggering        = 0
        TriggerSound                = GaladrielVoiceTerribleFury
        EffectRange                 = 200
        UnpackTime                  = 100
        PreparationTime             = 1
        PackTime                    = 3000
    End

    Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehaviorScreech
  	SpecialAbility		= SpecialAbilityScreech
	ForbiddenStatus		= INSIDE_GARRISON
	MaxScanRange		= 200
	Query			= 20 ANY ENEMIES -STRUCTURE -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_GrundfesteEnabler
        SpecialPowerTemplate    = SpecialPowerSpawnTornado
        TriggeredBy             = Upgrade_Level_8
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLGrundfeste
        SpecialPowerTemplate    = SpecialPowerSpawnTornado
        OCL                     = SUPERWEAPON_SpawnTornado
        CreateLocation          = CREATE_AT_LOCATION
        AvailableAtStart        = Yes
        StartsPaused            = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TornadoEnabler
        SpecialPowerTemplate    = SpecialAbilityGaladrielGrundfeste
        TriggeredBy             = Upgrade_Level_5
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLSpawnTornado
        SpecialPowerTemplate    = SpecialAbilityGaladrielGrundfeste
        OCL                     = OCL_GaladrielEarthquake
        CreateLocation          = CREATE_AT_LOCATION
        AvailableAtStart        = Yes
        StartsPaused            = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        TriggeredBy                = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_WordStarter
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = GaladrielFXWDM
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityGaladrielWordOfPower
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableHK2
        UpgradeToGrant              = Upgrade_GaladrielRingannehmen
        GiveOnBuildComplete         = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

	Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP        = Yes
	End

    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End

    Behavior = FXListDie ModuleTag_AnnounceWeLostTheRing
        DeathFX             = GandalfAnnounceFortressDeathLostRingFX
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList        = OCL_TheOneRing
    End

    Behavior = CreateObjectDie ModuleTag_RemoveFX
        CreationList        = OCL_GaladrielRingannehmenDead
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate TerribleFury_AI
        CommandButtonName  = Command_SpecialAbilityGaladrielAntlitz
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate GaladrielGrundfesteAI
        CommandButtonName = Command_SpecialAbilityGaladrielGrundfeste
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate WhirlwindAI
        CommandButtonName = Command_SpecialPowerGaladrielSpawnTornado
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_SpecialAbilityGaladrielMachtdesRinges
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Scale 		= 0.95
    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 19.2
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 12
    ShadowSizeY         = 12
    ShadowTexture       = ShadowI
End

Object LothlorienGaladrielRingablehnen

    SelectPortrait = HPGaladrielMod
    ButtonImage    = HIGaladrielne

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        StaticModelLODMode   = Yes
        GlowEnabled          = Yes
        GlowEmissive         = Yes
        OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model               = EUGaldrlGd_SKN
            ParticleSysBone     = B_PELVIS GaladrielGlimmer01 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer02 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer03 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer04 FollowBone:Yes
        End


        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            ParticleSysBone = B_HEAD VergesseneWorterWave
        End


        AnimationState                = USER_3
             StateName                = Attacking
             Animation                = EUGldrl_SPCB
             AnimationName            = EUGldrl_SKL.EUGldrl_SPCB
             AnimationMode            = ONCE
          End
            ParticleSysBone = NONE GaladrielBlastInitialCenter
            ParticleSysBone = NONE GaladrielBlastInitialVortex
            ParticleSysBone = NONE GaladrielBlastInitialWave
        End



        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLB
                AnimationMode        = ONCE
                AnimationPriority   = 15
            End
            Animation                = IDLC
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLC
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            Animation                = IDLD
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLD
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            StateName                = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_FLYA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = DYING SPLATTED
            Animation           = EUGaldrl_LNDA
                AnimationName     = RUEwnHrHrs_SKL.RUEwnHrHrs_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = EUGaldrl_DTHA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_DTHA
                AnimationMode     = ONCE
            End

            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation           = EUGaldrl_GTPA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = EUGaldrl_LNDA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End
        AnimationState        = MOVING WANDER
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = USER_4
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielEdainTerribleFuryFearBlast
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_RUNB
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE ONE_RING
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGaldrl_SKL.EUGaldrl_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode     = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGaldrl_SKL.EUGaldrl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_TNTA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_HITA
                AnimationMode = ONCE
            End
        End





        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState            = SPECIAL_WEAPON_THREE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw ModuleTag_ShieldBubble
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = WEAPONSET_HERO_MODE
            Model = exhealingm
            ParticleSysBone = NONE GaladrielEdainFearBlast FollowBone:Yes
        End
    End



    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = GALADRIEL_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    MaxSimultaneousOfType    = 1
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = GALADRIELDAG_DAMAGE
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    CrushableLevel = 4

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    GaladrielAttackValar
        Weapon            = SECONDARY  GaladrielAttackStructure
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst       = SECONDARY   STRUCTURE BLOCKING_GATE
    End

    WeaponSet
        Conditions         = WEAPONSET_HERO_MODE
        Weapon             = PRIMARY    GaladrielAttackValar
    End


    ArmorSet
        Conditions      = None
        Armor           = SilmarilHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    BountyValue = ELVEN_GALADRIEL_BOUNTY_VALUE
    RecruitText                     = CONTROLBAR:GaladrielRecruit
    ReviveText                    = CONTROLBAR:GaladrielRevive
    Hotkey                        = CONTROLBAR:GaladrielHotkey
    DisplayName = OBJECT:ElvenGaladriel

    CrusherLevel        = 0
    CommandSet = LothlorienGaladrielCommandSet_Valar
    CommandPoints = 0




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElrondWeapon
    End

    AutoResolveLeadership = AutoResolve_ElrondBonus





    VoiceAttack                                 = GaladrielModVoiceAttack
    VoiceAttackAir                                = GaladrielModVoiceAttack
    VoiceAttackCharge                             = GaladrielModVoiceAttack
    VoiceAttackMachine                             = GaladrielModVoiceAttack
    VoiceAttackStructure                         = GaladrielModVoiceAttack
    VoiceCreated                                = SH_ThreeForElves
    VoiceFullyCreated                             = SH_ThreeForElves
    VoiceFear                                    = GaladrielModVoiceHelpMe
    VoiceGuard                                    = GaladrielModVoiceMove
    VoiceMove                                     = GaladrielModVoiceMove
    VoiceMoveToCamp                             = GaladrielModVoiceMove
    VoicePriority                                = 95
    VoiceSelect                                 = GaladrielModVoiceSelect
    VoiceSelectBattle                              = GaladrielModVoiceSelect

    SoundImpact                                 = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip        = GaladrielModVoiceMove
        VoiceGarrison                            = GaladrielModVoiceMove
        VoiceInitiateCaptureBuilding            = GaladrielModVoiceMove
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_DTHA    Frames:15
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner = GaladrielDie



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO HEAVY_MELEE_HITTER SCARY ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    BuildCost = GALADRIELDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM


    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                 = GALADRIELDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End


    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                   = DYING
        DeathAnimationTime          = 6500
        RespawnAnim                 = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter   = NONE +CASTLE_KEEP
        ButtonImage                 = HIGaladrielne
        RespawnAsTemplate           = LothlorienGaladriel

        RespawnRules =            AutoSpawn:No   Cost:GALADRIELDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End



    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = GaladrielEdainFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_INFANTRY_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay            = 5000
        SinkRate            = 10.0
        DestructionDelay    = 1800
        Sound                = INITIAL GaladrielVoiceDie
        Weapon                = FINAL RingHeroDeathShockwave
    End

    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Hero
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End


    Behavior = AutoHealBehavior ModuleTag_GaladrielHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1200
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End



    Behavior = ObjectCreationUpgrade MaketheFrodoInstant
        TriggeredBy         = Upgrade_GaladrielRingablehnen
        Delay               = 0.0
        ThingToSpawn        = GaladrielRohanFrodo_mod
        Offset              = X:80.0 Y:0.0 Z:0.0
        FadeInTime          = 600
    End

    Behavior = ObjectCreationUpgrade MaketheFrodoRevive
        TriggeredBy         = Upgrade_RingHero
        Delay               = 1000.0
        ThingToSpawn        = GaladrielRohanFrodo_mod
        Offset              = X:80.0 Y:0.0 Z:0.0
        FadeInTime          = 600
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = No
        BonusName        = GaladrielRingablehnenLeadership
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2000
        Range            = 300

        ObjectFilter     = ANY +INFANTRY +CAVALRY -MACHINE -SHIP -STRUCTURE -BASE_FOUNDATION -HERO ALLIES
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
        EffectRadius         = 150
        PingDelay            = 2000
        HealPercentPerSecond = 3%
        AllowFilter          = ANY +INFANTRY +CAVALRY +HERO -MACHINE +MONSTER -IMMOBILE +DOZER
        NonStackable         = Yes
        HealFX               = FX_SpellHealUnitHealBuff
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MachtdesgoldenenWaldesEnabler
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        TriggeredBy                = Upgrade_Level_10
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_MachtdesgoldenenWaldesStarter
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MachtdesgoldenenWaldesWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = MachtdesgoldenenWaldesWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_MachtdesgoldenenAutoAbility
        SpecialAbility             = SpecialAbilityMagiedesgoldenenWaldes
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLSpawnMarvelegEnabler
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       TriggeredBy                 = Upgrade_Level_3
       ObeyRechageOnTrigger        = Yes
    End

    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnMarveleg
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       OCL                         = OCL_DerRingNenya
       CreateLocation              = CREATE_AT_LOCATION
       StartsPaused                = Yes
       SetModelCondition           = ModelConditionState:USER_2
       SetModelConditionTime       = 2.1
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnMarvelegUpdate
        SpecialPowerTemplate       = SpecialAbilityDerRingNenya
        UnpackTime                 = 1
        PreparationTime            = 3
        PackTime                   = 2096
        AwardXPForTriggering       = 0
        FreezeAfterTriggerDuration = 0
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ErinnerungEnabler
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        TriggeredBy                = Upgrade_Level_5
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ErinnerungStarter
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ErinnerungWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = ErinnerunganTelperionWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_ErinnerungAutoAbility
        SpecialAbility             = SpecialAbilityErinnerunganTelperion
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LichtEarendilsEnabler
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        TriggeredBy             = Upgrade_Level_7
    End

      Behavior = SpecialPowerModule ModuleTag_LichtEarendilsStarter
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_LichtEarendilsUpdate
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        HeroAttributeModifier   = GaladrielLichtEarendils
        HeroEffectDuration      = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End





    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP        = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingablehnen
        TriggeredBy                  = Upgrade_GaladrielRingablehnen
        GetUpgradeCommandButtonName  = Command_SpecialAbilityFakeUpdateGaladrielRingAnnehmenFX
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = GaladrielRingablehnenFX
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +HERO
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList    = OCL_GaladrielAblehnenDieFix
    End

    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate FarsightAI
        CommandButtonName = Command_SpecialAbilityGaladrielFarsight
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornAthelas
        CommandButtonName = Command_SpecialAbilityWordNenya
        SpecialPowerAIType = AI_SPECIAL_POWER_SELFAOEHEALHEROS
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_SpecialAbilityGaladrielWordOfPower
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Scale 		= 0.95
    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 19.2
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 12
    ShadowSizeY         = 12
    ShadowTexture       = ShadowI
End


Object LothlorienGaladrielRingablehnen_OhneRing

    SelectPortrait = HPGaladrielMod
    ButtonImage    = HIGaladrielne

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

      StaticModelLODMode   = Yes
      OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model               = EUGaldrlGd_SKN
            ParticleSysBone     = B_PELVIS GaladrielGlimmer01 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer02 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer03 FollowBone:Yes
            ParticleSysBone     = B_PELVIS GaladrielGlimmer04 FollowBone:Yes
        End


        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            ParticleSysBone = B_HEAD VergesseneWorterWave
        End


        AnimationState                = USER_3
             StateName                = Attacking
             Animation                = EUGldrl_SPCB
             AnimationName            = EUGldrl_SKL.EUGldrl_SPCB
             AnimationMode            = ONCE
          End
            ParticleSysBone = NONE GaladrielBlastInitialCenter
            ParticleSysBone = NONE GaladrielBlastInitialVortex
            ParticleSysBone = NONE GaladrielBlastInitialWave
        End




        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLB
                AnimationMode        = ONCE
                AnimationPriority   = 15
            End
            Animation                = IDLC
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLC
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            Animation                = IDLD
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLD
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            StateName                = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_FLYA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = DYING SPLATTED
            Animation           = EUGaldrl_LNDA
                AnimationName     = RUEwnHrHrs_SKL.RUEwnHrHrs_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = EUGaldrl_DTHA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_DTHA
                AnimationMode     = ONCE
            End

            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation           = EUGaldrl_GTPA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = EUGaldrl_LNDA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End
        AnimationState        = MOVING WANDER
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = USER_4
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielEdainTerribleFuryFearBlast
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_RUNB
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE ONE_RING
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        =  FIRING_OR_PREATTACK_A ONE_RING
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGaldrl_SKL.EUGaldrl_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode     = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGaldrl_SKL.EUGaldrl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_TNTA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_HITA
                AnimationMode = ONCE
            End
        End





        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState            = SPECIAL_WEAPON_THREE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_ShieldBubble
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = WEAPONSET_HERO_MODE
            Model = exhealingm
        End
    End


    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = GALADRIEL_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    MaxSimultaneousOfType    = 1
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = GALADRIELDAG_DAMAGE
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    CrushableLevel = 4
    BuildCost = GALADRIELDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    GaladrielAttackValar
        Weapon            = SECONDARY  GaladrielAttackStructure
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst       = SECONDARY   STRUCTURE BLOCKING_GATE
    End

    WeaponSet
        Conditions         = WEAPONSET_HERO_MODE
        Weapon             = PRIMARY    GaladrielAttackValar
    End

    ArmorSet
        Conditions      = None
        Armor           = SilmarilHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    BountyValue = ELVEN_GALADRIEL_BOUNTY_VALUE
    RecruitText                     = CONTROLBAR:GaladrielRecruit
    ReviveText                    = CONTROLBAR:GaladrielRevive
    Hotkey                        = CONTROLBAR:GaladrielHotkey
    DisplayName = OBJECT:ElvenGaladriel
    CrusherLevel        = 0
    CommandSet = LothlorienGaladrielCommandSet_Valar
    CommandPoints = 0


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElrondWeapon
    End

    AutoResolveLeadership = AutoResolve_ElrondBonus




    VoiceAttack                                 = GaladrielModVoiceAttack
    VoiceAttackAir                              = GaladrielModVoiceAttack
    VoiceAttackCharge                           = GaladrielModVoiceAttack
    VoiceAttackMachine                          = GaladrielModVoiceAttack
    VoiceAttackStructure                        = GaladrielModVoiceAttack
    VoiceCreated                                = GaladrielModVoiceSalute
    VoiceFullyCreated                           = GaladrielModVoiceSalute
    VoiceFear                                   = GaladrielModVoiceHelpMe
    VoiceGuard                                  = GaladrielModVoiceMove
    VoiceMove                                   = GaladrielModVoiceMove
    VoiceMoveToCamp                             = GaladrielModVoiceMove
    VoicePriority                               = 95
    VoiceSelect                                 = GaladrielModVoiceSelect
    VoiceSelectBattle                           = GaladrielModVoiceSelect

    SoundImpact                                 = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip        = GaladrielModVoiceMove
        VoiceGarrison                           = GaladrielModVoiceMove
        VoiceInitiateCaptureBuilding            = GaladrielModVoiceMove
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_DTHA    Frames:15
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner = GaladrielDie



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO HEAVY_MELEE_HITTER SCARY ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM


    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                 = GALADRIELDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                   = DYING
        DeathAnimationTime          = 6500
        RespawnAnim                 = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter   = NONE +CASTLE_KEEP
        ButtonImage                 = HIGaladrielne
        RespawnAsTemplate           = LothlorienGaladrielRingablehnen_OhneRing

        RespawnRules =            AutoSpawn:No    Cost:GALADRIELDAG_COST        Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = GaladrielEdainFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_INFANTRY_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay            = 5000
        SinkRate            = 10.0
        DestructionDelay    = 1800
        Sound                = INITIAL GaladrielVoiceDie
        Weapon                = FINAL RingHeroDeathShockwave
    End

    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Hero
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End



    Behavior = AutoHealBehavior ModuleTag_GaladrielHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1200
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = No
        BonusName        = GaladrielRingablehnenLeadership
        TriggeredBy      = Upgrade_Level_1
        RefreshDelay     = 2000
        Range            = 300

        ObjectFilter     = ANY +INFANTRY +CAVALRY -MACHINE -SHIP -STRUCTURE -BASE_FOUNDATION -HERO ALLIES
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MachtdesgoldenenWaldesEnabler
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        TriggeredBy                = Upgrade_Level_10
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_MachtdesgoldenenWaldesStarter
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MachtdesgoldenenWaldesWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = MachtdesgoldenenWaldesWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_MachtdesgoldenenAutoAbility
        SpecialAbility             = SpecialAbilityMagiedesgoldenenWaldes
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLSpawnMarvelegEnabler
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       TriggeredBy                 = Upgrade_Level_3
       ObeyRechageOnTrigger        = Yes
    End

    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnMarveleg
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       OCL                         = OCL_DerRingNenya
       CreateLocation              = CREATE_AT_LOCATION
       StartsPaused                = Yes
       SetModelCondition           = ModelConditionState:USER_2
       SetModelConditionTime       = 2.1
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnMarvelegUpdate
        SpecialPowerTemplate       = SpecialAbilityDerRingNenya
        UnpackTime                 = 1
        PreparationTime            = 3
        PackTime                   = 2096
        AwardXPForTriggering       = 0
        FreezeAfterTriggerDuration = 0
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ErinnerungEnabler
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        TriggeredBy                = Upgrade_Level_5
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_ErinnerungStarter
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ErinnerungWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityErinnerunganTelperion
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = ErinnerunganTelperionWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_ErinnerungAutoAbility
        SpecialAbility             = SpecialAbilityErinnerunganTelperion
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LichtEarendilsEnabler
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        TriggeredBy             = Upgrade_Level_7
    End

      Behavior = SpecialPowerModule ModuleTag_LichtEarendilsStarter
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        StartsPaused            = Yes
    End

    Behavior = HeroModeSpecialAbilityUpdate ModuleTag_LichtEarendilsUpdate
        SpecialPowerTemplate    = SpecialAbilityGaladrielLichtEarendils
        HeroAttributeModifier   = GaladrielLichtEarendils
        HeroEffectDuration      = 30000
        UnpackTime              = 1
        TriggerSound            = AragornBladeMaster
    End







    Behavior = AttributeModifierUpgrade ModuleTag_RingBonus
        TriggeredBy         = Upgrade_GaladrielRingablehnen
        AttributeModifier   = GaladrielRingAblehnen
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
        UpgradeRequired      = Upgrade_GaladrielRingablehnen
        EffectRadius         = 150
        PingDelay            = 2000
        HealPercentPerSecond = 3%
        AllowFilter          = ANY +INFANTRY +CAVALRY +HERO -MACHINE +MONSTER -IMMOBILE +DOZER
        NonStackable         = Yes
        HealFX               = FX_SpellHealUnitHealBuff
    End





    Behavior = DoCommandUpgrade Module_DoCommandUpgradeRingablehnen
        TriggeredBy                  = Upgrade_GaladrielRingablehnen
        GetUpgradeCommandButtonName  = Command_SpecialAbilityFakeUpdateGaladrielRingAnnehmenFX
    End

    Behavior = SpecialPowerModule ModuleTag_ChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = GaladrielRingablehnenFX
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +HERO
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

	Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP        = Yes
	End

    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate FarsightAI
        CommandButtonName = Command_SpecialAbilityGaladrielFarsight
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornAthelas
        CommandButtonName = Command_SpecialAbilityWordNenya
        SpecialPowerAIType = AI_SPECIAL_POWER_SELFAOEHEALHEROS
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_SpecialAbilityGaladrielWordOfPower
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Scale = 0.95
    Geometry            = CYLINDER
    GeometryMajorRadius    = 8.0
    GeometryHeight        = 19.2
    GeometryIsSmall        = Yes

    Shadow                = SHADOW_DECAL
    ShadowSizeX            = 12
    ShadowSizeY            = 12
    ShadowTexture        = ShadowI
End

Object LothlorienGaladrielNachRing

    SelectPortrait = HPGaladrielMod
    ButtonImage    = HIGaladrielne

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

      StaticModelLODMode   = Yes
      OkToChangeModelColor = Yes

        DefaultModelConditionState
            Model               = EUGaldrlGd_SKN
        End

        ModelConditionState = USER_1
            Model           = EUGaldrl_SKN
            ParticleSysBone = B_PELVIS GaladAura FollowBone:Yes
            ParticleSysBone = B_PELVIS GaladAura02 FollowBone:Yes
        End

        ModelConditionState ONE_RING
            Model           = EUGaldrl_SKN
            ParticleSysBone = B_PELVIS GaladAura FollowBone:Yes
            ParticleSysBone = B_PELVIS GaladAura02 FollowBone:Yes

        End

        ModelConditionState ONE_RING USER_1
            Model           = EUGaldrl_SKN
            ParticleSysBone = B_PELVIS GaladAura FollowBone:Yes
            ParticleSysBone = B_PELVIS GaladAura02 FollowBone:Yes

        End


        AnimationState            = USER_1
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End


            Flags           = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState            = USER_2
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            ParticleSysBone = B_HEAD VergesseneWorterWave
        End


        AnimationState                = USER_3
             StateName                = Attacking
             Animation                = EUGldrl_SPCB
             AnimationName            = EUGldrl_SKL.EUGldrl_SPCB
             AnimationMode            = ONCE
          End
            ParticleSysBone = NONE GaladrielBlastInitialCenter
            ParticleSysBone = NONE GaladrielBlastInitialVortex
            ParticleSysBone = NONE GaladrielBlastInitialWave
        End



        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLB
                AnimationMode        = ONCE
                AnimationPriority   = 15
            End
            Animation                = IDLC
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLC
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            Animation                = IDLD
                AnimationName        = EUGaldrl_SKL.EUGaldrl_IDLD
                AnimationMode        = ONCE
                AnimationPriority   = 1
            End
            StateName                = Idle
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_FLYA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = DYING SPLATTED
            Animation           = EUGaldrl_LNDA
                AnimationName     = RUEwnHrHrs_SKL.RUEwnHrHrs_LNDA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = EUGaldrl_SKL.EUGaldrl_FLYA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = EUGaldrl_DTHA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_DTHA
                AnimationMode     = ONCE
            End

            ParticleSysBone = NONE UltraInitial01
            ParticleSysBone = NONE UltraInitial02
            ParticleSysBone = NONE UltraInitial03
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation           = EUGaldrl_GTPA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = EUGaldrl_LNDA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = MOVING WANDER WEAPONSTATE_CLOSE_RANGE
            StateName           = WithSword
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End
        AnimationState        = MOVING WANDER
            Animation           = EUGaldrl_WLKA
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNB
                AnimationMode     = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState            = USER_4
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCA
                AnimationMode    = ONCE
            End
            FXEvent                = Frame:5 Name:FX_GaladrielEdainTerribleFuryFearBlast
        End

        AnimationState        = MOVING
            Flags               = RANDOMSTART
            Animation           = EUGaldrl_RUNB
                AnimationName     = EUGaldrl_SKL.EUGaldrl_RUNA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = FIRING_OR_PREATTACK_A WEAPONSTATE_CLOSE_RANGE ONE_RING
            StateName                = WithSword
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
            Animation                = ATKB
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = FIRING_OR_PREATTACK_A
            Animation                = ATKA
                AnimationName        = EUGaldrl_SKL.EUGaldrl_LVLA
                AnimationMode        = ONCE
                UseWeaponTiming        = Yes
            End
        End

        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGaldrl_SKL.EUGaldrl_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName     = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode     = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGaldrl_SKL.EUGaldrl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState = LEVELED
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_TNTA
                AnimationMode = ONCE
            End
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = EUGaldrl_SKL.EUGaldrl_HITA
                AnimationMode = ONCE
            End
        End





        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
        End




        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Sword
            Animation                    = Sword
                AnimationName            = EUGaldrl_SKL.EUGaldrl_CHRA
                AnimationMode            = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End



        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    EUGaldrl_SKL.EUGaldrl_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState            = SPECIAL_WEAPON_THREE
            Animation
                AnimationName    = EUGaldrl_SKL.EUGaldrl_SPCB
                AnimationMode    = ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw ModuleTag_ShieldBubble
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = WEAPONSET_HERO_MODE
            Model = exhealingm
            ParticleSysBone = NONE GaladrielEdainFearBlast FollowBone:Yes
        End
    End



    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = GALADRIEL_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    MaxSimultaneousOfType    = 1
    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO
    DisplayMeleeDamage = GALADRIELDAG_DAMAGE
    CrushableLevel = 4

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    GaladrielAttack
        Weapon            = SECONDARY  GaladrielAttackStructure
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst       = SECONDARY   STRUCTURE
    End

    ArmorSet
        Conditions      = None
        Armor           = SilmarilHeroHeavyArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 250
    ShroudClearingRange = 400
    BountyValue = ELVEN_GALADRIEL_BOUNTY_VALUE
    RecruitText                     = CONTROLBAR:GaladrielRecruit
    ReviveText                    = CONTROLBAR:GaladrielRevive
    Hotkey                        = CONTROLBAR:GaladrielHotkey
    DisplayName = OBJECT:ElvenGaladriel

    CrusherLevel        = 0
    CommandSet = LothlorienGaladrielCommandSet_NurnochRing
    CommandPoints = 0




    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_ElrondBody

    AutoResolveArmor
        Armor = AutoResolve_ElrondArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_ElrondWeapon
    End

    AutoResolveLeadership = AutoResolve_ElrondBonus





    VoiceAttack                                 = GaladrielModVoiceAttack
    VoiceAttackAir                                = GaladrielModVoiceAttack
    VoiceAttackCharge                             = GaladrielModVoiceAttack
    VoiceAttackMachine                             = GaladrielModVoiceAttack
    VoiceAttackStructure                         = GaladrielModVoiceAttack
    VoiceCreated                                = GaladrielModVoiceSalute
    VoiceFullyCreated                             = GaladrielModVoiceSalute
    VoiceFear                                    = GaladrielModVoiceHelpMe
    VoiceGuard                                    = GaladrielModVoiceMove
    VoiceMove                                     = GaladrielModVoiceMove
    VoiceMoveToCamp                             = GaladrielModVoiceMove
    VoicePriority                                = 95
    VoiceSelect                                 = GaladrielModVoiceSelect
    VoiceSelectBattle                              = GaladrielModVoiceSelect

    SoundImpact                                 = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip        = GaladrielModVoiceMove
        VoiceGarrison                            = GaladrielModVoiceMove
        VoiceInitiateCaptureBuilding            = GaladrielModVoiceMove
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_LNDA    Frames:6
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:EUGALDRL_SKL.EUGALDRL_DTHA    Frames:15
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner = GaladrielDie



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO HEAVY_MELEE_HITTER SCARY ATTACK_NEEDS_LINE_OF_SIGHT ARMY_SUMMARY
    BuildCost = GALADRIELDAG_COST
    BuildTime = SILMARIL_HERO_BUILDTIME
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM

    Body = RespawnBody ModuleTag_RespawnBody
        MaxHealth                 = GALADRIELDAG_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 6500
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HIGaladrielne
        RespawnAsTemplate             = LothlorienGaladriel

        RespawnRules =            AutoSpawn:No    Cost:GALADRIELDAG_COST       Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End


    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AILuaEventsList            = GaladrielEdainFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_INFANTRY_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes            = ALL
        SinkDelay            = 5000
        SinkRate            = 10.0
        DestructionDelay    = 1800
        Sound                = INITIAL GaladrielVoiceDie
        Weapon                = FINAL RingHeroDeathShockwave
    End

    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Hero
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End


    Behavior = AutoHealBehavior ModuleTag_GaladrielHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1200
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate    = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FarsightUnpause
        SpecialPowerTemplate    = SpecialAbilityElrondFarsight
        TriggeredBy             = Upgrade_Level_1
        ObeyRechageOnTrigger    = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_FarsightOCL
        StartsPaused            = Yes
        SpecialPowerTemplate    = SpecialAbilityElrondFarsight
        OCL                     = OCL_SpecialPowerFarSeeing
        CreateLocation          = CREATE_AT_LOCATION
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive     = No
        BonusName        = GaladrielHerrindesGoldenenWaldes
        TriggeredBy      = Upgrade_Level_3
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = ANY +INFANTRY +CAVALRY -MACHINE -SHIP -STRUCTURE -BASE_FOUNDATION -HERO ALLIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HardenEnabler
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        TriggeredBy                  = Upgrade_Level_7
        ObeyRechageOnTrigger         = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_HardenStarter
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        StartsPaused                 = Yes
        UpdateModuleStartsAttack     = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_HardenWeaponFireUpdate
        SpecialPowerTemplate         = SpecialAbilityBlickderweiﬂenFrau
        WhichSpecialWeapon           = 3
        MustFinishAbility        	 = Yes	
        FreezeAfterTriggerDuration   = 100
        UnpackTime                   = 700
        PreparationTime              = 1
        PackTime                     = 100
        AwardXPForTriggering         = 0
        StartAbilityRange            = 270
        SpecialWeapon                = BlickderweiﬂenFrauWeapon
        TriggerSound                 = LorienEffeckts2
		ChainedButton            	 = "Command_SpecialAbilityGaladrielStorm"
	End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LightningEnabler
        SpecialPowerTemplate        = SpecialAbilityGaladrielStorm
        TriggeredBy                 = Upgrade_ThorinOrkrist
    End

    Behavior = SpecialPowerModule ModuleTag_LightningStrike
        SpecialPowerTemplate        = SpecialAbilityGaladrielStorm
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = Yes
    End

	Behavior = ArrowStormUpdate ModuleTag_ShootLightningBolts
		SpecialPowerTemplate	= SpecialAbilityGaladrielStorm
        UnpackingVariation      = 3
        CanShootEmptyGround     = Yes
		FreezeAfterTriggerDuration   = 3000
        UnpackTime              = 2500
        PreparationTime         = 1
        PersistentPrepTime      = 500
        PackTime                = 1500
        ApproachRequiresLOS     = No
        AwardXPForTriggering    = 0
        WeaponTemplate  = GaladrielStormWeapon
        TargetRadius    = 70
        ShotsPerTarget  = 1
        ShotsPerBurst   = 3
        MaxShots        = 15
    End	






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MagiedesgoldenenWaldesEnabler
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        TriggeredBy                = Upgrade_Level_10
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_MagiedesgoldenenWaldesStarter
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes

    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_MagiedesgoldenenWaldesWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityMagiedesgoldenenWaldes
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = MagiedesgoldenenWaldesWeapon
    End

    Behavior = AutoAbilityBehavior ModuleTag_MagiedesgoldenenAutoAbility
        SpecialAbility             = SpecialAbilityMagiedesgoldenenWaldes
        MaxScanRange               = 80
        Query                      = 3 ANY +HORDE +MACHINE ENEMIES
        Query                      = 1 ANY +HERO +MONSTER NOT_FLYING_UNITS
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_OCLSpawnMarvelegEnabler
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       TriggeredBy                 = Upgrade_Level_7
       ObeyRechageOnTrigger        = Yes
    End

    Behavior = OCLSpecialPower  ModuleTag_OCLSpawnMarveleg
       SpecialPowerTemplate        = SpecialAbilityDerRingNenya
       OCL                         = OCL_DerRingNenya
       CreateLocation              = CREATE_AT_LOCATION
       StartsPaused                = Yes
       SetModelCondition           = ModelConditionState:USER_2
       SetModelConditionTime       = 2.1
    End

    Behavior = SpecialAbilityUpdate ModuleTag_OCLSpawnMarvelegUpdate
        SpecialPowerTemplate       = SpecialAbilityDerRingNenya
        UnpackTime                 = 1
        PreparationTime            = 3
        PackTime                   = 2096
        AwardXPForTriggering       = 0
        FreezeAfterTriggerDuration = 0
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        TriggeredBy                = Upgrade_Level_10
    End

    Behavior = SpecialPowerModule ModuleTag_WordStarter
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        SetModelCondition          = ModelConditionState:USER_1
        SetModelConditionTime      = 9.0
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityGaladrielWordOfPower
        WhichSpecialWeapon         = 2
        SkipContinue               = Yes
        UnpackTime                 = 3000
        PackTime                   = 1
        FreezeAfterTriggerDuration = 4000
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = GaladrielFXWDM
    End

    Behavior = AutoAbilityBehavior ModuleTag_WoPAutoAbility
	SpecialAbility		= SpecialAbilityGaladrielWordOfPower
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
	Query			= 40 ALL ENEMIES
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList             = OCL_TheOneRing
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP        = Yes
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate FarsightAI
        CommandButtonName = Command_SpecialAbilityGaladrielFarsight
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornAthelas
        CommandButtonName = Command_SpecialAbilityWordNenya
        SpecialPowerAIType = AI_SPECIAL_POWER_SELFAOEHEALHEROS
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate GandalfWordOfPowerAI
        CommandButtonName = Command_SpecialAbilityGaladrielWordOfPower
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Scale 		= 0.95
    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 19.2
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 12
    ShadowSizeY         = 12
    ShadowTexture       = ShadowI
End

