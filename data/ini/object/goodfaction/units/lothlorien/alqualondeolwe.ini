Object AlqualondOlwe

    SelectPortrait = HPAlqualondOlwe
    ButtonImage    = HIAlqualondOlwe

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                    = euolwe
            Skeleton                 = EUHaldir_SKL
            WeaponLaunchBone         = PRIMARY ARROW
        End

        ModelConditionState = USER_8
            Model                    = euolwe
            Skeleton                 = EUHaldir_SKL
            WeaponLaunchBone         = PRIMARY ARROW
            ParticleSysBone          = B_SWORDBONE ElrondWaterKlingenFX FollowBone:Yes
        End

        ModelConditionState = USER_6
            Model                    = euolwe
            Skeleton                 = EUHaldir_SKL
            WeaponLaunchBone         = PRIMARY ARROW
            ParticleSysBone          = BAT_HEAD GandalfWhiteGlow FollowBone:Yes
            Shadow                   = SHADOW_ADDITIVE_DECAL
            ShadowSizeX              = 200
            ShadowSizeY              = 200
            ShadowTexture            = EXGandalfGlow
        End



        AnimationState                        = PASSENGER USER_6
            StateName                        = STATE_Grabbed
            Animation                        = Bow
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
            End
        End
        AnimationState                        = PASSENGER
            StateName                        = STATE_Grabbed
            Animation                        = Sword
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
            End
        End


        AnimationState                        = FREEFALL USER_6
            StateName                        = STATE_Falling
            Animation                        = Bow
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End
        AnimationState                        = FREEFALL
            StateName                        = STATE_Falling
            Animation                        = Sword
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
                AnimationBlendTime            = 10
                AnimationSpeedFactorRange    = 0.24 0.24
            End
        End


        AnimationState                        = STUNNED_FLAILING USER_6
            StateName                        = STATE_Fly
            Animation
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES2
        End
        AnimationState                        = STUNNED_FLAILING
            StateName                        = STATE_Fly
            Animation                        = Sword
                AnimationName                = EUHaldir_FLYB
                AnimationMode                = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES2
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                elseif PrevState == "STATE_Fly"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End


        AnimationState                        = DYING DEATH_1 SPLATTED USER_6
            StateName                        = STATE_Dead
            Animation                        = Bow
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = DYING DEATH_1 SPLATTED
            StateName                        = STATE_Dead
            Animation                        = Sword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
        End


        AnimationState                        = DYING DEATH_1 USER_6
            Animation                        = Bow1
                AnimationName                = EUHaldir_DIESv5
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_DIESv5
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    CurDrawableHideSubObject("ArrowNock")
                    CurDrawableHideSubObject("arrow")
                    return "WantBow"
                end
                if GetClientRandomNumberReal(0,2) < 1
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow1"
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow2"
                end
            EndScript
        End
        AnimationState                        = DYING DEATH_1
            Animation                        = Sword1
                AnimationName                = EUHaldir_DIESv5
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_DIESV5
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                end
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if GetClientRandomNumberReal(0,2) < 1
                then
                    return "Sword1"
                else
                    return "Sword2"
                end
            EndScript
        End


        AnimationState                        = DYING DEATH_2 USER_6
            Animation                        = FadeOut
                AnimationName                = EUHaldir_DIEBV5
                AnimationMode                = ONCE
            End
        End
        AnimationState                        = DYING DEATH_2
            Animation                        = FadeOut
                AnimationName                = EUHaldir_DIESV5
                AnimationMode                = LOOP
            End
        End


        AnimationState                        = STUNNED_STANDING_UP USER_6
            StateName                        = STATE_GetUp
            Animation                        = Sword
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.2    1.2
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End
        AnimationState                        = STUNNED_STANDING_UP
            StateName                        = STATE_GetUp
            Animation                        = Sword
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.2    1.2
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End


        AnimationState                        = STUNNED USER_6
            StateName                        = STATE_Land
            Animation                        = Bow
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES3
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                end
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                return "Bow"
            EndScript
        End
        AnimationState                        = STUNNED
            StateName                        = STATE_Land
            Animation                        = Sword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantSword" or PrevAnim == "Bow"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                Flags                        = MAINTAIN_FRAME_ACROSS_STATES3
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = LOOP
            End
        End

        AnimationState        = PACKING_TYPE_1
            StateName         = Charge
            Animation
            AnimationName         = EUHaldir_CHRS
            AnimationMode         = Once
                  AnimationBlendTime   = 5
          End
          FXEvent             = Frame:14 Name:FX_OlweCharge
        End

        AnimationState        = PACKING_TYPE_1 USER_6
            StateName         = Charge
            Animation
            AnimationName         = EUHaldir_CHRS
            AnimationMode         = Once
                  AnimationBlendTime   = 5
          End
          FXEvent             = Frame:14 Name:FX_OlweCharge
        End


        AnimationState                        = FIRING_OR_PREATTACK_A USER_6
            StateName                        = Attacking_Bow
            Animation
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
                AnimationBlendTime            = 20
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            StateName                        = Ready_Sword

            Animation                        = AttackWithSwordA
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordB
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordD
                AnimationName                = EUHaldir_ATKSV4
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                        = SPECIAL_WEAPON_ONE
            Animation
                AnimationName                = EUHaldir_SPCA
                AnimationMode                = ONCE
            End
            FrameForPristineBonePositions    = 60
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
            EndScript
        End


        AnimationState                        = MOVING USER_6
            StateName                        = Moving_Bow
            Animation
                AnimationName                = EUHaldir_RUNS
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Moving") end
            EndScript
        End
        AnimationState                        = MOVING
            StateName                        = Moving_Sword
            Animation
                AnimationName                = EUHaldir_RUNS
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Moving") end
            EndScript
        End


        AnimationState                        = PREATTACK_A USER_6
            Animation                        = ReadyToDrawn
                AnimationName                = EUHaldir_ATA1
                AnimationMode                = ONCE
                AnimationBlendTime            = 0
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                        = FIRING_OR_RELOADING_A USER_6
            StateName                        = STATE_Firing
            Animation
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = ONCE
                AnimationBlendTime            = 30
                UseWeaponTiming                = Yes
                AnimationSpeedFactorRange    = 1.5 1.5
            End
            Flags                            = START_FRAME_FIRST
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("ArrowNock")
            EndScript
        End


        AnimationState                        = MOVING BACKING_UP WEAPONSET_CREATE_A_HERO_WS_01
            StateName                        = STATE_BackingUp
            Animation                        = Bow
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        return "WantBow"
                    end
                end
                return "Bow"
            EndScript
        End
        AnimationState                        = MOVING BACKING_UP
            StateName                        = STATE_BackingUp
            Animation                        = Sword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        return "WantSword"
                    end
                end
                return "Sword"
            EndScript
        End


        AnimationState                        = CONTINUOUS_FIRE_MEAN
            Animation                        = HangFrameWhileCoasting
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = MANUAL
                AnimationBlendTime            = 20
            End
            Flags                            = START_FRAME_LAST
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
                if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
            EndScript
        End

        AnimationState                        = CONTINUOUS_FIRE_SLOW
            StateName                        = Ready_Bow
            Animation                        = PutAwayArrow
                AnimationName                = EUHaldir_ATA3
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
            EndScript
        End


        AnimationState                        = ATTACKING USER_6
            StateName                        = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BR_Bow") end
                if Prev == "Selected_Bow" then CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow") end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                        = ATTACKING
            StateName                        = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword" then CurDrawableSetTransitionAnimState("TRANS_BR_Sword") end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End


        AnimationState                        = ENGAGED USER_6
            StateName                        = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                        = ENGAGED
            StateName                        = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End


        AnimationState                        = EMOTION_ALERT USER_6
            StateName                        = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow") end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow") end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                        = EMOTION_ALERT
            StateName                        = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword" then CurDrawableSetTransitionAnimState("TRANS_BR_Sword") end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End


        AnimationState                        = EMOTION_CELEBRATING USER_6
            StateName                        = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow")
                end
            EndScript
        End
        AnimationState                        = EMOTION_CELEBRATING
            StateName                        = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End



        AnimationState                        = EMOTION_TAUNTING USER_6
            StateName                        = STATE_Emotion_Bow
            Animation                        = Bow1
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End
        AnimationState                        = EMOTION_TAUNTING
            StateName                        = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                    then
                        CurDrawableAllowToContinue()
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End


        AnimationState                        = EMOTION_POINTING USER_6
            StateName                        = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SelectedToReady_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End
        AnimationState                        = EMOTION_POINTING
            StateName                        = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End


        AnimationState                         = HIT_REACTION HIT_LEVEL_1 USER_6
            StateName                        = Bored_Bow
            Animation
                AnimationName                = EUHaldir_HITE
                AnimationMode                 = ONCE
                AnimationSpeedFactorRange    = .9 .9
            End
        End
        AnimationState                        = HIT_REACTION HIT_LEVEL_1
            StateName                        = Bored_Sword
            Animation
                AnimationName                = EUHaldir_HITE
                AnimationMode                = ONCE
            End
        End

        AnimationState                        = RAISING_FLAG USER_6
            StateName                        = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = SELECTED USER_6
            StateName                        = Selected_Bow
            Animation                        = ATNE
                AnimationName                = EUHaldir_ATNS
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelected_Bow") end
                if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow") end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End

        AnimationState                        = RAISING_FLAG
            StateName                        = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                        = SELECTED
            StateName                        = Selected_Sword
            Animation                        = ATNA
                AnimationName                = EUHaldir_ATNS
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Sword" then CurDrawableSetTransitionAnimState("TRANS_BoredToSelected_Sword") end
                if Prev == "Ready_Sword" then CurDrawableSetTransitionAnimState("TRANS_ReadyToSelected_Sword") end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword" or PrevAnim == "EUHaldir_STHB"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End


        IdleAnimationState
            StateName                        = Bored_Sword
            Animation                        = Idle_Sword1
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword3
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 0
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SelectedToBored_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
                if Prev == "Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBored_Sword") end
                if Prev == "Ready_Sword" then CurDrawableSetTransitionAnimState("TRANS_RB_Sword") end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End


        AnimationState                        = USER_6
            StateName                        = Bored_Sword
            Animation                        = Idle_Sword1
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword3
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 0
            End
            Flags                            = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SelectedToBored_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
                if Prev == "Selected_Sword" then CurDrawableSetTransitionAnimState("TRANS_SelectedToBored_Sword") end
                if Prev == "Ready_Sword" then CurDrawableSetTransitionAnimState("TRANS_RB_Sword") end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End




        TransitionState                        = TRANS_BoredToSelected_Bow
            Animation
                AnimationName                = EUHaldir_ATNB
                AnimationMode                = ONCE
                AnimationBlendTime            = 10
            End
        End


        TransitionState                        = TRANS_SelectedToReady_Bow
            Animation                        = ATNE
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = ONCE
                AnimationBlendTime            = 10
            End
        End


        TransitionState                        = TRANS_SelectedToBored_Bow
            Animation
                AnimationName                = EUHaldir_ATNB
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_LAST
        End


        TransitionState                        = TRANS_RS_Bow
            Animation                        = ATNF
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = ONCE_BACKWARDS
                AnimationBlendTime            = 10
            End
            Flags                            = START_FRAME_LAST
        End


        TransitionState                        = TRANS_BR_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = ONCE
                AnimationBlendTime            = 20
            End
        End


        TransitionState                        = TRANS_RB_Bow
            Animation                        = IDLD
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = ONCE
                AnimationBlendTime            = 20
            End
        End


        TransitionState                    = TRANS_BoredToSelected_Sword
            Animation                    = ATNA
                AnimationName            = EUHaldir_ATNA
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_SR_Sword
            Animation                    = ATNC
                AnimationName            = EUHaldir_IDLF
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_SelectedToBored_Sword
            Animation                    = ATNA
                AnimationName            = EUHaldir_ATNA
                AnimationMode            = ONCE_BACKWARDS
            End
            Flags                        = START_FRAME_LAST
        End


        TransitionState                    = TRANS_ReadyToSelected_Sword
            Animation                    = ATNC
                AnimationName            = EUHaldir_IDLST1
                AnimationMode            = ONCE_BACKWARDS
                AnimationBlendTime        = 20
            End
            Flags                        = START_FRAME_LAST
        End


        TransitionState                    = TRANS_BR_Sword
            Animation                    = ATNS
                AnimationName            = EUHaldir_ATNS
                AnimationMode            = ONCE
                AnimationBlendTime        = 20
            End
        End


        TransitionState                    = TRANS_RB_Sword
            Animation                    = IDLG
                AnimationName            = EUHaldir_ATNS
                AnimationMode            = ONCE
                AnimationBlendTime        = 20
            End
        End



        TransitionState                    = TRANS_SwordToBow_Moving
            Animation                    = DrawBow
                AnimationName            = EUHaldir_RUNS
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_BowToSword_Moving
            Animation                    = DrawSword
                AnimationName            = EUHaldir_RUNS
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_BowToSword_Ready
            Animation                    = DrawSwords
                AnimationName            = EUHaldir_RUNS
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_SwordToBow_Ready
            Animation                    = DrawBow
                AnimationName            = EUHaldir_ATNS
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_BowToSword_Selected
            Animation                    = DrawSwords
                AnimationName            = EUHaldir_ATNS
                AnimationMode            = ONCE
            End
        End


        TransitionState                    = TRANS_SwordToBow_Selected
            Animation                    = DrawBow
                AnimationName            = EUHaldir_ATNS
                AnimationMode            = ONCE
            End
        End

   End



    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Lothlorien
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    BuildCost                         = MEDIUM_FIRST_AGE_HERO_COST
    BuildTime                         = MEDIUM_FIRST_AGE_HERO_BUILDTIME
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 350
    MaxSimultaneousOfType             = 1
    DisplayMeleeDamage                = MEDIUM_FIRST_AGE_HERO_DAMAGE
    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:AlqualondOlwe
    RecruitText                       = CONTROLBAR:AlqualondOlweRecruit
    ReviveText                        = CONTROLBAR:AlqualondOlweRevive
    Hotkey                            = CONTROLBAR:AlqualondOlweHotkey
    CrushableLevel               = 2

    CommandSet                        = AlqualondOlweCommandSet
    CommandPoints                     = 0



    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY OlweSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                  = WEAPONSET_CREATE_A_HERO_WS_01
        Weapon                          = PRIMARY OlweUlmoWeapon
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = WEAPONSET_CREATE_A_HERO_WS_02
        Weapon                        = PRIMARY OlweWaterSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End

    ArmorSet
        Conditions                    = MOUNTED
        Armor                         = FirstAgeMediumHeroArmorMounted
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                         = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_GlorfindelWeapon
    End





    VoiceCreated                         = OlweVoiceSalute
    VoiceFullyCreated                    = OlweVoiceSalute
    VoiceAttack                          = OlweVoiceAttack
    VoiceAttackAir                       = OlweVoiceAttack
    VoiceAttackCharge                    = OlweVoiceAttack
    VoiceAttackMachine                   = OlweVoiceAttack
    VoiceAttackStructure                 = OlweVoiceAttack
    VoiceFear                            = OlweVoiceHelpMe
    VoiceGuard                           = OlweVoiceMove
    VoiceMove                            = OlweVoiceMove
    VoiceMoveToCamp                      = OlweVoiceMove
    VoiceMoveWhileAttacking              = OlweVoiceMove
    VoicePriority                        = 90
    VoiceRetreatToCastle                 = OlweVoiceRetreat
    VoiceSelect                          = OlweVoiceSelect
    VoiceSelectBattle                    = OlweVoiceSelect

    SoundImpact                          = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip = OlweVoiceMove
        VoiceGarrison                    = OlweVoiceMove
        VoiceInitiateCaptureBuilding     = OlweVoiceMove
    End

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key    = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
    MaxUpdateRangeCap = 800
        AnimationSound = Sound:ArrowDrawBow                        Animation:EUHaldir_SKL.EUHaldir_ATA1    Frames:6
        AnimationSound = Sound:ArrowDrawBow                        Animation:EUHaldir_SKL.EUHaldir_ATA2    Frames:18
        AnimationSound = Sound:SwordShingClean1                    Animation:EUHaldir_SKL.EUHaldir_STHA     Frames:24
        AnimationSound = Sound:SwordIntoScabbard1                  Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:9
        AnimationSound = Sound:WeaponSwitchBow                     Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:15
        AnimationSound = Sound:SwordShingClean1                 Animation:EUHaldir_SKL.EUHaldir_STHC     Frames:20
        AnimationSound = Sound:SwordIntoScabbard1               Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:5
        AnimationSound = Sound:WeaponSwitchBow                  Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:8
        AnimationSound = Sound:SwordShingClean1                 Animation:EUHaldir_SKL.EUHaldir_RUNC     Frames:14
        AnimationSound = Sound:SwordIntoScabbard1               Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:4
        AnimationSound = Sound:WeaponSwitchBow                  Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:16
        AnimationSound = Sound:BodyFallSoldier                  Animation:EUHaldir_SKL.EUHaldir_LNDA    Frames:9
        AnimationSound = Sound:BodyFallSoldier                  Animation:EUHaldir_SKL.EUHaldir_LNDB    Frames:1
        AnimationSound = Sound:BodyFallGenericNoArmor           Animation:EUHaldir_SKL.EUHaldir_DIEB     Frames:82
        AnimationSound = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_DIEBV5     Frames:25
        AnimationSound = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_DIESV4     Frames:26
        AnimationSound = Sound:BodyFallGenericNoArmor          Animation:EUHaldir_SKL.EUHaldir_DIESV5    Frames:100
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    TauntAndPointDistance        = 300
    TauntAndPointUpdateDelay    = 10000
    AddEmotion            = Doom_Base
    AddEmotion            = Point_Base
    AddEmotion            = Taunt_Base
     AddEmotion            = CheerIdle_Base
    AddEmotion            = CheerBusy_Base
    AddEmotion            = Alert_Base
    AddEmotion            = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                   = EMOTION_CHEER_RADIUS
        MaxHealth                     = MEDIUM_FIRST_AGE_HERO_HEALTH
        PermanentlyKilledByFilter     = NONE
        DodgePercent                  = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 3000
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HIAlqualondOlwe_Wotr

        RespawnRules =    AutoSpawn:No           Cost:MEDIUM_FIRST_AGE_HERO_COST       Time:MEDIUM_FIRST_AGE_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        AILuaEventsList              = OlweFunctions
        MoodAttackCheckRate          = 500
        HoldGroundCloseRangeDistance = 41
        CanAttackWhileContained      = Yes
    End

    Behavior = AutoHealBehavior ModuleTag_LegolasHealing
        StartsActive                  = Yes
        HealingAmount                 = HERO_HEAL_AMOUNT
        HealingDelay                  = 1000
        StartHealingDelay             = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat         = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = HeroOlwe
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        AILuaEventsList              = OlweFunctions
        MoodAttackCheckRate          = 500
        HoldGroundCloseRangeDistance = 41
        CanAttackWhileContained      = Yes
    End

    Behavior = WeaponSetUpgrade Create_A_Hero_Weapon1
        TriggeredBy               = Upgrade_TestBuilding
        WeaponCondition           = WEAPONSET_CREATE_A_HERO_WS_01
    End

    Behavior = WeaponSetUpgrade Create_A_Hero_Weapon2
        TriggeredBy               = Upgrade_TestBuilding_2
        WeaponCondition           = WEAPONSET_CREATE_A_HERO_WS_02
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = 55
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
        ShockStandingTime         = 2000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes              = ALL
        SinkDelay             = 3000
        SinkRate             = 0.5
        DestructionDelay         = 15000
        Sound                  = INITIAL MablungVoiceDie
        DeathFlags             = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1           = 1500
        HitReactionThreshold1           = 400

        FastHitsResetReaction           = Yes
    End








    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive                       = No
        BonusName                          = OlweKingofAlqualonde
        TriggeredBy                        = Upgrade_Level_1
        RefreshDelay                       = 2000
        Range                              = 200
        AntiCategory                       = BUFF
        ObjectFilter                       = LORIEN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY -STRUCTURE -BASE_FOUNDATION -HERO +CAVALRY -DOZER
    End





    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         MountedTemplate                = AlqualondOlweMount
         SynchronizeTimerOnSpecialPower = SpecialAbilityEonweWrathofValinor SpecialAbilityOlweFlooding
         UnpackTime                     = GOOD_MOUNT_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WachpostenerrichtenEnabler
        SpecialPowerTemplate            = SpecialAbilityOlweFlooding
        TriggeredBy                     = Upgrade_Level_5
        ObeyRechageOnTrigger            = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_WachpostenerrichtenSpecialPower
        SpecialPowerTemplate         = SpecialAbilityOlweFlooding
        OCL                          = OCL_OlweFloodingDecrease
        CreateLocation                  = CREATE_AT_LOCATION
        StartsPaused                    = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MagicShield
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        TriggeredBy                     = Upgrade_Level_8
    End

    Behavior = SpecialPowerModule ModuleTag_MagicShieldUpdate
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack        = No
        StartsPaused                    = No
    End

    Behavior = CostModifierUpgrade ModuleTag_CostModifier
        TriggeredBy                    = Upgrade_Level_8
        ObjectFilter                   = ANY +HERO
        Percentage                     = -20%
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMMagicShield
        TriggeredBy                      = Upgrade_Level_8
        AttributeModifier                = OlweMagicShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate            = SpecialAbilityEonweWrathofValinor
        TriggeredBy                     = Upgrade_Level_10
        ObeyRechageOnTrigger            = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate            = SpecialAbilityEonweWrathofValinor
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
        AttributeModifier               = OlweUlmuriHorn
        AttributeModifierRange          = 300
        AttributeModifierAffectsSelf    = Yes
        AttributeModifierAffects        = ANY +INFANTRY +CAVALRY -HERO
        AttributeModifierFX             = FX_TheodenGloriousChargeFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
       SpecialPowerTemplate             = SpecialAbilityEonweWrathofValinor
        UnpackTime                      = 1500
        UnpackingVariation              = 1
        PreparationTime                 = 0
        PersistentPrepTime              = 0
        PackTime                        = 2096
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_OlweSetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_OlweSetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_OlweSetStanceGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMounted_AI
        CommandButtonName  = Command_OlweMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate Flooding_AI
        CommandButtonName  = Command_OlweFlooding
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_STRUCTURES
        SpecialPowerRange  = 200
   End

    Behavior = AISpecialPowerUpdate UlmuriHorn_AI
        CommandButtonName  = Command_OlweUlmuriHorn
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Scale                = 1.01
    Geometry             = CYLINDER
    GeometryMajorRadius  = 8.0
    GeometryHeight       = 19.2
    GeometryIsSmall      = Yes
    Shadow               = SHADOW_DECAL
    ShadowSizeX          = 19
    ShadowSizeY          = 19
    ShadowTexture        = ShadowI
End


Object AlqualondOlweMount







    SelectPortrait = HPAlqualondOlwe
    ButtonImage    = HIAlqualondOlwe

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero

    EquivalentTo = AlqualondOlwe



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                    = euolwe_m
            Skeleton                 = RUHHs_Theo_SKL
            WeaponLaunchBone         = PRIMARY PASSENGERBONE
        End

        ModelConditionState = USER_8
            Model                    = euolwe_m
            Skeleton                 = RUHHs_Theo_SKL
            WeaponLaunchBone         = PRIMARY PASSENGERBONE
           ParticleSysBone           = B_SWORDBONE ElrondWaterKlingenFX FollowBone:Yes
        End

        ModelConditionState = USER_6
            Model                    = euolwe_m
            Skeleton                 = RUHHs_Theo_SKL
            WeaponLaunchBone         = PRIMARY PASSENGERBONE
            ParticleSysBone          = BAT_HEAD GandalfWhiteGlow FollowBone:Yes
            Shadow                   = SHADOW_ADDITIVE_DECAL
            ShadowSizeX              = 200
            ShadowSizeY              = 200
            ShadowTexture            = EXGandalfGlow
        End



        AnimationState                = MOUNTED DEBUG
            Animation
                AnimationName       = RUHHs_Theo_IDLA
                AnimationMode       = ONCE
            End
            ParticleSysBone = BAT_HHEAD glowHorseGold FollowBone:Yes
            ParticleSysBone = B_HHIPL glowHorseRearGold FollowBone:Yes
            ParticleSysBone = BAT_SPINE2 glowGold FollowBone:Yes
        End



        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =   USER_6 FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =   USER_6 STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End

        AnimationState                =   USER_6 DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End


        AnimationState                =    DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =   USER_6 DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =   USER_6 STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =   USER_6 STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState                        = USER_6 PARALYZED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = USER_6 MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                =    MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =   USER_6 MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =   USER_6 TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =   USER_6 TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =   USER_6 MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =   USER_6 MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =   USER_6 MOVING ACCELERATE

            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =   USER_6 MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =   USER_6 MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =  USER_6 MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState        = PACKING_TYPE_1
            StateName         = Charge
            Animation
            AnimationName         = RUHHs_Theo_CHRA
            AnimationMode         = Once
                  AnimationBlendTime   = 5
          End
          FXEvent             = Frame:14 Name:FX_OlweCharge_M
        End

        AnimationState        = PACKING_TYPE_1 USER_6
            StateName         = Charge
            Animation
            AnimationName         = RUHHs_Theo_CHRA
            AnimationMode         = Once
                  AnimationBlendTime   = 5
          End
          FXEvent             = Frame:14 Name:FX_OlweCharge_M
        End

        AnimationState        = SPECIAL_WEAPON_THREE
        Animation             = CHRA
            AnimationName     = RUHHs_Theo_SPCA
            AnimationMode     = Once
        End
        Animation             = CHRB
            AnimationName     = RUHHs_Theo_IDLC
            AnimationMode     = Once
        End
            ParticleSysBone   = ROOTTRANSFORM GandalfCrystalSphere FollowBone:Yes
            ParticleSysBone   = ROOTTRANSFORM GandalfBeamGlow2 FollowBone:Yes
        End

        AnimationState        = USER_6 SPECIAL_WEAPON_THREE
        Animation             = CHRA
            AnimationName     = RUHHs_Theo_SPCA
            AnimationMode     = Once
        End
        Animation             = CHRB
            AnimationName     = RUHHs_Theo_IDLC
            AnimationMode     = Once
        End
            ParticleSysBone   = ROOTTRANSFORM GandalfCrystalSphere FollowBone:Yes
            ParticleSysBone   = ROOTTRANSFORM GandalfBeamGlow2 FollowBone:Yes
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    USER_6 FIRING_OR_PREATTACK_A
            Animation                =    AttackAb
                AnimationName        =    RUHHs_Theo_CHRA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                =   USER_6 ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_CHRA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                = USER_6 LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =   USER_6 RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =  USER_6 EMOTION_TAUNTING
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                = USER_6 EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        AnimationState                =   USER_6 SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = USER_6
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        IdleAnimationState
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

   End



    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"







    Side                              = Lothlorien
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    BuildCost                         = MEDIUM_FIRST_AGE_HERO_COST
    BuildTime                         = MEDIUM_FIRST_AGE_HERO_BUILDTIME
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 350
    MaxSimultaneousOfType             = 1
    DisplayMeleeDamage                = MEDIUM_FIRST_AGE_HERO_DAMAGE
    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:AlqualondOlwe
    RecruitText                       = CONTROLBAR:AlqualondOlweRecruit
    ReviveText                        = CONTROLBAR:AlqualondOlweRevive
    Hotkey                            = CONTROLBAR:AlqualondOlweHotkey

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    CrusherLevel                      = 0
    MountedCrusherLevel               = 1
    MountedCrushableLevel             = 2
    CrushWeapon                       = HeroCrush
    CrushKnockback                    = 60
    CrushZFactor                      = 1.0

    CommandSet                        = AlqualondOlweCommandSet
    CommandPoints                     = 0





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY OlweSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = WEAPONSET_CREATE_A_HERO_WS_01
        Weapon                        = PRIMARY OlweUlmoWeapon
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = WEAPONSET_CREATE_A_HERO_WS_02
        Weapon                        = PRIMARY OlweWaterSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeMediumHeroArmor
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                         = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_GlorfindelWeapon
    End





    VoiceAttack                          = OlweVoiceAttack
    VoiceAttackAir                       = OlweVoiceAttack
    VoiceAttackCharge                    = OlweVoiceAttack
    VoiceAttackMachine                   = OlweVoiceAttack
    VoiceAttackStructure                 = OlweVoiceAttack
    VoiceFear                            = OlweVoiceHelpMe
    VoiceGuard                           = OlweVoiceMove
    VoiceMove                            = OlweVoiceMove
    VoiceMoveToCamp                      = OlweVoiceMove
    VoiceMoveWhileAttacking              = OlweVoiceMove
    VoicePriority                        = 90
    VoiceRetreatToCastle                 = OlweVoiceRetreat
    VoiceSelect                          = OlweVoiceSelect
    VoiceSelectBattle                    = OlweVoiceSelect

    SoundImpact                          = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip = OlweVoiceMove
        VoiceGarrison                    = OlweVoiceMove
        VoiceInitiateCaptureBuilding     = OlweVoiceMove
    End

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key    = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
    MaxUpdateRangeCap = 800
           AnimationSound = Sound:HorseMoveFootsteps              Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL  Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps              Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA  Frames:0
        AnimationSound = Sound:HorseMoveFootsteps              Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1  Frames:0
        AnimationSound = Sound:HorseMoveFootsteps              Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1  Frames:0
        AnimationSound = Sound:HorseWhinny                     Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC  Frames:3
        AnimationSound = Sound:HorseDieForHero                 Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA  Frames:0
        AnimationSound = Sound:BodyFallSoldier                 Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA  Frames:1 9
        AnimationSound = Sound:HorseDieForHero                 Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor          Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:4
        AnimationSound = Sound:BodyFallSoldier                 Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:42
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
    TauntAndPointDistance        = 300
    TauntAndPointUpdateDelay    = 10000
    AddEmotion            = Doom_Base
    AddEmotion            = Point_Base
    AddEmotion            = Taunt_Base
     AddEmotion            = CheerIdle_Base
    AddEmotion            = CheerBusy_Base
    AddEmotion            = Alert_Base
    AddEmotion            = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                   = EMOTION_CHEER_RADIUS
        MaxHealth                     = MEDIUM_FIRST_AGE_HERO_HEALTH
        PermanentlyKilledByFilter     = NONE
        DodgePercent                  = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 3000
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HIAlqualondOlwe_Wotr

        RespawnRules =    AutoSpawn:No           Cost:MEDIUM_FIRST_AGE_HERO_COST       Time:MEDIUM_FIRST_AGE_HERO_RESPAWNTIME        Health:100%
   End

    Behavior = AutoHealBehavior ModuleTag_LegolasHealing
        StartsActive                  = Yes
        HealingAmount                 = HERO_HEAL_AMOUNT
        HealingDelay                  = 1000
        StartHealingDelay             = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat         = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = HeroOlwe
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        AILuaEventsList              = OlweFunctions
        MoodAttackCheckRate          = 500
        HoldGroundCloseRangeDistance = 41
        CanAttackWhileContained      = Yes
    End

    Behavior = WeaponSetUpgrade Create_A_Hero_Weapon1
        TriggeredBy               = Upgrade_TestBuilding
        WeaponCondition           = WEAPONSET_CREATE_A_HERO_WS_01
    End

    Behavior = WeaponSetUpgrade Create_A_Hero_Weapon2
        TriggeredBy               = Upgrade_TestBuilding_2
        WeaponCondition           = WEAPONSET_CREATE_A_HERO_WS_02
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_NORMAL
        Speed     = 122
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
        ShockStandingTime         = 2000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes              = ALL
        SinkDelay             = 3000
        SinkRate             = 0.5
        DestructionDelay         = 15000
        Sound                  = INITIAL MablungVoiceDie
        DeathFlags             = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1           = 1500
        HitReactionThreshold1           = 400

        FastHitsResetReaction           = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive                       = No
        BonusName                          = OlweKingofAlqualonde
        TriggeredBy                        = Upgrade_Level_1
        RefreshDelay                       = 2000
        Range                              = 200
        AntiCategory                       = BUFF
        ObjectFilter                       = ANY +INFANTRY -STRUCTURE -BASE_FOUNDATION -HERO +CAVALRY -DOZER
    End





    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         MountedTemplate                = AlqualondOlwe
         SynchronizeTimerOnSpecialPower = SpecialAbilityEonweWrathofValinor SpecialAbilityOlweFlooding
         UnpackTime                     = GOOD_MOUNT_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WachpostenerrichtenEnabler
        SpecialPowerTemplate            = SpecialAbilityOlweFlooding
        TriggeredBy                     = Upgrade_Level_5
        ObeyRechageOnTrigger            = Yes
    End

    Behavior = OCLSpecialPower ModuleTag_WachpostenerrichtenSpecialPower
        SpecialPowerTemplate         = SpecialAbilityOlweFlooding
        OCL                          = OCL_OlweFloodingDecrease
        CreateLocation                  = CREATE_AT_LOCATION
        StartsPaused                    = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MagicShield
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        TriggeredBy                     = Upgrade_Level_8
    End

    Behavior = SpecialPowerModule ModuleTag_MagicShieldUpdate
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack        = No
        StartsPaused                    = No
    End

    Behavior = CostModifierUpgrade ModuleTag_CostModifier
        TriggeredBy                    = Upgrade_Level_8
        ObjectFilter                   = ANY +HERO
        Percentage                     = -20%
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMMagicShield
        TriggeredBy                      = Upgrade_Level_8
        AttributeModifier                = OlweMagicShield
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate            = SpecialAbilityEonweWrathofValinor
        TriggeredBy                     = Upgrade_Level_10
        ObeyRechageOnTrigger            = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate            = SpecialAbilityEonweWrathofValinor
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
        AttributeModifier               = OlweUlmuriHorn
        AttributeModifierRange          = 300
        AttributeModifierAffectsSelf    = Yes
        AttributeModifierAffects        = ANY +INFANTRY +CAVALRY -HERO
        AttributeModifierFX             = FX_TheodenGloriousChargeFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
       SpecialPowerTemplate             = SpecialAbilityEonweWrathofValinor
        UnpackTime                      = 1500
        UnpackingVariation              = 1
        PreparationTime                 = 0
        PersistentPrepTime              = 0
        PackTime                        = 2096
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_OlweSetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_OlweSetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_OlweSetStanceGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate ToggleMounted_AI
        CommandButtonName  = Command_OlweMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate Flooding_AI
        CommandButtonName  = Command_OlweFlooding
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_STRUCTURES
        SpecialPowerRange  = 200
    End

    Behavior = AISpecialPowerUpdate UlmuriHorn_AI
        CommandButtonName  = Command_OlweUlmuriHorn
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Scale                 = 1.03
    Geometry              = CYLINDER
    GeometryMajorRadius   = 8.0
    GeometryHeight        = 19.2
    GeometryIsSmall       = Yes
    Shadow                = SHADOW_DECAL
    ShadowSizeX           = 19
    ShadowSizeY           = 19
    ShadowTexture         = ShadowI
End

ChildObject AlqualondOlwe_AI AlqualondOlwe

	EquivalentTo = AlqualondOlwe

    BuildCost            = FIRST_AGE_AI_HERO_COST
    BuildTime            = FIRST_AGE_AI_HERO_BUILDTIME
    MaxSimultaneousOfType  = 1

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End





    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         MountedTemplate                = AlqualondOlweMount_AI
         SynchronizeTimerOnSpecialPower = SpecialAbilityEonweWrathofValinor SpecialAbilityOlweFlooding
         UnpackTime                     = GOOD_MOUNT_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End
End

ChildObject AlqualondOlweMount_AI AlqualondOlweMount

	EquivalentTo = AlqualondOlweMount

    BuildCost            = FIRST_AGE_AI_HERO_COST
    BuildTime            = FIRST_AGE_AI_HERO_BUILDTIME
    MaxSimultaneousOfType  = 1

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End





    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate           = SpecialAbilityToggleMounted
         MountedTemplate                = AlqualondOlwe_AI
         SynchronizeTimerOnSpecialPower = SpecialAbilityEonweWrathofValinor SpecialAbilityOlweFlooding
         UnpackTime                     = GOOD_MOUNT_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End
End

