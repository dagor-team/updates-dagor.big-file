Object LothlorienHaldirsElves


    SelectPortrait     = UPGaladhrim
    ButtonImage        = HSGaladhrim

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

    RandomTexture = eugaladh_bow.tga  0 cubows.tga



        DefaultModelConditionState
            Model                           = rugaladhrim_ska
            Skeleton                        = EUHaldir_SKL
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = SECONDARY ARROWNOCK
            WeaponLaunchBone                = TERTIARY ARROW
        End

        ModelConditionState                 = WEAPONSET_TOGGLE_1
            Model                           = rugaladhrim_skb
            Skeleton                        = EUHaldir_SKL
        End





        AnimationState                    = PASSENGER WEAPONSET_TOGGLE_1
            StateName                    = STATE_Grabbed
            Animation                    = Sword
                AnimationName            = EUHaldir_FLYB
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = PASSENGER
            StateName                    = STATE_Grabbed
            Animation                    = Bow
                AnimationName            = EUHaldir_FLYA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = FREEFALL WEAPONSET_TOGGLE_1
            StateName                    = STATE_Falling
            Animation                    = Sword
                AnimationName            = EUHaldir_FLYB
                AnimationMode            = LOOP
                AnimationBlendTime        = 10
                AnimationSpeedFactorRange    = 0.24    0.24
            End
        End

        AnimationState                    = FREEFALL
            StateName                    = STATE_Falling
            Animation                    = Bow
                AnimationName            = EUHaldir_FLYA
                AnimationMode            = LOOP
                AnimationBlendTime        = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        AnimationState                    = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Fly
            Animation                   = Sword
                AnimationName           = EUHaldir_FLYB
                AnimationMode           = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES2
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                elseif PrevState == "STATE_Fly"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED_FLAILING
            StateName                    = STATE_Fly
            Animation
                AnimationName           = EUHaldir_FLYA
                AnimationMode           = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES2
        End

        AnimationState                    = DYING DEATH_1 SPLATTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Dead
            Animation                    = Sword
                AnimationName            = EUHaldir_LNDB
                AnimationMode            = ONCE
            End
        End

        AnimationState                    = DYING DEATH_1 SPLATTED
            StateName                    = STATE_Dead
            Animation                    = Bow
                AnimationName            = EUHaldir_LNDA
                AnimationMode            = ONCE
            End
        End



        AnimationState                    = DYING DEATH_1 WEAPONSET_TOGGLE_1
            Animation                        = Sword1
                AnimationName                = EUHaldir_DIESv5
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_DIESV5
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End

            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if GetClientRandomNumberReal(0,2) < 1
                then
                    return "Sword1"
                else
                    return "Sword2"
                end
            EndScript
        End

        AnimationState                    = DYING DEATH_2 WEAPONSET_TOGGLE_1
            Animation                   = FadeOut
                AnimationName           = EUHaldir_IDLF
                AnimationMode           = LOOP
            End
        End

        AnimationState                    = DYING DEATH_1
            Animation                        = Bow1
                AnimationName                = EUHaldir_DIEBV5
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_DIEBV5
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()

                if PrevState == "STATE_Fly"
                then
                    CurDrawableHideSubObject("ArrowNock")
                    CurDrawableHideSubObject("arrow")
                    return "WantBow"
                end

                if GetClientRandomNumberReal(0,2) < 1
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow1"
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow2"
                end
            EndScript
        End

        AnimationState                    = DYING DEATH_2
            Animation                        = FadeOut
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
        End


        AnimationState                    = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName                    = STATE_GetUp
            Animation                        = Sword
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.2    1.2
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End



        AnimationState                    = STUNNED_STANDING_UP
            StateName                    = STATE_GetUp
            Animation                        = Bow
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.42 1.42
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow"
                end
            EndScript
        End

        AnimationState                    = STUNNED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Land
            Animation                        = Sword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantSword" or PrevAnim == "Bow"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                Flags                        = MAINTAIN_FRAME_ACROSS_STATES3
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED
            StateName                    = STATE_Land
            Animation                        = Bow
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES3
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                end

                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                return "Bow"
            EndScript
        End





        AnimationState                    = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName                        = Ready_Sword

            Animation                        = AttackWithSwordA
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordB
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordD
                AnimationName                = EUHaldir_ATKSV4
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            StateName                        = Attacking_Bow
            Animation
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
                AnimationBlendTime            = 20
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End


        AnimationState                    = PREATTACK_A
            Animation                        = ReadyToDrawn
                AnimationName                = EUHaldir_ATA1
                AnimationMode                = ONCE
                AnimationBlendTime            = 0
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                    = FIRING_OR_RELOADING_A
            StateName                        = STATE_Firing
            Animation
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = ONCE
                AnimationBlendTime            = 30
                UseWeaponTiming                = Yes
                AnimationSpeedFactorRange    = 2.0 2.0
            End
            Flags                            = START_FRAME_FIRST
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("ArrowNock")
            EndScript
        End





        AnimationState                    = MOVING BACKING_UP WEAPONSET_TOGGLE_1
            StateName                        = STATE_BackingUp
            Animation                        = Sword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        return "WantSword"
                    end
                end
                return "Sword"
            EndScript
        End

        AnimationState                    = MOVING BACKING_UP
            StateName                    = STATE_BackingUp
            Animation                        = Bow
                AnimationName                = EUHaldir_BAKB
                AnimationMode                = LOOP
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        return "WantBow"
                    end
                end

                return "Bow"
            EndScript
        End



        AnimationState                    = MOVING WEAPONSET_TOGGLE_1
            StateName                        = Moving_Sword
            Animation
                AnimationName                = EUHaldir_RUNS
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Moving") end
            EndScript
        End

        AnimationState                    = MOVING
            StateName                        = Moving_Bow
            Animation
                AnimationName                = EUHaldir_RUNB
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Moving") end
            EndScript
        End



        AnimationState                    = CONTINUOUS_FIRE_MEAN
            Animation                        = HangFrameWhileCoasting
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = MANUAL
                AnimationBlendTime            = 20
            End
            Flags                            = START_FRAME_LAST
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
                if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
            EndScript
        End
        AnimationState                        = CONTINUOUS_FIRE_SLOW
            StateName                        = Ready_Bow
            Animation                        = PutAwayArrow
                AnimationName                = EUHaldir_ATA3
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
            EndScript
        End






        AnimationState                    = EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ENGAGED WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")

                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End

        AnimationState                    = EMOTION_ALERT
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End


        AnimationState                    = RAISING_FLAG WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = RAISING_FLAG
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")



                end
            EndScript
        End


        AnimationState                    = ENGAGED
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End







        AnimationState                    = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                    then
                        CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow1
                AnimationName                = EUHaldir_TNTA
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_TNTA
                AnimationMode                = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_POINTING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_POINTING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_PNTA
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_PNTA
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                =    SELECTED WEAPONSET_TOGGLE_1
            StateName                =    Selected_Sword
            Animation                        = ATNA
                AnimationName                = EUHaldir_ATNS
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BS_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RS_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end

            EndScript
        End

        AnimationState                =    SELECTED
            StateName               =    Selected_Bow
            Animation                        = ATNE
                AnimationName                = EUHaldir_ATNE
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BS_Bow")                end
                if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




        AnimationState                        = HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
            StateName                        = Bored_Sword
            Animation
                AnimationName                = EUHaldir_HITE
                AnimationMode                = ONCE
            End
        End

        AnimationState                         = HIT_REACTION HIT_LEVEL_1
            StateName                        = Bored_Bow
            Animation
                AnimationName                = EUHaldir_HITA
                AnimationMode                 = ONCE
                AnimationSpeedFactorRange    = .9 .9
            End
        End




        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = Bored_Sword
            Animation                        = Idle_Sword1
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword3
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 0
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SB_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RB_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End

        IdleAnimationState
            StateName                    = Bored_Bow
            Animation                        = IdleBowB
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
            Animation                        = IdleBowD
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
                AnimationPriority            = 10
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Bow" or Prev == "TRANS_RB_Bow" then return "IdleNoFidget" end
                if Prev == "Selected_Bow"        then CurDrawableSetTransitionAnimState("TRANS_SB_Bow")        end
                if Prev == "Ready_Bow"            then CurDrawableSetTransitionAnimState("TRANS_RB_Bow")        end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




		TransitionState						= TRANS_BoredToSelected_Bow
			Animation
				AnimationName				= EUHaldir_ATNB
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
		End


		TransitionState						= TRANS_SelectedToReady_Bow
			Animation						= ATNE
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
		End


		TransitionState						= TRANS_SelectedToBored_Bow
			Animation
				AnimationName				= EUHaldir_ATNB
				AnimationMode				= ONCE_BACKWARDS
			End
			Flags							= START_FRAME_LAST
		End


		TransitionState						= TRANS_RS_Bow
			Animation						= ATNF
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE_BACKWARDS
				AnimationBlendTime			= 10
			End
			Flags							= START_FRAME_LAST
		End


		TransitionState						= TRANS_BR_Bow
			Animation						= IDLB
				AnimationName				= EUHaldir_IDLST1
				AnimationMode				= ONCE
				AnimationBlendTime			= 20
			End
		End


		TransitionState						= TRANS_RB_Bow
			Animation						= IDLD
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE
				AnimationBlendTime			= 20
			End
		End


		TransitionState					= TRANS_BoredToSelected_Sword
			Animation					= ATNA
				AnimationName			= EUHaldir_ATNA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SR_Sword
			Animation					= ATNC
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SelectedToBored_Sword
			Animation					= ATNA
				AnimationName			= EUHaldir_ATNA
				AnimationMode			= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End


		TransitionState					= TRANS_ReadyToSelected_Sword
			Animation					= ATNC
				AnimationName			= EUHaldir_IDLST1
				AnimationMode			= ONCE_BACKWARDS
				AnimationBlendTime		= 20
			End
			Flags						= START_FRAME_LAST
		End


		TransitionState					= TRANS_BR_Sword
			Animation					= ATNS
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
				AnimationBlendTime		= 20
			End
		End


		TransitionState					= TRANS_RB_Sword
			Animation					= IDLG
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
				AnimationBlendTime		= 20
			End
		End



		TransitionState					= TRANS_SwordToBow_Moving
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHC
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Moving
			Animation					= DrawSword
				AnimationName			= EUHaldir_STHD
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Ready
			Animation					= DrawSwords
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SwordToBow_Ready
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHB
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Selected
			Animation					= DrawSwords
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SwordToBow_Selected
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHB
				AnimationMode			= ONCE
			End
		End
	End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 7
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY   HaldirsGaladhrimBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1
        Weapon            = PRIMARY   GaladhrimWarriorSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions         = CONTAINED
        Weapon             = PRIMARY    HaldirsGaladhrimBow
        AutoChooseSources  = PRIMARY  FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = GOOD_ADVANCED_ARCHERS
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = GOOD_ADVANCED_ARCHERS_HEAVY_ARMOR
        DamageFX        = NormalDamageFX
    End

    VisionRange           = 420
    VisionSide            = 50%
    VisionRear            = 25%
    ShroudClearingRange   = 420

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = 10
    DisplayName = OBJECT:LothlorienHaldirsElves
    CrushableLevel = 0

    CrushRevengeWeapon = DolSoldatenCrushRevenge

    CommandSet = ElvenHaldirGaladrimCommandSet




    VoiceAttack                       = GaladhrimVoiceAttack
    VoiceAttackAir                    = GaladhrimVoiceAttack
    VoiceAttackCharge                 = GaladhrimVoiceAttackCharge
    VoiceAttackStructure              = GaladhrimVoiceAttackStructure
    VoiceAttackMachine                = GaladhrimVoiceAttackStructure
    VoiceCreated                      = GaladhrimVoiceSalute
    VoiceFullyCreated                 = GaladhrimVoiceSalute
    VoiceMove                         = GaladhrimVoiceMove
    VoiceMoveToCamp                   = GaladhrimVoiceMoveCamp
    VoiceMoveWhileAttacking           = GaladhrimVoiceDisengage
    VoicePriority                     = 44
    VoiceRetreatToCastle              = GaladhrimVoiceRetreat
    VoiceSelect                       = GaladhrimVoiceSelect
    VoiceSelectBattle                 = GaladhrimVoiceSelectBattle
    VoiceGuard                        = GaladhrimVoiceMove

    VoiceEnterStateAttack             = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateAttackAir          = GaladhrimVoiceEnterStateAttackBow
    VoiceEnterStateAttackCharge       = GaladhrimVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine      = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateAttackStructure    = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateMove               = GaladhrimVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = GaladhrimVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking = GaladhrimVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle    = GaladhrimVoiceEnterStateRetreat

    UnitSpecificSounds
        VoiceGarrison              = GaladhrimVoiceGarrison
        VoicePrimaryWeaponMode     = GaladhrimVoiceModeBow
        VoiceSecondaryWeaponMode   = GaladhrimVoiceModeSword
    End


    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Elf Unit Infantry Elf_Warrior
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING       Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING       Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG           Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap                     = 800
        AnimationSound                        = Sound:ArrowDrawBow                      Animation:EUHaldir_SKL.EUHaldir_ATA1     Frames:6
        AnimationSound                        = Sound:ArrowDrawBow                      Animation:EUHaldir_SKL.EUHaldir_ATA2     Frames:18
        AnimationSound                        = Sound:SwordShingClean1                  Animation:EUHaldir_SKL.EUHaldir_STHA     Frames:24
        AnimationSound                        = Sound:SwordIntoScabbard1                Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:9
        AnimationSound                        = Sound:WeaponSwitchBow                   Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:15
        AnimationSound                        = Sound:SwordShingClean1                  Animation:EUHaldir_SKL.EUHaldir_STHC     Frames:20
        AnimationSound                        = Sound:SwordIntoScabbard1                Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:5
        AnimationSound                        = Sound:WeaponSwitchBow                   Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:8
        AnimationSound                        = Sound:SwordShingClean1                  Animation:EUHaldir_SKL.EUHaldir_RUNC     Frames:14
        AnimationSound                        = Sound:SwordIntoScabbard1                Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:4
        AnimationSound                        = Sound:WeaponSwitchBow                   Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:16
        AnimationSound                        = Sound:BodyFallSoldier                   Animation:EUHaldir_SKL.EUHaldir_LNDA     Frames:9
        AnimationSound                        = Sound:BodyFallSoldier                   Animation:EUHaldir_SKL.EUHaldir_LNDB     Frames:1
        AnimationSound                        = Sound:BodyFallGenericNoArmor            Animation:EUHaldir_SKL.EUHaldir_DIEB     Frames:82
        AnimationSound                        = Sound:BodyFallSoldier                   Animation:EUHaldir_SKL.EUHaldir_DIEBV5   Frames:25
        AnimationSound                        = Sound:BodyFallSoldier                   Animation:EUHaldir_SKL.EUHaldir_DIESV4   Frames:26
        AnimationSound                        = Sound:BodyFallGenericNoArmor            Animation:EUHaldir_SKL.EUHaldir_DIESV5   Frames:100
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ARCHER ATTACK_NEEDS_LINE_OF_SIGHT GRAB_AND_DROP

    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 850
        MaxHealthDamaged     = 375
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = AttributeModifierUpgrade ModuleTag_Kampfbereitschaft
        TriggeredBy       = Upgrade_LothlorienKampfbereitschaft
        AttributeModifier = KampfbereitschaftModifier
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeKampfbereitschaft2
        TriggeredBy       = Upgrade_LothlorienKampfbereitschaft
        ShowSubObjects    = SHOW02 MANTEL GNLT
        HideSubObjects    = DRAPE UMHANG HIDE01
    End

    Behavior = AttributeModifierUpgrade ModuleTag_Kampfausrustung
        TriggeredBy       = Upgrade_LothlorienKampfausrustung
        AttributeModifier = KampfausrustungModifier
    End

    Behavior = SubObjectsUpgrade Armor_UpgradeKampfausrustung2
        TriggeredBy       = Upgrade_LothlorienKampfausrustung
        UpgradeTexture    = eugaladh_bow.tga 0 cubows.tga
        RecolorHouse      = No
        ShowSubObjects    = Forged_Blade
    End
	
	ReplaceModule ModuleTag_DefaultShareExp
       Behavior = ShareExperienceBehavior ModuleTag_DefaultShareExp_Nekromant
          Radius            = 300.0
          ObjectFilter      = ANY +LothlorienHaldir_Rohan ALLIES
          DropOff           = 0.30
       End
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate               = 500
        CanAttackWhileContained           = Yes
        AILuaEventsList                   = RohanElvenWarriorFunctions
        AttackPriority                    = AttackPriority_Archer
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanPanicLocomotor
        Condition = SET_PANIC
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanScaredLocomotor
        Condition = SET_SCARED
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End


    Behavior = WeaponSetUpgrade ModuleTag_14
        TriggeredBy = Upgrade_SilverThornArrows
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.5
        DestructionDelay = 15000
        Sound = INITIAL GaladhrimVoiceDie
        DeathFlags = DEATH_1

    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    Scale = 0.91
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 14
    ShadowSizeY = 14
    ShadowTexture = ShadowI
End

ChildObject LothlorienHaldirsElvesMod_Summoned LothlorienHaldirsElves
    IsTrainable = No
    CommandPoints = 0
    EquivalentTo = LothlorienHaldirsElves

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType   = FADED
    End
End

Object LothlorienHaldirsElvesInn


    SelectPortrait     = UPGaladhrim
    ButtonImage        = HSGaladhrim

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Haldir

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                           = euhalelv_skn
            Skeleton                        = EUHaldir_SKL
            WeaponLaunchBone                = PRIMARY ARROW
            WeaponLaunchBone                = SECONDARY ARROWNOCK
            WeaponLaunchBone                = TERTIARY ARROW
        End

        ModelConditionState                 = WEAPONSET_TOGGLE_1
            Model                           = euhalelv_skn
            Skeleton                        = EUHaldir_SKL
        End






        AnimationState                    = PASSENGER WEAPONSET_TOGGLE_1
            StateName                    = STATE_Grabbed
            Animation                    = Sword
                AnimationName            = EUHaldir_FLYB
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = PASSENGER
            StateName                    = STATE_Grabbed
            Animation                    = Bow
                AnimationName            = EUHaldir_FLYA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = FREEFALL WEAPONSET_TOGGLE_1
            StateName                    = STATE_Falling
            Animation                    = Sword
                AnimationName            = EUHaldir_FLYB
                AnimationMode            = LOOP
                AnimationBlendTime        = 10
                AnimationSpeedFactorRange    = 0.24    0.24
            End
        End

        AnimationState                    = FREEFALL
            StateName                    = STATE_Falling
            Animation                    = Bow
                AnimationName            = EUHaldir_FLYA
                AnimationMode            = LOOP
                AnimationBlendTime        = 10
                AnimationSpeedFactorRange    = 0.5    0.5
            End
        End

        AnimationState                    = STUNNED_FLAILING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Fly
            Animation                   = Sword
                AnimationName           = EUHaldir_FLYB
                AnimationMode           = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES2
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                elseif PrevState == "STATE_Fly"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED_FLAILING
            StateName                    = STATE_Fly
            Animation
                AnimationName           = EUHaldir_FLYA
                AnimationMode           = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES2
        End

        AnimationState                    = DYING DEATH_1 SPLATTED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Dead
            Animation                    = Sword
                AnimationName            = EUHaldir_LNDB
                AnimationMode            = ONCE
            End
        End

        AnimationState                    = DYING DEATH_1 SPLATTED
            StateName                    = STATE_Dead
            Animation                    = Bow
                AnimationName            = EUHaldir_LNDA
                AnimationMode            = ONCE
            End
        End



        AnimationState                    = DYING DEATH_1 WEAPONSET_TOGGLE_1
            Animation                        = Sword1
                AnimationName                = EUHaldir_DIESv5
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_DIESV5
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End

            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "WantSword"
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if GetClientRandomNumberReal(0,2) < 1
                then
                    return "Sword1"
                else
                    return "Sword2"
                end
            EndScript
        End

        AnimationState                    = DYING DEATH_2 WEAPONSET_TOGGLE_1
            Animation                   = FadeOut
                AnimationName           = EUHaldir_IDLF
                AnimationMode           = LOOP
            End
        End

        AnimationState                    = DYING DEATH_1
            Animation                        = Bow1
                AnimationName                = EUHaldir_DIEBV5
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_DIEBV5
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()

                if PrevState == "STATE_Fly"
                then
                    CurDrawableHideSubObject("ArrowNock")
                    CurDrawableHideSubObject("arrow")
                    return "WantBow"
                end

                if GetClientRandomNumberReal(0,2) < 1
                then
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow1"
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow2"
                end
            EndScript
        End

        AnimationState                    = DYING DEATH_2
            Animation                        = FadeOut
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
        End


        AnimationState                    = STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
            StateName                    = STATE_GetUp
            Animation                        = Sword
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.2    1.2
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end

                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End



        AnimationState                    = STUNNED_STANDING_UP
            StateName                    = STATE_GetUp
            Animation                        = Bow
                AnimationName                = EUHaldir_GTPB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 1.42 1.42
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_GTPSX1
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                else
                    CurDrawableShowSubObject("arrow")
                    CurDrawableShowSubObject("arrownock")
                    return "Bow"
                end
            EndScript
        End

        AnimationState                    = STUNNED WEAPONSET_TOGGLE_1
            StateName                    = STATE_Land
            Animation                        = Sword
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantSword" or PrevAnim == "Bow"
                    then
                        CurDrawableShowSubObject("arrow")
                        CurDrawableShowSubObject("arrownock")
                        return "WantSword"
                    end
                end
                Flags                        = MAINTAIN_FRAME_ACROSS_STATES3
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                return "Sword"
            EndScript
        End

        AnimationState                    = STUNNED
            StateName                    = STATE_Land
            Animation                        = Bow
                AnimationName                = EUHaldir_LNDA
                AnimationMode                = ONCE
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_LNDB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES3
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                PrevAnim = CurDrawablePrevAnimation()
                if PrevState == "STATE_Fly"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        CurDrawableHideSubObject("ArrowNock")
                        CurDrawableHideSubObject("arrow")
                        return "WantBow"
                    end
                end

                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                return "Bow"
            EndScript
        End





        AnimationState                    = FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
            StateName                        = Ready_Sword

            Animation                        = AttackWithSwordA
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordB
                AnimationName                = EUHaldir_ATKSV2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            Animation                        = AttackWithSwordD
                AnimationName                = EUHaldir_ATKSV4
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
            EndScript
        End

        AnimationState                        = FIRING_OR_PREATTACK_A
            StateName                        = Attacking_Bow
            Animation
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = ONCE
                UseWeaponTiming                = Yes
                AnimationBlendTime            = 20
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End


        AnimationState                    = PREATTACK_A
            Animation                        = ReadyToDrawn
                AnimationName                = EUHaldir_ATA1
                AnimationMode                = ONCE
                AnimationBlendTime            = 0
                UseWeaponTiming                = Yes
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ArrowNock")
            EndScript
        End

        AnimationState                    = FIRING_OR_RELOADING_A
            StateName                        = STATE_Firing
            Animation
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = ONCE
                AnimationBlendTime            = 30
                UseWeaponTiming                = Yes
                AnimationSpeedFactorRange    = 2.0 2.0
            End
            Flags                            = START_FRAME_FIRST
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("ArrowNock")
            EndScript
        End





        AnimationState                    = MOVING BACKING_UP WEAPONSET_TOGGLE_1
            StateName                        = STATE_BackingUp
            Animation                        = Sword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Animation                        = WantSword
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                            = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "Bow" or PrevAnim == "WantSword"
                    then
                        return "WantSword"
                    end
                end
                return "Sword"
            EndScript
        End

        AnimationState                    = MOVING BACKING_UP
            StateName                    = STATE_BackingUp
            Animation                        = Bow
                AnimationName                = EUHaldir_BAKB
                AnimationMode                = LOOP
            End
            Animation                        = WantBow
                AnimationName                = EUHaldir_BAKS
                AnimationMode                = LOOP
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES4
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim    = CurDrawablePrevAnimation()
                PrevState    = CurDrawablePrevAnimationState()
                if PrevState == "STATE_BackingUp"
                then
                    if PrevAnim == "WantBow" or PrevAnim == "Sword"
                    then
                        return "WantBow"
                    end
                end

                return "Bow"
            EndScript
        End



        AnimationState                    = MOVING WEAPONSET_TOGGLE_1
            StateName                        = Moving_Sword
            Animation
                AnimationName                = EUHaldir_RUNS
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Bow" then CurDrawableSetTransitionAnimState("TRANS_BowToSword_Moving") end
            EndScript
        End

        AnimationState                    = MOVING
            StateName                        = Moving_Bow
            Animation
                AnimationName                = EUHaldir_RUNB
                AnimationMode                = LOOP
            End
            Flags = RANDOMSTART
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Moving_Sword" then CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Moving") end
            EndScript
        End



        AnimationState                    = CONTINUOUS_FIRE_MEAN
            Animation                        = HangFrameWhileCoasting
                AnimationName                = EUHaldir_ATA2
                AnimationMode                = MANUAL
                AnimationBlendTime            = 20
            End
            Flags                            = START_FRAME_LAST
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
                if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
            EndScript
        End
        AnimationState                        = CONTINUOUS_FIRE_SLOW
            StateName                        = Ready_Bow
            Animation                        = PutAwayArrow
                AnimationName                = EUHaldir_ATA3
                AnimationMode                = ONCE
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("ARROWNOCK")
            EndScript
        End






        AnimationState                    = EMOTION_ALERT WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ENGAGED WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")
                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING WEAPONSET_TOGGLE_1
            StateName                    = Ready_Sword
            Animation                        = Alert_1
                AnimationName                = EUHaldir_IDLST1
                AnimationMode                = LOOP
            End
            BeginScript
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("ArrowNock")

                CurDrawableHideSubObject("arrow")
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")            end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")            end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                end
            EndScript
        End

        AnimationState                    = EMOTION_ALERT
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End


        AnimationState                    = RAISING_FLAG WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = RAISING_FLAG
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")



                end
            EndScript
        End


        AnimationState                    = ENGAGED
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End
        AnimationState                    = ATTACKING
            StateName                    = Ready_Bow
            Animation                        = IDLB
                AnimationName                = EUHaldir_IDLB
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Bored_Bow"        then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")                end
                if Prev == "Selected_Bow"    then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                end
            EndScript
        End







        AnimationState                    = EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_CHRS
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_CELEBRATING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_CHRB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_TAUNTING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_TNTB
                AnimationMode                = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                    then
                        CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_TAUNTING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow1
                AnimationName                = EUHaldir_TNTA
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_TNTA
                AnimationMode                = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                    = EMOTION_POINTING WEAPONSET_TOGGLE_1
            StateName                    = STATE_Emotion_Sword
            Animation                        = Sword
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Animation                        = Sword2
                AnimationName                = EUHaldir_PNTB
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableHideSubObject("arrow")
                CurDrawableHideSubObject("arrownock")

                if PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
                elseif PrevState == "Bored_Sword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
                end
            EndScript
        End
        AnimationState                    = EMOTION_POINTING
            StateName                    = STATE_Emotion_Bow
            Animation                        = Bow
                AnimationName                = EUHaldir_PNTA
                AnimationMode                = ONCE
            End
            Animation                        = Bow2
                AnimationName                = EUHaldir_PNTA
                AnimationMode                = ONCE
            End
            Flags                        = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                PrevState = CurDrawablePrevAnimationState()
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")

                if PrevState == "STATE_Emotion_Sword"
                then
                    CurDrawableAllowToContinue()
                    if( CurDrawablePrevAnimFraction() > .89 )
                    then
                        CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
                    end
                elseif PrevState == "STATE_Emotion_Bow"
                then
                    CurDrawableAllowToContinue()
                elseif PrevState == "Selected_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
                elseif PrevState == "Bored_Bow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
                end
            EndScript
        End



        AnimationState                =    SELECTED WEAPONSET_TOGGLE_1
            StateName                =    Selected_Sword
            Animation                        = ATNA
                AnimationName                = EUHaldir_ATNS
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Sword"        then CurDrawableSetTransitionAnimState("TRANS_BS_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RS_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end

            EndScript
        End

        AnimationState                =    SELECTED
            StateName               =    Selected_Bow
            Animation                        = ATNE
                AnimationName                = EUHaldir_ATNE
                AnimationMode                = LOOP
            End
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
                if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BS_Bow")                end
                if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow")                end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




        AnimationState                        = HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
            StateName                        = Bored_Sword
            Animation
                AnimationName                = EUHaldir_HITE
                AnimationMode                = ONCE
            End
        End

        AnimationState                         = HIT_REACTION HIT_LEVEL_1
            StateName                        = Bored_Bow
            Animation
                AnimationName                = EUHaldir_HITA
                AnimationMode                 = ONCE
                AnimationSpeedFactorRange    = .9 .9
            End
        End




        AnimationState                    = WEAPONSET_TOGGLE_1
            StateName                    = Bored_Sword
            Animation                        = Idle_Sword1
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = Idle_Sword3
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLF
                AnimationMode                = ONCE
                AnimationPriority            = 0
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("ARROW")
                CurDrawableHideSubObject("ARROWNOCK")

                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
                if Prev == "Selected_Sword"        then CurDrawableSetTransitionAnimState("TRANS_SB_Sword")        end
                if Prev == "Ready_Sword"        then CurDrawableSetTransitionAnimState("TRANS_RB_Sword")        end
                if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
                then
                    CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")
                end
            EndScript
        End

        IdleAnimationState
            StateName                    = Bored_Bow
            Animation                        = IdleBowB
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
            Animation                        = IdleBowD
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
            End
            Animation                        = IdleNoFidget
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
                AnimationPriority            = 20
            End
            Animation                        = IdleNoFidget2
                AnimationName                = EUHaldir_IDLE
                AnimationMode                = ONCE
                AnimationPriority            = 10
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableShowSubObject("arrow")
                CurDrawableShowSubObject("arrownock")
                PrevAnim = CurDrawablePrevAnimation()
                Prev = CurDrawablePrevAnimationState()
                if Prev == "TRANS_SB_Bow" or Prev == "TRANS_RB_Bow" then return "IdleNoFidget" end
                if Prev == "Selected_Bow"        then CurDrawableSetTransitionAnimState("TRANS_SB_Bow")        end
                if Prev == "Ready_Bow"            then CurDrawableSetTransitionAnimState("TRANS_RB_Bow")        end
                if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
                then
                    CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")
                end
            EndScript
        End




		TransitionState						= TRANS_BoredToSelected_Bow
			Animation
				AnimationName				= EUHaldir_ATNB
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
		End


		TransitionState						= TRANS_SelectedToReady_Bow
			Animation						= ATNE
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE
				AnimationBlendTime			= 10
			End
		End


		TransitionState						= TRANS_SelectedToBored_Bow
			Animation
				AnimationName				= EUHaldir_ATNB
				AnimationMode				= ONCE_BACKWARDS
			End
			Flags							= START_FRAME_LAST
		End


		TransitionState						= TRANS_RS_Bow
			Animation						= ATNF
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE_BACKWARDS
				AnimationBlendTime			= 10
			End
			Flags							= START_FRAME_LAST
		End


		TransitionState						= TRANS_BR_Bow
			Animation						= IDLB
				AnimationName				= EUHaldir_IDLST1
				AnimationMode				= ONCE
				AnimationBlendTime			= 20
			End
		End


		TransitionState						= TRANS_RB_Bow
			Animation						= IDLD
				AnimationName				= EUHaldir_IDLB
				AnimationMode				= ONCE
				AnimationBlendTime			= 20
			End
		End


		TransitionState					= TRANS_BoredToSelected_Sword
			Animation					= ATNA
				AnimationName			= EUHaldir_ATNA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SR_Sword
			Animation					= ATNC
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SelectedToBored_Sword
			Animation					= ATNA
				AnimationName			= EUHaldir_ATNA
				AnimationMode			= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End


		TransitionState					= TRANS_ReadyToSelected_Sword
			Animation					= ATNC
				AnimationName			= EUHaldir_IDLST1
				AnimationMode			= ONCE_BACKWARDS
				AnimationBlendTime		= 20
			End
			Flags						= START_FRAME_LAST
		End


		TransitionState					= TRANS_BR_Sword
			Animation					= ATNS
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
				AnimationBlendTime		= 20
			End
		End


		TransitionState					= TRANS_RB_Sword
			Animation					= IDLG
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
				AnimationBlendTime		= 20
			End
		End



		TransitionState					= TRANS_SwordToBow_Moving
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHC
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Moving
			Animation					= DrawSword
				AnimationName			= EUHaldir_STHD
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Ready
			Animation					= DrawSwords
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SwordToBow_Ready
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHB
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_BowToSword_Selected
			Animation					= DrawSwords
				AnimationName			= EUHaldir_STHA
				AnimationMode			= ONCE
			End
		End


		TransitionState					= TRANS_SwordToBow_Selected
			Animation					= DrawBow
				AnimationName			= EUHaldir_STHB
				AnimationMode			= ONCE
			End
		End
	End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Lothlorien
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 7
    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT


    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY   HaldirsGaladhrimBow
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = WEAPONSET_TOGGLE_1
        Weapon            = PRIMARY   GaladhrimWarriorSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions         = CONTAINED
        Weapon             = PRIMARY    HaldirsGaladhrimBow
        AutoChooseSources  = PRIMARY  FROM_PLAYER FROM_SCRIPT FROM_AI
    End


    ArmorSet
        Conditions      = None
        Armor           = GOOD_ADVANCED_ARCHERS
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = PLAYER_UPGRADE
        Armor           = GOOD_ADVANCED_ARCHERS_HEAVY_ARMOR
        DamageFX        = NormalDamageFX
    End


    VisionRange           = 420
    VisionSide            = 50%
    VisionRear            = 25%
    ShroudClearingRange   = 420

    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = 10
    DisplayName = OBJECT:LothlorienHaldirsElves
    CrushableLevel = 0

    CrushRevengeWeapon = DolSoldatenCrushRevenge

    CommandSet = ElvenHaldirGaladrimCommandSet




    VoiceAttack                       = GaladhrimVoiceAttack
    VoiceAttackAir                    = GaladhrimVoiceAttack
    VoiceAttackCharge                 = GaladhrimVoiceAttackCharge
    VoiceAttackStructure              = GaladhrimVoiceAttackStructure
    VoiceAttackMachine                = GaladhrimVoiceAttackStructure
    VoiceCreated                      = GaladhrimVoiceSalute
    VoiceFullyCreated                 = GaladhrimVoiceSalute
    VoiceMove                         = GaladhrimVoiceMove
    VoiceMoveToCamp                   = GaladhrimVoiceMoveCamp
    VoiceMoveWhileAttacking           = GaladhrimVoiceDisengage
    VoicePriority                     = 44
    VoiceRetreatToCastle              = GaladhrimVoiceRetreat
    VoiceSelect                       = GaladhrimVoiceSelect
    VoiceSelectBattle                 = GaladhrimVoiceSelectBattle
    VoiceGuard                        = GaladhrimVoiceMove

    VoiceEnterStateAttack             = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateAttackAir          = GaladhrimVoiceEnterStateAttackBow
    VoiceEnterStateAttackCharge       = GaladhrimVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine      = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateAttackStructure    = GaladhrimVoiceEnterStateAttack
    VoiceEnterStateMove               = GaladhrimVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = GaladhrimVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking = GaladhrimVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle    = GaladhrimVoiceEnterStateRetreat

    UnitSpecificSounds
        VoiceGarrison              = GaladhrimVoiceGarrison
        VoicePrimaryWeaponMode     = GaladhrimVoiceModeBow
        VoiceSecondaryWeaponMode   = GaladhrimVoiceModeSword
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Elf Unit Infantry Elf_Warrior
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:EMOTION_CELEBRATING    Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxCheerSinglesLoop
        ModelCondition = Required:EMOTION_TAUNTING        Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:EMOTION_POINTING        Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionElfCompilationVoxTauntSinglesLoop
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap                     = 800
        AnimationSound                        = Sound:ArrowDrawBow                    Animation:EUHaldir_SKL.EUHaldir_ATA1     Frames:6
        AnimationSound                        = Sound:ArrowDrawBow                    Animation:EUHaldir_SKL.EUHaldir_ATA2     Frames:18
        AnimationSound                        = Sound:SwordShingClean1                Animation:EUHaldir_SKL.EUHaldir_STHA     Frames:24
        AnimationSound                        = Sound:SwordIntoScabbard1              Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:9
        AnimationSound                        = Sound:WeaponSwitchBow                 Animation:EUHaldir_SKL.EUHaldir_STHB     Frames:15
        AnimationSound                        = Sound:SwordShingClean1                Animation:EUHaldir_SKL.EUHaldir_STHC     Frames:20
        AnimationSound                        = Sound:SwordIntoScabbard1              Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:5
        AnimationSound                        = Sound:WeaponSwitchBow                 Animation:EUHaldir_SKL.EUHaldir_STHD     Frames:8
        AnimationSound                        = Sound:SwordShingClean1                Animation:EUHaldir_SKL.EUHaldir_RUNC     Frames:14
        AnimationSound                        = Sound:SwordIntoScabbard1              Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:4
        AnimationSound                        = Sound:WeaponSwitchBow                 Animation:EUHaldir_SKL.EUHaldir_RUNT     Frames:16
        AnimationSound                        = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_LNDA     Frames:9
        AnimationSound                        = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_LNDB     Frames:1
        AnimationSound                        = Sound:BodyFallGenericNoArmor          Animation:EUHaldir_SKL.EUHaldir_DIEB     Frames:82
        AnimationSound                        = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_DIEBV5   Frames:25
        AnimationSound                        = Sound:BodyFallSoldier                 Animation:EUHaldir_SKL.EUHaldir_DIESV4   Frames:26
        AnimationSound                        = Sound:BodyFallGenericNoArmor          Animation:EUHaldir_SKL.EUHaldir_DIESV5   Frames:100
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY SCORE THROWN_OBJECT PATH_THROUGH_EACH_OTHER ARCHER ATTACK_NEEDS_LINE_OF_SIGHT GRAB_AND_DROP

    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 800
        MaxHealthDamaged     = 350
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End


    Behavior = SubObjectsUpgrade ModuleTag_FireArrowSwapUpgrade
        TriggeredBy = Upgrade_SilverThornArrows
        ShowSubObjects    = FireArowTip
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy        = Upgrade_ForgedBlades
    End

    Behavior = SubObjectsUpgrade Armor_Upgrade
        TriggeredBy = Upgrade_HeavyArmor
        UpgradeTexture    = euhaldirelb.tga 0 euhaldirelb_ha.tga
        RecolorHouse    = Yes
        HideSubObjects    = KAPUZE ARME02
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = SubObjectsUpgrade ForgedBlades_Upgrade1
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ForgedBlades_Upgrade
        TriggeredBy        = Upgrade_ForgedBlades
        ShowSubObjects    = Forged_Blade
    End


    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate               = 500
        CanAttackWhileContained           = Yes
        AILuaEventsList                   = RohanElvenWarriorFunctions
        AttackPriority                    = AttackPriority_Archer
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanPanicLocomotor
        Condition = SET_PANIC
        Speed      = NORMAL_FOOT_MED_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanScaredLocomotor
        Condition = SET_SCARED
        Speed      = NORMAL_FOOT_MED_MEMBER_SPEED
    End


    Behavior = WeaponSetUpgrade ModuleTag_14
        TriggeredBy = Upgrade_SilverThornArrows
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 21
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.5
        DestructionDelay = 15000
        Sound = INITIAL GaladhrimVoiceDie
        DeathFlags = DEATH_1

    End

      Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 5000
        DestructionDelay = 5000
        DeathFlags = DEATH_2
        FX = INITIAL FX_UnSummonElvenAllies
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End

    Scale = 0.91
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
    Shadow = SHADOW_DECAL
    ShadowSizeX = 14
    ShadowSizeY = 14
    ShadowTexture = ShadowI
End

