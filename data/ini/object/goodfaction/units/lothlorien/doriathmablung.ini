Object DoriathMablung

    SelectPortrait = HPMablung
    ButtonImage    = HPMablung

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero



    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        DefaultModelConditionState
            Model                    = eumablung
            Skeleton                 = EUGlrfdl_SKL
        End

       ModelConditionState = MOUNTED
            Model                    = eumablungm
            Skeleton                 = RUHHs_Theo_SKL
            WeaponLaunchBone         = PRIMARY PASSENGERBONE
        End

        ModelConditionState  = WEAPONSET_TOGGLE_3
            Model                    = eumablung
            Skeleton                 = EUGlrfdl_SKL
            ParticleSysBone          = None MablungFlare FollowBone:Yes
        End



        AnimationState                = MOUNTED DEBUG
            Animation
                AnimationName       = RUHHs_Theo_IDLA
                AnimationMode       = ONCE
            End
            ParticleSysBone = BAT_HHEAD glowHorseGold FollowBone:Yes
            ParticleSysBone = B_HHIPL glowHorseRearGold FollowBone:Yes
            ParticleSysBone = BAT_SPINE2 glowGold FollowBone:Yes
        End



        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED DYING SPLATTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End



        AnimationState                =    MOUNTED DYING DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState        = SPECIAL_WEAPON_THREE MOUNTED
        Animation             = CHRA
            AnimationName     = RUHHs_Theo_SPCA
            AnimationMode     = Once
        End
        Animation             = CHRB
            AnimationName     = RUHHs_Theo_IDLC
            AnimationMode     = Once
        End
            ParticleSysBone   = ROOTTRANSFORM GandalfCrystalSphere FollowBone:Yes
            ParticleSysBone   = ROOTTRANSFORM GandalfBeamGlow2 FollowBone:Yes
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    MOUNTED ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = MOUNTED LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = MOUNTED EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End




        IdleAnimationState
            Animation                = IDLB
                AnimationName        = EUGlrfdl_IDLB
                AnimationMode        = ONCE
            End
            Animation                = IDLC
                AnimationName        = EUGlrfdl_IDLC
                AnimationMode        = ONCE
            End
            Animation                = IDLD
                AnimationName        = EUGlrfdl_IDLD
                AnimationMode        = ONCE
            End
            Animation                = IDLE
                AnimationName        = EUGlrfdl_IDLE
                AnimationMode        = ONCE
            End
            StateName                = Idle
            BeginScript
                CurDrawableHideSubObject("spear")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript

        End

        AnimationState            = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation
                AnimationName   = EUGlrfdl_FLYA
                AnimationMode   = LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SheatheSword") end
            EndScript
        End

        AnimationState            = STUNNED_STANDING_UP
            Animation
                AnimationName   = EUGlrfdl_GTPA
                AnimationMode   = ONCE
                AnimationSpeedFactorRange= 1.5 1.5
            End
        End

        AnimationState            = STUNNED
            Animation
                AnimationName   = EUGlrfdl_LNDA
                AnimationMode   = ONCE
            End
            StateName           = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SheatheSword") end
            EndScript
        End


        AnimationState                =    DYING SPLATTED
            Animation
                AnimationName        =    EUGlrfdl_LNDA
                AnimationMode        =    ONCE
            End
            StateName                =    NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SheatheSword") end
            EndScript
        End
        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName           = EUGlrfdl_MFDA
                AnimationMode       = LOOP
            End
        End


        AnimationState                =    DYING
            Animation
                AnimationName        =    EUGlrfdl_DTHA
                AnimationMode        =    ONCE
                AnimationPriority   =   10
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = EUGlrfdl_IDLB
                AnimationMode                = LOOP
            End
        End



        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = EUGlrfdl_ATKSV2
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
            BeginScript
                CurDrawableHideSubObject("spear")
            EndScript
        End

        AnimationState                =    MOVING ATTACKING
            Flags                    =    RANDOMSTART
            Animation                =    RUNB
                AnimationName        =    EUGlrfdl_RUNB
                AnimationMode        =    LOOP
            End
            StateName                =    NoSword
            BeginScript
                CurDrawableHideSubObject("spear")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SheatheSword") end
            EndScript
        End


        AnimationState                =    MOVING
            Flags                    =    RANDOMSTART
            Animation                =    RUNA
                AnimationName        =    EUGlrfdl_RUNA
                AnimationMode        =    LOOP
            End
            StateName                =    NoSword
            BeginScript
                CurDrawableHideSubObject("spear")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword" then CurDrawableSetTransitionAnimState("TRANS_SheatheSword") end
            EndScript
        End

        AnimationState = USER_1
            Animation
                AnimationName                = EUGlrfdl_SPCA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.75 0.75
            End
        End

        AnimationState = USER_2
            Animation
                AnimationName                = EUGlrfdl_SPCB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.8 0.8
            End
        End

        AnimationState = USER_5
            Animation
                AnimationName                = EUGlrfdl_SPCB
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.8 0.8
            End
            EnteringStateFX = FX_GlorfindelReinkarnationStart
        End


        AnimationState                =    FIRING_OR_PREATTACK_A
            StateName                =    Sword
            Animation                =    ATKA
                AnimationName        =    EUGlrfdl_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    ATKB
                AnimationName        =    EUGlrfdl_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    ATKC
                AnimationName        =    EUGlrfdl_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                CurDrawableHideSubObject("spear")
            EndScript
        End

        AnimationState = SPECIAL_WEAPON_THREE
            Animation = CrackThatWhip
                AnimationName = EUGlrfdl_SPCB
                AnimationMode = ONCE
            End
            ParticleSysBone = NONE GlorfindelDeathDistortion FollowBone:Yes
            ParticleSysBone = NONE GlorfindelDeathLight FollowBone:Yes
            ParticleSysBone = NONE GlorfindelDeathLightMotes FollowBone:Yes
        End


        AnimationState = SPECIAL_WEAPON_THREE MOUNTED
            Animation = CrackThatWhip
                AnimationName = EUGlrfnMnt_SPCB
                AnimationMode = ONCE
            End
            ParticleSysBone = NONE GlorfindelDeathDistortion FollowBone:Yes
            ParticleSysBone = NONE GlorfindelDeathLight FollowBone:Yes
            ParticleSysBone = NONE GlorfindelDeathLightMotes FollowBone:Yes
        End



        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = EUGlrfdl_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState            = HIT_REACTION HIT_LEVEL_1
            StateName            = STATE_Bored_Sword
            Animation            = Hit_Level_1_A
                AnimationName    = EUGlrfdl_HITA
                AnimationMode    = ONCE
            End
        End

        AnimationState            = HIT_REACTION HIT_LEVEL_2
            StateName            = STATE_Bored_Sword
            Animation            = Hit_Level_1_A
                AnimationName    = EUGlrfdl_HITA
                AnimationMode    = ONCE
            End
        End

        AnimationState            = HIT_REACTION HIT_LEVEL_3
            StateName            = STATE_Bored_Sword
            Animation            = Hit_Level_1_A
                AnimationName    = EUGlrfdl_HITA
                AnimationMode    = ONCE
            End
        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    EUGlrfdl_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNC
                AnimationName            =    EUGlrfdl_ATNC
                AnimationMode            =    ONCE
            End
        End

        AnimationState                        = LEVELED
            Animation                        = LevelUp
                AnimationName                = EUGlrfdl_LVLA
                AnimationMode                = ONCE
                AnimationSpeedFactorRange    = 0.75 0.75
            End
        End

        AnimationState                =    RAISING_FLAG
            Animation                =    CHRA
                AnimationName        =    EUGlrfdl_CHRA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    EUGlrfdl_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                CurDrawableHideSubObject("spear")
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End


        AnimationState                =    EMOTION_CELEBRATING
            Animation                =    CHRA
                AnimationName        =    EUGlrfdl_CHRA
                AnimationMode        =    ONCE
                AnimationPriority    =    10
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_TAUNTING
            Animation
                AnimationName            = EUGlrfdl_TNTA
                AnimationMode            = LOOP
            End
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            = EUGlrfdl_TNTA
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = EUGlrfdl_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState        = PACKING_TYPE_1
            StateName         = Favour
            Animation
            AnimationName         = EUGlrfdl_SPCA
            AnimationMode         = Once
                AnimationBlendTime   = 5
          End
        End

        AnimationState           = SPECIAL_WEAPON_TWO
            Animation            = Give
                    AnimationName    = EUGlrfdl_SPCB
                    AnimationMode    = ONCE
            End
        End

    End



    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

    Side                              = Lothlorien
    EditorSorting                     = UNIT
    ThreatLevel                       = 4.0
    ThingClass                        = CHARACTER_UNIT
    BuildCost                         = MEDIUM_FIRST_AGE_HERO_COST
    BuildTime                         = MEDIUM_FIRST_AGE_HERO_BUILDTIME
    ShockwaveResistance               = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount                = TRANSPORTSLOTCOUNT_HERO
    BountyValue                       = 320
    MaxSimultaneousOfType             = 1
    DisplayMeleeDamage                = MEDIUM_FIRST_AGE_HERO_DAMAGE
    VisionRange                       = 340
    ShroudClearingRange               = 420
    MaxVisionBonusPercent             = 300%
    VisionBonusTestRadius             = 200
    VisionBonusPercentPerFoot         = 1.0%

    DisplayName                       = OBJECT:DoriathMablung
    RecruitText                       = CONTROLBAR:DoriathMablungRecruit
    ReviveText                        = CONTROLBAR:DoriathMablungRevive
    Hotkey                            = CONTROLBAR:DoriathMablungHotkey

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO
    CrusherLevel                      = 0
    MountedCrusherLevel               = 1
    MountedCrushableLevel             = 2
    CrushWeapon                       = HeroCrush
    CrushKnockback                    = 60
    CrushZFactor                      = 1.0

    CommandSet                        = DoriathMablungCommandSet
    CommandPoints                     = 0





    WeaponSet
        Conditions                    = None
        Weapon                        = PRIMARY MablungSword
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = MOUNTED
        Weapon                        = PRIMARY MablungSwordMounted
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions                    = WEAPONSET_TOGGLE_3
        Weapon                        = PRIMARY    MablungSword_Epesse
        Weapon                        = SECONDARY  MablungSword
        OnlyAgainst                   = SECONDARY  STRUCTURE
        AutoChooseSources             = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End





    ArmorSet
        Conditions                    = None
        Armor                         = FirstAgeStrongHeroArmor
        DamageFX                      = NormalDamageFX
    End

    ArmorSet
        Conditions                    = MOUNTED
        Armor                         = FirstAgeVeryStrongHeroArmorMounted
        DamageFX                      = NormalDamageFX
    End





    AutoResolveUnitType               = AutoResolveUnit_Hero
    AutoResolveCombatChain            = AutoResolve_HeroCombatChain

    AutoResolveBody                   = AutoResolve_GlorfindelBody

    AutoResolveArmor
        Armor                         = AutoResolve_GlorfindelArmor
    End

    AutoResolveWeapon
        Weapon                        = AutoResolve_GlorfindelWeapon
    End





    VoiceCreated                         = MablungVoiceSalute
    VoiceFullyCreated                    = MablungVoiceSalute
    VoiceAttack                          = MablungVoiceAttack
    VoiceAttackAir                       = MablungVoiceAttack
    VoiceAttackCharge                    = MablungVoiceAttackCharge
    VoiceAttackMachine                   = MablungVoiceAttack
    VoiceAttackStructure                 = MablungVoiceAttackBuilding
    VoiceFear                            = MablungVoiceHelpMe
    VoiceGuard                           = MablungVoiceMove
    VoiceMove                            = MablungVoiceMove
    VoiceMoveToCamp                      = MablungVoiceMoveCamp
    VoiceMoveWhileAttacking              = MablungVoiceDisengage
    VoicePriority                        = 90
    VoiceRetreatToCastle                 = MablungVoiceRetreat
    VoiceSelect                          = MablungVoiceSelect
    VoiceSelectBattle                    = MablungVoiceSelectBattle

    SoundImpact                          = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip = MablungVoiceMove
        VoiceGarrison                    = MablungVoiceMove
        VoiceInitiateCaptureBuilding     = MablungVoiceMove
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove                    = MablungVoiceMove
            VoiceSelect                  = MablungVoiceSelect
        End
    End

    CrowdResponseKey = ElfHero

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key    = Humanoid_Male Elf Elf_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BodyFallSoldier         Animation:EUGLRFDL_SKL.EUGLRFDL_LNDA      Frames:5
        AnimationSound = Sound:BodyFallSoldier         Animation:EUGLRFDL_SKL.EUGLRFDL_DTHA      Frames:34
        AnimationSound = Sound:FootstepDirtA           Animation:EUGlrfdl_SKL.EUGlrfdl_RUNA      Frames:9 18 28 38 48 58
        AnimationSound = Sound:FootstepDirtA           Animation:EUGlrfdl_SKL.EUGlrfdl_RUNB      Frames:9 18 28 38 48 58

        AnimationSound = Sound:HorseMoveFootsteps      Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL  Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps      Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA  Frames:0
        AnimationSound = Sound:HorseMoveFootsteps      Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1  Frames:0
        AnimationSound = Sound:HorseMoveFootsteps      Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1  Frames:0
        AnimationSound = Sound:HorseWhinny             Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC  Frames:3
        AnimationSound = Sound:HorseDieForHero         Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA  Frames:0
        AnimationSound = Sound:BodyFallSoldier         Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA  Frames:1 9
        AnimationSound = Sound:HorseDieForHero         Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor  Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:4
        AnimationSound = Sound:BodyFallSoldier         Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA  Frames:42
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = 200
        TauntAndPointUpdateDelay        = 10000
        PointAt                         = ANY +HERO
        AddEmotion                      = Doom_Base
        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base
        AddEmotion                      = Alert_Base
        AddEmotion                      = CheerForAboutToCrush_Base
    End







    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                   = EMOTION_CHEER_RADIUS
        MaxHealth                     = MEDIUM_FIRST_AGE_HERO_HEALTH
        PermanentlyKilledByFilter     = NONE
        DodgePercent                  = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                     = DYING
        DeathAnimationTime            = 3000
        RespawnAnim                   = LEVELED
        RespawnAnimationTime          = 2000
        AutoRespawnAtObjectFilter     = NONE +CASTLE_KEEP
        ButtonImage                   = HPMablung

        RespawnRules =    AutoSpawn:No           Cost:MEDIUM_FIRST_AGE_HERO_COST       Time:MEDIUM_FIRST_AGE_HERO_RESPAWNTIME        Health:100%
   End

    Behavior = AutoHealBehavior ModuleTag_LegolasHealing
        StartsActive                  = Yes
        HealingAmount                 = HERO_HEAL_AMOUNT
        HealingDelay                  = 1000
        StartHealingDelay             = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat         = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        CanAttackWhileContained        = Yes
        AILuaEventsList                = LegolasFunctions
    End

    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 65
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = 115
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult             = 1.0
        ShockStandingTime       = 2000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes           = ALL
        SinkDelay            = 3000
        SinkRate             = 0.5
        DestructionDelay     = 15000
        Sound                = INITIAL MablungVoiceDie
        DeathFlags           = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1           = 1500
        HitReactionThreshold1           = 400

        FastHitsResetReaction           = Yes
    End












    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        TriggeredBy                        = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate               = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive                       = No
        BonusName                          = MablungLeadership
        TriggeredBy                        = Upgrade_Level_1
        RefreshDelay                       = 2000
        Range                              = 200
        AntiCategory                       = BUFF
        ObjectFilter                       = LORIEN_LEADERSHIP_UNITS_OBF ;ANY +INFANTRY -STRUCTURE -BASE_FOUNDATION -HERO +CAVALRY -DOZER
    End




	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnifeEnabler
        SpecialPowerTemplate               = SpecialAbilityMablungEpesse
        TriggeredBy                        = Upgrade_Level_3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_KnifeFighterPowerUpdate
        SpecialPowerTemplate               = SpecialAbilityMablungEpesse
        Duration                           = 30000
        AttributeModifier                  = MablungEpesseBouns
        WeaponSetFlags                     = WEAPONSET_TOGGLE_3
        StartsPaused                       = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_KnifeFighterAutoAbility
	SpecialAbility		= SpecialAbilityMablungEpesse
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= 150
	Query			= 15 ALL ENEMIES
	Query			= 1 ANY ENEMIES +HERO +MONSTER
   End
    





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseToggleEnabler
        SpecialPowerTemplate               = SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
       SpecialPowerTemplate                = SpecialAbilityToggleMounted
       UpdateModuleStartsAttack            = Yes
       StartsPaused                        = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
       SpecialPowerTemplate                = SpecialAbilityToggleMounted
       UnpackTime                          = GOOD_MOUNT_TIME
       PreparationTime                     = 1
       PersistentPrepTime                  = 250
       PackTime                            = GOOD_MOUNT_TIME
       OpacityTarget                       = .3
       AwardXPForTriggering                = 0
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KnechtschaftEnabler
        SpecialPowerTemplate               = SpecialAbilityMablungGraceofMerethAderthad
        TriggeredBy                        = Upgrade_Level_7
        ObeyRechageOnTrigger               = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_KnechtschaftStarter
        SpecialPowerTemplate               = SpecialAbilityMablungGraceofMerethAderthad
        UpdateModuleStartsAttack           = Yes
        StartsPaused                       = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_KnechtschaftUpdate
        SpecialPowerTemplate               = SpecialAbilityMablungGraceofMerethAderthad
        SkipContinue                       = Yes
        UnpackTime                         = 1100
        PreparationTime                    = 1
        PersistentPrepTime                 = 500
        PackTime                           = 500
        MustFinishAbility                  = Yes
        AwardXPForTriggering               = 0
        StartAbilityRange                  = 350
        SpecialWeapon                      = MablungGraceofMerethAderthadWeapon
        WhichSpecialWeapon                 = 2
    End





    

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_KingsFavorEnabler
        SpecialPowerTemplate               = SpecialAbilityMabulngsFavor
        TriggeredBy                    	   = Upgrade_Level_10
    End

     Behavior = SpecialPowerModule ModuleTag_KingsFavorSpecialPowerModule
        SpecialPowerTemplate               = SpecialAbilityMabulngsFavor
        StartsPaused                       = Yes
        UpdateModuleStartsAttack           = Yes
        InitiateSound                      = MablungVoiceSP1
    End

     Behavior = LevelGrantSpecialPower ModuleTag_KingsFavor
        SpecialPowerTemplate               = SpecialAbilityMabulngsFavor
        UnpackingVariation                 = 1
        StartAbilityRange                  = 200.0
        LevelFX                            = FX_MablungFavourSound
        Experience                         = 1000
        RadiusEffect                       = 200.0
        AcceptanceFilter                   = KINGSFAVOR_OBJECTFILTER
        UnpackTime                         = 3000
        PreparationTime                    = 0
        FreezeAfterTriggerDuration         = 2000
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate GiveXPAoE_AI
        CommandButtonName  = Command_MablungCaptianFavour
        SpecialPowerAIType = AI_SPECIAL_POWER_GIVEXP_AOE
        SpecialPowerRadius = 30.0
    End

    Behavior = AISpecialPowerUpdate ToggleMounted_AI
        CommandButtonName  = Command_MablungMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate Rage_AI
        CommandButtonName  = Command_MablungEpesse
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Scale                = 1.03
    Geometry             = CYLINDER
    GeometryMajorRadius  = 8.0
    GeometryHeight       = 19.2
    GeometryIsSmall      = Yes
    Shadow               = SHADOW_DECAL
    ShadowSizeX          = 19
    ShadowSizeY          = 19
    ShadowTexture        = ShadowI
End

ChildObject DoriathMablung_AI DoriathMablung

    EquivalentTo = DoriathMablung

    BuildCost            = FIRST_AGE_AI_HERO_COST
    BuildTime            = FIRST_AGE_AI_HERO_BUILDTIME
    MaxSimultaneousOfType = 1

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End
End

