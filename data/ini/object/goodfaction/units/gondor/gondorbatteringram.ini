Object MenRamCrew

  ButtonImage            = BISiegeWorks_BatteringRam
  SelectPortrait         = UPIsenguard_BatteringRam

  Draw = W3DHordeModelDraw ModuleTag_01

    StaticModelLODMode = Yes

    LodOptions    = LOW
        AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_LOW
        MaxRandomTextures        =    MAX_RANDOM_TEXTURES_LOW
        MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_LOW
        MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_LOW
    End

    LodOptions    = MEDIUM
        AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_MED
        MaxRandomTextures        =    MAX_RANDOM_TEXTURES_MED
        MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_MED
        MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_MED
    End

    LodOptions    = HIGH
        AllowMultipleModels        =    ALLOW_MULTIPLE_MODELS_HIGH
        MaxRandomTextures        =    MAX_RANDOM_TEXTURES_HIGH
        MaxRandomAnimations        =    MAX_RANDOM_ANIMATIONS_HIGH
        MaxAnimFrameDelta        =    MAX_ANIM_FRAME_DELTA_HIGH
    End

    RandomTexture = gusoldier.tga        0 gusoldier.tga
    RandomTexture = gusoldier_ha.tga    0 gusoldier.tga
    RandomTexture = gusoldier.tga        0 gumanatarms.tga
    RandomTexture = gusoldier_ha.tga    0 gumanatarms.tga

    DefaultModelConditionState
        Model = GUBRCREW_SKN
        Skeleton = IUUrukahi_SKL
    End

    IdleAnimationState
        Animation = IDLB
            AnimationName = IUUrukahi_IDLB
            AnimationMode = ONCE
            AnimationPriority = 20
        End
        Animation = IDLG
            AnimationName = IUUrukahi_IDLG
            AnimationMode = ONCE
            AnimationPriority = 1
        End
        Animation = IDLD
            AnimationName = IUUrukahi_IDLD
            AnimationMode = ONCE
            AnimationPriority = 2
        End
        StateName = Idle
        BeginScript
            Prev = CurDrawablePrevAnimationState()
        EndScript
    End

    AnimationState = JUST_BUILT PASSENGER_VARIATION_1
        Animation = built
            AnimationName        = IUUrukahi_UDBL
            AnimationMode        = ONCE
            AnimationBlendTime    = 0
        End
    End

    AnimationState = JUST_BUILT PASSENGER_VARIATION_2
        Animation = built
            AnimationName        = IUUrukahi_UDBR
            AnimationMode        = ONCE
            AnimationBlendTime    = 0
        End
    End

    AnimationState = DYING
        Animation = DIEA
            AnimationName = IUUrukahi_BDIA
            AnimationMode = ONCE
            AnimationSpeedFactorRange    =    0.7 1.4
        End
        Animation = DIEB
            AnimationName = IUUrukahi_BDIB
            AnimationMode = ONCE
            AnimationSpeedFactorRange    =    0.7 1.4
        End
        Animation = DIEC
            AnimationName = IUUrukahi_BDIC
            AnimationMode = ONCE
            AnimationSpeedFactorRange    =    0.7 1.4
        End
    End




    AnimationState = FIRING_OR_PREATTACK_A PASSENGER PASSENGER_VARIATION_1
        Animation = grasping_siege_lefthanded
            AnimationName =  IUUrukahi_BATB
            AnimationMode = ONCE

        End
    End

    AnimationState = FIRING_OR_PREATTACK_A PASSENGER PASSENGER_VARIATION_2
        Animation = grasping_siege_righthanded
            AnimationName = IUUrukahi_BATA
            AnimationMode = ONCE

        End
    End

    AnimationState = FIRING_OR_PREATTACK_B PASSENGER PASSENGER_VARIATION_1
        Animation = grasping_siege_lefthanded
            AnimationName =  IUUrukahi_BATB
            AnimationMode = ONCE

        End
    End
    AnimationState = FIRING_OR_PREATTACK_B PASSENGER PASSENGER_VARIATION_2
        Animation = grasping_siege_righthanded
            AnimationName = IUUrukahi_BATA
            AnimationMode = ONCE

        End
    End

    AnimationState = FIRING_OR_PREATTACK_C PASSENGER PASSENGER_VARIATION_1
        Animation = grasping_siege_lefthanded
            AnimationName =  IUUrukahi_BATB
            AnimationMode = ONCE

        End
    End
    AnimationState = FIRING_OR_PREATTACK_C PASSENGER PASSENGER_VARIATION_2
        Animation = grasping_siege_righthanded
            AnimationName = IUUrukahi_BATA
            AnimationMode = ONCE

        End
    End




    AnimationState = MOVING BACKING_UP PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRND
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End
    AnimationState = MOVING BACKING_UP PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNC
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End


    AnimationState = MOVING TURN_LEFT TURN_LEFT_HIGH_SPEED PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRNB
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.6 0.6
        End
    End
    AnimationState = MOVING TURN_LEFT TURN_LEFT_HIGH_SPEED PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNA
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.8 0.8
        End
    End

    AnimationState = MOVING TURN_RIGHT TURN_RIGHT_HIGH_SPEED PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRNB
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.8 0.8
        End
    End
    AnimationState = MOVING TURN_RIGHT TURN_RIGHT_HIGH_SPEED PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNA
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.6 0.6
        End
    End


    AnimationState = MOVING TURN_LEFT PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRND
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.4 0.4
        End
    End
    AnimationState = MOVING TURN_LEFT PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNA
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End

    AnimationState = MOVING TURN_RIGHT PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRNB
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End
    AnimationState = MOVING TURN_RIGHT PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNC
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.4 0.4
        End
    End


    AnimationState = MOVING PASSENGER PASSENGER_VARIATION_1
        Animation = moving_siege_lefthanded
            AnimationName =  IUUrukahi_BRNB
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End
    AnimationState = MOVING PASSENGER PASSENGER_VARIATION_2
        Animation = moving_siege_righthanded
            AnimationName = IUUrukahi_BRNA
            AnimationMode = LOOP
            AnimationSpeedFactorRange    =    0.7 0.7
        End
    End




    AnimationState = PASSENGER PASSENGER_VARIATION_1
        Animation = idle_siege_lefthanded
            AnimationName =  IUUrukahi_BIDB
            AnimationMode = LOOP
        End
    End
    AnimationState = PASSENGER PASSENGER_VARIATION_2
        Animation = idle_siege_righthanded
            AnimationName = IUUrukahi_BIDA
            AnimationMode = LOOP
        End
    End
  End

    #include "..\..\..\includes\StunDrawModuleLarge.inc"


    Side = Men
    EditorSorting = UNIT

    ThreatLevel = ISENGARD_BATTERINGRAM_THREAT_LEVEL
    ThreatBreakdown IsengardBatteringRam_DetailedThreat
        AIKindOf = SIEGEWEAPON
    End

    ThingClass = HORDE_UNIT
    EmotionRange = 240
    CommandPoints      = 0
    TransportSlotCount = TRANSPORTSLOTCOUNT_SIEGE

    VisionRange = VISION_STANDARD_MELEE
    ShroudClearingRange = SHROUD_CLEAR_MACHINE

    BuildFadeInOnCreateTime = 2.5

    BountyValue = ISENGARD_URUKFIGHTER_BOUNTY_VALUE
    DisplayName = OBJECT:GondorFighter
    CrushableLevel = 0
    CrusherLevel = 0
    CrushRevengeWeapon = BasicInfantryCrushRevenge

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    IsengardBannerSword
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    ArmorSet
        Conditions      = None
        Armor           = BatteringRamArmor
        DamageFX        = NormalDamageFX
    End




    VoiceAttack                    = GondorSoldierVoiceAttack
    VoiceAttackCharge                = GondorSoldierVoiceAttackCharge
    VoiceAttackMachine            = GondorSoldierVoiceAttack
    VoiceAttackStructure            = GondorSoldierVoiceAttackBuilding
    VoiceEnterStateAttack            = GondorSoldierVoiceEnterStateAttack
    VoiceEnterStateAttackCharge        = GondorSoldierVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine        = GondorSoldierVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure    = GondorSoldierVoiceEnterStateAttackBuilding
    VoiceCreated                = GondorSoldierVoiceSalute
    VoiceFullyCreated             = GondorSoldierVoiceSalute
    VoiceGuard                    = GondorSoldierVoiceMove
    VoiceMove                    = GondorSoldierVoiceMove
    VoiceMoveToCamp                = GondorSoldierVoiceMoveCamp
    VoiceMoveWhileAttacking            = GondorSoldierVoiceDisengage
    VoicePriority                = 49
    VoiceRetreatToCastle            = GondorSoldierVoiceRetreat
    VoiceSelect                    = GondorSoldierVoiceSelectMS
    VoiceSelectBattle             = GondorSoldierVoiceSelectBattle
    VoiceEnterStateMove            = GondorSoldierVoiceEnterStateMove
    VoiceEnterStateMoveToCamp        = GondorSoldierVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking    = GondorSoldierVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle    = GondorSoldierVoiceEnterStateRetreat

    SoundImpact                    = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                            = GondorSoldierVoiceGarrison
        VoiceDesperateAttack                        = GondorSoldierVoiceDesperateCharge
        VoiceAttackUnitWebbedHumanoidWithGondorFighterInside    = GondorSoldierVoiceAttackWebbedSoldier
        VoiceAttackUnitWebbedHumanoidWithGondorArcherInside    = GondorSoldierVoiceAttackWebbedSoldier
        VoiceEnterUnitElvenTransportShip    = GondorSoldierVoiceMove
        VoiceInitiateCaptureBuilding        = GondorSoldierVoiceMove
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_BRNA        Frames:0 10
        AnimationSound = Sound:BatteringRamGroupFootstep        Animation:IUUrukahi_SKL.IUUrukahi_BRNA        Frames:1 11
        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_BRNB        Frames:0 10
        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_BRNC        Frames:0 10
        AnimationSound = Sound:BatteringRamGroupFootstep        Animation:IUUrukahi_SKL.IUUrukahi_BRNC        Frames:1 11
        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_BRND        Frames:0 10

        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_UDBL        Frames:4 14 24 34 42 54 67
        AnimationSound = Sound:BatteringRamGroupFootstep        Animation:IUUrukahi_SKL.IUUrukahi_UDBL        Frames:5 15 25 35 43 55 68
        AnimationSound = Sound:BatteringRamFootstepDirtALoose        Animation:IUUrukahi_SKL.IUUrukahi_UDBR        Frames:4 14 24 34 42 54 67

        AnimationSound = Sound:BodyFallGeneric1                Animation:IUUrukahi_SKL.IUUrukahi_BDIA        Frames:37
        AnimationSound = Sound:BodyFallGeneric1                Animation:IUUrukahi_SKL.IUUrukahi_BDIB        Frames:59
        AnimationSound = Sound:BodyFallGeneric1                Animation:IUUrukahi_SKL.IUUrukahi_BDIC        Frames:67
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER WORKING_PASSENGER HEAVY_MELEE_HITTER

    Body = ActiveBody ModuleTag_02
        MaxHealth             = ISENGARD_URUKFIGHTER_HEALTH
        MaxHealthDamaged      = ISENGARD_URUKFIGHTER_HEALTH_DAMAGED
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList               = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        AttackPriority               = AttackPriority_Infantry
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_FAST_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 1.50
        DestructionDelay = 10000
        Sound = INITIAL UrukVoiceDie
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 5
    GeometryMinorRadius = 5
    GeometryHeight = 5
    GeometryIsSmall = Yes

    Shadow = SHADOW_DECAL
    ShadowSizeX = 21
    ShadowSizeY = 21
    ShadowTexture = ShadowI
End


Object MenBatteringRam


    ButtonImage          = BISiegeWorks_BatteringRam
    SelectPortrait       = UPIsenguard_BatteringRam

    #include "..\..\..\includes\StunDrawModuleLarge.inc"

    Draw = W3DScriptedModelDraw ModuleTag_01

      StaticModelLODMode = Yes

        ExtraPublicBone = CREWBONE
        ExtraPublicBone = PASSENGER
        DependencySharedModelFlags = MOVING FIRING_OR_PREATTACK_A FIRING_OR_PREATTACK_B FIRING_OR_PREATTACK_C TURN_LEFT TURN_RIGHT BACKING_UP

        DefaultModelConditionState
            Model = IUBATTRRAM_SKN
            WeaponLaunchBone            =    PRIMARY CREWBONE07
            Skeleton = IUBATTRRAM_SKL
            WeaponFireFXBone    PRIMARY CREWBONE07
        End

        IdleAnimationState
            Animation = IDL
                AnimationName = IUBATTRRAM_IDLA
                AnimationMode = LOOP
            End
            StateName = Idle
        End

        AnimationState = MOVING
            Animation = Moving
                AnimationName = IUBATTRRAM_RUNA
                AnimationMode = LOOP
            End
            ParticleSysBone = None InfantryDustTrails
        End

        AnimationState = FIRING_OR_PREATTACK_A
            Animation = Attacking
                AnimationName = IUBATTRRAM_ATKA
                AnimationMode = ONCE

            End
        End

        AnimationState = FIRING_OR_PREATTACK_B
            Animation = Attacking
                AnimationName = IUBATTRRAM_ATKA
                AnimationMode = ONCE

            End
        End


        AnimationState = FIRING_OR_PREATTACK_C
            Animation = Attacking
                AnimationName = IUBATTRRAM_ATKA
                AnimationMode = ONCE

            End
        End


        AnimationState = DYING
            Animation = Dying
                AnimationName = IUBATTRRAM_DIEA
                AnimationMode = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUBATTRRAM_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState  = JUST_BUILT
            Animation = Being_Built
                AnimationName        = IUBattrRam_BLDA
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
            End
        End
    End


    Side                = Men
    IsTrainable        = No
    EditorSorting        = UNIT
    ThreatLevel            = 1.0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE
    TransportSlotCount    = TRANSPORTSLOTCOUNT_SIEGE

    ShroudClearingRange     = SHROUD_CLEAR_MACHINE
    VisionRange        = ISENGARD_BATTERINGRAM_VISION_RANGE

    BountyValue         = ISENGARD_BATTERINGRAM_BOUNTY_VALUE
    CrushableLevel        = 3
    DisplayName            = OBJECT:IsengardBatteringRam
    CommandSet            = GenericCommandSet
    CommandPoints      = DEFAULT_SIEGE_COMMANDPOINTS
    MaxSimultaneousOfType  = NEW_RAM_RATIO
    BuildCost             = ISENGARD_BATTERINGRAM_BUILDCOST
    BuildTime            = ELITE_BUILDTIME

    WeaponSet
        Conditions  = None
        Weapon        = PRIMARY    IsengardBatteringRam
        Weapon        = SECONDARY IsengardBatteringRamGate
        OnlyAgainst = SECONDARY BLOCKING_GATE
        Weapon      = TERTIARY  IsengardBatteringRamWall
        OnlyAgainst = TERTIARY  WALK_ON_TOP_OF_WALL
    End
    WeaponSet
        Conditions  = PASSENGER_TYPE_ONE
        Weapon        = PRIMARY IsengardBatteringRamWithMine
    End

    ArmorSet
        Conditions      = None
        Armor           = BatteringRamArmor
        DamageFX        = None
    End

    BuildFadeInOnCreateTime = 2.5




    VoiceAttack                    = GondorSoldierVoiceAttack
    VoiceAttackCharge                = GondorSoldierVoiceAttackCharge
    VoiceAttackMachine            = GondorSoldierVoiceAttack
    VoiceAttackStructure            = GondorSoldierVoiceAttackBuilding
    VoiceEnterStateAttack            = GondorSoldierVoiceEnterStateAttack
    VoiceEnterStateAttackCharge        = GondorSoldierVoiceEnterStateAttackCharge
    VoiceEnterStateAttackMachine        = GondorSoldierVoiceEnterStateAttackBuilding
    VoiceEnterStateAttackStructure    = GondorSoldierVoiceEnterStateAttackBuilding
    VoiceCreated                = GondorSoldierVoiceSalute
    VoiceFullyCreated             = GondorSoldierVoiceSalute
    VoiceGuard                    = GondorSoldierVoiceMove
    VoiceMove                    = GondorSoldierVoiceMove
    VoiceMoveToCamp                = GondorSoldierVoiceMoveCamp
    VoiceMoveWhileAttacking            = GondorSoldierVoiceDisengage
    VoicePriority                = 50
    VoiceRetreatToCastle            = GondorSoldierVoiceRetreat
    VoiceSelect                    = GondorSoldierVoiceSelectMS
    VoiceSelectBattle             = GondorSoldierVoiceSelectBattle
    VoiceEnterStateMove            = GondorSoldierVoiceEnterStateMove
    VoiceEnterStateMoveToCamp        = GondorSoldierVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking    = GondorSoldierVoiceEnterStateDisengage
    VoiceEnterStateRetreatToCastle    = GondorSoldierVoiceEnterStateRetreat

    SoundImpact                    = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                            = GondorSoldierVoiceGarrison
        VoiceDesperateAttack                        = GondorSoldierVoiceDesperateCharge
        VoiceAttackUnitWebbedHumanoidWithGondorFighterInside    = GondorSoldierVoiceAttackWebbedSoldier
        VoiceAttackUnitWebbedHumanoidWithGondorArcherInside    = GondorSoldierVoiceAttackWebbedSoldier
        VoiceEnterUnitElvenTransportShip    = GondorSoldierVoiceMove
        VoiceInitiateCaptureBuilding        = GondorSoldierVoiceMove
    End

    SoundImpact                 = ImpactHorse

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior                    = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = SiegeWeapon BatteringRam
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MACHINE SCORE CAN_ATTACK PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS HEAVY_MELEE_HITTER
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_SHORTISH

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = ISENGARD_BATTERINGRAM_HEALTH
        MaxHealthDamaged  = ISENGARD_BATTERINGRAM_HEALTH_DAMAGED
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 2500
    End

    Behavior = SiegeEngineContain ModuleTag_Contain
        ObjectStatusOfCrew        = UNSELECTABLE UNATTACKABLE
        Slots                    = 1
        DamagePercentToUnits    = 100%
        PassengerFilter            = NONE +CAN_RIDE_BATTERING_RAM
        KillPassengersOnDeath    = Yes
        AllowAlliesInside        = Yes
        AllowEnemiesInside        = No
        AllowNeutralInside        = No
        CrewFilter                = NONE +INFANTRY -CAN_RIDE_BATTERING_RAM
        CrewMax                    = 6
        InitialCrew                = MenRamCrew 6
        ExitDelay                = 500
        NumberOfExitPaths        = 0
        GoAggressiveOnExit        = Yes
        TypeOneForWeaponSet        = CAN_RIDE_BATTERING_RAM
        EjectPassengersOnDeath    = Yes
        ShowPips                = No

        PassengerBonePrefix = PassengerBone:CREWBONE    KindOf:INFANTRY
        BoneSpecificConditionState 1 PASSENGER_VARIATION_1
        BoneSpecificConditionState 4 PASSENGER_VARIATION_1
        BoneSpecificConditionState 6 PASSENGER_VARIATION_1
        BoneSpecificConditionState 2 PASSENGER_VARIATION_2
        BoneSpecificConditionState 3 PASSENGER_VARIATION_2
        BoneSpecificConditionState 5 PASSENGER_VARIATION_2
    End

    LocomotorSet
        Locomotor     = BatteringRamLocomotor
        Condition     = SET_NORMAL
        Speed         = 32
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 2.00
        DestructionDelay = 9000
        Sound = INITIAL UrukVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 12
    GeometryIsSmall = No
    Shadow = SHADOW_VOLUME
End




Object GondorBatteringRam


    SelectPortrait = UPGondorBatteringRam
    ButtonImage    = HSGondorBatteringRam

    Draw = W3DTruckDraw ModuleTag_DRAW

        WadingParticleSys = EntRipples

        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        DefaultModelConditionState
            Model               = gubatram_skna
            WeaponLaunchBone    = PRIMARY CREWBONE07
        End

        ModelConditionState     = DYING
            Model               = gubatram_diec
            WeaponLaunchBone    = PRIMARY CREWBONE07
        End



    IdleAnimationState
      StateName           = Stand
      Animation = IDLES
        AnimationName     = gubatram_skl.gubatram_idla
        AnimationMode       = ONCE
        AnimationBlendTime  = 15
      End
      Animation = IDLES
        AnimationName     = gubatram_skl.gubatram_idlb
        AnimationMode       = ONCE
        AnimationBlendTime  = 2
      End
    End

    ModelConditionState = JUST_BUILT
        Model               = gubatram_b
    End

    AnimationState      = JUST_BUILT
        Animation         = gubatram_b
            AnimationName   = gubatram_b.gubatram_b
            AnimationMode   = ONCE
            AnimationBlendTime = 0
            AnimationSpeedFactorRange = 1.6 1.6
        End
        StateName           = JUST_BUILT
    End


        AnimationState      = DYING DEATH_1
            Animation         = gubatram_diec
                AnimationName   = gubatram_diec.gubatram_diec
                AnimationMode   = ONCE
            End
        End

        AnimationState      = DYING
            Animation         = gubatram_diec
                AnimationName   = gubatram_diec.gubatram_diec
                AnimationMode   = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = gubatram_skl.gubatram_idla
                AnimationMode                = LOOP
            End
        End



    TransitionState       = Trans_Attack_To_MoveLeft
        Animation           = MoveLeft
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = ONCE
           AnimationBlendTime = 30
        End
    End

    AnimationState        = TURN_LEFT
        StateName           = TurningLeft
        Animation           = TurnLeft
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = LOOP
           AnimationBlendTime = 5
        End
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            elseif Prev == "Attacking"
            then
                if CurDrawablePrevAnimFraction() > .10
                then
                    CurDrawableSetTransitionAnimState("Trans_Attack_To_MoveLeft")
                end
            end
        EndScript
    End

    TransitionState       = Trans_Attack_To_MoveRight
        Animation           = MoveRight
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = ONCE
           AnimationBlendTime = 30
        End
    End


    AnimationState        = TURN_RIGHT
        StateName           = TurningRight
        Animation           = MoveRight
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = LOOP
           AnimationBlendTime = 5
        End
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            elseif Prev == "Attacking"
            then
                if CurDrawablePrevAnimFraction() > .10
                then
                    CurDrawableSetTransitionAnimState("Trans_Attack_To_MoveRight")
                end
            end
        EndScript
    End


    TransitionState       = Trans_Attack_To_Move
        Animation           = GUSiegTreb_BLDA
            AnimationName     = gubatram_skl.gubatram_mova
            AnimationMode     = ONCE
            AnimationBlendTime= 30
        End
    End

    AnimationState        = MOVING
      Animation = Move
        AnimationName           = gubatram_skl.gubatram_mova
        AnimationMode       = LOOP
        Distance = 20
      End
      BeginScript
        Prev = CurDrawablePrevAnimationState()

        if Prev == "Attacking"
        then
            if CurDrawablePrevAnimFraction() > .10
            then
                CurDrawableSetTransitionAnimState("Trans_Attack_To_Move")
            end
      EndScript
    End


        AnimationState = FIRING_OR_PREATTACK_A
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End

        AnimationState = FIRING_OR_PREATTACK_B
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End

        AnimationState = FIRING_OR_PREATTACK_C
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End



    AnimationState = HIT_REACTION HIT_LEVEL_1
        Animation = Hit_Level_1_a
            AnimationName = gubatram_skl.gubatram_hita
            AnimationMode = ONCE
        End
    End


    TrackMarks          = EXTireTrack2_Temp.tga
    TrackMarksLeftBone  = WHEELL03
    TrackMarksRightBone = WHEELR03

    LeftFrontTireBone           = WHEELL03
    RightFrontTireBone          = WHEELR03
    LeftRearTireBone            = WHEELL02
    RightRearTireBone           = WHEELR02
    LeftRearTireBone2           = WHEELL01
    RightRearTireBone2          = WHEELR01
    TireRotationMultiplier      = 0.2
    PowerslideRotationAddition  = 2.5
    ParticlesAttachedToAnimatedBones = Yes
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone     = WheelL03 FootstepSlash
            ParticleSysBone     = WheelR03 FootstepSlash
        End
        AnimationState        = TURN_RIGHT
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
        AnimationState        = TURN_LEFT
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
        AnimationState = MOVING
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
    End

    #include "..\..\..\includes\StunDrawModuleLarge.inc"



    Side             = Men
    EditorSorting    = UNIT

    ThreatLevel      = GONDOR_TREBUCHET_THREAT_LEVEL
    ThreatBreakdown GondorTrebuchet_DetailedThreat
        AIKindOf     = SIEGEWEAPON
    End

    ThingClass             = MACHINE
    TransportSlotCount     = TRANSPORTSLOTCOUNT_SIEGE
    BountyValue            = 75

    WeaponSet
        Conditions      = None
        Weapon          = PRIMARY   GondorBatteringRam
        Weapon          = SECONDARY GondorBatteringRamGate
        OnlyAgainst     = SECONDARY BLOCKING_GATE
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainGondorRamArmor
        DamageFX        = None
    End

    VisionRange               = 200
    ShroudClearingRange       = 475
    VisionSide                = 50%
    VisionRear                = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    DisplayName             = OBJECT:GondorBatteringRam
    CrushableLevel          = 2
    ShockwaveResistance     = SHOCKWAVE_RESISTANCE_IMMUNE
    BuildFadeInOnCreateTime = 4.4

    CommandPoints      = DEFAULT_SIEGE_COMMANDPOINTS
    MaxSimultaneousOfType  = NEW_RAM_RATIO
    CommandSet              = GondorBatteringRamCommandSet


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_MordorAttackTrollBody

    AutoResolveArmor
        Armor = AutoResolve_MordorAttackTrollArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorAttackTrollWeapon
    End




    VoiceAttack                       = GondorBatteringRamVoiceAttack
    VoiceCreated                      = GondorBatteringRamVoiceSalute
    VoiceMove                         = GondorBatteringRamVoiceMove
    VoiceMoveToCamp                   = GondorBatteringRamVoiceMoveCamp
    VoiceMoveWhileAttacking           = GondorBatteringRamVoiceDisengage
    VoicePriority                     = 55
    VoiceSelect                       = GondorBatteringRamVoiceSelectMS
    VoiceSelectBattle                 = GondorBatteringRamVoiceSelectBattle
    VoiceEnterStateAttack             = GondorBatteringRamVoiceEnterStateAttack
    VoiceEnterStateMove               = GondorBatteringRamVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = GondorBatteringRamVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking = GondorBatteringRamVoiceEnterStateDisengage
    VoiceCombineWithHorde             = GondorBatteringRamVoiceJoinDefend
    VoiceGuard                        = GondorBatteringRamVoiceMove

    SoundImpact                       = ImpactHorse
    SoundMoveLoop                     = TrebuchetMoveLoop
    SoundMoveStart                    = TrebuchetMoveStart
    SoundOnDamaged                    = UnitDamageWoodLight
    SoundOnReallyDamaged              = UnitDamageWoodHeavy
    SoundAmbientReallyDamaged         = UnitDamageFireSmallLoop

    CrowdResponseKey = GoodMen

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip    = GondorBatteringRamVoiceMove
        VoiceGarrison                       = GondorBatteringRamVoiceMove
        VoiceInitiateCaptureBuilding        = GondorBatteringRamVoiceMove
    End

        #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TrebuchetLaunchVoice            Animation:gubatram_skl.gubatram_atka Frames: 24
        AnimationSound = Sound:BatteringRamFootstepDirtALoose  Animation:gubatram_skl.gubatram_mova Frames:0 10 20 30 40 50 60
        AnimationSound = Sound:BatteringRamGroupFootstep       Animation:gubatram_skl.gubatram_mova Frames:1 11 22 33 44 55
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male SiegeWeapon Unit Trebuchet
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MACHINE SCORE CAN_ATTACK CAN_ATTACK_WALLS ARMY_SUMMARY SIEGEENGINE
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_SHORTISH

    BuildCost = 500
    BuildTime = STRONG_BUILDTIME

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = ISENGARD_BATTERINGRAM_HEALTH
        MaxHealthDamaged  = ISENGARD_BATTERINGRAM_HEALTH_DAMAGED
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Artillery
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList            = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        AttackPriority             = AttackPriority_Infantry
    End

    LocomotorSet
        Locomotor = GondorBatteringRamLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_SIEGE_MED_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes       = NONE +EXPLODED +BURNED
        SinkDelay        = 0
        SinkRate         = 1.0
        DestructionDelay = 23000
        Sound            = INITIAL TrebuchetDie
    End

    Behavior = SlowDeathBehavior ModuleTag_067
        DeathTypes       = ALL -EXPLODED -BURNED
        SinkDelay        = 0
        SinkRate         = 1.0
        DestructionDelay = 23000
        Sound            = INITIAL TrebuchetDie
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = SquishCollide ModuleTag_07
    End

    Behavior = TransitionDamageFX ModuleTag_8
        DamagedFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
        ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:FireBuildingLarge
        ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
        RubbleParticleSystem1 = Bone:None RandomBone:No PSys:FireBuildingLarge
        RubbleFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
    End

    Behavior = CreateObjectDie ModuleTagOCLDie
        DebrisPortionOfSelf = GondorTrebuchetDebrisPiece
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2000
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10
        HitReactionThreshold1 = 10.0
        HitReactionThreshold2 = 25000.0
        HitReactionThreshold3 = 50000.0
    End

    Behavior = SubObjectsUpgrade ModuleTag_HideAll
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects    = BANNER01 BANNER02
    End

    Behavior = SpecialPowerModule ModuleTag_LeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = No
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    AutoResolveUnitType     = AutoResolveUnit_Siege
    AutoResolveCombatChain  = AutoResolve_SiegeCombatChain
    AutoResolveBody         = AutoResolve_IsengardBallistaBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardBallistaArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardBallistaWeapon
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
    Shadow = SHADOW_VOLUME
End

Object ArnorBatteringRam

    SelectPortrait = UPArnorBatteringRam
    ButtonImage    = HSArnorBatteringRam

    Draw = W3DTruckDraw ModuleTag_DRAW

        WadingParticleSys    = EntRipples
        OkToChangeModelColor = Yes
        StaticModelLODMode   = Yes

        RandomTexture = gubatram02_arnor.tga 0 gubatram02.tga
        RandomTexture = guarnorsoldat.tga 0 gunumnrean.tga


        DefaultModelConditionState
            Model               = gubatram_sknc
            WeaponLaunchBone    = PRIMARY CREWBONE07
        End

        ModelConditionState     = DYING
            Model               = gubatram_died
            WeaponLaunchBone    = PRIMARY CREWBONE07
        End



    IdleAnimationState
      StateName           = Stand
      Animation = IDLES
        AnimationName     = gubatram_skl.gubatram_idla
        AnimationMode       = ONCE
        AnimationBlendTime  = 15
      End
      Animation = IDLES
        AnimationName     = gubatram_skl.gubatram_idlb
        AnimationMode       = ONCE
        AnimationBlendTime  = 2
      End
    End

    ModelConditionState = JUST_BUILT
        Model               = gubatram_b
    End

    AnimationState      = JUST_BUILT
        Animation         = gubatram_b
            AnimationName   = gubatram_b.gubatram_b
            AnimationMode   = ONCE
            AnimationBlendTime = 0
            AnimationSpeedFactorRange = 1.6 1.6
        End
        StateName           = JUST_BUILT
    End


        AnimationState      = DYING DEATH_1
            Animation         = gubatram_died
                AnimationName   = gubatram_died.gubatram_died
                AnimationMode   = ONCE
            End
        End

        AnimationState      = DYING
            Animation         = gubatram_died
                AnimationName   = gubatram_died.gubatram_died
                AnimationMode   = ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = gubatram_skl.gubatram_idla
                AnimationMode                = LOOP
            End
        End



    TransitionState       = Trans_Attack_To_MoveLeft
        Animation           = MoveLeft
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = ONCE
           AnimationBlendTime = 30
        End
    End

    AnimationState        = TURN_LEFT
        StateName           = TurningLeft
        Animation           = TurnLeft
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = LOOP
           AnimationBlendTime = 5
        End
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            elseif Prev == "Attacking"
            then
                if CurDrawablePrevAnimFraction() > .10
                then
                    CurDrawableSetTransitionAnimState("Trans_Attack_To_MoveLeft")
                end
            end
        EndScript
    End

    TransitionState       = Trans_Attack_To_MoveRight
        Animation           = MoveRight
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = ONCE
           AnimationBlendTime = 30
        End
    End


    AnimationState        = TURN_RIGHT
        StateName           = TurningRight
        Animation           = MoveRight
           AnimationName      = gubatram_skl.gubatram_mova
           AnimationMode      = LOOP
           AnimationBlendTime = 5
        End
        BeginScript
            Prev = CurDrawablePrevAnimationState()
            elseif Prev == "Attacking"
            then
                if CurDrawablePrevAnimFraction() > .10
                then
                    CurDrawableSetTransitionAnimState("Trans_Attack_To_MoveRight")
                end
            end
        EndScript
    End


    TransitionState       = Trans_Attack_To_Move
        Animation           = GUSiegTreb_BLDA
            AnimationName     = gubatram_skl.gubatram_mova
            AnimationMode     = ONCE
            AnimationBlendTime= 30

        End
    End

    AnimationState        = MOVING
      Animation = Move
        AnimationName           = gubatram_skl.gubatram_mova
        AnimationMode       = LOOP
        Distance = 20
      End
      BeginScript
        Prev = CurDrawablePrevAnimationState()

        if Prev == "Attacking"
        then
            if CurDrawablePrevAnimFraction() > .10
            then
                CurDrawableSetTransitionAnimState("Trans_Attack_To_Move")
            end
      EndScript
    End


        AnimationState = FIRING_OR_PREATTACK_A
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End

        AnimationState = FIRING_OR_PREATTACK_B
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End

        AnimationState = FIRING_OR_PREATTACK_C
            Animation = Attacking
                AnimationName = gubatram_skl.gubatram_atka
                AnimationMode = ONCE
            End
        End



    AnimationState = HIT_REACTION HIT_LEVEL_1
        Animation = Hit_Level_1_a
            AnimationName = gubatram_skl.gubatram_hita
            AnimationMode = ONCE
        End
    End

    TrackMarks          = EXTireTrack2_Temp.tga
    TrackMarksLeftBone  = WHEELL03
    TrackMarksRightBone = WHEELR03

    LeftFrontTireBone           = WHEELL03
    RightFrontTireBone          = WHEELR03
    LeftRearTireBone            = WHEELL02
    RightRearTireBone           = WHEELR02
    LeftRearTireBone2           = WHEELL01
    RightRearTireBone2          = WHEELR01
    TireRotationMultiplier      = 0.2
    PowerslideRotationAddition  = 2.5
    ParticlesAttachedToAnimatedBones = Yes
    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone     = WheelL03 FootstepSlash
            ParticleSysBone     = WheelR03 FootstepSlash
        End
        AnimationState        = TURN_RIGHT
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
        AnimationState        = TURN_LEFT
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
        AnimationState = MOVING
            ParticleSysBone     = WheelL03 GenericSiegeTrailDust
            ParticleSysBone     = WheelR03 GenericSiegeTrailDust
        End
    End

    #include "..\..\..\includes\StunDrawModuleLarge.inc"




    Side             = Arnor
    EditorSorting    = UNIT

    ThreatLevel      = GONDOR_TREBUCHET_THREAT_LEVEL
    ThreatBreakdown GondorTrebuchet_DetailedThreat
        AIKindOf     = SIEGEWEAPON
    End

    ThingClass             = MACHINE
    TransportSlotCount     = TRANSPORTSLOTCOUNT_SIEGE
    BountyValue            = ISENGARD_BATTERINGRAM_BOUNTY_VALUE

    WeaponSet
        Conditions      = None
        Weapon          = PRIMARY   GondorBatteringRam
        Weapon          = SECONDARY GondorBatteringRamGate
        OnlyAgainst     = SECONDARY BLOCKING_GATE
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainGondorRamArmor
        DamageFX        = None
    End

    VisionRange               = SIEGE_ENGINE_VISION_RANGE
    ShroudClearingRange       = SIEGE_ENGINE_SHROUD_CLEARING
    VisionSide                = SIEGE_ENGINE_VISION_SIDE
    VisionRear                = SIEGE_ENGINE_VISION_REAR
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = SIEGE_ENGINE_VISION_BONUS_TEST_RADIUS
    VisionBonusPercentPerFoot = SIEGE_ENGINE_VISION_BONUS_PERCENT

    DisplayName             = OBJECT:ArnorBatteringRam
    CrushableLevel          = 2
    ShockwaveResistance     = SHOCKWAVE_RESISTANCE_IMMUNE
    BuildFadeInOnCreateTime = 4.4
    CommandPoints      = DEFAULT_SIEGE_COMMANDPOINTS
    MaxSimultaneousOfType   = NEW_RAM_RATIO
    CommandSet              = ArnorBatteringRamCommandSet



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_MordorAttackTrollBody

    AutoResolveArmor
        Armor = AutoResolve_MordorAttackTrollArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorAttackTrollWeapon
    End




    VoiceAttack                       = GondorBatteringRamVoiceAttack
    VoiceCreated                      = GondorBatteringRamVoiceSalute
    VoiceMove                         = GondorBatteringRamVoiceMove
    VoiceMoveToCamp                   = GondorBatteringRamVoiceMoveCamp
    VoiceMoveWhileAttacking           = GondorBatteringRamVoiceDisengage
    VoicePriority                     = 55
    VoiceSelect                       = GondorBatteringRamVoiceSelectMS
    VoiceSelectBattle                 = GondorBatteringRamVoiceSelectBattle
    VoiceEnterStateAttack             = GondorBatteringRamVoiceEnterStateAttack
    VoiceEnterStateMove               = GondorBatteringRamVoiceEnterStateMove
    VoiceEnterStateMoveToCamp         = GondorBatteringRamVoiceEnterStateMoveCamp
    VoiceEnterStateMoveWhileAttacking = GondorBatteringRamVoiceEnterStateDisengage
    VoiceCombineWithHorde             = GondorBatteringRamVoiceJoinDefend
    VoiceGuard                        = GondorBatteringRamVoiceMove

    SoundImpact                       = ImpactHorse
    SoundMoveLoop                     = TrebuchetMoveLoop
    SoundMoveStart                    = TrebuchetMoveStart
    SoundOnDamaged                    = UnitDamageWoodLight
    SoundOnReallyDamaged              = UnitDamageWoodHeavy
    SoundAmbientReallyDamaged         = UnitDamageFireSmallLoop

    CrowdResponseKey = GoodMen

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip    = GondorBatteringRamVoiceMove
        VoiceGarrison                       = GondorBatteringRamVoiceMove
        VoiceInitiateCaptureBuilding        = GondorBatteringRamVoiceMove
    End

        #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:TrebuchetLaunchVoice            Animation:gubatram_skl.gubatram_atka Frames: 24
        AnimationSound = Sound:BatteringRamFootstepDirtALoose  Animation:gubatram_skl.gubatram_mova Frames:0 10 20 30 40 50 60
        AnimationSound = Sound:BatteringRamGroupFootstep       Animation:gubatram_skl.gubatram_mova Frames:1 11 22 33 44 55
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male SiegeWeapon Unit Trebuchet
        UnitWeight = 2
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MACHINE SCORE CAN_ATTACK CAN_ATTACK_WALLS ARMY_SUMMARY SIEGEENGINE
    CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_SHORTISH

    BuildCost = 500
    BuildTime = STRONG_BUILDTIME

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = ISENGARD_BATTERINGRAM_HEALTH
        MaxHealthDamaged  = ISENGARD_BATTERINGRAM_HEALTH_DAMAGED
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Artillery
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList            = IsengardFighterFunctions
        MoodAttackCheckRate        = 500
        AttackPriority             = AttackPriority_Infantry
    End

    LocomotorSet
        Locomotor = GondorBatteringRamLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_SIEGE_MED_MEMBER_SPEED
    End

    Behavior = PhysicsBehavior ModuleTag_04
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes       = NONE +EXPLODED +BURNED
        SinkDelay        = 0
        SinkRate         = 1.0
        DestructionDelay = 23000
        Sound            = INITIAL TrebuchetDie
    End

    Behavior = SlowDeathBehavior ModuleTag_067
        DeathTypes       = ALL -EXPLODED -BURNED
        SinkDelay        = 0
        SinkRate         = 1.0
        DestructionDelay = 23000
        Sound            = INITIAL TrebuchetDie
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = SquishCollide ModuleTag_07

    End

    Behavior = TransitionDamageFX ModuleTag_8
        DamagedFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
        ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:FireBuildingLarge
        ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
        RubbleParticleSystem1 = Bone:None RandomBone:No PSys:FireBuildingLarge
        RubbleFXList1 = Loc: X:0 Y:0 Z:5 FXList:FX_TrebDamage
    End


    Behavior = CreateObjectDie ModuleTagOCLDie
        DebrisPortionOfSelf = GondorTrebuchetDebrisPiece
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2000
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10
        HitReactionThreshold1 = 10.0
        HitReactionThreshold2 = 25000.0
        HitReactionThreshold3 = 50000.0
    End


    Behavior = SubObjectsUpgrade ModuleTag_HideAll
        TriggeredBy       = Upgrade_ObjectLevel1
        HideSubObjects    = BANNER01 BANNER02
    End

    Behavior = SpecialPowerModule ModuleTag_LeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = No
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    AutoResolveUnitType     = AutoResolveUnit_Siege
    AutoResolveCombatChain  = AutoResolve_SiegeCombatChain
    AutoResolveBody         = AutoResolve_IsengardBallistaBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardBallistaArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardBallistaWeapon
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
    Shadow = SHADOW_VOLUME
End

ChildObject GondorBatteringRam_Boromir GondorBatteringRam
    MaxSimultaneousOfType   = 10
End

ChildObject ArnorBatteringRam_AI ArnorBatteringRam

    EquivalentTo   = ArnorBatteringRam
    CommandPoints  = DEFAULT_SIEGE_COMMANDPOINTS_AI
End

ChildObject GondorBatteringRam_AI GondorBatteringRam

    EquivalentTo   = GondorBatteringRam
    CommandPoints  = DEFAULT_SIEGE_COMMANDPOINTS_AI
End