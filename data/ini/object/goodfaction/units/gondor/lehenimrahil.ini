Object GondorImrahil

    SelectPortrait = HPImrahil
    ButtonImage    = HIImrahil

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

      OkToChangeModelColor = No
      
        ExtraPublicBone = PASSENGERBONE
              DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP
            
        RandomTexture = gudolhorse1.tga  0 gudolhorse.tga

        DefaultModelConditionState
            Model            = guimrah_skn ;guirahil_skn
            WeaponLaunchBone = PRIMARY SPEAR
            WeaponLaunchBone = SECONDARY SPEAR 
            WeaponLaunchBone = TERTIARY SPEAR 
        End

        StaticModelLODMode = Yes
        

        ; --- Idle Anims
        IdleAnimationState
            StateName = STATE_Idle
            Animation = IDLB
                AnimationName        = RUEomer_SKL.RUEomer_IDLB
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLC
                AnimationName        = RUEomer_SKL.RUEomer_IDLC
                AnimationMode        = ONCE
                AnimationPriority    = 20
            End
            Animation = IDLD
                AnimationName        = RUEomer_SKL.RUEomer_IDLD
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLE
                AnimationName        = RUEomer_SKL.RUEomer_IDLE
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected"    then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
            EndScript
        End

       ;;;;;;;;;;; MOUNTED STATE ;;;;;;;;;;;;;;;
        ModelConditionState            = MOUNTED
            Model    =    guimrahor_skn
        End

        ;; SPECIAL SPEAR THROW ANIMS
        AnimationState        =  SPECIAL_WEAPON_ONE MOUNTED;using spear
            Animation           = SPRA
                AnimationName     = RUHHs_Theo_SKL.RUEomrHrs_SPRA  
                AnimationMode     = ONCE
            End
            FrameForPristineBonePositions = 60
        End

        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking_throw
            Animation
                AnimationName        = RUEomer_SKL.RUEomer_ATKE
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 58
        End

        ; --- stunned anims
        AnimationState                = FREEFALL MOUNTED
            Animation            = free fall
                AnimationName        = RURohrm_SKL.RURohrm_FLYB
                AnimationMode        = LOOP
                AnimationBlendTime    = 10
            End
        End

        AnimationState                = STUNNED_FLAILING MOUNTED
            Animation            = JustDie
                AnimationName        = RURohrm_SKL.RURohrm_FLYC
                AnimationMode        = LOOP
            End
        End

        AnimationState                = DYING DEATH_1 SPLATTED MOUNTED
            Animation            = splatted
                AnimationName        = RURohrm_SKL.RURohrm_LNDA
                AnimationMode        = ONCE
                AnimationBlendTime      =  2
            End
            FXEvent                = Frame:2 Name:FX_SplatDust
        End

        AnimationState                = DYING DEATH_1 MOUNTED
            Animation            = JustDie
                AnimationName        = RURohrm_SKL.RURohrm_DIEA
                AnimationMode        = ONCE
            End
        End
        
        AnimationState                = DYING DEATH_2 MOUNTED
            Animation            = FadeOut
                AnimationName        = RURohrm_SKL.RURohrm_IDLB
                AnimationMode        = ONCE
            End
        End
        
        AnimationState                = STUNNED_STANDING_UP MOUNTED
            Animation            = StandUp
                AnimationName        = RURohrm_SKL.RURohrm_GTPA
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        
        AnimationState                = STUNNED MOUNTED
            Animation            = Land
                AnimationName        = RURohrm_SKL.RURohrm_LNDA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = BURNINGDEATH MOUNTED
            Animation
                AnimationName        = RURohrm_SKL.RURohrm_MFDA
                AnimationMode        = LOOP
                Distance        = 100
            End
        End

        AnimationState                = PARALYZED MOUNTED
            Animation
                AnimationName        = RURohrm_SKL.RURohrm_IDLB
                AnimationMode        = LOOP
            End
        End

        AnimationState                = MOUNTED TURN_LEFT_HIGH_SPEED
            Animation            = TurnLeft
                AnimationName        = RURohrm_SKL.RURohrm_TNL1
                AnimationMode        = LOOP
                AnimationBlendTime    = 20
            End
        End
        
        AnimationState                = MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation            = TurnRight
                AnimationName        = RURohrm_SKL.RURohrm_TNR1
                AnimationMode        = LOOP
                AnimationBlendTime    = 20
            End
        End

        AnimationState                = MOVING TURN_LEFT MOUNTED 
            Animation            = TurnLeft
                AnimationName        = RURohrm_SKL.RURohrm_TRNL
                AnimationMode        = LOOP
            End
        End

        AnimationState                = MOVING TURN_RIGHT MOUNTED 
            Animation            = TurnRight
                AnimationName        = RURohrm_SKL.RURohrm_TRNR
                AnimationMode        = LOOP
            End
        End

        AnimationState                = MOVING ACCELERATE MOUNTED 
            Animation            = Accelerate
                AnimationName        = RURohrm_SKL.RURohrm_ACCL
                AnimationMode        = ONCE ; was LOOP
            End
        End

        AnimationState                = MOVING DECELERATE MOUNTED
            Animation            = Decelerate
                AnimationName        = RURohrm_SKL.RURohrm_DECL
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 0.55 0.55
            End
        End

        AnimationState                = MOVING WALKING MOUNTED
            Animation            = Walk1
                AnimationName        = RURohrm_SKL.RURohrm_WLKB
                AnimationMode        = LOOP
                Distance        = 25
            End
            Flags                = RANDOMSTART
        End

        AnimationState                = MOVING BACKING_UP MOUNTED
            Animation            = BACKING UP
                AnimationName        = RURohrm_SKL.RURohrm_BAKA
                AnimationMode        = LOOP
            End
        End

        AnimationState                    = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation            = Yes
            Animation            = TrotAndFire
                AnimationName        = RURohrm_SKL.RURohrm_ATRB
                AnimationMode        = LOOP
                Distance        = 70; 35
            End
            Flags                = RANDOMSTART
        End

        AnimationState                = MOVING MOUNTED
            Animation            = RunA
                AnimationName        = RURohrm_SKL.RURohrm_RUNA
                AnimationMode        = LOOP
                Distance        = 40
            End
            Flags                = RANDOMSTART
        End

        AnimationState                = FIRING_OR_PREATTACK_A MOUNTED
            Animation            = AttackA1
                AnimationName        = RURohrm_SKL.RURohrm_ATKA
                AnimationMode        = ONCE
            End
        End

        AnimationState                = RAISING_FLAG MOUNTED
            Animation            = CheerA
                AnimationName        = RURohrm_SKL.RURohrm_CHRA
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End

            Animation            = CheerB
                AnimationName        = RURohrm_SKL.RURohrm_CHRB
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End

            Animation            = CheerC
                AnimationName        = RURohrm_SKL.RURohrm_CHRC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End

            Animation            = CheerD
                AnimationName        = RURohrm_SKL.RURohrm_CHRD
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 0.9 1.1
            End

            Animation            = Salute
                AnimationName        = RURohrm_SKL.RURohrm_SLTA
                AnimationMode        = ONCE
            End
            Flags                = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                = EMOTION_CELEBRATING MOUNTED
            Animation            = CheerA
                AnimationName        = RURohrm_SKL.RURohrm_CHRA
                AnimationMode        = ONCE
            End
            Animation            = CheerB
                AnimationName        = RURohrm_SKL.RURohrm_CHRB
                AnimationMode        = ONCE
            End
            Animation            = CheerC
                AnimationName        = RURohrm_SKL.RURohrm_CHRC
                AnimationMode        = ONCE
            End
            Animation            = CheerD
                AnimationName        = RURohrm_SKL.RURohrm_CHRD
                AnimationMode        = ONCE
            End
            Animation            = Salute
                AnimationName        = RURohrm_SKL.RURohrm_SLTA
                AnimationMode        = ONCE
            End
            Flags                = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                = EMOTION_TAUNTING MOUNTED
            Animation            = Taunting
                AnimationName        = RURohrm_SKL.RURohrm_TNTA
                AnimationMode        = ONCE
            End
            Animation            = Taunting2
                AnimationName        = RURohrm_SKL.RURohrm_TNTB
                AnimationMode        = ONCE
            End
            Flags                = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        ;;======= POINTING
            
        AnimationState                    = EMOTION_POINTING MOUNTED
            Animation                    = Pointing1
                AnimationName            = RURohrm_SKL.RURohrm_PNTA
                AnimationMode            = LOOP
            End
        End
        
;;======== ALERT

        AnimationState                    = EMOTION_ALERT MOUNTED
            Animation                    = IDLA
                AnimationName            = RURohrm_SKL.RURohrm_IDLA
                AnimationMode            = LOOP
            End
        End

        AnimationState                = SELECTED MOUNTED
            StateName            = State_Selected
;            SimilarRestart            = Yes
            Animation            = AtAttention
                AnimationName        = RURohrm_SKL.RURohrm_IDLA
                AnimationMode        = LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then
                    CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected_Mounted")
            EndScript
        End

        TransitionState                = TRANS_Idle_to_Selected_Mounted
            Animation            = ATNA
                AnimationName        = RURohrm_SKL.RURohrm_ATNA
                AnimationMode        = ONCE
                AnimationSpeedFactorRange = 1.0 1.0
            End
        End

        TransitionState                = TRANS_Selected_to_Idle_Mounted
            Animation            = ATNC
                AnimationName        = RURohrm_SKL.RURohrm_ATNA
                AnimationMode        = ONCE_BACKWARDS
                AnimationSpeedFactorRange = 0.6 1.0
            End
            Flags                        = START_FRAME_LAST RESTART_ANIM_WHEN_COMPLETE
        End

         AnimationState                = MOUNTED
            ;StateName            = Idle
            Animation            
                AnimationName        = RURohrm_SKL.RURohrm_IDLB
                AnimationMode        = ONCE
                AnimationBlendTime    = 15
            End
            ;BeginScript
            ;    Prev = CurDrawablePrevAnimationState()
            ;    if Prev == "State_Selected" then
            ;        CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle_Mounted")
            ;    end
            ;EndScript
        End
        
        ;;;;;;;;;;; UNMOUNTED STATE ;;;;;;;;;;;;;
        ; --- Stunned anims
        AnimationState                =    STUNNED_FLAILING 
            Flags                    =    RANDOMSTART
            Animation                =    RUEomer_FLYA
                AnimationName        =    RUEomer_SKL.RUEomer_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        
        
        
        ; --- Dying anims
        AnimationState                =    DYING DEATH_1 SPLATTED
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        
        AnimationState                =    DYING DEATH_1
            Animation                =    RUEomer_DIEA
                AnimationName        =    RUEomer_SKL.RUEomer_DIEA
                AnimationMode        =    ONCE
            End
            Animation                =    RUEomer_DIEB
                AnimationName        =    RUEomer_SKL.RUEomer_DIEB
                AnimationMode        =    ONCE
            End
        End
        
        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUEomer_IDLA
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    RUEomer_GTPA
                AnimationName        =    RUEomer_SKL.RUEomer_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        
        AnimationState                =    STUNNED 
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        
        ; --- Moving Anims
        
        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUEomer_SKL.RUEomer_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART 
        End
        
        
        AnimationState                = MOVING PANICKING
            Animation                = MFDA
                AnimationName        = RUEomer_SKL.RUEomer_MFDA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End
        
        
        AnimationState = MOVING ATTACKING
            Animation                =    RUEomer_RUNB
                AnimationName        =    RUEomer_SKL.RUEomer_RUNB
                AnimationMode        =    LOOP
                Distance            =   50; 30
            End
        End
            
        AnimationState                =    MOVING 
            Flags                    =    RANDOMSTART
            Animation                =    RUEomer_RUNA
                AnimationName        =    RUEomer_SKL.RUEomer_RUNA
                AnimationMode        =    LOOP
                Distance            =   30
            End
        End

        ; Attacking Anims
        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    ATKA
                AnimationName        =    RUEomer_SKL.RUEomer_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKB
                AnimationName        =    RUEomer_SKL.RUEomer_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKC
                AnimationName        =    RUEomer_SKL.RUEomer_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKD
                AnimationName        =    RUEomer_SKL.RUEomer_ATKD
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End
        
        ; ATTACKING
        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = RUEomer_SKL.RUEomer_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE ; acts like an idle animation & keeps running the animations.
        End

        
        AnimationState                =    RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRA
                    AnimationMode   =    ONCE
                End
                Animation           =    CHRB
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRB
                    AnimationMode   =    ONCE
                End
                Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUEomer_SKL.RUEomer_ATNB
                AnimationMode        =    LOOP
            End
            StateName = STATE_Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle"    then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") return end
            EndScript
        End
        
        TransitionState = TRANS_Idle_to_Selected
            Animation = IDLF
                AnimationName        = RUEomer_SKL.RUEomer_ATNA ;RUEomer_SKL.RUEomer_IDLF
                AnimationMode        = ONCE
            End        
        End
        
        TransitionState = TRANS_Selected_to_Idle
            Animation            = ATNE
                AnimationName    = RUEomer_SKL.RUEomer_ATNE
                AnimationMode    = ONCE
            End        
        End
            
        
        ;----Emotion Animations
        AnimationState                =    EMOTION_CELEBRATING USER_1
                Animation           =    CHRA
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRA
                    AnimationMode   =    ONCE
                End
        End
        
        AnimationState                =    EMOTION_TAUNTING
                Animation           =    CHRB
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRB
                    AnimationMode   =    ONCE
                End
                Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End
        
        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            = RUEomer_SKL.RUEomer_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = RUEomer_SKL.RUEomer_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End
        
        ; READY IDLE
        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = RUEomer_SKL.RUEomer_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE ; acts like an idle animation & keeps running the animations.
        End
        
        ; --------- Click and Hit Reactions ------------
        AnimationState = HIT_REACTION HIT_LEVEL_1
;            Animation = Hit_Level_1_a
;                AnimationName = RUEomer_SKL.RUEomer_HITA
;                AnimationMode = ONCE
;            End
            Animation = Hit_Level_1_b
                AnimationName = RUEomer_SKL.RUEomer_HITB
                AnimationMode = ONCE
            End
;            Animation = Hit_Level_1_c
;                AnimationName = RUEomer_SKL.RUEomer_HITC
;                AnimationMode = ONCE
;            End
        End
        

;---transitions---        
    TransitionState = Trans_Idle_To_Sword
        Animation = Transition
            AnimationName = GUFaramir_SKL.GUFaramir_STHA
            AnimationMode = ONCE
        End
    End


    TransitionState = Trans_Sword_To_Idle
        Animation = Transition
            AnimationName = GUFaramir_SKL.GUFaramir_STHB
            AnimationMode = ONCE
        End
    End

        ;;;; ------------- This is dying anims for summoned hero ------------;;;
        
        AnimationState                =    MOUNTED DYING SPLATTED DEATH_2
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        ; This is the no-spawn-horse type of death
        AnimationState                =    MOUNTED DYING DEATH_2
            Animation
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
        End

        ; --- Dying anims
        AnimationState                        =    DYING SPLATTED DEATH_2
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End
        AnimationState                        =    DYING DEATH_2
            Animation = IDLB
                AnimationName        = RUEomer_SKL.RUEomer_IDLB
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLC
                AnimationName        = RUEomer_SKL.RUEomer_IDLC
                AnimationMode        = ONCE
                AnimationPriority    = 20
            End
        End
        
End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Men
    EditorSorting = UNIT
    ThreatLevel = BOROMIR_THREAT_LEVEL
    ThingClass        = CHARACTER_UNIT
    BuildCost         = IMRAHILLDAG_COST
    BuildTime         = MEDIUM_HERO_BUILDTIME
    DisplayMeleeDamage = IMRAHILLDAG_DAMAGE

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY    FaramirSword
    End

    WeaponSet
        Conditions        = HIDDEN
        Weapon            = PRIMARY    ImrahilSword_Disziplin
    End

    ArmorSet
        Conditions      = None
        Armor           = StrongHeroArmor
        DamageFX        = NormalDamageFX
    End

    ArmorSet
        Conditions      = MOUNTED
        Armor           = StrongElvenHeroArmorMounted
        DamageFX        = NormalDamageFX
    End

    VisionRange = 300
    ShroudClearingRange = 380
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue   = GONDOR_BOROMIR_BOUNTY_VALUE
    DisplayName   = OBJECT:GondorImrahil
    RecruitText   = CONTROLBAR:GondorImrahilRecruit
    ReviveText    = CONTROLBAR:GondorImrahilRevive
    Hotkey        = CONTROLBAR:GondorImrahilHotkey
    CrusherLevel  = 0
    MountedCrusherLevel   = 1
    CrushableLevel        = 2
    MountedCrushableLevel = 2

    CrushWeapon           = ImrahilHorseCrush

    MinCrushVelocityPercent  = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor   = 1.0

    CommandSet = ImrahilCommandSet
    CommandPoints = 0


    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_BoromirBody

    AutoResolveArmor
        Armor = AutoResolve_BoromirArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_BoromirWeapon
    End

    AutoResolveLeadership = AutoResolve_BoromirBonus




    VoiceAttack                = ImrahilVoiceAttack
    VoiceAttackCharge          = ImrahilVoiceAttack
    VoiceAttackMachine         = ImrahilVoiceAttack
    VoiceAttackStructure       = ImrahilVoiceAttack
    VoiceCreated               = ImrahilVoiceCreated
    VoiceFullyCreated          = ImrahilVoiceCreated
    VoiceFear                  = ImrahilVoiceHelpMe
    VoiceMove                  = ImrahilVoiceMove
    VoiceMoveToCamp            = ImrahilVoiceMove
    VoiceMoveWhileAttacking    = ImrahilVoiceAttack
    VoicePriority              = 85
    VoiceRetreatToCastle       = ImrahilVoiceSelect
    VoiceSelect                = ImrahilVoiceSelect
    VoiceSelectBattle          = ImrahilVoiceSelect
    VoiceGuard                 = ImrahilVoiceMove

    SoundImpact                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison                       = ImrahilVoiceMove
        VoiceEnterUnitElvenTransportShip    = ImrahilVoiceMove
        VoiceInitiateCaptureBuilding        = ImrahilVoiceMove
    End


    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:RUEomer_SKL.RUEomer_RUNA        Frames:4 15
        AnimationSound = Sound:FootstepDirtA            Animation:RUEomer_SKL.RUEomer_RUNB        Frames:5 15 26 36

        AnimationSound = Sound:SwordIntoScabbard1            Animation:RUEomer_SKL.RUEomer_ATKE         Frames:13
        AnimationSound = Sound:EomerThrowSpear            Animation:RUEomer_SKL.RUEomer_ATKE         Frames:55
        AnimationSound = Sound:SwordShingClean1            Animation:RUEomer_SKL.RUEomer_ATKE         Frames:91

        AnimationSound = Sound:TauntHumanHitShield        Animation:RUEomer_SKL.RUEomer_CHRB        Frames:22 32

        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:RUEomer_SKL.RUEomer_DIEA        Frames:48
        AnimationSound = Sound:BodyFallGenericNoArmor        Animation:RUEomer_SKL.RUEomer_DIEB        Frames:18
        AnimationSound = Sound:BodyFallSoldier            Animation:RUEomer_SKL.RUEomer_LNDA        Frames:2
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_ACCL    Frames: 8 30
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_RUNA    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_RUNB    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_RUNC    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_TNL1    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_TNR1    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_TRNL    Frames: 0
        AnimationSound = Sound: HorseMoveFootstepsLoose        Animation: RURohrm_SKL.RURohrm_TRNR    Frames: 0
        AnimationSound = Sound: HorseWhinny            Animation: RURohrm_SKL.RURohrm_CHRB    Frames: 8
        AnimationSound = Sound: HorseWhinny            Animation: RURohrm_SKL.RURohrm_CHRC    Frames: 15
        AnimationSound = Sound: HorseWhinny            Animation: RURohrm_SKL.RURohrm_DIEA    Frames: 0
        AnimationSound = Sound: BodyFallGeneric1        Animation: RURohrm_SKL.RURohrm_DIEA    Frames: 10 46
        AnimationSound = Sound: BodyFallGeneric1        Animation: RURohrm_SKL.RURohrm_LNDA    Frames: 3 11
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End



    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HERO ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius                = EMOTION_CHEER_RADIUS
        MaxHealth                  = IMRAHILLDAG_HEALTH
        PermanentlyKilledByFilter  = NONE
        DodgePercent               = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 4966
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 2000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIImrahilNew
        RespawnAsTemplate          = GondorImrahil

        RespawnRules =    AutoSpawn:No           Cost:IMRAHILLDAG_COST       Time:MEDIUM_HERO_RESPAWNTIME        Health:100%
   End

    Behavior = AutoHealBehavior ModuleTag_BoromirHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList            = ImrahilFunctions
        MoodAttackCheckRate        = 500
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance               = 300
        TauntAndPointUpdateDelay            = 10000
        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End


    LocomotorSet
        Locomotor = HeroHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = NORMAL_MOUNTED_MED_MEMBER_SPEED
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 161
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL ImrahilVoiceDie
        DeathFlags = DEATH_1
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = AttributeModifierUpgrade ModuleTag_FinrodBonus
        TriggeredBy       = Upgrade_RaiseShield
        AttributeModifier = FinarfinRingModifierHero
    End





    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UnpackTime                  = GOOD_MOUNT_TIME
         PreparationTime             = 1
         PersistentPrepTime          = 250
         PackTime                    = GOOD_MOUNT_TIME
         OpacityTarget               = .3
         AwardXPForTriggering        = 0
    End




    Behavior = SpecialPowerModule ModuleTag_SoldierSpecialStarter
        UpdateModuleStartsAttack     = No
        SpecialPowerTemplate         = SpecialPowerAraphantStatSoldier
        StartsPaused                 = No
        AttributeModifier            = AraphantSelfModifierSoldier
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = NONE +GondorImrahil
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_SoldierSpecialUpdate
        SpecialPowerTemplate         = SpecialPowerAraphantStatSoldier
        UnpackTime                   = 1500
        PackTime                     = 1500
        AwardXPForTriggering         = 0
        MustFinishAbility            = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Soldier
        StartsActive             = No
        BonusName                = ImrahilLeadershipAbwehr
        TriggeredBy              = Upgrade_TestBuilding
        RefreshDelay             = 2000
        Range                    = 180
        ObjectFilter             = NONE +GondorKnightsofDol +LehenDolsoldaten +DolAmrothGardeBanner +DolAmrothGardeMountedHorde +DolAmrothGardeMountedBanner +DolAmrothGardeMounted +DolAmrothGardeFoot +DolAmrothGardeFootHorde ALLIES
    End

    Behavior = ModelConditionUpgrade ModulTag_StatSoldier
        TriggeredBy              = Upgrade_TestBuilding
        AddConditionFlags        = USER_2
    End





    Behavior = SpecialPowerModule ModuleTag_ArcherSpecialStarter
        UpdateModuleStartsAttack     = No
        SpecialPowerTemplate         = SpecialPowerAraphantStatArcher
        StartsPaused                 = No
        AttributeModifier            = AraphantSelfModifierArcher
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = NONE +GondorImrahil
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_ArcherSpecialUpdate
        SpecialPowerTemplate         = SpecialPowerAraphantStatArcher
        UnpackTime                   = 1500
        PackTime                     = 1500
        AwardXPForTriggering         = 0
        MustFinishAbility            = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Archer
        StartsActive             = No
        BonusName                = ImrahilLeadershipAngriff
        TriggeredBy              = Upgrade_PlantShield
        RefreshDelay             = 2000
        Range                    = 999999

        ObjectFilter             = NONE +GondorKnightsofDol +LehenDolsoldaten +DolAmrothGardeBanner +DolAmrothGardeMountedHorde +DolAmrothGardeMountedBanner +DolAmrothGardeMounted +DolAmrothGardeFoot +DolAmrothGardeFootHorde ALLIES
    End

    Behavior = ModelConditionUpgrade ModulTag_StatArcher
        TriggeredBy              = Upgrade_PlantShield
        AddConditionFlags        = USER_7
    End





    Behavior = SpecialPowerModule ModuleTag_CavalerySpecialStarter
        UpdateModuleStartsAttack     = No
        SpecialPowerTemplate         = SpecialPowerAraphantStatCavalry
        StartsPaused                 = No
        AttributeModifier            = AraphantSelfModifierCavalery
        AttributeModifierRange       = 1
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = NONE +GondorImrahil
    End

    Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_CavalerySpecialUpdate
        SpecialPowerTemplate         = SpecialPowerAraphantStatCavalry
        UnpackTime                   = 1500
        PackTime                     = 1500
        AwardXPForTriggering         = 0
        MustFinishAbility            = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Cavalery
        StartsActive             = No
        BonusName                = ImrahilLeadershipAbwehrAngriff
        TriggeredBy              = Upgrade_RaiseShield
        RefreshDelay             = 2000
        Range                    = 999999
        ObjectFilter             = NONE +GondorKnightsofDol +LehenDolsoldaten +DolAmrothGardeBanner +DolAmrothGardeMountedHorde +DolAmrothGardeMountedBanner +DolAmrothGardeMounted +DolAmrothGardeFoot +DolAmrothGardeFootHorde ALLIES
    End

    Behavior = ModelConditionUpgrade ModulTag_StatCavalery
        TriggeredBy              = Upgrade_RaiseShield
        AddConditionFlags        = USER_6
    End


    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = ImrahilCommandSet_Leadership
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags            = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet    = ImrahilCommandSet
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP                     = Yes
    End



    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 500
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = ImrahilCitadelModifier
        AllowFilter             = ANY +GondorWachterderVeste +GondorWachterderVesteHorde ALLIES
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EhreEnabler
        SpecialPowerTemplate = SpecialAbilityGlorfindelWindRider
        TriggeredBy          = Upgrade_Level_3
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_EhreUpdate
        SpecialPowerTemplate = SpecialAbilityGlorfindelWindRider
        Duration             = 30000
        AttributeModifier    = ImrahilEhreModifier
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DisziplinEnabler
        SpecialPowerTemplate      = SpecialAbilityTheodenRuckzug
        TriggeredBy               = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_DisziplinUpdate
        SpecialPowerTemplate      = SpecialAbilityTheodenRuckzug
        UpdateModuleStartsAttack  = Yes
        StartsPaused              = Yes
        AttributeModifier         = DolAmrothDisziplinModifier
        AttributeModifierRange    = 300
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects  = ANY +LehenDolsoldaten +DolAmrothGardeMountedBanner +DolAmrothGardeMounted +DolAmrothGardeFoot +DolAmrothGardeBanner +GondorKnightsofDol ALLIES
        AttributeModifierFX       = FX_DisziplinFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_DisziplinAnimation
        UnpackTime                = 1000
        UnpackingVariation        = 1
        SpecialPowerTemplate      = SpecialAbilityTheodenRuckzug
        PreparationTime           = 0
        PersistentPrepTime        = 0
        PackTime                  = 1330
     End







    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_PrinzengardeEnabler
        SpecialPowerTemplate    = SpecialAbilityImrahilSummonPrinzengarde
        TriggeredBy             = Upgrade_Level_10
    End

    Behavior = OCLSpecialPower ModuleTag_PrinzengardeSpecialPower
        SpecialPowerTemplate    = SpecialAbilityImrahilSummonPrinzengarde
        OCL                     = OCL_GondorDolAmrothSummonEgg
        TriggerFX               = FX_GamlingHeroldSummon
        CreateLocation          = CREATE_AT_LOCATION
        StartsPaused            = Yes
    End



    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgradeSchwan
        UpgradeToGrant      = Upgrade_ThorinOrkrist
        GiveOnBuildComplete = Yes
    End





    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = ImrahilRetterObjectDestroyWeapon
            FireDelay = 2000
            OneShot = Yes
        End
    End

    Behavior = ObjectCreationUpgrade ModuleTag_RetterObject
        TriggeredBy     = Upgrade_RaiseSchmiedekunst
        Delay           = 0
        ThingToSpawn    = RetterObjectImrahil
    End








    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_ImrahilToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End

    Behavior = AISpecialPowerUpdate SpecialPowerTheodenGloriousCharge
        CommandButtonName = Command_SpecialAbilityImrahilEhre
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Behavior = AISpecialPowerUpdate MightyRageAI
        CommandButtonName = Command_SpecialAbilityImrahilBlutlinie
        SpecialPowerAIType = AI_SPECIAL_POWER_HEAL_AOE
        SpecialPowerRadius = 200.0
    End

    Behavior = AISpecialPowerUpdate SpecialPowerAragornOathBreakers
        CommandButtonName = Command_SpecialAbilityImrahilPrinzengarde
        SpecialPowerAIType = AI_SPECIAL_POWER_TARGETAOE_SUMMON
        SpecialPowerRadius = 30.0
    End




    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20
  ShadowSizeY = 20
  ShadowTexture = ShadowI
End

ChildObject GondorImrahil_forMM GondorImrahil
    MaxSimultaneousOfType    = 1
    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
    End
End

ChildObject GondorImrahilFoot GondorImrahil
End

ChildObject GondorImrahilMount GondorImrahil
End

ChildObject GondorImrahil_Slaved GondorImrahil
End



