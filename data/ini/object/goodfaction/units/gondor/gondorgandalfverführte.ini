Object GondorGandalfVerfuhrte

    SelectPortrait = HPGandalfBad
    ButtonImage    = HIGandalfBad

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_LeaderHero

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDrawInWorldBuilder

        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = GUGandalf_SKN
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_01

        GlowEnabled = No
        GlowEmissive = No

        ExtraPublicBone = STAFF
        ExtraPublicBone = B_SWORDBONE
        ExtraPublicBone = PASSENGERBONE
        DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP



        DefaultModelConditionState
            Model               = GUGandalf_VERF
            WeaponLaunchBone    = TERTIARY STAFF
            ParticleSysBone     = STAFF_LIGHT GandalfFireSmall FollowBone:Yes
            ParticleSysBone     = STAFF_LIGHT GandalfFireSmoke FollowBone:Yes
            ParticleSysBone     = B_SWORDBONE SaronRingSpark FollowBone:Yes
        End

        ModelConditionState     = HERO
            Model               = GUGandalf_VERF
            WeaponLaunchBone    = TERTIARY STAFF
            ParticleSysBone     = STAFF_LIGHT GandalfFireSmall FollowBone:Yes
            ParticleSysBone     = STAFF_LIGHT GandalfFireSmoke FollowBone:Yes
            ParticleSysBone     = STAFF GandalfVerfuhrteStaffFlare FollowBone:Yes
        End


        IdleAnimationState
            StateName = Idle
            Animation = Foot_IDLB
                AnimationName       = GUGandalfG_SKL.GUGandalfG_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End
            Animation = Foot_IDLC
                AnimationName       = GUGandalfG_SKL.GUGandalfG_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End
            Animation = Foot_IDLD
                AnimationName       = GUGandalfG_SKL.GUGandalfG_IDLD
                AnimationMode       = ONCE
                AnimationPriority   = 1
            End
            Animation = Foot_IDLE
                AnimationName       = GUGandalfG_SKL.GUGandalfG_IDLE
                AnimationMode       = ONCE
                AnimationPriority   = 2
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
                CurDrawableHideSubObject("STAFF_LIGHT")
            EndScript

        End


        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_FLYB
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED DYING SPLATTED
            Animation                =    Land
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED DYING
            Animation                =    JustDie
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_GTPA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = GUGdfHrs_SKL.GUGdfHrs_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState      = STUNNED_FLAILING
            Animation = StunnedFlail
                AnimationName         = GUGandalfG_SKL.GUGandalfG_FLYA
                AnimationMode     = LOOP
            End
        End

        AnimationState      = DYING SPLATTED
            Animation = Stunned
                AnimationName         = GUGandalfG_SKL.GUGandalfG_LNDA
                AnimationMode     = ONCE
            End

        End

        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName           = GUGandalfG_SKL.GUGandalfG_MFDA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = DYING
            Animation = Die
                AnimationName           = GUGandalfG_SKL.GUGandalfG_DIEB
                AnimationMode       = ONCE
            End

        End

        AnimationState        = STUNNED_STANDING_UP
            Animation           = GUGandalfG_GTPA
                AnimationName     = GUGandalfG_SKL.GUGandalfG_GTPA
                AnimationMode     = ONCE
            End
        End

        AnimationState      = STUNNED
            Animation = Stunned
                AnimationName         = GUGandalfG_SKL.GUGandalfG_LNDA
                AnimationMode     = ONCE
            End

        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUGandalfG_SKL.GUGandalfG_IDLB
                AnimationMode                = LOOP
            End
        End





        AnimationState        =  PASSENGER EATING
            StateName = BeingEaten
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_EATA
                AnimationMode       = ONCE
                AnimationBlendTime    =    4
            End
        End

        AnimationState        =  PASSENGER
        StateName = BeingEaten
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_FLLA
                AnimationMode       = LOOP
                AnimationBlendTime    =    4
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE MOUNTED
            StateName = Attacking
            Animation
                AnimationName        = GUGdfHrs_SKL.GUGdfHrs_SPLA
                AnimationMode       = ONCE
                AnimationBlendTime    =    4
            End
            FXEvent            = Frame:5 Name:FX_GandalfPreAttackBlast
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPCK
                AnimationMode       = ONCE
            End
            FXEvent            = Frame:5 Name:FX_PreWortderDunkelheit
        End


        AnimationState        =  SPECIAL_WEAPON_TWO MOUNTED
            StateName = Attacking
            Animation
                AnimationName        = GUGdfHrs_SKL.GUGdfHrs_SPLD
                AnimationMode       = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_TWO
            StateName = BreathingFireAnimation
            Animation
                AnimationName       = GUGandalfG_SKL.GUGandalfG_SPCL
                AnimationMode       = ONCE
            End
                ParticleSysBone = STAFF GandalfFireBreath FollowBone:Yes
                ParticleSysBone = STAFF balrogBreathEmbers FollowBone:Yes
                ParticleSysBone = STAFF balrogBreathSmoke FollowBone:Yes
                ParticleSysBone = STAFF balrogBreathProxy FollowBone:Yes
        End


        AnimationState        =  MOUNTED PACKING_TYPE_1 UNPACKING
            StateName = Attacking
            Animation = LightningSwordStart
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_SPE1
                AnimationMode       = ONCE
            End
            FXEvent            = Frame:14 Name:FX_GandalfLightningCharge
            FXEvent            = Frame:14 Name:FX_GandalfLightningSword  FrameStop:70
        End

        AnimationState        =  MOUNTED PACKING_TYPE_1 PREPARING
            StateName = Attacking
            Animation = LightningSwordLoop
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_SPE2
                AnimationMode       = LOOP
            End
        End

        AnimationState        =  MOUNTED PACKING_TYPE_1 PACKING
            StateName = Attacking
            Animation = LightningSwordPutAway
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_SPE3
                AnimationMode       = ONCE
            End
        End


        AnimationState        =  PACKING_TYPE_1 UNPACKING
            StateName = Attacking
            Animation = LightningSwordStart
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE3
                AnimationMode       = ONCE
            End
            FXEvent            = Frame:14 Name:FX_GandalfVerfuhrteLightningCharge
            FXEvent            = Frame:14 Name:FX_GandalfVerfuhrteLightningSword  FrameStop:70
        End

        AnimationState        =  PACKING_TYPE_1 PREPARING
            StateName = Attacking
            Animation = LightningSwordLoop
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE2
                AnimationMode       = LOOP
            End
        End

        AnimationState        =  PACKING_TYPE_1 PACKING
            StateName = Attacking
            Animation = LightningSwordPutAway
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE1
                AnimationMode       = ONCE
            End
        End



        AnimationState        =  PACKING_TYPE_2 UNPACKING
            StateName = Attacking
            Animation = LightningSwordStart
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE3
                AnimationMode       = ONCE
            End
            ParticleSysBone     = NONE BalrogIgniteHeatWave FollowBone:No
            ParticleSysBone     = NONE GandalfVerfuhrteWorte01 FollowBone:Yes
        End

        AnimationState        =  PACKING_TYPE_2 PREPARING
            StateName = Attacking
            Animation = LightningSwordLoop
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE2
                AnimationMode       = ONCE
            End
            ParticleSysBone     = NONE BalrogIgniteHeatWave FollowBone:No
            ParticleSysBone     = NONE GandalfVerfuhrteWorte01 FollowBone:Yes
        End

        AnimationState        =  PACKING_TYPE_2 PACKING
            StateName = Attacking
            Animation = LightningSwordPutAway
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPE1
                AnimationMode       = ONCE
            End
            ParticleSysBone     = NONE BalrogIgniteHeatWave FollowBone:No
            ParticleSysBone     = NONE GandalfVerfuhrteWorte01 FollowBone:Yes
        End



        AnimationState        =  MOUNTED SPECIAL_WEAPON_THREE
            StateName = Attacking
            Animation = StaffLaser
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_SPLG
                AnimationMode       = ONCE
            End
            FXEvent            = Frame:30 Name:FX_GandalfVerfuhrteStaffFlare
        End


        AnimationState        =  SPECIAL_WEAPON_THREE
            StateName = Attacking
            Animation = StaffLaser
                AnimationName           = GUGandalfG_SKL.GUGandalfG_SPCH
                AnimationMode       = ONCE
            End
            FXEvent            = Frame:30 Name:FX_GandalfVerfuhrteStaffFlare
        End









        AnimationState        =  UNPACKING
            StateName = Attacking
            Animation
                AnimationName        = GUGdfHrs_SKL.GUGdfHrs_IDLA
                AnimationMode       = ONCE
            End
        End


        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A MOVING
            Animation                =    MountedRunAndFire
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATRA
                AnimationMode        =    LOOP
                Distance            =    60
            End
        End

        AnimationState                =    MOUNTED BETWEEN_FIRING_SHOTS_A MOVING
            Animation                =    TrotBetweenShotsMoving
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_WLKA
                AnimationMode        =    LOOP
                Distance            =    30
            End
        End


        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    MountedSlash
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        = Yes
            End
            Animation                =    MountedStab
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        = Yes
            End
        End




        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUGandalfG_SKL.GUGandalfG_WLKA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        =  FIRING_OR_PREATTACK_A
            Animation = StaffSwing
                AnimationName           = GUGandalfG_SKL.GUGandalfG_ATKA
                AnimationMode       = ONCE
                UseWeaponTiming        = Yes
            End
            Animation = SwordSwing
              AnimationName           = GUGandalfG_SKL.GUGandalfG_ATKB
              AnimationMode       = ONCE
              UseWeaponTiming        = Yes
            End
            Animation = SpinningSwordStaff
              AnimationName           = GUGandalfG_SKL.GUGandalfG_ATKC
              AnimationMode       = ONCE
              UseWeaponTiming        = Yes
            End
        End




        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnRight
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_TNR1
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnRight
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_TNL1
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_WLKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_RUNA
                AnimationMode        =    LOOP
            End
             Flags                    =    RANDOMSTART

        End



        AnimationState        = MOVING WANDER
            Animation = Wandering
                AnimationName           = GUGandalfG_SKL.GUGandalfG_WLKA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = MOVING
            Animation = Moving
                AnimationName           =  GUGandalfG_SKL.GUGandalfG_WLKA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = MOUNTED LEVELED    USER_1
            Animation = Yippee
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_LVLA
                AnimationMode       = ONCE
            End



        End

        AnimationState        = MOUNTED LEVELED
            Animation = Yippee
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_LVLA
                AnimationMode       = ONCE
            End
        End


        AnimationState        = MOUNTED EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = GUGdfHrs_SKL.GUGdfHrs_IDLA
                AnimationMode     = LOOP
            End
        End
        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = GUGandalfG_SKL.GUGandalfG_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState        = LEVELED    USER_1
            Animation = Yippee
                AnimationName           = GUGandalfG_SKL.GUGandalfG_LVLA
                AnimationMode       = ONCE
            End



        End

        AnimationState        = LEVELED
            Animation = Yippee
                AnimationName           = GUGandalfG_SKL.GUGandalfG_LVLA
                AnimationMode       = ONCE
            End
        End

        AnimationState                =    MOUNTED SELECTED USER_1
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        AnimationState        = MOUNTED RAISING_FLAG
            Animation
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = MOUNTED EMOTION_CELEBRATING
            Animation
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = MOUNTED EMOTION_TAUNTING
            Animation
                AnimationName           = GUGdfHrs_SKL.GUGdfHrs_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                CurDrawableHideSubObject("STAFF_LIGHT")
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_ATNA
                AnimationMode        =    ONCE
            End
        End

        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    GUGandalfG_SKL.GUGandalfG_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    GUGandalfG_SKL.GUGandalfG_ATNE
                AnimationMode            =    ONCE
            End
        End

        AnimationState                =    SELECTED USER_1
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    GUGandalfG_SKL.GUGandalfG_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End

        AnimationState        = RAISING_FLAG
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = EMOTION_CELEBRATING
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState        = EMOTION_TAUNTING
            Animation
                AnimationName           = GUGandalfG_SKL.GUGandalfG_LVLA
                AnimationMode       = LOOP
            End
        End

        AnimationState                =    SELECTED
            StateName                =    Selected

            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    GUGandalfG_SKL.GUGandalfG_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
                CurDrawableHideSubObject("STAFF_LIGHT")
            EndScript
        End

        AnimationState = MOUNTED HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = GUGdfHrs_SKL.GUGdfHrs_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = GUGandalfG_SKL.GUGandalfG_HITA
                AnimationMode = ONCE
            End
        End

        AnimationState = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_IDLA
                AnimationPriority    =    30
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    GUGdfHrs_SKL.GUGdfHrs_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_Schmiedekunst
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = USER_8
            Model           = exldrspimla
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"

    Behavior = SubObjectsUpgrade ModuleTag_MakingTheGandalf
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects     = STAFF_LIGHT
    End


    Side                  = Men
    EditorSorting         = UNIT
    ThreatLevel           = GANDALF_THREAT_LEVEL
    ThingClass            = CHARACTER_UNIT
    DisplayMeleeDamage    = SILMARIL_HERO_DAMAGE
    BuildFadeInOnCreateTime  = 4.4
    EquivalentTo             = GondorGandalf
    MaxSimultaneousOfType    = 1
    BuildCost           = GANDALFDAG_COST
    BuildTime           = SILMARIL_HERO_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    TransportSlotCount  = TRANSPORTSLOTCOUNT_HERO
    CommandSet          = GondorGandalfVerfuhrteCommandSetMain
    CommandPoints       = 0

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY GandalfSwordRing
    End

    ArmorSet
        Conditions    = None
        Armor         = SilmarilHeroHeavyArmor
        DamageFX      = NormalDamageFX
    End


    VisionRange               = 200
    ShroudClearingRange       = 350
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue               = GONDOR_GANDALFWHITE_BOUNTY_VALUE
    DisplayName               = OBJECT:GandalfderVerfuhrte
    RecruitText               = CONTROLBAR:GandalfTheWhiteRecruit
    ReviveText                = CONTROLBAR:GandalfTheWhiteRevive
    Hotkey                    = CONTROLBAR:GandalfTheWhiteHotkey

    CrusherLevel              = 0
    CrushableLevel            = 4

    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_GandalfBody

    AutoResolveWeapon
        Weapon = AutoResolve_GandalfWeapon
    End
    AutoResolveArmor
        Armor = AutoResolve_GandalfArmor
    End

    VoiceAttack                = GandalfBadVoiceAttack
    VoiceAttackCharge          = GandalfBadVoiceAttack
    VoiceAttackMachine         = GandalfBadVoiceAttack
    VoiceAttackStructure       = GandalfBadVoiceAttack
	VoiceCreated				 = SH_NineForMen
	VoiceFullyCreated			 = SH_NineForMen
    VoiceFear                  = GandalfBadVoiceHelp
    VoiceMove                  = GandalfBadVoiceMove
    VoiceMoveToCamp            = GandalfBadVoiceMove
    VoiceMoveWhileAttacking    = GandalfBadVoiceMove
    VoicePriority              = 95
    VoiceRetreatToCastle       = GandalfBadVoiceSelect
    VoiceSelect                = GandalfBadVoiceSelect
    VoiceSelectBattle          = GandalfBadVoiceSelect
    VoiceGuard                 = GandalfBadVoiceSelect

    SoundImpact                = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison    		    = GandalfVoiceGarrison
        VoiceEnterUnitElvenTransportShip    = GandalfBadVoiceMove
        VoiceInitiateCaptureBuilding        = GandalfBadVoiceSelect
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove        = GandalfBadVoiceMove
            VoiceSelect      = GandalfBadVoiceSelect
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner        = GandalfDie

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA            Animation:GUGandalfG_SKL.GUGandalfG_RUNA        Frames:10 20
        AnimationSound = Sound:FootstepDirtA            Animation:GUGandalfG_SKL.GUGandalfG_RUNB        Frames:10 22 33 45
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:GUGandalfG_SKL.GUGandalfG_DIEB        Frames:63
        AnimationSound = Sound:BodyFallGenericNoArmor   Animation:GUGandalfG_SKL.GUGandalfG_LNDA        Frames:2
    End

    RadarPriority        = UNIT
    KindOf               = HERO HEAVY_MELEE_HITTER PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK ARMY_SUMMARY SCARY GANDALF
    PathfindDiameter     = 40.0


    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius               = EMOTION_CHEER_RADIUS
        MaxHealth                 = STRONG_HERO_HEALTH
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 5367
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 2000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIGandalfgood
        RespawnAsTemplate          = GondorGandalf

        RespawnRules =            AutoSpawn:No    Cost:GANDALFDAG_COST        Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End

    Behavior = AutoHealBehavior ModuleTag_GandalfHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_04
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        AILuaEventsList            = GandalfVerfuhrteEdainFunctions
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance               = 300
        TauntAndPointUpdateDelay            = 10000
        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End


    LocomotorSet
        Locomotor = BasicSauronLocomotor
        Condition = SET_NORMAL
        Speed     = 20
    End

    Behavior = PhysicsBehavior ModuleTag_05
        GravityMult = 1.0
        ShockStandingTime = 3800
    End

    Behavior = SlowDeathBehavior ModuleTag_06
        DeathTypes = ALL -KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL GandalfVoiceDie
    End

    Behavior = SquishCollide ModuleTag_07

    End

    Behavior = SlowDeathBehavior ModuleTag_08
        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper1
        WeaponSetFlags         = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet = GondorGandalfVerfuhrteCommandSetSecond
    End

    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper2
        WeaponSetFlags         = WEAPONSET_TOGGLE_2
        WeaponToggleCommandSet = GondorGandalfVerfuhrteCommandSetMain
    End

    Behavior = CommandSetUpgrade ModueTag_CommandSet_AI
        TriggeredBy         = Upgrade_ObjectUnderAIControl
        CommandSet          = GondorGandalfVerfuhrteCommandSet_AI
    End


    Behavior = OCLSpecialPower ModuleTag_09
        SpecialPowerTemplate = SuperweaponPartTheHeavens
        OCL                  = OCL_PartTheHeavensMod
    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 2000
        HitReactionThreshold1 = 5.0
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SilmarilHeroLeadershipStart
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
    End

    Behavior = SpecialPowerModule ModuleTag_SilmarilHeroLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership3
        UpdateModuleStartsAttack    = No
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_SilmarilHeroLeadership
        StartsActive     = Yes
        BonusName        = SilmarilHeroGlobalLeadership
        RefreshDelay     = 2000
        Range            = 1250
        ObjectFilter     = ALL -HERO -MACHINE -SHIP -DOZER -STRUCTURE ALLIES
    End





    Behavior = AttributeModifierAuraUpdate ModuleTag_Nebeneffeckt
        StartsActive    = Yes
        BonusName       = RingNebeneffecktGandalfderVerfuhrte
        RefreshDelay    = 2000
        Range           = 250
        AntiCategory    = BUFF
        ObjectFilter    = ANY +INFANTRY +CAVALRY +DOZER -STRUCTURE -HERO -MACHINE -SHIP
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Nebeneffeckt2
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        TriggeredBy              = Upgrade_Level_1
    End

    Behavior = SpecialPowerModule ModuleTag_Nebeneffeckt3
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = Yes
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_BlastEnabler
        SpecialPowerTemplate       = SpecialAbilityWizardBlast
        TriggeredBy                = Upgrade_Level_1
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_BlastStarter
        SpecialPowerTemplate       = SpecialAbilityWizardBlast
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        InitiateSound              = GandalfVerfuhrteWordofPowerVoice
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WizardBlastWeaponFireUpdate
        SpecialPowerTemplate    = SpecialAbilityWizardBlast
        WhichSpecialWeapon      = 2
        SkipContinue            = Yes
        UnpackTime              = 900
        PreparationTime         = 1
        PersistentPrepTime      = 1500
        PackTime                = 1100
        AwardXPForTriggering    = 0
        StartAbilityRange       = 80.0
        MustFinishAbility       = Yes
        SpecialWeapon           = GandalfVerfuhrteFeuerMagie
    End

    Behavior = AutoAbilityBehavior ModuleTag_WizardBlastAutoAbility
	SpecialAbility		= SpecialAbilityWizardBlast
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= GANDALF_FORCE_ATTACK_RANGE
	Query			= 15 ALL ENEMIES -STRUCTURE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LightningEnabler
        SpecialPowerTemplate     = SpecialAbilityLightningSword
        TriggeredBy              = Upgrade_Level_2
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_11
        SpecialPowerTemplate     = SpecialAbilityLightningSword
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
        InitiateSound            = GandalfVoiceAttackLightningSword
    End

    Behavior = ArrowStormUpdate ModuleTag_12
        SpecialPowerTemplate     = SpecialAbilityLightningSword
        StartAbilityRange        = 275.0
        UnpackingVariation       = 1
        UnpackTime               = 2500
        PreparationTime          = 1
        PersistentPrepTime       = 500
        PackTime                 = 1500
        ApproachRequiresLOS      = Yes
        AwardXPForTriggering     = 0
        ActiveLoopSound          = GandalfLightningLoop
        WeaponTemplate  	 = GandalfVerfuhrteLightningSwordBlastWeapon
        TargetRadius   		 = 120
        ShotsPerTarget   	 = 1
        ShotsPerBurst   	 = 1
        MaxShots        	 = 11
    End

    Behavior = AutoAbilityBehavior ModuleTag_LightningSwordAutoAbility
		SpecialAbility		= SpecialAbilityLightningSword
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange	= 275.0
		Query			= 1 ANY ENEMIES +MONSTER +HERO -STRUCTURE
		Query			= 15 ALL ENEMIES -STRUCTURE
    End
	
	
	
	
	

    Behavior = DarknessSpecialPower ModuleTag_GandalfsWorte
        SpecialPowerTemplate          = SpecialAbilityGandalfsWorte
        AttributeModifier             = GandalfsWorte
        AttributeModifierAffects      = NONE +GondorGandalfVerfuhrte ALLIES
        AttributeModifierWeatherBased = Yes
        WeatherDuration               = 120000
        ChangeWeather                 = CLOUDY
        AvailableAtStart              = Yes
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GandalfsWorteAnimation
        UnpackTime                  = 2500
        UnpackingVariation            = 2
        SpecialPowerTemplate        = SpecialAbilityGandalfsWorte
        PreparationTime               = 0
        PersistentPrepTime            = 0
        PackTime                    = 5000
    End

    Behavior = SpecialAbilityUpdate ModuleTag_BlackRiderScreechGandalfsWorte
        SpecialPowerTemplate        = SpecialAbilityGandalfsWorte
        UnpackTime                   = 0
        AwardXPForTriggering           = 0
        Instant                        = Yes
        EffectRange                    = 300
    End

    Behavior = AutoAbilityBehavior ModuleTag_GandalfsWorteAutoAbility
		SpecialAbility		= SpecialAbilityGandalfsWorte
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange	= 200
		Query			= 15 ALL ENEMIES
		Query			= 1 ANY ENEMIES +HERO +MONSTER
	End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_IstariLightEnabler
        SpecialPowerTemplate     = SpecialAbilityIstariLight
        TriggeredBy              = Upgrade_Level_7
        ObeyRechageOnTrigger     = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_IstariLightPower
        SpecialPowerTemplate     = SpecialAbilityIstariLight
        UpdateModuleStartsAttack = Yes
        StartsPaused             = Yes
        InitiateSound            = GandalfVoiceAttackIstariLight
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_IstariLightUpdate
        SpecialPowerTemplate    = SpecialAbilityIstariLight
        SkipContinue            = Yes
        UnpackTime              = 2000
        PreparationTime         = 1
        PersistentPrepTime      = 2000
        PackTime                = 500
        AwardXPForTriggering    = 0
        StartAbilityRange       = GANDALF_PHASER_CAST_RANGE
        ApproachRequiresLOS     = Yes
        SpecialWeapon           = GandalfVerfuhrteStaffWeapon
        MustFinishAbility       = Yes
        WhichSpecialWeapon      = 3
        BusyForDuration         = 2500
    End

    Behavior = AutoAbilityBehavior ModuleTag_IstariLightAutoAbility
		SpecialAbility		= SpecialAbilityIstariLight
		ForbiddenStatus 	= INSIDE_GARRISON
		MaxScanRange	= GANDALF_PHASER_CAST_RANGE
		Query			= 1 ANY ENEMIES +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir +GondorGwaihir_Summoned +ElvenFortressEagle +KhamulFellBeast +MorgomirFellBeast +Drogoth
		Query			= 1 ANY ENEMIES +MONSTER +HERO -STRUCTURE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_WordEnabler
        SpecialPowerTemplate       = SpecialAbilityWordOfPowerGandalf
        TriggeredBy                = Upgrade_Level_10
        ObeyRechageOnTrigger       = Yes
    End

    Behavior = SpecialPowerModule ModuleTag_WordStarter
        SpecialPowerTemplate       = SpecialAbilityWordOfPowerGandalf
        UpdateModuleStartsAttack   = Yes
        StartsPaused               = Yes
        InitiateSound              = BadGandalfBlast
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WordWeaponFireUpdate
        SpecialPowerTemplate       = SpecialAbilityWordOfPowerGandalf
        WhichSpecialWeapon         = 1
        SkipContinue               = Yes
        UnpackTime                 = 1700
        PackTime                   = 1
        FreezeAfterTriggerDuration = 2500
        AwardXPForTriggering       = 0
        StartAbilityRange          = 80.0
        SpecialWeapon              = GandalfVerfuhrteWordOfPower
    End

    Behavior = AutoAbilityBehavior ModuleTag_WordWeaponAutoAbility
		SpecialAbility			= SpecialAbilityWordOfPowerGandalf
		ForbiddenStatus 		= INSIDE_GARRISON
		MaxScanRange		= GANDALF_WORD_OF_POWER_RANGE
		Query				= 40 ALL ENEMIES
    End


	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Escape
		SpecialPowerTemplate	= SpecialAbilityCirdanReiseindenWesten
		TriggeredBy				= Upgrade_Level_3
	End

  	Behavior = SpecialPowerModule ModuleTag_EscapeStarter
		SpecialPowerTemplate    = SpecialAbilityCirdanReiseindenWesten
		StartsPaused				= Yes
		AttributeModifier			= GandalfCursedEscape
		AttributeModifierAffectsSelf = Yes
	End

	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_EscapeUpdate
		SpecialPowerTemplate    = SpecialAbilityCirdanReiseindenWesten
		HeroEffectDuration			= 30000
		UnpackTime              = 1
	End



    Behavior = RemoveUpgradeUpgrade ModuleTag_RemoveSilmaril
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        UpgradeToRemove               = Upgrade_FortressRingHero Upgrade_RingHero
        RemoveFromAllPlayerObjects    = Yes
        SuppressEvaEventForRemoval    = Yes
    End

    Behavior = FXListDie ModuleTag_AnnounceWeLostTheRing
        DeathFX                  = GandalfAnnounceFortressDeathLostRingFX
    End

    Behavior = CreateObjectDie ModuleTag_DropTheRing
        CreationList             = OCL_TheOneRing
    End



    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End
	

    Behavior = AISpecialPowerUpdate GandalfWizardBlastAI
        CommandButtonName = Command_SpecialAbilityFlammeAnors
        SpecialPowerAIType = AI_SPECIAL_POWER_GANDALF_WIZARD_BLAST
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate GandalfLightningSwordAI
        CommandButtonName = Command_GondorGandalfLightningSwordEdain_Evil
        SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate GandalfsWorteAI
		CommandButtonName = Command_SpecialAbilityGandalfsWorte
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Behavior = AISpecialPowerUpdate GandalfMaiarLightAI
        CommandButtonName = Command_GondorGandalfMaiarLight
        SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
    End

	Behavior = AISpecialPowerUpdate EscapeAI
		CommandButtonName = Command_SpecialAbilityGandalfCursedEscape
		SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
	End
	
    Behavior = AISpecialPowerUpdate GandalfDunklesWortderMachtAI
        CommandButtonName = Command_SpecialAbilityDunklesWortderMacht
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
        SpecialPowerRadius = 250
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 25
    GeometryIsSmall     = Yes
    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 20
    ShadowSizeY         = 20
    ShadowTexture       = ShadowI
End

ChildObject GondorGandalfVerfuhrte_forFornost GondorGandalfVerfuhrte

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                  = DYING
        DeathAnimationTime         = 5367
        RespawnAnim                = LEVELED
        RespawnAnimationTime       = 2000
        AutoRespawnAtObjectFilter  = NONE +CASTLE_KEEP
        ButtonImage                = HIGandalfgood
        RespawnAsTemplate          = GondorGandalf_forFornost

        RespawnRules =            AutoSpawn:No    Cost:GANDALFDAG_COST        Time:SILMARIL_HERO_RESPAWNTIME        Health:100%
    End
End