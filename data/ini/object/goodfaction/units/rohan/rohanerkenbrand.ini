Object RohanErkenbrand

    SelectPortrait         = HPErkenbrand
    ButtonImage            = HIErkenbrand

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_SupportHero


    Draw = W3DHordeModelDraw ModuleTag_01

        ExtraPublicBone = PASSENGERBONE
        DependencySharedModelFlags = TURN_LEFT_HIGH_SPEED TURN_RIGHT_HIGH_SPEED MOVING ACCELERATE DECELERATE TURN_LEFT TURN_RIGHT ATTACKING BACKING_UP

        DefaultModelConditionState
            Model            = RUErken_SKN
            WeaponLaunchBone = PRIMARY SPEAR
            WeaponLaunchBone = SECONDARY SPEAR
            WeaponLaunchBone = TERTIARY SPEAR
        End

        ModelConditionState  = MOUNTED
            Model            = RUErken_HRS
            WeaponLaunchBone = PRIMARY SPEAR
            WeaponLaunchBone = SECONDARY SPEAR
            WeaponLaunchBone = TERTIARY SPEAR
        End


        IdleAnimationState
            StateName = STATE_Idle
            Animation = IDLB
                AnimationName        = RUEomer_SKL.RUEomer_IDLB
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLC
                AnimationName        = RUEomer_SKL.RUEomer_IDLC
                AnimationMode        = ONCE
                AnimationPriority    = 20
            End
            Animation = IDLD
                AnimationName        = RUEomer_SKL.RUEomer_IDLD
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Animation = IDLE
                AnimationName        = RUEomer_SKL.RUEomer_IDLE
                AnimationMode        = ONCE
                AnimationPriority    = 1
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Selected"    then CurDrawableSetTransitionAnimState("TRANS_Selected_to_Idle") return end
            EndScript
        End


        AnimationState                =    FREEFALL MOUNTED
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    STUNNED_FLAILING MOUNTED
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                =    DYING SPLATTED MOUNTED DEATH_1
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    DYING SPLATTED MOUNTED DEATH_2
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                =    DYING MOUNTED DEATH_1
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    DYING MOUNTED DEATH_2
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                =    STUNNED_STANDING_UP MOUNTED
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End


        AnimationState                =    STUNNED MOUNTED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE MOUNTED
            Animation           = SPRA
                AnimationName     = RUHHs_Theo_SKL.RUEomrHrs_SPRA
                AnimationMode     = ONCE
            End
            FrameForPristineBonePositions = 60
        End

        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking_throw
            Animation
                AnimationName        = RUEomer_SKL.RUEomer_ATKE
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 58
        End








        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.8 1.8
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.8 1.8
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOVING TURN_LEFT MOUNTED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING TURN_RIGHT MOUNTED
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING ACCELERATE MOUNTED
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE MOUNTED
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange    = 0.55 0.55
            End

        End

        AnimationState                =    MOVING WALKING MOUNTED
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOVING BACKING_UP MOUNTED
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = MountedRunAndFire
                AnimationName       = RUHHs_Theo_SKL.RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_B
            ShareAnimation        = Yes
            Animation           = MountedRunAndFire
                AnimationName       = RUHHs_Theo_SKL.RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING MOUNTED
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End
             Flags                    =    RANDOMSTART

        End

     AnimationState        = MOVING TURN_LEFT_HIGH_SPEED CHARGING
      Animation = Turn
        AnimationName = RUHHs_Theo_SKL.RUHHs_Theo_TNL1
        AnimationMode       = LOOP
        AnimationBlendTime  = 15
      End
      StateName           = Turn_Left_High_Speed
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Moving" or Prev == "Turn_Right_High_Speed" then CurDrawableAllowToContinue() return end
      EndScript
    End

    AnimationState         = MOVING TURN_RIGHT_HIGH_SPEED CHARGING
      Animation = Turn
        AnimationName = RUHHs_Theo_SKL.RUHHs_Theo_TNR1
        AnimationMode       = LOOP
        AnimationBlendTime  = 15
      End
      StateName           = Turn_Right_High_Speed
      BeginScript
        Prev = CurDrawablePrevAnimationState()
        if Prev == "Moving" or Prev == "Turn_Left_High_Speed" then CurDrawableAllowToContinue() return end
      EndScript
    End

    AnimationState            = MOVING TURN_LEFT CHARGING
        Animation            = Turn
            AnimationName        = RUHHs_Theo_SKL.RUHHs_Theo_TRNL
            AnimationMode       = LOOP
            AnimationBlendTime  = 5
        End
    End

    AnimationState          = MOVING TURN_RIGHT CHARGING
      Animation = Turn
        AnimationName = RUHHs_Theo_SKL.RUHHs_Theo_TRNR
        AnimationMode       = LOOP
        AnimationBlendTime  = 5
      End
    End

    AnimationState          = MOVING CHARGING
      Animation = Charge
        AnimationName = RUHHs_Theo_SKL.RUHHs_Theo_RUNA
        AnimationMode       = LOOP
        AnimationBlendTime  = 15
      End
      StateName           = Charging
    End


        AnimationState                =    FIRING_OR_PREATTACK_A MOUNTED
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    FIRING_OR_PREATTACK_B MOUNTED
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_CELEBRATING MOUNTED
                Animation
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    SELECTED MOUNTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
            EndScript
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                = MOUNTED
            Animation
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation            =    IdleB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation            =    IdleC
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    STUNNED_FLAILING
            Flags                    =    RANDOMSTART
            Animation                =    RUEomer_FLYA
                AnimationName        =    RUEomer_SKL.RUEomer_FLYA
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange    = 0.4 0.6
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End




        AnimationState                =    DYING SPLATTED DEATH_1
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End

        AnimationState                =    DYING SPLATTED DEATH_2
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End

        AnimationState                =    DYING DEATH_1
            Animation                =    RUEomer_DIEA
                AnimationName        =    RUEomer_SKL.RUEomer_DIEA
                AnimationMode        =    ONCE
            End
            Animation                =    RUEomer_DIEB
                AnimationName        =    RUEomer_SKL.RUEomer_DIEB
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    DYING DEATH_2
            Animation                =    RUEomer_IDLA
                AnimationName        =    RUEomer_SKL.RUEomer_IDLA
                AnimationMode        =    LOOP
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUEomer_IDLA
                AnimationMode                = ONCE_BACKWARDS
            End
            Flags                            = START_FRAME_FIRST
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    RUEomer_GTPA
                AnimationName        =    RUEomer_SKL.RUEomer_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End

        AnimationState                =    STUNNED
            Animation                =    RUEomer_LNDA
                AnimationName        =    RUEomer_SKL.RUEomer_LNDA
                AnimationMode        =    ONCE
            End
            StateName = NoSword
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Sword"    then CurDrawableSetTransitionAnimState("Trans_Sword_To_Idle") return end
            EndScript
        End



        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUEomer_SKL.RUEomer_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_B
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUEomer_SKL.RUEomer_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState                = MOVING PANICKING
            Animation                = MFDA
                AnimationName        = RUEomer_SKL.RUEomer_MFDA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End


        AnimationState = MOVING ATTACKING
            Animation                =    RUEomer_RUNB
                AnimationName        =    RUEomer_SKL.RUEomer_RUNB
                AnimationMode        =    LOOP
                Distance            =   50
            End
        End

        AnimationState                =    MOVING
            Flags                    =    RANDOMSTART
            Animation                =    RUEomer_RUNA
                AnimationName        =    RUEomer_SKL.RUEomer_RUNA
                AnimationMode        =    LOOP
                Distance            =   30
            End
        End



        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    ATKA
                AnimationName        =    RUEomer_SKL.RUEomer_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKB
                AnimationName        =    RUEomer_SKL.RUEomer_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKC
                AnimationName        =    RUEomer_SKL.RUEomer_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKD
                AnimationName        =    RUEomer_SKL.RUEomer_ATKD
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    FIRING_OR_PREATTACK_B
            Animation                =    ATKA
                AnimationName        =    RUEomer_SKL.RUEomer_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKB
                AnimationName        =    RUEomer_SKL.RUEomer_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKC
                AnimationName        =    RUEomer_SKL.RUEomer_ATKC
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Animation                =    ATKD
                AnimationName        =    RUEomer_SKL.RUEomer_ATKD
                AnimationMode        =    ONCE
                UseWeaponTiming        =   Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = RUEomer_SKL.RUEomer_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRA
                    AnimationMode   =    ONCE
                End
                Animation           =    CHRB
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRB
                    AnimationMode   =    ONCE
                End
                Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            Animation                =    ATNB
                AnimationName        =    RUEomer_SKL.RUEomer_ATNB
                AnimationMode        =    LOOP
            End
            StateName = STATE_Selected
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "STATE_Idle"    then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") return end
            EndScript
        End

        TransitionState = TRANS_Idle_to_Selected
            Animation = IDLF
                AnimationName        = RUEomer_SKL.RUEomer_ATNA
                AnimationMode        = ONCE
            End
        End

        TransitionState = TRANS_Selected_to_Idle
            Animation            = ATNE
                AnimationName    = RUEomer_SKL.RUEomer_ATNE
                AnimationMode    = ONCE
            End
        End



        AnimationState                =    EMOTION_CELEBRATING
                Animation           =    CHRA
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRA
                    AnimationMode   =    ONCE
                End
        End

        AnimationState                =    EMOTION_TAUNTING
                Animation           =    CHRB
                    AnimationName   =    RUEomer_SKL.RUEomer_CHRB
                    AnimationMode   =    ONCE
                End
                Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            = RUEomer_SKL.RUEomer_TNTA
                AnimationMode            = ONCE
            End
            Animation                    = Taunting
                AnimationName            = RUEomer_SKL.RUEomer_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = RUEomer_SKL.RUEomer_IDLA
                AnimationMode     = ONCE
            End
            Flags               = RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_b
                AnimationName = RUEomer_SKL.RUEomer_HITB
                AnimationMode = ONCE
            End
        End



    TransitionState = Trans_Idle_To_Sword
        Animation = Transition
            AnimationName = GUFaramir_SKL.GUFaramir_STHA
            AnimationMode = ONCE
        End
    End


    TransitionState = Trans_Sword_To_Idle
        Animation = Transition
            AnimationName = GUFaramir_SKL.GUFaramir_STHB
            AnimationMode = ONCE
        End
    End


    End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOUNTED MOVING WADING
            ParticleSysBone = None FootstepSlash
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING ACCELERATE
            ParticleSysBone = None GenericSiegeTrailDust
        End
        AnimationState = MOUNTED MOVING
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"




    Side 	       = Rohan
    EditorSorting      = UNIT
    ThreatLevel        = THEODEN_THREAT_LEVEL
    ThingClass         = CHARACTER_UNIT
    BuildCost          = ERKENBRANDDAG_COST
    BuildTime          = WEAK_HERO_BUILDTIME
    DisplayMeleeDamage = ERKENBRANDDAG_DAMAGE

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO

    WeaponSet
        Conditions           = None
        Weapon               = PRIMARY      ErkenbrandChargeWeapon
        Weapon               = SECONDARY    ErkenbrandNewSword
        AutoChooseSources    = PRIMARY NONE
    End

    WeaponSet
        Conditions           = MOUNTED
        Weapon               = PRIMARY      ErkenbrandChargeWeapon
        Weapon               = SECONDARY    ErkenbrandNewSword
        AutoChooseSources    = PRIMARY NONE
    End


    ArmorSet
        Conditions      = None
        Armor           = EdainWarriorHeroArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = MOUNTED
        Armor           = EdainWarriorHeroArmorMounted
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue = ROHAN_THEODEN_BOUNTY_VALUE
    DisplayName = OBJECT:RohanErkenbrand
    RecruitText = CONTROLBAR:RohanErkenbrandRecruit
    ReviveText    = CONTROLBAR:RohanErkenbrandRevive
    Hotkey        = CONTROLBAR:RohanErkenbrandHotkey
    CrusherLevel  = 0
    MountedCrusherLevel = 1
    CrushableLevel = 2
    MountedCrushableLevel = 2
    MaxSimultaneousOfType = 1
    CrushWeapon           = HeroCrush

    MinCrushVelocityPercent     = MINCRUSHVELOCITYPERCENT_HERO
    CrushDecelerationPercent    = CRUSHDECELERATIONPERCENT_HERO

    CrushKnockback = 40
    CrushZFactor = 1.0

    CommandSet = RohanErkenbrandCommandSet
    CommandPoints = 0



    AutoResolveUnitType = AutoResolveUnit_Hero
    AutoResolveCombatChain = AutoResolve_HeroCombatChain

    AutoResolveBody = AutoResolve_FaramirBody

    AutoResolveArmor
        Armor = AutoResolve_FaramirArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_FaramirWeapon
    End

    AutoResolveLeadership = AutoResolve_FaramirBonus




    VoiceAttack            = ErkenbrandVoiceAttack
    VoiceAttackCharge      = ErkenbrandVoiceAttack
    VoiceAttackStructure   = ErkenbrandVoiceAttack
    VoiceCreated           = ErkenbrandVoiceCreated
    VoiceFullyCreated      = ErkenbrandVoiceCreated
    VoiceFear              = ErkenbrandVoiceHelpMe
    VoiceGuard             = ErkenbrandVoiceMove
    VoiceMove              = ErkenbrandVoiceMove
    VoiceMoveToCamp        = ErkenbrandVoiceMove
    VoicePriority          = 80
    VoiceSelect            = ErkenbrandVoiceSelect
    VoiceSelectBattle      = ErkenbrandVoiceSelect

    SoundCrushing          = RohirrimCrushing
    SoundImpact            = ImpactHorse

    UnitSpecificSounds
        VoiceGarrison    = ErkenbrandVoiceSelect
        VoiceEnterUnitElvenTransportShip    = ErkenbrandVoiceMove
        VoiceInitiateCaptureBuilding        = ErkenbrandVoiceMove
    End

    ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
        SoundState = MOUNTED
            VoiceMove            = ErkenbrandVoiceMove
            VoiceSelect          = ErkenbrandVoiceMove
        End
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
    EvaEventDieOwner     = ErkenbrandDie

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:RUTheoden_SKL.RUTheoden_RUNA    Frames:5 16
        AnimationSound = Sound:FootstepDirtA        Animation:RUTheoden_SKL.RUTheoden_RUNB    Frames:4 12 20 27

        AnimationSound = Sound:TauntHumanHitShield    Animation:RUTheoden_SKL.RUTheoden_CHRB    Frames:21 31

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEA    Frames:47
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUTheoden_SKL.RUTheoden_DIEB    Frames:19
        AnimationSound = Sound:BodyFallSoldier        Animation:RUTheoden_SKL.RUTheoden_LNDA    Frames:1

        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Hero
    End




    RadarPriority = UNIT
    KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = RespawnBody ModuleTag_DeathBody
        CheerRadius                      = EMOTION_CHEER_RADIUS
        MaxHealth                        = ERKENBRANDDAG_HEALTH
        PermanentlyKilledByFilter        = NONE
        DodgePercent                     = HERO_DODGE_PERCENT
    End

    Behavior = RespawnUpdate ModuleTag_RespawnUpdate
        DeathAnim                   = DYING
        DeathAnimationTime          = 3333
        RespawnAnim                 = LEVELED
        RespawnAnimationTime        = 2000
        AutoRespawnAtObjectFilter   = NONE +CASTLE_KEEP
        ButtonImage                 = HIErkenbrand

        RespawnRules =    AutoSpawn:No           Cost:ERKENBRANDDAG_COST       Time:WEAK_HERO_RESPAWNTIME        Health:100%
   End




    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero3
        EffectRadius            = 300
        PingDelay               = 2000
        UpgradeRequired         = Upgrade_TestBuilding_2
        ModifierName            = HamaErkenBrandModifier
        AllowFilter             = ANY +RohanHama ALLIES
    End

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    300
        TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

     Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate             = 500
        HoldGroundCloseRangeDistance    = 60
        AILuaEventsList                 = RohanHeroFunctions
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 100000
        PingDelay               = 2000
        ModifierName            = ErkenbrandUnitsModifier
        AllowFilter             = ANY +IsenfurtReiter_Summoned ALLIES
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_GOOD_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = ROHAN_MOUNTED_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HeroHorseEnragedLocomotor
        Condition = SET_ENRAGED
        Speed     = FAST_MOUNTED_HERO_SPEED
    End

   Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = ErkenbrandHeroEffect
            FireDelay = 0
            OneShot = No
        End
        ChargingModeTrigger = Yes
        AliveOnly = Yes
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseEnabler
        SpecialPowerTemplate         = SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate        = SpecialAbilityToggleMounted
         UnpackTime                  = ROHAN_MOUNT_TIME
         PreparationTime             = 1
         PersistentPrepTime          = 250
         PackTime                    = ROHAN_MOUNT_TIME
         OpacityTarget               = .3
         AwardXPForTriggering        = 0
         TriggerInstantlyOnCreate    = No
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FeldmedizinStarter
        SpecialPowerTemplate            = SpecialAbilityFeldmedizin
        TriggeredBy                     = Upgrade_Level_3
    End

    Behavior = SpecialPowerModule ModuleTag_FeldmedizinDummy
        SpecialPowerTemplate            = SpecialAbilityFeldmedizin
        StartsPaused                    = Yes
        UpdateModuleStartsAttack        = Yes
    End

    Behavior = ActivateModuleSpecialPower ModuleTag_CloseTheGap
	SpecialPowerTemplate			= SpecialAbilityFeldmedizin
	StartAbilityRange			= 200
	TriggerSpecialPower			= ModuleTag_FeldmedizinHeal        TARGETPOS
    End

    Behavior = PlayerHealSpecialPower ModuleTag_FeldmedizinHeal
	SpecialPowerTemplate			= SpecialAbilityActivateeDummy
	HealAmount				= 0.75
	HealAsPercent				= Yes
	HealAffects				= INFANTRY CAVALRY HERO
	HealRadius				= 200
	HealFX					= FX_SpellHealUnitHealBuff
	InitiateSound				= AragornAthelesEffect
	TriggerFX				= FX_DainMightyRage02
   End

   Behavior = AutoAbilityBehavior ModuleTag_FieldMedicAutoAbilityBehavior

	SpecialAbility	= SpecialAbilityFeldmedizin
	ForbiddenStatus = INSIDE_GARRISON

	MaxScanRange	= 200
	Query		= 3 ANY ALLIES +HORDE
	Query		= 20 ALL ENEMIES
   End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership1
        SpecialPowerTemplate = SpecialAbilityFakeLeadership2
        TriggeredBy = Upgrade_Level_5
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate1
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack  = No
		StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership12
        StartsActive            = No
        BonusName               = ErkenbrandLeadership
        TriggeredBy             = Upgrade_Level_5
        RefreshDelay            = 2000
        Range                   = 300
        ObjectFilter            = ANY +IsenfurtReiter_Hauptmann +IsenfurtSpeertrager_Hauptmann +IsenfurtWachter_Hauptmann +IsenfurtWachter +IsenfurtSpeertrager +IsenfurtReiter -HERO -STRUCTURE -DOZER -MACHINE -SHIP ALLIES
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HornburgEnabler
        SpecialPowerTemplate         = SpecialAbilityMeisterderHornburg
        TriggeredBy                  = Upgrade_Level_7
    End

    Behavior = SpecialPowerModule ModuleTag_HornburgUpdate
        SpecialPowerTemplate         = SpecialAbilityMeisterderHornburg
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = MeisterderHornBurgModifier
        AttributeModifierRange       = 200
        AttributeModifierAffectsSelf = Yes
        AttributeModifierAffects     = ANY +IsenfurtWachter +IsenfurtSpeertrager +IsenfurtReiter +IsenfurtSpeertrager_Hauptmann +IsenfurtWachter_Hauptmann +IsenfurtReiter_Hauptmann
        AttributeModifierFX          = FX_ErkenbrandChargeFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime                   = 0
        UnpackingVariation           = 1
        SpecialPowerTemplate         = SpecialAbilityMeisterderHornburg
        PreparationTime              = 0
        PersistentPrepTime           = 0
        PackTime                     = 0
     End

    Behavior = AutoAbilityBehavior ModuleTag_HornburgAutoAbility
        SpecialAbility               = SpecialAbilityMeisterderHornburg
        MaxScanRange                 = 100
        Query                        = 3 ANY +HORDE +HERO ENEMIES
    End


    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 80
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL ErkenbrandVoiceDie
        DeathFlags = DEATH_1
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        FadeDelay = 0
        FadeTime = 2500
        DestructionDelay = 2500
        Sound = INITIAL SpellGenericUnsummonFasterMS
        DeathFlags = DEATH_2
        Weapon     = INITIAL ErkenbrandSummonDeathPingWeapon
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End






    Behavior = AISpecialPowerUpdate ErkenbrandStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate ErkenbrandStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate ErkenbrandHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ErkenbrandCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate ErkenbrandFieldMedicAI

	CommandButtonName = Command_SpecialAbilityErkenbrandFeldmedizin
	SpecialPowerAIType = AI_SPECIAL_POWER_HEAL_AOE

	SpecialPowerRadius = 120.0

    End

    Behavior = AISpecialPowerUpdate SpecialPowerErkenbrandGloriousCharge

	CommandButtonName = Command_SpecialAbilityMeisterderHornburg
	SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF

    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryHeight      = 25
    GeometryIsSmall     = Yes

    Shadow              = SHADOW_DECAL
    ShadowSizeX         = 19
    ShadowSizeY         = 19
    ShadowTexture       = ShadowI
End

ChildObject RohanErkenbrand_Summoned RohanErkenbrand
    IsTrainable = No
    CommandPoints = 0
    CommandSet = RohanErkenbrandSummonedCommandSet

    EquivalentTo = RohanErkenbrand

    KindOf = +SUMMONED

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
    End

    Behavior = ExperienceLevelCreate ModuleTag_MPLevelBonus
        LevelToGrant = 5
    End

    MaxSimultaneousOfType    = 1





    Behavior = SpecialPowerModule ModuleTag_SeiteStarter
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack       = Yes
         StartsPaused                   = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Seite
         SpecialPowerTemplate           = SpecialAbilityGandalfGeprufte
         MountedTemplate                = RohanErkenbrand
         SynchronizeTimerOnSpecialPower = ErkenbrandMeisterderHornburg SpecialAbilityFeldmedizin
         UnpackTime                     = OBJECT_TOGGLE_TIME
         PreparationTime                = 0
         PackTime                       = 0
         OpacityTarget                  = .0
         AwardXPForTriggering           = 0
         IgnoreFacingCheck              = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade_Seite
        TriggeredBy                     = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName     = Command_SpecialAbilityGlorfindelRingSwitch
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime      = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End
End

ChildObject RohanErkenbrand_Summoned_forHK RohanErkenbrand
    IsTrainable = Yes
    CommandPoints = 0
    CommandSet = RohanErkenbrandSummonedCommandSet
    MaxSimultaneousOfType    = 1
    EquivalentTo = RohanErkenbrand

    KindOf = +SUMMONED
End

