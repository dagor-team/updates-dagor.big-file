Object RohanCaptain

    SelectPortrait = UPRohanHauptmann
    ButtonImage    = HIRohanHauptmann_Wotr

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarThrallMaster

    Draw = W3DScriptedModelDraw ModuleTag_01

       DefaultModelConditionState
            Model            = rugenerl_skn
       End

        ModelConditionState  = MOUNTED
            Model            = rugenerl_mnt
            Skeleton         = RUHHs_Theo_SKL
            WeaponLaunchBone = PRIMARY PASSENGERBONE
        End


        AnimationState                =    MOUNTED FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    MOUNTED PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End



        AnimationState                =    MOUNTED DYING SPLATTED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End



        AnimationState                =    MOUNTED DYING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    MOUNTED STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    MOUNTED STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED MOUNTED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOUNTED MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End




        AnimationState                =    MOUNTED MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOUNTED TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOUNTED MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOUNTED MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOUNTED MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End

        End


        AnimationState                =    MOUNTED MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                        =    PACKING_TYPE_2 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1 MOUNTED
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End

        AnimationState                =    MOUNTED FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    MOUNTED ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = MOUNTED LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING MOUNTED
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = MOUNTED EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    MOUNTED SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        AnimationState            = MOUNTED
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End





        IdleAnimationState
            StateName = Idle
            Animation           = IDLB
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLB
                AnimationMode     = ONCE
                AnimationPriority   = 20
            End
            Animation           = IDLD
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLD
                AnimationMode     = ONCE
                AnimationPriority   = 1
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        TransitionState       = Trans_None_To_Sword
            Animation           = GUBoromir_STHA
                AnimationName     = GUBoromir_SKL.GUBoromir_STHA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = Trans_Sword_To_None
            Animation           = GUBoromir_STHB
                AnimationName     = GUBoromir_SKL.GUBoromir_STHB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = GUBoromir_FLYA
                AnimationName     = GUBoromir_SKL.GUBoromir_FLYA
                AnimationMode     = LOOP
            End
        End






        AnimationState        = DYING SPLATTED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = GUBoromir_SKL.GUBoromir_MFDA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = GUBoromir_DTHA
                AnimationName     = GUBoromir_SKL.GUBoromir_DTHA
                AnimationMode     = ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBoromir_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GUBoromir_GTPA
                AnimationName     = GUBoromir_SKL.GUBoromir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = PACKING_TYPE_2
            StateName          =    CaptainPower
            Animation           = GUBoromir_CHRA
                AnimationName     = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = UNPACKING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = PREPARING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNB
                AnimationMode     = ONCE
            End
            EnteringStateFX = FX_BoromirHorn
        End
        AnimationState        = PACKING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNC
                AnimationMode     = ONCE
            End
        End
        AnimationState        = SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNB
                AnimationMode     = LOOP
            End
        End



        AnimationState        = MOVING WANDER

            Animation           = GUBoromir_WLKA
                AnimationName     = GUBoromir_SKL.GUBoromir_WLKA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUBoromir_SKL.GUBoromir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = MOVING

            Flags               = RANDOMSTART
            Animation           = GUBoromir_RUNB
                AnimationName     = GUBoromir_SKL.GUBoromir_RUNA
                AnimationMode     = LOOP
            End
        End





        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = GUBoromir_ATD1
                AnimationName     = GUBoromir_SKL.GUBoromir_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATND
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATNE
                AnimationMode            =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    GUBoromir_SKL.GUBoromir_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End


        AnimationState            = EMOTION_TAUNTING
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
        End

        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            =  GUBoromir_SKL.GUBoromir_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End



        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = GUBoromir_SKL.GUBoromir_HITA
                AnimationMode = ONCE
            End
        End


    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End




    Side                = Rohan
    EditorSorting       = UNIT
    ThreatLevel         = 2.0
    TransportSlotCount  = TRANSPORTSLOTCOUNT_UNIT
    BuildCost           = 300
    BuildTime           = MEDIUM_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    ShowHealthInSelectionDecal = Yes
    BountyValue = 40

    WeaponSet
        Conditions        = NONE
        Weapon            = PRIMARY    RohanHauptmannWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions        = MOUNTED
        Weapon            = PRIMARY    RohanHauptmannWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions        = HIDDEN
    End


    ArmorSet
        Conditions      = None
        Armor           = EdainWarriorHeroArmor
        DamageFX        = NormalDamageFX
    End
    ArmorSet
        Conditions      = MOUNTED
        Armor           = EdainWarriorHeroArmorMounted
        DamageFX        = NormalDamageFX
    End


    VisionRange = 250
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    DisplayName           = OBJECT:RohanCaptain
    CrusherLevel          = 0
    CrushableLevel        = 0
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 2
    CrushRevengeWeapon    = AntiCavalryInfantryCrushRevenge

    CommandSet    = RohanHauptmannCommandSet
    CommandPoints = 50

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0





    VoiceAttack                         = TuorVoiceAttack
    VoiceAttackAir                      = TuorVoiceAttack
    VoiceAttackCharge                   = TuorVoiceAttack
    VoiceAttackMachine                  = TuorVoiceAttack
    VoiceAttackStructure                = TuorVoiceAttack
    VoiceCreated                        = TuorVoiceSelect
    VoiceFullyCreated                   = TuorVoiceSelect
    VoiceGuard                          = TuorVoiceMove
    VoiceMove                           = TuorVoiceMove
    VoiceMoveToCamp                     = TuorVoiceMove
    VoiceMoveWhileAttacking             = TuorVoiceAttack
    VoicePriority                       = 60
    VoiceRetreatToCastle                = TuorVoiceMove
    VoiceSelect                         = TuorVoiceSelect
    VoiceSelectBattle                   = TuorVoiceSelect

    SoundImpact                         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip  = TuorVoiceMove
        VoiceGarrison                   = TuorVoiceMove
        VoiceInitiateCaptureBuilding    = TuorVoiceMove
    End

    CrowdResponseKey = GoodMen

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUCaptain_SKL.GUCaptain_HRNA     Frames:7
        AnimationSound = Sound:BoromirHorn            Animation:GUCaptain_SKL.GUCaptain_HRNB     Frames:0
        AnimationSound = Sound:SwordShingClean1        Animation:GUCaptain_SKL.GUCaptain_HRNC     Frames:5
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNA     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNB     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_ATRA     Frames:11 23 35 47
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_MFDA    Frames:8 20 31 41

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_DTHA     Frames:116
        AnimationSound = Sound:BodyFallSoldier        Animation:GUCaptain_SKL.GUCaptain_LNDA     Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_SPCE     Frames:82
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0

    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 1400
        MaxHealthDamaged     = 500
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        AILuaEventsList                =    MordorInfantryBannerFunctions
        MinCowerTime                =    3000
        MaxCowerTime                =    5000
        AttackPriority                =     AttackPriority_Infantry
        BurningDeathTime            =    BURNINGDEATH_DURATION_INFANTRY
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
        MaxQueueEntries = 1
    End

    Behavior = StatusBitsUpgrade ModuleTag_UpgradeStatus
        TriggeredBy = Upgrade_HeroldIsenfurtReiterHorde Upgrade_HeroldRohanWestfoldSpearmen Upgrade_HeroldRohanWestfoldWachter
        StatusToSet = IGNORE_AI_COMMAND SUMMONING_REPLACEMENT
    End

    Behavior = CommandSetUpgrade ModuelTag_UpgradeCmdSet
        TriggeredBy = Upgrade_HeroldIsenfurtReiterHorde Upgrade_HeroldRohanWestfoldSpearmen Upgrade_HeroldRohanWestfoldWachter
        CommandSet  = EmptyCommandSet
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HorseEnabler
        SpecialPowerTemplate = SpecialAbilityToggleMounted
    End

    Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UpdateModuleStartsAttack  = Yes
         StartsPaused              = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate      = SpecialAbilityToggleMounted
         UnpackTime              = ROHAN_MOUNT_TIME
         PreparationTime         = 1
         PersistentPrepTime      = 250
         PackTime                = ROHAN_MOUNT_TIME
         OpacityTarget            = .3
         AwardXPForTriggering    = 0
    End



    Behavior = DoCommandUpgrade ModuleTag_UpgradeSpeer
        TriggeredBy = Upgrade_HeroldRohanWestfoldSpearmen
        GetUpgradeCommandButtonName = Command_SpecialAbilityHeroldSummonRohanWestfoldSpearmen
    End

     Behavior = SpecialPowerModule ModuleTag_SpeerStarter
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonWestfoldSpearmen
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
        TriggerFX                = FX_HeroldSummon
     End

    Behavior = SummonReplacementSpecialAbilityUpdate ModuleTag_Speer
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonWestfoldSpearmen
        UnpackTime               = 1000
        PreparationTime          = 1000
        PersistentPrepTime       = 0
        PackTime                 = 0
        AwardXPForTriggering     = 0
        MountedTemplate          = GetreueSpeerHordeHauptmann
        IgnoreFacingCheck        = Yes
        MustFinishAbility        = Yes
    End



    Behavior = DoCommandUpgrade ModuleTag_UpgradeSchwert
        TriggeredBy = Upgrade_HeroldRohanWestfoldWachter
        GetUpgradeCommandButtonName = Command_SpecialAbilityHeroldSummonRohanWestfoldWachter
    End

     Behavior = SpecialPowerModule ModuleTag_SchwertStarter
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonWestfoldWachter
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
        TriggerFX                = FX_HeroldSummon
     End

    Behavior = SummonReplacementSpecialAbilityUpdate ModuleTag_Schwert
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonWestfoldWachter
        UnpackTime               = 1000
        PreparationTime          = 1000
        PersistentPrepTime       = 0
        PackTime                 = 0
        AwardXPForTriggering     = 0
        MountedTemplate          = GetreueSchwertHordeHauptmann
        IgnoreFacingCheck        = Yes
        MustFinishAbility        = Yes
    End



    Behavior = DoCommandUpgrade ModuleTag_UpgradePferd
        TriggeredBy = Upgrade_HeroldIsenfurtReiterHorde
        GetUpgradeCommandButtonName = Command_SpecialAbilityHeroldSummonIsenfurtReiterHorde
    End

     Behavior = SpecialPowerModule ModuleTag_PferdStarter
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonIsenfurtReiterHorde
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
        TriggerFX                = FX_HeroldSummon
     End

    Behavior = SummonReplacementSpecialAbilityUpdate ModuleTag_Pferd
        SpecialPowerTemplate     = SpecialAbilityHeroldSummonIsenfurtReiterHorde
        UnpackTime               = 1000
        PreparationTime          = 1000
        PersistentPrepTime       = 0
        PackTime                 = 0
        AwardXPForTriggering     = 0
        MountedTemplate          = GetreueReiterHordeHauptmann
        IgnoreFacingCheck        = Yes
        MustFinishAbility        = Yes
    End


    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
         TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 45
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = 110
    End


    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL IsildurVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI1
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 8000
        GrantUpgrade = Upgrade_HeroldRohanWestfoldSpearmen
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_HeroesToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20
  ShadowSizeY = 20
  ShadowTexture = ShadowI


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardBeserkerBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardBeserkerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardBeserkerWeapon
    End
End

Object RohanHauptmannBanner

    SelectPortrait = UPRohanHauptmann
    ButtonImage    = HIRohanHauptmann_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model               = rugenerl_skn
        End



        IdleAnimationState
            StateName = Idle
            Animation           = IDLB
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLB
                AnimationMode     = ONCE
                AnimationPriority   = 20
            End
            Animation           = IDLD
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLD
                AnimationMode     = ONCE
                AnimationPriority   = 1
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        TransitionState       = Trans_None_To_Sword
            Animation           = GUBoromir_STHA
                AnimationName     = GUBoromir_SKL.GUBoromir_STHA
                AnimationMode     = ONCE
            End
        End
        TransitionState       = Trans_Sword_To_None
            Animation           = GUBoromir_STHB
                AnimationName     = GUBoromir_SKL.GUBoromir_STHB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = GUBoromir_FLYA
                AnimationName     = GUBoromir_SKL.GUBoromir_FLYA
                AnimationMode     = LOOP
            End
        End






        AnimationState        = DYING SPLATTED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End


        AnimationState        = DYING AFLAME
            Animation = DieAflame
                AnimationName       = GUBoromir_SKL.GUBoromir_MFDA
                AnimationMode       = LOOP
            End
        End
        AnimationState        = DYING
            Animation           = GUBoromir_DTHA
                AnimationName     = GUBoromir_SKL.GUBoromir_DTHA
                AnimationMode     = ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = GUBoromir_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState        = STUNNED_STANDING_UP
            Animation           = GUBoromir_GTPA
                AnimationName     = GUBoromir_SKL.GUBoromir_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.3 1.3
            End
        End
        AnimationState        = STUNNED
            Animation           = GUBoromir_LNDA
                AnimationName     = GUBoromir_SKL.GUBoromir_LNDA
                AnimationMode     = ONCE
            End
        End



        AnimationState        = PACKING_TYPE_2
            StateName          =    CaptainPower
            Animation           = GUBoromir_CHRA
                AnimationName     = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.2 1.2
            End
        End


        AnimationState        = UNPACKING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNA
                AnimationMode     = ONCE
            End
        End
        AnimationState        = PREPARING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNB
                AnimationMode     = ONCE
            End
            EnteringStateFX = FX_BoromirHorn
        End
        AnimationState        = PACKING SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNC
                AnimationMode     = ONCE
            End
        End
        AnimationState        = SPECIAL_POWER_1
            Animation
                AnimationName     = GUBoromir_SKL.GUBoromir_HRNB
                AnimationMode     = LOOP
            End
        End



        AnimationState        = MOVING WANDER

            Animation           = GUBoromir_WLKA
                AnimationName     = GUBoromir_SKL.GUBoromir_WLKA
                AnimationMode     = LOOP
            End
        End


        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = GUBoromir_SKL.GUBoromir_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End


        AnimationState        = MOVING

            Flags               = RANDOMSTART
            Animation           = GUBoromir_RUNB
                AnimationName     = GUBoromir_SKL.GUBoromir_RUNA
                AnimationMode     = LOOP
            End
        End





        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = GUBoromir_ATD1
                AnimationName     = GUBoromir_SKL.GUBoromir_ATKB
                AnimationMode     = ONCE
                UseWeaponTiming        = Yes
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End


        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATND
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATND
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATNE
                AnimationName            =    GUBoromir_SKL.GUBoromir_ATNE
                AnimationMode            =    ONCE
            End
        End

        AnimationState                = LEVELED
            Animation                = LevelUp
                AnimationName        = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode        = ONCE
            End
        End

        AnimationState            = RAISING_FLAG
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    GUBoromir_SKL.GUBoromir_ATNB
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End


        AnimationState            = EMOTION_TAUNTING
            Animation           = CHRA
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRA
                AnimationMode   = Once
            End
        End

        AnimationState            = EMOTION_CELEBRATING
            Animation           = CHRB
                AnimationName   = GUBoromir_SKL.GUBoromir_CHRB
                AnimationMode   = Once
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                    = EMOTION_ALERT EMOTION_MORALE_HIGH
            Animation                    = Taunting
                AnimationName            =  GUBoromir_SKL.GUBoromir_TNTB
                AnimationMode            = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = GUBoromir_SKL.GUBoromir_IDLA
                AnimationMode     = LOOP
            End

        End



        AnimationState = HIT_REACTION HIT_LEVEL_1
            Animation = Hit_Level_1_a
                AnimationName = GUBoromir_SKL.GUBoromir_HITA
                AnimationMode = ONCE
            End
        End

    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End








    Side                = Rohan
    EditorSorting       = UNIT
    ThreatLevel         = 2.0
    TransportSlotCount  = TRANSPORTSLOTCOUNT_UNIT
    BuildCost           = 300
    BuildTime           = MEDIUM_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    ShowHealthInSelectionDecal = Yes
    BountyValue = 40

    WeaponSet
        Conditions        = NONE
        Weapon            = PRIMARY    RohanHauptmannWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions        = HIDDEN
    End


    ArmorSet
        Conditions      = None
        Armor           = EdainWarriorHeroArmor
        DamageFX        = NormalDamageFX
    End

    VisionRange = 200
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    DisplayName           = OBJECT:RohanCaptain
    CrusherLevel          = 0
    CrushableLevel        = 0
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 2
    CrushRevengeWeapon    = AntiCavalryInfantryCrushRevenge

    CommandSet    = RohanHauptmannCommandSet
    CommandPoints = 50




    VoiceAttack                         = TuorVoiceAttack
    VoiceAttackAir                      = TuorVoiceAttack
    VoiceAttackCharge                   = TuorVoiceAttack
    VoiceAttackMachine                  = TuorVoiceAttack
    VoiceAttackStructure                = TuorVoiceAttack
    VoiceGuard                          = TuorVoiceMove
    VoiceMove                           = TuorVoiceMove
    VoiceMoveToCamp                     = TuorVoiceMove
    VoiceMoveWhileAttacking             = TuorVoiceAttack
    VoicePriority                       = 60
    VoiceRetreatToCastle                = TuorVoiceMove
    VoiceSelect                         = TuorVoiceSelect
    VoiceSelectBattle                   = TuorVoiceSelect

    SoundImpact                         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip  = TuorVoiceMove
        VoiceGarrison                   = TuorVoiceMove
        VoiceInitiateCaptureBuilding    = TuorVoiceMove
    End

    CrowdResponseKey = GoodMen

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUCaptain_SKL.GUCaptain_HRNA     Frames:7
        AnimationSound = Sound:BoromirHorn            Animation:GUCaptain_SKL.GUCaptain_HRNB     Frames:0
        AnimationSound = Sound:SwordShingClean1        Animation:GUCaptain_SKL.GUCaptain_HRNC     Frames:5
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNA     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNB     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_ATRA     Frames:11 23 35 47
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_MFDA    Frames:8 20 31 41

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_DTHA     Frames:116
        AnimationSound = Sound:BodyFallSoldier        Animation:GUCaptain_SKL.GUCaptain_LNDA     Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_SPCE     Frames:82
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End





    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HEAVY_MELEE_HITTER IGNORES_SELECT_ALL BANNER
    PathfindDiameter = 40.0


    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 1600
        MaxHealthDamaged     = 500
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
    End

    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
         TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End

    LocomotorSet
        Locomotor = TheodenHumanLocomotor
        Condition = SET_NORMAL
        Speed     = 45
    End

    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_MOUNTED
        Speed     = 110
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 80
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL IsildurVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End



    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
        MaxQueueEntries = 1
    End






    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate              = 12000
        MeleeFreeUnitSpawnTime     = 24000
        DiedRespawnTime            = 12000
        MeleeFreeBannerReSpawnTime = 24000

        BannerMorphFX        = FX_BannerCarrierMorph
        UnitSpawnFX            = FX_BannerCarrierSpawnUnit
    End








    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate TheodenToggleMountedAI
        CommandButtonName = Command_HeroesToggleMounted
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MOUNTED
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20
  ShadowSizeY = 20
  ShadowTexture = ShadowI


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardBeserkerBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardBeserkerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardBeserkerWeapon
    End
End


Object RohanHauptmannBannerMounted

    SelectPortrait = UPRohanHauptmann
    ButtonImage    = HIRohanHauptmann_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model               = rugenerl_mnt
            Skeleton            = RUHHs_Theo_SKL
            WeaponLaunchBone    = PRIMARY PASSENGERBONE
        End



        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End



        AnimationState                =    DYING SPLATTED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
                AnimationBlendTime  =   2
            End
            FXEvent    = Frame:2 Name:FX_SplatDust
        End



        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 3.5 3.5
            End
        End

        AnimationState                =    STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = RunAndFire
                AnimationName       = RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End




        AnimationState                =    MOVING USING_SPECIAL_ABILITY
            Animation                =    RousingSpeech
                AnimationName        =    RUHHs_Theo_WLKB
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.2 1.2
                AnimationBlendTime    =    20
            End
        End


        AnimationState                =    MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 0.6 0.6
            End

        End

        AnimationState                =    MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End

        End


        AnimationState                =    MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End

        End

        AnimationState                        =    PACKING_TYPE_2
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_SPCA
                AnimationMode                =    ONCE
                AnimationBlendTime    =    20
            End
        End

        AnimationState                        =    PACKING_TYPE_1
            StateName                        =    SPELL
            Animation                        =    SPCC
                AnimationName                =    RUHHs_Theo_IDLC
                AnimationSpeedFactorRange    =    0.842 0.842
                AnimationMode                =    ONCE
            End
        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
                UseWeaponTiming        =    Yes
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    ATTACKING
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_ATKA
                AnimationMode        =    MANUAL
            End
        End

        AnimationState                = LEVELED
            StateName                = Idle
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = ONCE
                AnimationSpeedFactorRange    =    0.666 0.666
            End
        End

        AnimationState                =    RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                = EMOTION_CELEBRATING
            Animation                = LevelUp
                AnimationName        = RUHHs_Theo_IDLC
                AnimationMode        = LOOP
            End
        End

        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_MountedSelect") end
            EndScript
        End

        TransitionState                =    TRANS_MountedSelect
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        IdleAnimationState
            StateName = Idle
            Animation    =    IdleA
                AnimationName        =    RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleB
                AnimationName        =    RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation                =    IdleC
                AnimationName        =    RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End
     End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End






    Side                = Rohan
    EditorSorting       = UNIT
    ThreatLevel         = 2.0
    TransportSlotCount  = TRANSPORTSLOTCOUNT_UNIT
    BuildCost           = 300
    BuildTime           = MEDIUM_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG
    ShowHealthInSelectionDecal = Yes
    BountyValue = 40

    WeaponSet
        Conditions        = NONE
        Weapon            = PRIMARY    RohanHauptmannWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End
    WeaponSet
        Conditions        = HIDDEN
    End


    ArmorSet
        Conditions      = None
        Armor           = EdainWarriorHeroArmorMounted
        DamageFX        = NormalDamageFX
    End



    VisionRange = 200
    ShroudClearingRange = 400
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    DisplayName           = OBJECT:RohanCaptain
    CrusherLevel          = 0
    CrushableLevel        = 0
    MountedCrusherLevel   = 1
    MountedCrushableLevel = 2
    CrushRevengeWeapon    = AntiCavalryInfantryCrushRevenge

    CommandSet    = RohanHauptmannCommandSet
    CommandPoints = 50

    CrushWeapon        = HeroCrush

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0




    VoiceAttack                         = TuorVoiceAttack
    VoiceAttackAir                      = TuorVoiceAttack
    VoiceAttackCharge                   = TuorVoiceAttack
    VoiceAttackMachine                  = TuorVoiceAttack
    VoiceAttackStructure                = TuorVoiceAttack
    VoiceGuard                          = TuorVoiceMove
    VoiceMove                           = TuorVoiceMove
    VoiceMoveToCamp                     = TuorVoiceMove
    VoiceMoveWhileAttacking             = TuorVoiceAttack
    VoicePriority                       = 60
    VoiceRetreatToCastle                = TuorVoiceMove
    VoiceSelect                         = TuorVoiceSelect
    VoiceSelectBattle                   = TuorVoiceSelect

    SoundImpact                         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip  = TuorVoiceMove
        VoiceGarrison                   = TuorVoiceMove
        VoiceInitiateCaptureBuilding    = TuorVoiceMove
    End

    CrowdResponseKey = GoodMen

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SwordIntoScabbard1        Animation:GUCaptain_SKL.GUCaptain_HRNA     Frames:7
        AnimationSound = Sound:BoromirHorn            Animation:GUCaptain_SKL.GUCaptain_HRNB     Frames:0
        AnimationSound = Sound:SwordShingClean1        Animation:GUCaptain_SKL.GUCaptain_HRNC     Frames:5
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNA     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_RUNB     Frames:10 22
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_ATRA     Frames:11 23 35 47
        AnimationSound = Sound:FootstepDirtA        Animation:GUCaptain_SKL.GUCaptain_MFDA    Frames:8 20 31 41

        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_DTHA     Frames:116
        AnimationSound = Sound:BodyFallSoldier        Animation:GUCaptain_SKL.GUCaptain_LNDA     Frames:4
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:GUCaptain_SKL.GUCaptain_SPCE     Frames:82
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_ACCL    Frames:14 32
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_RUNA    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNL1    Frames:0
        AnimationSound = Sound:HorseMoveFootsteps        Animation:RUHHs_Theo_SKL.RUHHs_Theo_TNR1    Frames:0

        AnimationSound = Sound:HorseWhinny            Animation:RUHHs_Theo_SKL.RUHHs_Theo_IDLC    Frames:3

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:0
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_LNDA    Frames:1 9

        AnimationSound = Sound:HorseDieForHero        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:0
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:4
        AnimationSound = Sound:BodyFallSoldier        Animation:RUHHs_Theo_SKL.RUHHs_Theo_DIEA    Frames:42
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End





    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE HEAVY_MELEE_HITTER IGNORES_SELECT_ALL BANNER
    PathfindDiameter = 40.0

    Body = ActiveBody ModuleTag_02
        CheerRadius          = EMOTION_CHEER_RADIUS
        MaxHealth            = 1800
        MaxHealthDamaged     = 500
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
    End


    Behavior = AutoHealBehavior ModuleTag_TheodenHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    300
         TauntAndPointUpdateDelay    =    1000

        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
    End


    LocomotorSet
        Locomotor = HeroHorseLocomotor
        Condition = SET_NORMAL
        Speed     = 110
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = 80
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL IsildurVoiceDie
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 0.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End


    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
        MaxQueueEntries = 1
    End






    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate              = 12000
        MeleeFreeUnitSpawnTime     = 24000
        DiedRespawnTime            = 12000
        MeleeFreeBannerReSpawnTime = 24000

        BannerMorphFX        = FX_BannerCarrierMorph
        UnitSpawnFX            = FX_BannerCarrierSpawnUnit
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 20
  ShadowSizeY = 20
  ShadowTexture = ShadowI


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_IsengardBeserkerBody

    AutoResolveArmor
        Armor = AutoResolve_IsengardBeserkerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_IsengardBeserkerWeapon
    End
End

ChildObject RohanHauptmannForAI RohanCaptain
    MaxSimultaneousOfType    = 2
End

Object RohanHauptmannMountedForAI
End


Object RohanHeerlagerHauptmann

    SelectPortrait = HPArgelebPortrait

    Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model            = RUGeneral_SKA
            WeaponLaunchBone = PRIMARY SPEAR
            WeaponLaunchBone = SECONDARY SPEAR
            WeaponLaunchBone = TERTIARY SPEAR
        End



        AnimationState                =    FREEFALL
            Animation                =    freefall
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    STUNNED_FLAILING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_FLYC
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End


        AnimationState                =    DYING SPLATTED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                =    DYING
            Animation                =    JustDie
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DIEA
                AnimationMode        =    ONCE
            End
        End


        AnimationState                =    STUNNED_STANDING_UP
            Animation                =    StandUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_GTPA
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End


        AnimationState                =    STUNNED
            Animation                =    Land
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_LNDA
                AnimationMode        =    ONCE
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationMode                = LOOP
            End
        End


        AnimationState        =  SPECIAL_WEAPON_ONE
            Animation           = SPRA
                AnimationName     = RUHHs_Theo_SKL.RUEomrHrs_SPRA
                AnimationMode     = ONCE
            End
            FrameForPristineBonePositions = 60
        End

        AnimationState = PACKING_TYPE_1
            StateName = STATE_PlantingTotem_Mounted
            Animation
                AnimationName = RUHHs_Theo_SKL.RUEomrHrs_SPRA
                AnimationMode = ONCE
            End
        End

        AnimationState        =  SPECIAL_WEAPON_ONE
            StateName = Attacking_throw
            Animation
                AnimationName        = RUEomer_SKL.RUEomer_ATKE
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 58
        End

        AnimationState = PACKING_TYPE_1
            StateName = STATE_PlantingTotem
            Animation
                AnimationName = RUEomer_SKL.RUEomer_ATKE
                AnimationMode = ONCE
            End
        End


        AnimationState        =  SPECIAL_WEAPON_TWO
            Animation           = CHRA
                AnimationName     = RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                AnimationMode     = ONCE
            End
        End




        AnimationState                =    PASSENGER
            Animation                =    grabbed
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_GBDA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART
        End

        AnimationState                =    TURN_LEFT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNL1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.8 1.8
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    TURN_RIGHT_HIGH_SPEED
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TNR1
                AnimationMode        =    LOOP
                AnimationSpeedFactorRange= 1.8 1.8
                AnimationBlendTime    =    20
            End
        End

        AnimationState                =    MOVING TURN_LEFT
            Animation                =    TurnLeft
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING TURN_RIGHT
            Animation                =    TurnRight
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_TRNR
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING ACCELERATE
            Animation                =    Accelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ACCL
                AnimationMode        =    LOOP
            End

        End

        AnimationState                =    MOVING DECELERATE
            Animation                =    Decelerate
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_DECL
                AnimationMode        =    ONCE
                AnimationSpeedFactorRange    = 0.55 0.55
            End

        End

        AnimationState                =    MOVING WALKING
            Animation                =    Walk
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_WLKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState                =    MOVING BACKING_UP
            Animation                =    BackingUp
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_BAKA
                AnimationMode        =    LOOP
            End
            Flags                    =    RANDOMSTART

        End

        AnimationState        = MOVING FIRING_OR_PREATTACK_A
            ShareAnimation        = Yes
            Animation           = MountedRunAndFire
                AnimationName       = RUHHs_Theo_SKL.RUHHs_Theo_ATRA
                AnimationMode       = LOOP
            End
            Flags               = RANDOMSTART
        End

        AnimationState                =    MOVING
            Animation                =    RunA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_RUNA
                AnimationMode        =    LOOP
            End
             Flags                    =    RANDOMSTART

        End

        AnimationState                =    FIRING_OR_PREATTACK_A
            Animation                =    AttackA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKA
                AnimationMode        =    ONCE
            End
            Animation                =    AttackB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATKB
                AnimationMode        =    ONCE
            End
            Flags                    =    RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    RAISING_FLAG
                Animation           =    CHRA
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_CELEBRATING
                Animation
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    EMOTION_TAUNTING
                Animation
                    AnimationName   =    RUHHs_Theo_SKL.RUHHs_Theo_CHRA
                    AnimationMode   =    LOOP
                End
        End

        AnimationState                =    SELECTED
            SimilarRestart            =   Yes
            StateName                =    AtAttentionIdle
            Animation                =    ATNB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLH
                AnimationMode        =    LOOP
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
                if Prev == "AtAttentionIdle" then CurDrawableSetTransitionAnimState("TRANS_Select") end
            EndScript
        End

        TransitionState                =    TRANS_Select
            Animation                =    ATNA
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_ATNA
                AnimationMode        =    ONCE
            End
        End

        IdleAnimationState
            Animation       = Idle
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLA
                AnimationPriority    =    20
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation            =    IdleB
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLB
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Animation            =    IdleC
                AnimationName        =    RUHHs_Theo_SKL.RUHHs_Theo_IDLC
                AnimationMode        =    ONCE
                AnimationBlendTime    =    15
            End
            Flags                =    RESTART_ANIM_WHEN_COMPLETE
        End
    End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bhorsebox
        End
    End

    #include "..\..\..\includes\StunDrawModuleMedium.inc"


    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 50

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    RohanRohirrimSpear
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = EdainWarriorHeroArmorMounted
        DamageFX        = NormalDamageFX
    End


    VisionRange = VISION_STANDARD_MELEE
    ShroudClearingRange = SHROUD_CLEAR_STANDARD

    BountyValue = ROHAN_BANNER_BOUNTY_VALUE
    DisplayName = OBJECT:RohanGeneral
    CrusherLevel = 1
    CrushableLevel = 2
    CrushRevengeWeapon = BasicInfantryCrushRevenge
    CrushWeapon       = RohirrimCrush

    CommandSet = EmptyCommandSet




    VoiceCombineWithHorde     = RohanBannerVoiceJoin
      VoiceCreated        = RohanBannerVoiceSalute
    VoiceMove            = RohanBannerVoiceMove
    VoicePriority        = 20
    VoiceSelect            = RohanBannerVoiceSelectMS

    SoundImpact         = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitElvenTransportShip    = RohanBannerVoiceMove
        VoiceGarrison                        = RohanBannerVoiceMove
        VoiceInitiateCaptureBuilding        = RohanBannerVoiceMove
    End

    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Rohan_Banner
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End



  RadarPriority = UNIT
  KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY PATH_THROUGH_EACH_OTHER CAN_USE_SIEGE_TOWER SCORE THROWN_OBJECT BANNER GRAB_AND_DROP IGNORES_SELECT_ALL
  CamouflageDetectionMultiplier = CAMOUFLAGE_DETECTION_DISTANCE_MEDIUM

    BuildCost = ROHAN_BANNER_COST
    BuildTime = STRONG_BUILDTIME

    Body = ActiveBody ModuleTag_02
        MaxHealth         = 1300
        MaxHealthDamaged  = 600
        RecoveryTime      = ROHAN_BANNER_HEALTH_RECOVERY_TIME
        BurningDeathBehavior    = Yes
        BurningDeathFX            = FX_CavalryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        AttackPriority                =     AttackPriority_Infantry
        AILuaEventsList                =    CavalryFunctions
        BurningDeathTime            = BURNINGDEATH_DURATION_CAVALRY
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = NormalHorseHordeMemberLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_CAVALRY_FAST_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorCavalry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_CAVALRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -KNOCKBACK -FADED -EXTRA_8
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL RohanBannerVoiceDie
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        Sound = INITIAL SpellGenericUnsummonFasterMS
    End

    Behavior = SquishCollide ModuleTag_06

    End




    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000

        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection
    End






    Behavior = SpecialPowerModule ModuleTag_BoromirLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BoromirLeadership
        StartsActive    = Yes
        BonusName       = HauptmannLeadership
        RefreshDelay    = 2000
        Range           = 200
        AntiCategory    = BUFF
        ObjectFilter    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End


    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End



  Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.5
        DestructionDelay = 8000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
  End

  Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus = DEATH_4
        StartsActive   = Yes
        DelayTime      = 0
        DeathWeapon    = GrabandDropHorsesImpactWarhead
        WeaponOffset   = X:0 Y:0 Z:0
  End

  Behavior = BezierProjectileBehavior ModuleTag_BodyHitHorse
        FirstHeight               = 24
        SecondHeight              = 24
        FirstPercentIndent        = 30%
        SecondPercentIndent       = 70%
        TumbleRandomly            = Yes
        CrushStyle                = Yes
        DieOnImpact               = Yes
        BounceCount               = 1
        BounceDistance            = 40
        BounceFirstHeight         = 24
        BounceSecondHeight        = 24
        BounceFirstPercentIndent  = 20%
        BounceSecondPercentIndent = 80%
        GroundHitFX               = FX_GrabandDropHorsesGroundHit
        GroundBounceFX            = FX_GrabandDropHorsesGroundHit
  End


    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 7
        HitReactionLifeTimer2 = 15
        HitReactionLifeTimer3 = 10

        HitReactionThreshold1 = 5.0
        HitReactionThreshold2 = 25.0
        HitReactionThreshold3 = 50.0
    End

    Behavior = SubObjectsUpgrade Show_Topper
        TriggeredBy        = Upgrade_AllFactionUpgrade
        HideSubObjects    = Glow
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes
  Shadow = SHADOW_DECAL
  ShadowSizeX = 19
  ShadowSizeY = 19
  ShadowTexture = ShadowI
End


