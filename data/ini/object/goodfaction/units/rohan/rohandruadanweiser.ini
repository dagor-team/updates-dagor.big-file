Object DruedainWeiser


    ButtonImage    = HSDruedainHeiler
    SelectPortrait = UPDruedainHeiler

    DescriptionStrategic = CONTROLBAR:LW_ToolTip_Saruman

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

        ExtraPublicBone = STAFFFX

        DefaultModelConditionState
            Model               = rudruheiler
            Skeleton            = IUSaruman_SKL
            WeaponLaunchBone    = PRIMARY STAFFFX
        End



        IdleAnimationState
            StateName = Idle
            Animation = IDLB
                AnimationName       = IUSaruman_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End

            Animation = IDLC
                AnimationName       = IUSaruman_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 3
            End

            Animation = IDLD
                AnimationName       = IUSaruman_IDLD
                AnimationMode       = ONCE
                AnimationPriority   = 1
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = FLYA
                AnimationName     = IUSaruman_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState            = DYING BURNINGDEATH DEATH_1
            Animation
                AnimationName    = IUSaruman_DIEB
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING AFLAME DEATH_1
            Animation = DieAflame
                AnimationName     = IUSaruman_MFDA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = DYING DEATH_1
            Animation = DieB
                AnimationName     = IUSaruman_DIEB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation = ByeBye
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation
                AnimationName     = IUSaruman_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = IUSaruman_MFDA
                AnimationMode    = LOOP
                Distance        = 50
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUSaruman_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState                = PACKING_TYPE_1
            StateName                = Dominate
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanDominateAtSelf
        End


        AnimationState                = PACKING_TYPE_2
            StateName                = Spped_Craft
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
            End
            FXEvent    = Frame:15    Name: FX_SpeechCraft
        End


        AnimationState                = PACKING_TYPE_3
            StateName                = Dominate
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanCurunirAtSelf
        End




         AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = IUSaruman_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART

        End


         AnimationState                = MOVING USING_SPECIAL_ABILITY
             Flags                    = RANDOMSTART
             Animation                = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
         End



         AnimationState            = MOVING BACKING_UP
            Animation            = BackingUp
                AnimationName    = IUSaruman_BAKA
                AnimationMode    = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState        = MOVING ATTACKING
             Animation              = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
        End

        AnimationState        = MOVING
             Animation                = IUSaruman_RUNA
                 AnimationName     = IUSaruman_RUNA
                 AnimationMode     = LOOP
             End
        End


        AnimationState          = SPECIAL_WEAPON_ONE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_ATKB
                AnimationMode        = ONCE
            End
            FrameForPristineBonePositions = 27
        End


         AnimationState        =  SPECIAL_WEAPON_TWO
            StateName = Attacking
            Animation
                AnimationName       = IUSaruman_ATKB
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 27
        End


        AnimationState          = SPECIAL_WEAPON_THREE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        =    Yes
            End
            FrameForPristineBonePositions = 48
            FXEvent    = Frame:6    Name: FX_SarumanWeiﬂerRatAtSelf
        End



        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = IUSaruman_ATKC
                AnimationName     = IUSaruman_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End

            Animation           = IUSaruman_ATKD
                AnimationName     = IUSaruman_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End
        End


        AnimationState = WAR_CHANT




            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = LOOP
            End
        End

        AnimationState = EMOTION_TAUNTING
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = EMOTION_CELEBRATING
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = IUSaruman_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End

        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    IUSaruman_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATND
                AnimationName            =    IUSaruman_ATND
                AnimationMode            =    ONCE
            End
        End


        AnimationState        = LEVELED
            Animation = Yippee
                AnimationName       = IUSaruman_TNTA
                AnimationMode       = ONCE
            End
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState = RAISING_FLAG
            Animation = Chant
                AnimationName = IUSaruman_TNTA
                AnimationMode = ONCE
            End
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    IUSaruman_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End

    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = SARUMAN_THREAT_LEVEL
    ThingClass = CHARACTER_UNIT
    BuildCost           = 200
    BuildTime           = WEAK_BUILDTIME
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_STRONG

    TransportSlotCount = TRANSPORTSLOTCOUNT_HERO

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    DruedainWeiserWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions      = None
        Armor           = GOOD_REGULAR_SWORDS
        DamageFX        = NormalDamageFX
    End

    VisionRange = VISION_STANDARD_MELEE
    ShroudClearingRange = SHROUD_CLEAR_HERO
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    BountyValue     = 100
    DisplayName        = OBJECT:DruedainWeiser
    CrushableLevel    = 2
    CrusherLevel = 0

    CommandSet = DruedainWeiserCommandSet
    CommandPoints = 10





    VoiceAttack                            = WildMenVoiceAttack
    VoiceAttackCharge                    = WildMenVoiceAttackCharge
    VoiceAttackMachine                    = WildMenVoiceAttack
    VoiceAttackStructure                = WildMenVoiceAttackBuilding
    VoiceGuard                            = WildMenVoiceMove
    VoiceMove                            = WildMenVoiceMove
    VoiceMoveToCamp                        = WildMenVoiceMoveCamp
    VoiceMoveWhileAttacking                = WildMenVoiceMove
    VoicePriority                        = 52
    VoiceRetreatToCastle                = WildMenVoiceMove
    VoiceSelect                            = WildMenVoiceSelectMS
    VoiceSelectBattle                     = WildMenVoiceSelectBattle

    SoundImpact                            = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip    = WildMenVoiceMoveShip
        VoiceEnterUnitMordorMumakil            = WildMenVoiceMoveGarrison
        VoiceEnterUnitSlaughterHouse        = WildMenVoiceMoveGarrison
        VoiceGarrison                        = WildMenVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = WildMenVoiceCaptureBuilding
    End


    CrowdResponseKey = GoodMen

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Hero
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKB    Frames:39 104
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKC     Frames:43 92
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKD     Frames:13 29 55
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATRA    Frames:9 20 31 43 55 67
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:20
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:34
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_GTPA    Frames:51 75 113 139
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_HITA    Frames:12
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLC    Frames:116 188
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLD    Frames:43
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_LNDA    Frames:4
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_MFDA    Frames:10 19 29 39 48 57 66
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNA    Frames:11 22 34 46 57 69
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNB    Frames:10 23 36 49 62 75
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTA    Frames:36 49 103 123
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTB    Frames:24 111
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE NOTIFY_OF_PREATTACK ARMY_SUMMARY ATTACK_NEEDS_LINE_OF_SIGHT HEAVY_MELEE_HITTER
    PathfindDiameter = 40.0
    CamouflageDetectionMultiplier    = CAMOUFLAGE_DETECTION_DISTANCE_SHEDIUM

    Body = RespawnBody ModuleTag_RespawnBody
        CheerRadius               = EMOTION_CHEER_RADIUS
        MaxHealth                 = 800
        PermanentlyKilledByFilter = NONE
        DodgePercent              = HERO_DODGE_PERCENT
        CheerRadius               = EMOTION_CHEER_RADIUS
    End


    Behavior = AutoHealBehavior ModuleTag_SarumanHealing
        StartsActive = Yes
        HealingAmount = HERO_HEAL_AMOUNT
        HealingDelay = 1000
        StartHealingDelay = HERO_HEAL_DELAY
        HealOnlyIfNotInCombat = Yes
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = Hero

    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS STEALTHED
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance                = 300
        TauntAndPointUpdateDelay            = 10000
        AddEmotion            =    Doom_Base



        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base


        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_EVIL_HERO_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = 32
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStandingTime        = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        ShadowWhenDead = No
        DeathFlags = DEATH_1
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 100
        DeathFlags = DEATH_2
    End

    Behavior = SquishCollide ModuleTag_06

    End

    Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
        HitReactionLifeTimer1 = 3000
        HitReactionThreshold1 = 5.0
    End



    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = No
    End


    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
        EffectRadius        = GONDOR_WELL_AOE_RADIUS
        PingDelay        = 2000
        HealPercentPerSecond    = 3%
        AllowFilter        = ANY +INFANTRY +CAVALRY +HERO -MACHINE +MONSTER -IMMOBILE +DOZER
        NonStackable    = Yes
        HealFX            = FX_SpellHealUnitHealBuff
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate        = 10
        DetectionRange       = 400
        CancelOneRingEffect  = Yes
    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 5000
        UnitSpawnFX                = FX_BannerCarrierSpawnUnit


        ReplenishNearbyHorde    = Yes
        ScanHordeDistance        = 200
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Scale = 0.82
    Geometry                = CYLINDER
    GeometryMajorRadius        = 8.0
    GeometryMinorRadius        = 8.0
    GeometryHeight            = 19.2
    GeometryIsSmall            = Yes

    Shadow                    = SHADOW_DECAL
    ShadowSizeX                = 19
    ShadowSizeY                = 19
    ShadowTexture            = ShadowI
End



Object DruedainWeiserBanner


    ButtonImage = HSDruedainHeiler


    SelectPortrait = UPDruedainHeiler

    Draw = W3DScriptedModelDraw ModuleTag_01

      OkToChangeModelColor = Yes
      StaticModelLODMode = Yes

        DefaultModelConditionState
            Model               = rudruheiler
            Skeleton            = IUSaruman_SKL
            WeaponLaunchBone    = PRIMARY STAFFFX
        End

        ModelConditionState COMING_OUT_OF_FACTORY
            Model               = rudruheiler
            Skeleton            = IUSaruman_SKL
            WeaponLaunchBone    = PRIMARY STAFFFX
        End


        ModelConditionState        = STONED
            Model                  = rudruheiler
            Skeleton               = IUSaruman_SKL
            WeaponLaunchBone       = PRIMARY STAFFFX
            Texture                = rudruaden.tga rudruaden_stone.tga
            Texture                = rudruaden_2.tga rudruaden_2_stone.tga
            Texture                = rudruedain_h.tga rudruedain_h_stone.tga
            Texture                = rudruedain.tga rudruedain_stone.tga
            Texture                = rutreebeard.tga rutreebeard_stone.tga
        End

        AnimationState             = STONED
            Animation              = Stoned
                AnimationName      = IUSaruman_IDLB
                AnimationMode      = MANUAL
                AnimationBlendTime = 40
            End
            Flags    = RANDOMSTART
        End



        IdleAnimationState
            StateName = Idle
            Animation = IDLB
                AnimationName       = IUSaruman_IDLB
                AnimationMode       = ONCE
                AnimationPriority   = 20
            End

            Animation = IDLC
                AnimationName       = IUSaruman_IDLC
                AnimationMode       = ONCE
                AnimationPriority   = 3
            End

            Animation = IDLD
                AnimationName       = IUSaruman_IDLD
                AnimationMode       = ONCE
                AnimationPriority   = 1
            End

            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Selected" then CurDrawableSetTransitionAnimState("TRANS_Selected_To_Idle") end
            EndScript
        End

        AnimationState        = STUNNED_FLAILING
            Flags               = RANDOMSTART
            Animation           = FLYA
                AnimationName     = IUSaruman_FLYA
                AnimationMode     = LOOP
            End
        End


        AnimationState            = DYING BURNINGDEATH DEATH_1
            Animation
                AnimationName    = IUSaruman_DIEB
                AnimationMode    = ONCE
                AnimationBlendTime = 10
            End
        End

        AnimationState        = DYING SPLATTED DEATH_1
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING AFLAME DEATH_1
            Animation = DieAflame
                AnimationName     = IUSaruman_MFDA
                AnimationMode     = LOOP
            End
        End

        AnimationState        = DYING DEATH_1
            Animation = DieB
                AnimationName     = IUSaruman_DIEB
                AnimationMode     = ONCE
            End
        End

        AnimationState        = DYING DEATH_2
            Animation = ByeBye
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End



        AnimationState        = STUNNED_STANDING_UP
            Animation
                AnimationName     = IUSaruman_GTPA
                AnimationMode     = ONCE
                AnimationSpeedFactorRange = 1.5 1.5
            End
        End
        AnimationState        = STUNNED
            Animation
                AnimationName     = IUSaruman_LNDA
                AnimationMode     = ONCE
            End
        End

        AnimationState            = BURNINGDEATH
            Animation
                AnimationName    = IUSaruman_MFDA
                AnimationMode    = LOOP
                Distance        = 50
            End
        End

        AnimationState                        = PARALYZED
            Animation
                AnimationName                = IUSaruman_IDLB
                AnimationMode                = LOOP
            End
        End


        AnimationState                = PACKING_TYPE_1
            StateName                = Dominate
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanDominateAtSelf
        End


        AnimationState                = PACKING_TYPE_2
            StateName                = Spped_Craft
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
            End
            FXEvent    = Frame:15    Name: FX_SpeechCraft
        End


        AnimationState                = PACKING_TYPE_3
            StateName                = Dominate
            Animation
                AnimationName        = IUSaruman_TNTB
                AnimationMode        = ONCE
                AnimationBlendTime  = 5
            End
            FXEvent    = Frame:6    Name: FX_SarumanCurunirAtSelf
        End




         AnimationState = MOVING FIRING_OR_PREATTACK_A
            Animation = TrotAndFire
                AnimationName = IUSaruman_ATRA
                AnimationMode = LOOP
            End
            Flags = RANDOMSTART

        End


         AnimationState                = MOVING USING_SPECIAL_ABILITY
             Flags                    = RANDOMSTART
             Animation                = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
         End



         AnimationState            = MOVING BACKING_UP
            Animation            = BackingUp
                AnimationName    = IUSaruman_BAKA
                AnimationMode    = LOOP
            End
            Flags = RANDOMSTART
        End

        AnimationState        = MOVING ATTACKING
             Animation              = IUSaruman_RUNB
                 AnimationName     = IUSaruman_RUNB
                 AnimationMode     = LOOP
             End
        End

        AnimationState        = MOVING
             Animation                = IUSaruman_RUNA
                 AnimationName     = IUSaruman_RUNA
                 AnimationMode     = LOOP
             End
        End


        AnimationState          = SPECIAL_WEAPON_ONE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_ATKB
                AnimationMode        = ONCE
            End
            FrameForPristineBonePositions = 27
        End


         AnimationState        =  SPECIAL_WEAPON_TWO
            StateName = Attacking
            Animation
                AnimationName       = IUSaruman_ATKB
                AnimationMode       = ONCE
            End
            FrameForPristineBonePositions = 27
        End


        AnimationState          = SPECIAL_WEAPON_THREE
            Animation                = Throwing Fireball
                AnimationName        = IUSaruman_SPCA
                AnimationMode        = ONCE
                UseWeaponTiming        =    Yes
            End
            FrameForPristineBonePositions = 48
            FXEvent    = Frame:6    Name: FX_SarumanWeiﬂerRatAtSelf
        End



        AnimationState        = FIRING_OR_PREATTACK_A
            Animation           = IUSaruman_ATKC
                AnimationName     = IUSaruman_ATKC
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End

            Animation           = IUSaruman_ATKD
                AnimationName     = IUSaruman_ATKD
                AnimationMode     = ONCE
                UseWeaponTiming        =    Yes
            End
        End


        AnimationState = WAR_CHANT




            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = LOOP
            End
        End

        AnimationState = EMOTION_TAUNTING
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState = EMOTION_CELEBRATING
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RANDOMSTART RESTART_ANIM_WHEN_COMPLETE
        End


        AnimationState = HIT_REACTION
            Animation = Hit_Level_1_a
                AnimationName = IUSaruman_HITA
                AnimationMode = ONCE
            End
        End


        AnimationState        = ATTACKING
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End

        TransitionState                    =    TRANS_Idle_to_Selected
            Animation                    =    ATNA
                AnimationName            =    IUSaruman_ATNA
                AnimationMode            =    ONCE
            End
        End

        TransitionState                    =    TRANS_Selected_To_Idle
            Animation                    =    ATND
                AnimationName            =    IUSaruman_ATND
                AnimationMode            =    ONCE
            End
        End


        AnimationState        = LEVELED
            Animation = Yippee
                AnimationName       = IUSaruman_TNTA
                AnimationMode       = ONCE
            End
        End


        AnimationState        = EMOTION_ALERT
            Animation           = ALERT_1
                AnimationName     = IUSaruman_IDLA
                AnimationMode     = LOOP
            End
        End

        AnimationState = RAISING_FLAG
            Animation = Chant
                AnimationName = IUSaruman_TNTA
                AnimationMode = ONCE
            End
            Animation = Chant
                AnimationName = IUSaruman_TNTB
                AnimationMode = ONCE
            End
            Flags                        = RESTART_ANIM_WHEN_COMPLETE
        End

        AnimationState                =    SELECTED
            StateName                =    Selected
            SimilarRestart            =   Yes
            Animation                =    ATNB
                AnimationName        =    IUSaruman_ATNB
                AnimationMode        =    LOOP
                AnimationBlendTime  =   15
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Idle_to_Selected") end
            EndScript
        End
    End

    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"


    Side = Rohan
    EditorSorting = UNIT
    ThreatLevel = 1.0
    ThingClass = HORDE_UNIT
    CommandPoints = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    DruedainWeiserWeapon
        AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    WeaponSet
        Conditions        = HIDDEN
    End

    ArmorSet
        Conditions      = None
        Armor           = GOOD_REGULAR_SWORDS
        DamageFX        = NormalDamageFX
    End




    VisionRange = 200
    VisionSide = 35%
    VisionRear = 25%
    ShroudClearingRange = 350

    DisplayName = OBJECT:DruedainWeiser

    CrusherLevel = 0
    CrushableLevel = 0
    CrushRevengeWeapon = BasicInfantryCrushRevenge

    BuildCost         = GONDOR_BANNER_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    BountyValue     = GONDOR_BANNER_BOUNTY_VALUE
    CommandSet = EmptyCommandSet




    VoiceAttack                            = WildMenVoiceAttack
    VoiceAttackCharge                    = WildMenVoiceAttackCharge
    VoiceAttackMachine                    = WildMenVoiceAttack
    VoiceAttackStructure                = WildMenVoiceAttackBuilding
    VoiceGuard                            = WildMenVoiceMove
    VoiceMove                            = WildMenVoiceMove
    VoiceMoveToCamp                        = WildMenVoiceMoveCamp
    VoiceMoveWhileAttacking                = WildMenVoiceMove
    VoicePriority                        = 52
    VoiceRetreatToCastle                = WildMenVoiceMove
    VoiceSelect                            = WildMenVoiceSelectMS
    VoiceSelectBattle                     = WildMenVoiceSelectBattle

    SoundImpact                            = ImpactHorse

    UnitSpecificSounds
        VoiceEnterUnitEvilMenTransportShip    = WildMenVoiceMoveShip
        VoiceEnterUnitMordorMumakil            = WildMenVoiceMoveGarrison
        VoiceEnterUnitSlaughterHouse        = WildMenVoiceMoveGarrison
        VoiceGarrison                        = WildMenVoiceMoveGarrison
        VoiceInitiateCaptureBuilding        = WildMenVoiceCaptureBuilding
    End

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"

    CrowdResponseKey = GoodMen

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_foo
        ModelCondition = Required:RAISING_FLAG            Excluded:DYING ENGAGED    Sound:EmotionMenGoodCompilationBFME1and2VoxTauntSinglesLoop
    End

    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Humanoid_Male Man Man_Male Unit Infantry Gondor_Soldier
    End

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKB    Frames:39 104
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKC     Frames:43 92
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATKD     Frames:13 29 55
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_ATRA    Frames:9 20 31 43 55 67
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:20
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_DIEB    Frames:34
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_GTPA    Frames:51 75 113 139
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_HITA    Frames:12
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLC    Frames:116 188
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_IDLD    Frames:43
        AnimationSound = Sound:BodyFallGenericNoArmor    Animation:IUSaruman_SKL.IUSaruman_LNDA    Frames:4
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_MFDA    Frames:10 19 29 39 48 57 66
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNA    Frames:11 22 34 46 57 69
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_RUNB    Frames:10 23 36 49 62 75
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTA    Frames:36 49 103 123
        AnimationSound = Sound:FootstepDirtA        Animation:IUSaruman_SKL.IUSaruman_TNTB    Frames:24 111
    End




    RadarPriority = UNIT
    KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY PATH_THROUGH_EACH_OTHER SCORE THROWN_OBJECT GRAB_AND_DROP BANNER IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_02
        CheerRadius       = EMOTION_CHEER_RADIUS
        MaxHealth         = 500
        MaxHealthDamaged  = 250
        BurningDeathBehavior = Yes
        BurningDeathFX       = FX_InfantryBurningFlame
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        AttackPriority             = AttackPriority_Infantry
        AILuaEventsList            = GondorFighterFunctions
        BurningDeathTime           = BURNINGDEATH_DURATION_INFANTRY
    End




    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER

        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor = HumanLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_EVIL_INFANTRY_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = HumanWanderLocomotor
        Condition = SET_WANDER
        Speed     = NORMAL_EVIL_INFANTRY_MEMBER_SPEED
    End

    LocomotorSet
        Locomotor = BurningDeathLocomotorInfantry
        Condition = SET_BURNINGDEATH
        Speed      = BURNINGDEATH_WANDERSPEED_INFANTRY
    End

    Behavior = PhysicsBehavior ModuleTag_04
        GravityMult = 1.0
        ShockStunnedTimeLow        = 1400
        ShockStunnedTimeHigh    = 2400
        ShockStandingTime        = 666
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL -FADED
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
        ShadowWhenDead = No
        DeathFlags = DEATH_1
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
        DeathTypes = NONE +FADED
        SinkDelay = 3000
        SinkRate = 0.60
        DestructionDelay = 100
        DeathFlags = DEATH_2
    End


    Behavior = SquishCollide ModuleTag_06

    End


    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
        EffectRadius        = GONDOR_WELL_AOE_RADIUS
        PingDelay        = 2000
        HealPercentPerSecond    = 1%
        AllowFilter        = ANY +INFANTRY +CAVALRY +HERO -MACHINE +MONSTER -IMMOBILE +DOZER
        NonStackable    = Yes
        HealFX            = FX_SpellHealUnitHealBuff
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate        = 10
        DetectionRange       = 400
        CancelOneRingEffect  = Yes
    End





    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 10000
        MeleeFreeUnitSpawnTime        = 20000
        DiedRespawnTime            = 10000
        MeleeFreeBannerReSpawnTime    = 20000
        BannerMorphFX        = FX_HordeResurrectionWithBannerCarrierSFX
        UnitSpawnFX            = FX_HordeResurrection
    End

    Behavior = SlowDeathBehavior ModuleTag_07

        DeathTypes = NONE +KNOCKBACK
        SinkDelay = 3000
        SinkRate = 0.40
        DestructionDelay = 8000
    End



    Behavior = SlowDeathBehavior ModuleTag_GrabandDrop
        DeathTypes       = NONE +EXTRA_8
        SinkDelay        = 3000
        SinkRate         = 0.60
        DestructionDelay = 10000
        DeathFlags       = DEATH_4
        ShadowWhenDead   = Yes
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_GrabandDropImpact
        RequiredStatus  = DEATH_4
        StartsActive    = Yes
        DelayTime       = 0
        DeathWeapon     = GrabandDropInfantryImpactWarhead
        WeaponOffset    = X:0 Y:0 Z:0
    End

    Behavior = BezierProjectileBehavior ModuleTag_BodyHitHuman
       FirstHeight               = 24
       SecondHeight              = 24
       FirstPercentIndent        = 30%
       SecondPercentIndent       = 70%
       TumbleRandomly            = Yes
       CrushStyle                = Yes
       DieOnImpact               = Yes
       BounceCount               = 1
       BounceDistance            = 40
       BounceFirstHeight         = 24
       BounceSecondHeight        = 24
       BounceFirstPercentIndent  = 20%
       BounceSecondPercentIndent = 80%
       GroundHitFX               = FX_GrabandDropInfantryGroundHit
       GroundBounceFX            = FX_GrabandDropInfantryGroundHit
    End


    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Scale = 0.82
    Geometry = CYLINDER
    GeometryMajorRadius = 8.0
    GeometryMinorRadius = 8.0
    GeometryHeight = 19.2
    GeometryIsSmall = Yes

  Shadow = SHADOW_DECAL
  ShadowSizeX = 19
  ShadowSizeY = 19
  ShadowTexture = ShadowI
End


