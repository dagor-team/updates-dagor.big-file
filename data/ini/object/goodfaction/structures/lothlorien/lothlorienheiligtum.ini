


Object LothlorienHeiligtum

 SelectPortrait = BRHeiligtum

  EquivalentTo = BFME1LothlorienHeiligtum



  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    StaticModelLODMode = Yes
    UseStandardModelNames = Yes

    ExtraPublicBone = ARROW_01
    ExtraPublicBone = ARROW_02
    ExtraPublicBone = ARROW_03
    ExtraPublicBone = ARROW_04

    RandomTexture = sccentmoot.tga  0 sccelvensummon.tga

    DefaultModelConditionState
      Model = lbmystic
      Shadow                      = SHADOW_ALPHA_DECAL_DYNAMIC
      ShadowSizeX                 = 240
      ShadowSizeY                 = 240
      ShadowTexture               = sccentmoot
      ShadowOpacityStart          = 0
      ShadowOpacityFadeInTime     = 1000
      ShadowOpacityPeak           = 200
      ShadowOpacityFadeOutTime    = 1000
      ShadowOpacityEnd            = 0
      ShadowOverrideLODVisibility = Yes
      WeaponLaunchBone = PRIMARY ARROW
    End

    AnimationState = BUILD_PLACEMENT_CURSOR
        BeginScript
            CurDrawableHideSubObject("LVL1")
            CurDrawableHideSubObject("LVL01")
            CurDrawableHideSubObject("LVL2")
            CurDrawableHideSubObject("EUWORKER")
            CurDrawableHideSubObject("EUWORKER01")
        EndScript
    End


    AnimationState = PHANTOM_STRUCTURE
        BeginScript
            CurDrawableHideSubObject("LVL1")
            CurDrawableHideSubObject("LVL01")
            CurDrawableHideSubObject("LVL2")
            CurDrawableHideSubObject("EUWORKER")
            CurDrawableHideSubObject("EUWORKER01")
        EndScript
    End

        IdleAnimationState
            StateName                = STATE_Idle
            Animation                 = lbmystic
                AnimationName            = lbmystic.lbmystic
                    AnimationMode        = ONCE
                End
                Flags                = RESTART_ANIM_WHEN_COMPLETE












        End


    ModelConditionState  = SNOW JUST_BUILT
        Model = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState  = JUST_BUILT
        Model = lbmystic_a
    End

    AnimationState            = JUST_BUILT
            Animation           = lbmystic_a
                AnimationName     = lbmystic_a.lbmystic_a
                AnimationMode     = MANUAL
                AnimationBlendTime = 0
        End
            ParticleSysBone = NONE BuildingContructDustExp
            ParticleSysBone = NONE ExpElven
            BeginScript
                CurDrawablePlaySound("GondorBarracksBeginConstruction")
            EndScript
    End


    ModelConditionState = SNOW AWAITING_CONSTRUCTION
        Model    = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState   = AWAITING_CONSTRUCTION
      Model               = lbmystic_a

    End
    AnimationState        = AWAITING_CONSTRUCTION
      Animation           =  lbmystic_a
        AnimationName     =  lbmystic_a.lbmystic_a
        AnimationMode     = MANUAL
        AnimationBlendTime = 0
      End
      Flags                  = START_FRAME_FIRST
    End

    ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
        Model    = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
      Model               = lbmystic_a
   End

    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
        Animation           = lbmystic_a
            AnimationName     = lbmystic_a.lbmystic_a
            AnimationMode     = MANUAL
            End
            ParticleSysBone = NONE BuildingContructDustExp
            ParticleSysBone = NONE ExpElven
            BeginScript
                CurDrawablePlaySound("GondorBarracksBeginConstruction")
            EndScript
        End





    ModelConditionState  = DAMAGED
      Model         = lbmystic
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture       = lbflethouse.tga lbflethouse_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingMedium
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 FireBuildingSmall
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = DAMAGED
        EnteringStateFX    = FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = lbmystic
      Texture       = lbflethouse.tga lbflethouse_d.tga
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingLarge
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 SmokeBuildingLarge
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End

    AnimationState = REALLYDAMAGED
        EnteringStateFX    = FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = lbmystic
      Texture       = lbflethouse.tga lbflethouse_d.tga
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = RUBBLE
        EnteringStateFX    = FX_StructureMediumCollapse
          Animation                =    RubbleAnimation
            AnimationName        =    lbmystic.lbmystic
            AnimationMode        =    ONCE
          End
      BeginScript
        CurDrawableHideSubObject("NBElvnBarxDP1")
        CurDrawableHideSubObject("NBElvnBarxDP2")
        CurDrawableHideSubObject("NBElvnBarxDP3")
        CurDrawableHideSubObject("NBElvnBarxDP4")
      EndScript
    End

    ModelConditionState  = POST_RUBBLE
      Model         = None
        ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState  = POST_COLLAPSE
      Model         = None
        ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState = SNOW
        Model = lbmystic
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

  End

  Draw = W3DScriptedModelDraw ModuleTag_Draw_Elb
    OkToChangeModelColor  = Yes
    DefaultModelConditionState
        Model = lbsangerin_ani
    End
        IdleAnimationState
            Animation = lbsangerin_ani
                AnimationName        =    lbsangerin_ani.lbsangerin_ani
                AnimationMode            =    ONCE
                AnimationBlendTime = 0
                AnimationSpeedFactorRange = 1.0 1.0
            End
        End


        ModelConditionState = SNOW AWAITING_CONSTRUCTION UPGRADE_NUMENOR_STONEWORK
            Model    = NONE
        End

        ModelConditionState = SNOW AWAITING_CONSTRUCTION
            Model    = NONE
        End

        ModelConditionState   = AWAITING_CONSTRUCTION
            Model    = NONE
        End
        AnimationState        = AWAITING_CONSTRUCTION
        Animation           =  NONE
            AnimationName     =  NONE.NONE
            AnimationMode     = MANUAL
            AnimationBlendTime = 0
        End
        Flags                  = START_FRAME_FIRST
        End


        ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED UPGRADE_NUMENOR_STONEWORK
            Model    = NONE
        End

        ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Model    = NONE
        End

        ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Model               = NONE
        End
        AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Animation           = NONE
                AnimationName     = NONE.NONE
                AnimationMode     = MANUAL
                AnimationBlendTime = 0
            End
            Flags                  = START_FRAME_FIRST
            StateName              = BeingConstructed
        End


  End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End



    Draw = W3DScriptedModelDraw ModuleTag_DrawOneRing

        DefaultModelConditionState
            Model                = None
        End

        ModelConditionState   = FORTRESS_IMPROVEMENT_1
            Model             = None
            ParticleSysBone   = NONE OneRingGaladrielStructureSchleier1
            ParticleSysBone   = NONE OneRingGaladrielStructureSchleier2
        End

    End

   PlacementViewAngle  = 45



  DisplayName         = OBJECT:LothlorienHeiligtum
  Description          = CONTROLBAR:ToolTipLothlorienHeiligtum
  Side                = Lothlorien
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0

    RefundValue             = 250
    BuildCost               = ARMORY_COST
    BuildTime               = ARMORY_BUILDTIME
    BountyValue             = 80
    VisionRange             = 160
    ShroudClearingRange     = 180

  CommandSet = LothlorienHeiligtumCommandSet

    ArmorSet
        Conditions        = None
        Armor             = FactoryArmor

    End

    WeaponSet
        Conditions            = None
    End










    #include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

    VoiceSelect                        = LorienHeiligtumSelect

    SoundAmbientDamaged                = BuildingDamageFireMediumLoop
    SoundAmbientReallyDamaged        = BuildingDamageFireLargeLoop
    SoundOnDamaged                    = BuildingLightDamageWood
    SoundOnReallyDamaged            = BuildingHeavyDamageWood



    VoiceSelectUnderConstruction    = BuildingGoodVoiceSelectUnderConstruction


    UnitSpecificSounds
        UnderConstruction        = BuildingConstructionLoop

        UnderRepairFromRubble    = BuildingConstructionLoop
    End

  ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound: GondorForgeHammering Animation:lbmystic.lbmystic Frames: 40 62 90
  End



  RadarPriority       = STRUCTURE
  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION IGNORE_FOR_VICTORY AUTO_RALLYPOINT FS_FACTORY LIVING_WORLD_BUILDING_MIRROR

    Body                = StructureBody ModuleTag_05
        MaxHealth         = FARMDAG_HEALTH
        MaxHealthDamaged  = 1500.0
        MaxHealthReallyDamaged = 700.0

        DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK

        DamageCreationList = OCL_RBBarracks_Chunk1 CATAPULT_ROCK FRONT_DESTROYED
        DamageCreationList = OCL_RBBarracks_Chunk2 CATAPULT_ROCK BACK_DESTROYED
        DamageCreationList = OCL_RBBarracks_Chunk3 CATAPULT_ROCK RIGHT_DESTROYED
        DamageCreationList = OCL_RBBarracks_Chunk4 CATAPULT_ROCK LEFT_DESTROYED

    End

    Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
        WorkerName          = ElvenWorkerNoSelect
        SpawnTimer    = DEFAULT_STRUCTURE_HEALDELAY
    End

    Flammability
        Fuel          =   ELVEN_BARRACKS_FIRE_FUEL
        MaxBurnRate   =   ELVEN_BARRACKS_FIRE_MAX_BURN_RATE
        Decay         =   ELVEN_BARRACKS_FIRE_DECAY
        Resistance    =   ELVEN_BARRACKS_FIRE_RESISTANCE
    End

    Behavior = BuildingBehavior BuildingModuleTag
        NightWindowName        = N_WINDOW N_GLOW



    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP                     = Yes
    End

    Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
        Radius = 55
        MaxIncome = 0
        IncomeInterval = 999999
        HighPriority = Yes
        Visible = No
    End

    Behavior = QueueProductionExitUpdate QueueProductionModuleTag
        UnitCreatePoint         = X:-24.0 Y:28.0 Z:0.0
        NaturalRallyPoint       = X:-24.0 Y:140.0 Z:0.0
        ExitDelay               = STANDARD_HORDE_EXIT_DELAY
        PlacementViewAngle      = 0
        UseReturnToFormation    = No
    End

    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
        AutoAcquireEnemiesWhenIdle    = Yes
        MoodAttackCheckRate           = 250
    End

    Behavior = SubObjectsUpgrade ModuleTag_HideAll
        TriggeredBy       = Upgrade_StructureLevel1
        HideSubObjects    = LVL1 LVL01 LVL2
    End

    Behavior = SubObjectsUpgrade ModuleTag_ShowWallsAndFlag
        TriggeredBy       = Upgrade_LothlorienHeiligtumLevel2
        ShowSubObjects    = LVL1 LVL01
        HideSubObjects    = LVL2
    End

    Behavior = SubObjectsUpgrade ModuleTag_ShowTowersAndHideFlag
        TriggeredBy       = Upgrade_LothlorienHeiligtumLevel3
        ShowSubObjects    = LVL1 LVL01 LVL2
    End

    Behavior = WeaponSetUpgrade ModuleTag_ThirdLevelBuildingArrows
        TriggeredBy        = Upgrade_LothlorienHeiligtumLevel3
    End

    Behavior = LevelUpUpgrade ModuleTag_ElvenBarracksLevel2
        TriggeredBy    = Upgrade_LothlorienHeiligtumLevel2
        LevelsToGain   = 1
        LevelCap       = 3
    End

    Behavior = LevelUpUpgrade ModuleTag_ElvenBarracksLevel3
        TriggeredBy    = Upgrade_LothlorienHeiligtumLevel3
        LevelsToGain   = 1
        LevelCap       = 3
    End

    Behavior = CommandSetUpgrade ModueTag_ElvenBarracksLevel2CommandSet
        TriggeredBy      = Upgrade_LothlorienHeiligtumLevel2
        ConflictsWith    = Upgrade_LothlorienHeiligtumLevel3
        CommandSet       = LothlorienHeiligtumCommandSetLevel2
    End

    Behavior = CommandSetUpgrade ModueTag_ElvenBarracksLevel3CommandSet
        TriggeredBy      = Upgrade_LothlorienHeiligtumLevel3
        CommandSet       = LothlorienHeiligtumCommandSetLevel3
    End

    Behavior                  = StructureCollapseUpdate ModuleTag_06
        MinCollapseDelay        = 000
        MaxCollapseDelay        = 000
        CollapseDamping         = .5
        MaxShudder              = 0.6
        MinBurstDelay           = 250
        MaxBurstDelay           = 800
        BigBurstFrequency       = 4
        FXList                  = INITIAL   FX_StructureMediumCollapse
        FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
        DestroyObjectWhenDone    = Yes
        CollapseHeight            = 100
    End

    Behavior                = TransitionDamageFX ModuleTag_08
        ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium
    End



    Behavior = ModelConditionUpgrade ModuleTag_ShowOneRing
        TriggeredBy             = Upgrade_GaladrielRingannehmen
        AddConditionFlags       = FORTRESS_IMPROVEMENT_1
        Permanent               = No
    End


    Behavior = SpawnBehavior ModuleTag_SpawnAnimals
        SpawnNumber             = 3
        InitialBurst            = 3
        SpawnTemplateName       = Bear_child ElkMale_child HorseGrazing_child Rabbit_child ElkFemale_child
        SpawnReplaceDelay       = 30000
        FadeInTime              = 1000
        SpawnInsideBuilding     = Yes
    End



    Behavior = GeometryUpgrade Geom_ModuleTag_HideAll
        TriggeredBy        = Upgrade_StructureLevel1
        ShowGeometry    = Geom_Orig
        HideGeometry    = Geom_V2
    End
    Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls
        TriggeredBy        = Upgrade_LothlorienBarracksLevel2
        ShowGeometry    = Geom_Orig
        HideGeometry    = Geom_V2
    End
      Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower
        TriggeredBy        = Upgrade_LothlorienBarracksLevel3
        ShowGeometry    = Geom_V2 Geom_Orig
    End


    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero1
        EffectRadius            = 160
        PingDelay               = 2000
        ModifierName            = LorienGebaudeBonus

        AllowFilter             = ANY +INFANTRY +CAVALRY -HERO -MACHINE -MONSTER +DOZER -SHIP -LothlorienGrenzwachter -MirkwoodArcher_SlavedForBuildings -ElvenLorienArcher_SlavedForBuildings -LothlorienGaladhrim_Slaved -ElvenWorkerNoSelect ALLIES
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_FeelGoodHero2
        EffectRadius            = 160
        PingDelay               = 2000
        ModifierName            = LorienGebaudeBonus2

        AllowFilter             = ANY -INFANTRY -CAVALRY -HERO -MACHINE -MONSTER -DOZER -SHIP +LothlorienGrenzwachter -MirkwoodArcher_SlavedForBuildings -ElvenLorienArcher_SlavedForBuildings -LothlorienGaladhrim_Slaved -ElvenWorkerNoSelect ALLIES
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI1
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 450000
        GrantUpgrade = Upgrade_LothlorienHeiligtumLevel2
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI2
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 720000
        GrantUpgrade = Upgrade_LothlorienHeiligtumLevel3
    End

    Geometry              = BOX
    GeometryName          = Geom_Orig
    GeometryMajorRadius   = 80.0
    GeometryMinorRadius   = 80.0
    GeometryHeight        = 60.0

    GeometryIsSmall       = No
    Shadow                = SHADOW_VOLUME
    BuildCompletion          = PLACED_BY_PLAYER


End


ChildObject BFME1LothlorienHeiligtum LothlorienHeiligtum

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    StaticModelLODMode = Yes
    UseStandardModelNames = Yes

    ExtraPublicBone = ARROW_01
    ExtraPublicBone = ARROW_02
    ExtraPublicBone = ARROW_03
    ExtraPublicBone = ARROW_04

    RandomTexture = sccentmoot.tga  0 sccelvensummon.tga

    DefaultModelConditionState
      Model = lbmystic

      Shadow                      = SHADOW_ALPHA_DECAL_DYNAMIC
      ShadowSizeX                 = 240
      ShadowSizeY                 = 240
      ShadowTexture               = sccentmoot
      ShadowOpacityStart          = 0
      ShadowOpacityFadeInTime     = 1000
      ShadowOpacityPeak           = 200
      ShadowOpacityFadeOutTime    = 1000
      ShadowOpacityEnd            = 0
      ShadowOverrideLODVisibility = Yes
      WeaponLaunchBone = PRIMARY ARROW
    End

    AnimationState = BUILD_PLACEMENT_CURSOR
        BeginScript
            CurDrawableHideSubObject("LVL1")
            CurDrawableHideSubObject("LVL01")
            CurDrawableHideSubObject("LVL2")
            CurDrawableHideSubObject("EUWORKER")
            CurDrawableHideSubObject("EUWORKER01")
        EndScript
    End


    AnimationState = PHANTOM_STRUCTURE
        BeginScript
            CurDrawableHideSubObject("LVL1")
            CurDrawableHideSubObject("LVL01")
            CurDrawableHideSubObject("LVL2")
            CurDrawableHideSubObject("EUWORKER")
            CurDrawableHideSubObject("EUWORKER01")
        EndScript
    End

        IdleAnimationState
            StateName                = STATE_Idle
            Animation                 = lbmystic
                AnimationName            = lbmystic.lbmystic
                    AnimationMode        = ONCE
                End
                Flags                = RESTART_ANIM_WHEN_COMPLETE
        End


    ModelConditionState  = SNOW JUST_BUILT
        Model = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState  = JUST_BUILT
        Model = lbmystic_a
    End

    AnimationState            = JUST_BUILT
            Animation           = lbmystic_a
                AnimationName     = lbmystic_a.lbmystic_a
                AnimationMode     = MANUAL
                AnimationBlendTime = 0
        End
            ParticleSysBone = NONE BuildingContructDustExp
            ParticleSysBone = NONE ExpElven
            BeginScript
                CurDrawablePlaySound("GondorBarracksBeginConstruction")
            EndScript
    End


    ModelConditionState = SNOW AWAITING_CONSTRUCTION
        Model    = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState   = AWAITING_CONSTRUCTION
      Model               = lbmystic_a

    End
    AnimationState        = AWAITING_CONSTRUCTION
      Animation           =  lbmystic_a
        AnimationName     =  lbmystic_a.lbmystic_a
        AnimationMode     = MANUAL
        AnimationBlendTime = 0
      End
      Flags                  = START_FRAME_FIRST
    End

    ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
        Model    = lbmystic_a
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
      Model               = lbmystic_a
   End

    AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
        Animation           = lbmystic_a
            AnimationName     = lbmystic_a.lbmystic_a
            AnimationMode     = MANUAL
            End
            ParticleSysBone = NONE BuildingContructDustExp
            ParticleSysBone = NONE ExpElven
            BeginScript
                CurDrawablePlaySound("GondorBarracksBeginConstruction")
            EndScript
        End





    ModelConditionState  = DAMAGED
      Model         = lbmystic
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingMedium
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 FireBuildingSmall
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = DAMAGED
        EnteringStateFX    = FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = lbmystic
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingLarge
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 SmokeBuildingLarge
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End

    AnimationState = REALLYDAMAGED
        EnteringStateFX    = FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = lbmystic
      Texture       = lbtreehouse.tga eborchard_d.tga
      Texture = NBElvnBarx.tga NBElvnBarx_d.tga
      Texture = ebflet.tga ebflet_d.tga
      Texture = ebtower.tga ebtower_d.tga
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = RUBBLE
        EnteringStateFX    = FX_StructureMediumCollapse
          Animation                =    RubbleAnimation
            AnimationName        =    lbmystic.lbmystic
            AnimationMode        =    ONCE
          End
      BeginScript
        CurDrawableHideSubObject("NBElvnBarxDP1")
        CurDrawableHideSubObject("NBElvnBarxDP2")
        CurDrawableHideSubObject("NBElvnBarxDP3")
        CurDrawableHideSubObject("NBElvnBarxDP4")
      EndScript
    End

    ModelConditionState  = POST_RUBBLE
      Model         = None
        ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState  = POST_COLLAPSE
      Model         = None
        ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState = SNOW
        Model = lbmystic
        Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
    End

  End


    Draw = W3DScriptedModelDraw Icon
        ModelConditionState = NONE
            Model           = bbox
        End
    End


  Draw = W3DScriptedModelDraw ModuleTag_Draw_Elb
    OkToChangeModelColor  = Yes
    DefaultModelConditionState
        Model = lbsangerin_ani
    End
        IdleAnimationState
            Animation = lbsangerin_ani
                AnimationName        =    lbsangerin_ani.lbsangerin_ani
                AnimationMode            =    ONCE
                AnimationBlendTime = 0
                AnimationSpeedFactorRange = 1.0 1.0
            End
        End


        ModelConditionState = SNOW AWAITING_CONSTRUCTION UPGRADE_NUMENOR_STONEWORK
            Model    = NONE
        End

        ModelConditionState = SNOW AWAITING_CONSTRUCTION
            Model    = NONE
        End

        ModelConditionState   = AWAITING_CONSTRUCTION
            Model    = NONE
        End
        AnimationState        = AWAITING_CONSTRUCTION
        Animation           =  NONE
            AnimationName     =  NONE.NONE
            AnimationMode     = MANUAL
            AnimationBlendTime = 0
        End
        Flags                  = START_FRAME_FIRST
        End


        ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED UPGRADE_NUMENOR_STONEWORK
            Model    = NONE
        End

        ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Model    = NONE
        End

        ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Model               = NONE
        End
        AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
            Animation           = NONE
                AnimationName     = NONE.NONE
                AnimationMode     = MANUAL
                AnimationBlendTime = 0
            End
            Flags                  = START_FRAME_FIRST
            StateName              = BeingConstructed
        End


  End

    Draw = W3DScriptedModelDraw ModuleTag_DrawOneRing

        DefaultModelConditionState
            Model                = None
        End

        ModelConditionState   = FORTRESS_IMPROVEMENT_1
            Model             = None
            ParticleSysBone   = NONE OneRingGaladrielStructureSchleier1
            ParticleSysBone   = NONE OneRingGaladrielStructureSchleier2
        End
    End

    KindOf = +NEED_BASE_FOUNDATION

    Behavior = CastleMemberBehavior ModuleTag_CMB
    End

   PlacementViewAngle  = 45
End



Object LorienGarden



 SelectPortrait = BPLorienSanctuary

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = No
    StaticModelLODMode    = Yes
    UseStandardModelNames = Yes

    RandomTexture = ebsanctuary_bib.tga 0 ebbbattlet_bib.tga

    ExtraPublicBone = ARROW01

    DefaultModelConditionState
      Model = lbtree5l
      ParticleSysBone   = FXBONE01 SanctuaryGlow FollowBone:Yes Persist:SPAWN PersistID:100
      ParticleSysBone   = NONE AngTempleMist
      WeaponLaunchBone  = PRIMARY ARROW_01
    End

    ModelConditionState   = USER_7
      ParticleSysBone   = NONE NenyaMist Followbone:Yes Persist:SPAWN  PersistID:102
    End

	AnimationState = BUILD_PLACEMENT_CURSOR
		BeginScript
			CurDrawableHideSubObject("N_Window")
			CurDrawableHideSubObject("N_Glow")
   			CurDrawableHideSubObject("V1")
   			CurDrawableHideSubObject("V1a")
			CurDrawableHideSubObject("V2")
		EndScript
	End


	AnimationState = PHANTOM_STRUCTURE
		BeginScript
			CurDrawableHideSubObject("N_Window")
			CurDrawableHideSubObject("N_Glow")
   			CurDrawableHideSubObject("V1")
   			CurDrawableHideSubObject("V1a")
			CurDrawableHideSubObject("V2")
		EndScript
	End

    IdleAnimationState
		StateName	=	STATE_Idle
		Animation = IdleA
			AnimationName		=	lbtree5l
			AnimationMode		=	LOOP
			AnimationBlendTime	=	0
		End

	End



		ModelConditionState = AWAITING_CONSTRUCTION SNOW
			Model	= lbtree5l
			Texture = KBHall.tga KBHall_snow.tga
		End

		ModelConditionState   = AWAITING_CONSTRUCTION
			Model               = lbtree5l
		End

		AnimationState        = AWAITING_CONSTRUCTION
			Animation           =  lbtree5l
				AnimationName     =  lbtree5l
				AnimationMode     = MANUAL
				AnimationBlendTime = 0
			End
			Flags				  = START_FRAME_FIRST
		End

		ModelConditionState = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED SNOW
			Model	= lbtree5l
			Texture = KBHall.tga KBHall_snow.tga
			ParticleSysBone = NONE BuildingContructDust
			ParticleSysBone = NONE ExpElvenBig
		End

		ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			Model             = lbtree5l
			ParticleSysBone = NONE BuildingContructDust
			ParticleSysBone = NONE ExpElvenBig
		End

		AnimationState        = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			Animation           = lbtree5l
				AnimationName     = lbtree5l
				AnimationMode     = MANUAL
				AnimationBlendTime = 0
			End
			Flags				  = START_FRAME_FIRST
			StateName			  = BeingConstructed
			BeginScript
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
				CurDrawableHideSubObject("N_Window")
				CurDrawableHideSubObjectPermanently("V1")
				CurDrawableHideSubObjectPermanently("V2")
				CurDrawableHideSubObjectPermanently("V1S")
				CurDrawableHideSubObjectPermanently("V2S")
			EndScript
		End




    ModelConditionState  = DAMAGED
      Model         = lbtree5l
		ParticleSysBone FireSmall01 FireBuildingLarge
		ParticleSysBone FireSmall02 FireBuildingMedium
		ParticleSysBone FireSmall03 FireBuildingMedium
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = DAMAGED
		EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = lbtree5l
		ParticleSysBone FireSmall01 FireBuildingLarge
		ParticleSysBone FireSmall02 FireBuildingLarge
		ParticleSysBone FireSmall03 FireBuildingMedium
		ParticleSysBone FireSmall04 SmokeBuildingLarge
		ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = REALLYDAMAGED
		EnteringStateFX	= FX_BuildingReallyDamaged
      	Animation				=	RubbleAnimation
			AnimationName		=	lbtree5l
			AnimationMode		=	ONCE
  		End
    End

    ModelConditionState  = RUBBLE
      Model         = lbtree5l
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = RUBBLE
		EnteringStateFX	= FX_StructureMediumCollapse
      	Animation				=	RubbleAnimation
			AnimationName		=	lbtree5l
			AnimationMode		=	ONCE
  		End
      BeginScript
        CurDrawableHideSubObject("NBElvnBarxDP1")
        CurDrawableHideSubObject("NBElvnBarxDP2")
        CurDrawableHideSubObject("NBElvnBarxDP3")
        CurDrawableHideSubObject("NBElvnBarxDP4")
      EndScript
    End

    ModelConditionState  = POST_RUBBLE
      Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState  = POST_COLLAPSE
      Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End


		AnimationState        = UNPACKING SPECIAL_POWER_1
			Animation
				AnimationName     = lbtree5l
				AnimationMode     = ONCE
			End
		End
		AnimationState        = PREPARING SPECIAL_POWER_1
			Animation
				AnimationName     = lbtree5l
				AnimationMode     = ONCE
			End
			EnteringStateFX = FX_LorienSanctuaryGatheringLight
		End
		AnimationState        = PACKING SPECIAL_POWER_1
			Animation
				AnimationName     = lbtree5l
				AnimationMode     = ONCE
			End
		End
		AnimationState        = SPECIAL_POWER_1
			Animation
				AnimationName     = lbtree5l
				AnimationMode     = LOOP
			End
		End

    ModelConditionState = SNOW
		Model = lbtree5l
		Texture = NBElvnBarx.tga NBElvnBarx_Snow.tga
		Model = lbtree5l
		Texture = ELorienH.tga ELorienH_snow.tga
		Model = lbtree5l
		Texture = EBTree.tga EBTree_S.tga
    End
  End

  Draw = W3DFloorDraw ModuleTag_DrawFloor
		StaticModelLODMode = Yes
     ModelName = EBsanctuar_BIB

     WeatherTexture		= SNOWY EBBbattleT_Bib_snow.tga
  		HideIfModelConditions	=	AWAITING_CONSTRUCTION
  		HideIfModelConditions	=	PARTIALLY_CONSTRUCTED
  End

   PlacementViewAngle  = -45


  DisplayName		= OBJECT:LorienGarden
  Description		= OBJECT:LorienGardenDescription
  Side			= Lothlorien
  EditorSorting		= STRUCTURE
  ThreatLevel		= 1.0
  MaxSimultaneousOfType = 1
  BuildCost             = 1500
  BuildTime             = 45
  VisionRange           = ELVEN_MALLORN_TREE_SHROUD_CLEAR
  ShroudClearingRange   = ELVEN_MALLORN_TREE_SHROUD_CLEAR
  BountyValue           = ELVEN_MALLORN_TREE_BOUNTY_VALUE
  CommandPointBonus     = 100
  CommandSet 		= LorienGardenCommandSet

  ArmorSet
    Conditions        = None
    Armor             = StructureArmor
  End

  WeaponSet
	Conditions		= None
  End



	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect				= ElfBarracksSelect

	SoundAmbientDamaged			= BuildingDamageFireMediumLoop
	SoundAmbientReallyDamaged		= BuildingDamageFireLargeLoop
	SoundOnDamaged				= BuildingLightDamageWood
	SoundOnReallyDamaged			= BuildingHeavyDamageWood

	VoiceSelectUnderConstruction		= BuildingGoodVoiceSelectUnderConstruction
	VoiceFullyCreated			= EVA:ElfBarracksComplete

	UnitSpecificSounds
		UnderConstruction		= BuildingConstructionLoop
		UnderRepairFromRubble		= BuildingConstructionLoop
	End



  RadarPriority      = STRUCTURE
  KindOf             = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION IGNORE_FOR_VICTORY AUTO_RALLYPOINT FS_FACTORY LIVING_WORLD_BUILDING_MIRROR MADE_OF_WOOD

	Body                = StructureBody ModuleTag_05
		MaxHealth         = 4000
		MaxHealthDamaged  = 2000
		MaxHealthReallyDamaged = 1000

		DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK
		DamageCreationList = OCL_RBBarracks_Chunk1 CATAPULT_ROCK FRONT_DESTROYED
		DamageCreationList = OCL_RBBarracks_Chunk2 CATAPULT_ROCK BACK_DESTROYED
		DamageCreationList = OCL_RBBarracks_Chunk3 CATAPULT_ROCK RIGHT_DESTROYED
		DamageCreationList = OCL_RBBarracks_Chunk4 CATAPULT_ROCK LEFT_DESTROYED
	End

	Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
		WorkerName	= ElvenWorkerNoSelect
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
	End

	Flammability
		Fuel          =   ELVEN_BARRACKS_FIRE_FUEL
		MaxBurnRate   =   ELVEN_BARRACKS_FIRE_MAX_BURN_RATE
		Decay         =   ELVEN_BARRACKS_FIRE_DECAY
		Resistance    =   ELVEN_BARRACKS_FIRE_RESISTANCE
	End

	Behavior = BuildingBehavior BuildingModuleTag
		NightWindowName		= N_WINDOW N_GLOW
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
	End

	Behavior = TerrainResourceBehavior ModuleTag_MoneyProduction
		Radius		= 0
		MaxIncome	= 30
		IncomeInterval	= 10000
	End

	ClientBehavior = TerrainResourceClientBehavior ModuleTag_MoneyProductionClient
	End

	Behavior = QueueProductionExitUpdate QueueProductionModuleTag
		UnitCreatePoint		= X:0.0 Y:0.0 Z:0.0
		PlacementViewAngle	= 0
		NaturalRallyPoint	= X:70.0 Y:7.2 Z:0.0
		ExitDelay		= STANDARD_HORDE_EXIT_DELAY
		UseReturnToFormation	= No
	End

  	Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
		AutoAcquireEnemiesWhenIdle	= Yes
		MoodAttackCheckRate		= 250
	End

	Behavior = SubObjectsUpgrade ModuleTag_HideAll
		TriggeredBy	= Upgrade_StructureLevel1
		HideSubObjects	= TOWER
	End

	Behavior = SubObjectsUpgrade ModuleTag_ShowWallsAndFlag
		TriggeredBy	= Upgrade_StructureLevel2
		ShowSubObjects	= V1 V1a
		HideSubObjects	= TOWER
	End

	Behavior = SubObjectsUpgrade ModuleTag_ShowTowersAndHideFlag
		TriggeredBy	= Upgrade_StructureLevel3
		ShowSubObjects	= TOWER
	End

	Behavior = LevelUpUpgrade ModuleTag_ElvenBarracksLevel2
		TriggeredBy    = Upgrade_StructureLevel2
		LevelsToGain   = 1
		LevelCap       = 2
	End

	Behavior = LevelUpUpgrade ModuleTag_ElvenBarracksLevel3
		TriggeredBy    = Upgrade_StructureLevel3
		LevelsToGain   = 1
		LevelCap       = 3
	End

	Behavior = SpawnPointProductionExitUpdate ModuleTag_ProductionExit
		SpawnPointBoneName = ARCHER
	End

	;Behavior = CostModifierUpgrade ModuleTag_CostModifier
	;	LabelForPalantirString  = GUI:GALADHRIM_DISCOUNT
	;	StartsActive 		    = Yes
	;	ObjectFilter		    = ANY +LothlorienGaladhrimHorde
	;	Percentage		        = -10%
	;End

    Behavior = CostModifierUpgrade ModuleTag_CostModifier2
        LabelForPalantirString  = GUI:GALADHRIM_DISCOUNT
        StartsActive            = No
        TriggeredBy             = Upgrade_StructureLevel2
        ObjectFilter            = NONE +LothlorienGaladhrimHorde
        Percentage              = -25%
    End

	Behavior                  = StructureCollapseUpdate ModuleTag_06
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight		= 100
	End

	Behavior                = TransitionDamageFX ModuleTag_08
		ReallyDamagedFXList1  = Loc: X:0 Y:0 Z:0 FXList:FX_BuildingReallyDamagedTransitionMedium
	End

	Behavior = GeometryUpgrade Geom_ModuleTag_HideAll
		TriggeredBy	= Upgrade_StructureLevel1
		ShowGeometry	= Geom_Orig
		HideGeometry	= Geom_V2
	End
	Behavior = GeometryUpgrade Geom_ModuleTag_ShowWalls
		TriggeredBy	= Upgrade_StructureLevel2
		ShowGeometry	= Geom_Orig
		HideGeometry	= Geom_V2
	End
  	Behavior = GeometryUpgrade Geom_ModuleTag_ShowFlagsAndTower
		TriggeredBy	= Upgrade_StructureLevel3
		ShowGeometry	= Geom_V2 Geom_Orig
	End

        Behavior = AttributeModifierUpgrade ModuleTag_Reinforced
		TriggeredBy	   = Upgrade_StructureLevel3
		AttributeModifier  = GaladhonLightBonus
	End

	Behavior = SubObjectsUpgrade ModuleTag_ShowBanners2
		TriggeredBy	   = Upgrade_StructureLevel3
		ShowSubObjects	   = GLOWCARD00  GLOWCARD01 GLOWCARD02 GLOWCARD03 GLOWCARD04 GLOWCARD05 GLOWCARD06 GLOWCARD07 GLOWCARD08 GLOWCARD09 GLOWCARD10 GLOWCARD11 GLOWCARD12 GLOWCARD13 GLOWCARD14 GLOWCARD15 GLOWCARD16 GLOWCARD17 GLOWCARD18
	End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EnableUpgradeGrandHarvest
	SpecialPowerTemplate = SpecialAbilityFakeLeadership
	TriggeredBy 	     = Upgrade_AllFactionUpgrade
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_GrandHarvestLothlorien
	StartsActive	= No
	TriggeredBy     = Upgrade_AllFactionUpgrade
	BonusName	= LothGrandHarvest
	RefreshDelay	= 2000
	Range		= 999999
	TargetEnemy	= No
	ObjectFilter	= ANY +ElvenMallornTree +ElvenMallornTree_AI  +BFME1ElvenMallornTree +GoodRivIntroMallorn ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_EnableDiscount
	SpecialPowerTemplate      = SpecialAbilityFakeLeadership2
	TriggeredBy 	          = Upgrade_StructureLevel3
    End

    Behavior = CostModifierUpgrade ModuleTag_DiscountUpgrades
        LabelForPalantirString    = GUI:UPGRADE_DISCOUNT
        TriggeredBy               = Upgrade_StructureLevel3
        UpgradeDiscount           = Yes
        ApplyToTheseUpgrades      = Upgrade_TechnologyBasicTraining Upgrade_BasicTraining Upgrade_TechnologyForgedBlades Upgrade_ForgedBlades Upgrade_TechnologyLothlorienLongBows Upgrade_LothlorienLongBows Upgrade_TechnologySilverThornArrows Upgrade_SilverThornArrows
        Percentage                = -25%
    End


    Behavior = ObjectCreationUpgrade ModuleTag_IamAI1
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 250000
        GrantUpgrade = Upgrade_BundnisWaldelbenTrigger
    End

  Geometry              = BOX
  GeometryName		= Geom_Orig
  GeometryMajorRadius   = 50.6
  GeometryMinorRadius   = 20.6
  GeometryHeight        = 46.8
  GeometryIsSmall       = No
  GeometryOffset	= X:-15 Y:8 Z:0

  AdditionalGeometry	= BOX
  GeometryName		= Geom_Orig
  GeometryMajorRadius   = 34.6
  GeometryMinorRadius   = 39.6
  GeometryHeight        = 12.8
  GeometryIsSmall       = No
  GeometryOffset	= X:-29 Y:-20 Z:0

  AdditionalGeometry    = BOX
  GeometryName		= Geom_V2
  GeometryMajorRadius   = 12.5
  GeometryMinorRadius   = 12.5
  GeometryHeight        = 80.0
  GeometryOffset	= X:-13 Y:30 Z:0

  Shadow                = SHADOW_VOLUME

  BuildCompletion	= PLACED_BY_PLAYER

  GeometryContactPoint	= X:-56.311	Y:38.761	Z:0		Repair
  GeometryContactPoint	= X:-0.492	Y:-65.304	Z:0		Repair
  GeometryContactPoint	= X:-71.003	Y:-6.883	Z:0
  GeometryContactPoint	= X:40.821	Y:-11.871	Z:0
  GeometryContactPoint	= X:-0.163	Y:-0.326	Z:68.459	Swoop
End

