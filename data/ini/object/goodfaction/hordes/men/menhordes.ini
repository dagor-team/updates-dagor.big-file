Object GondorFighterHorde

    ButtonImage        = UPGondor_Soldier2
    SelectPortrait     = UPGondor_Soldier2

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorSoldier
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 250
    BuildTime = WEAK_BUILDTIME
    ShroudClearingRange = 300
    VisionRange = 200
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload 			= GondorFighter 15
        Slots 				= 15
        PassengerFilter   		= NONE +INFANTRY
        ShowPips 			= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset			= X:0 Y:0
        MeleeBehavior 			= Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorFighter Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation        = GondorFighterHordeBlock
        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HerzdesFeuers
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    CommandSet = GondorFighterHordeCommandSet


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GondorFighterHorde_Summoned GondorFighterHorde
    IsTrainable    =    No
    CommandPoints     =    0
    CommandSet    =    GondorFighterHordeCommandSet_Summoned
    EquivalentTo      =    GondorFighterHorde

    DisplayName  =  OBJECT:HordeGondorSoldier

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GondorFighter_Summoned 15
        Slots         = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorFighter_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFighter_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighter_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

End



ChildObject GondorFighterHordeBlock GondorFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained          =
        InitialPayload                   = GondorFighter 15
        Slots                            = 15
        PassengerFilter                  = NONE +INFANTRY
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = No
        AttributeModifiers               = GondorFighterBlock_Edain
        RandomOffset                     = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorFighter    Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:GondorFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


ChildObject GondorFighterHorde_Denethor GondorFighterHorde

    EquivalentTo      =    GondorFighterHorde
    CommandSet        =    GondorFighterHordeCommandSet_Denethor

    BuildCost = 120
    BuildTime = VERYWEAK_BUILDTIME

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GondorFighter_Denethor 15
        Slots         = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorFighter_Denethor  Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorFighter_Denethor Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFighter_Denethor Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighter_Denethor Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
     End
End


Object GondorTowerShieldGuardHorde

    ButtonImage       = WOR_GondorTowerGuard
    SelectPortrait    = UPGondor_TowerGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorTowerGuard
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorTowerGuardHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorTowerGuardHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End



    BuildCost             = TOWERGUARDHORDE_BUILDCOST
    BuildTime             = STRONG_BUILDTIME
    VisionRange           = 200
    ShroudClearingRange   = 300
    VisionSide            = 50%
    VisionRear            = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 40

    CommandSet = GondorTowerShieldGuardCommandSetMod

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        =    500
        MaxCowerTime            =    5000
        MinCowerTime            =    3000
        AILuaEventsList            =    InfantryFunctions
        AttackPriority            =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GondorTowerShieldGuard 10
        Slots             = 10
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus    = 30.0
            AngleLimitCos    = -0.17
            InnerRange    = 30
            OuterRange    = 80
            OuterRangeBuildings    = 140
        End


        BannerCarriersAllowed    = GondorTowerGuardInfantryBanner
        BannerCarrierPosition    = UnitType:GondorTowerShieldGuard  Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuard Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuard Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorTowerShieldGuardHordeShieldWall
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GondorTowerShieldGuardHorde_Summoned GondorTowerShieldGuardHorde
    IsTrainable       = No
    CommandPoints     = 0
    CommandSet        = GondorTowerShieldGuardCommandSet_SummonedMod
    EquivalentTo      = GondorTowerShieldGuardHorde

    DisplayName     = OBJECT:HordeGondorTowerGuard

    Behavior     = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GondorTowerShieldGuardUpgraded_Summoned 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
            FacingBonus        =    30.0
            AngleLimitCos        =    -0.17
            InnerRange        =    30
            OuterRange        =    80
            OuterRangeBuildings    =    140
        End

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuardUpgraded_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuardUpgraded_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation         = GondorTowerShieldGuardHordeShieldWall
        MeleeAttackLeashDistance   = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance          = 1
        BackUpMaxDistance          = 3
        BackupPercentage           = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorTowerShieldGuardHordePorcupine GondorTowerShieldGuardHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = GondorTowerShieldGuard 10
        Slots                             = 10
        PassengerFilter                   = NONE +INFANTRY
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = No
        RandomOffset                      = X:2 Y:1
        RanksToReleaseWhenAttacking       = 0
        RanksToJustFreeWhenAttacking      = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation              = Yes
        MinimumHordeSize                  = 5

        AlternateFormation                = GondorTowerShieldGuardHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = GondorTowerGuardInfantryBanner
        BannerCarrierPosition            = UnitType:GondorTowerShieldGuard    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:GondorTowerShieldGuard Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End

ChildObject GondorTowerShieldGuardHordeShieldWall GondorTowerShieldGuardHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         		 = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay        		 = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained          =
        InitialPayload                   = GondorTowerShieldGuard 10
        Slots                            = 10
        PassengerFilter                  = NONE +INFANTRY
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = No
        AttributeModifiers               = GilGaladsLeibwachterShieldWall
        RandomOffset                     = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorTowerGuardInfantryBanner
        BannerCarrierPosition    = UnitType:GondorTowerShieldGuard   Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuard Position:X:0 Y:0        Position:X:0 Y:12.5        Position:X:0 Y:-12.5        Position:X:0 Y:25        Position:X:0 Y:-25
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuard Position:X:-12.5 Y:0        Position:X:-12.5 Y:12.5        Position:X:-12.5 Y:-12.5        Position:X:-12.5 Y:25        Position:X:-12.5 Y:-25
        RanksToReleaseWhenAttacking = 1

        AlternateFormation = GondorTowerShieldGuardHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

ChildObject GondorTowerShieldGuardHorde_Denethor GondorTowerShieldGuardHorde

    CommandSet    =    GondorTowerShieldGuardCommandSet_Denethor
    EquivalentTo  =    GondorTowerShieldGuardHorde

    BuildCost             = 450
    BuildTime             = MEDIUM_BUILDTIME

    Behavior     = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GondorTowerShieldGuard_Denethor 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End


        BannerCarriersAllowed    = GondorTowerGuardInfantryBanner
        BannerCarrierPosition    = UnitType:GondorTowerShieldGuard_Denethor  Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuard_Denethor Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuard_Denethor Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End
End


Object GondorArcherHorde

    ButtonImage       = UPGondor_Archer
    SelectPortrait    = UPGondor_Archer

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY   GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 250
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 300
    ShroudClearingRange     = 350
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GondorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = GondorArcherHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorArcher 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorArcher    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorArcher Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorArcher Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base



        AddEmotion            =    Doom_Base



        AddEmotion    =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

ChildObject GondorArcherHorde_Summoned GondorArcherHorde
    IsTrainable    =    No
    CommandPoints     =    0
    CommandSet    =    GondorArcherHordeCommandSet_Summoned
    EquivalentTo      =    GondorArcherHorde

    DisplayName     = OBJECT:HordeGondorArcher

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GondorArcher_Summoned 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorArcher_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorArcher_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorArcher_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime    = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime    = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType    = FADED
    End
End


ChildObject GondorArcherHorde_Denethor GondorArcherHorde

    CommandSet    =    GondorArcherHordeCommandSet_Denethor
    EquivalentTo  =    GondorArcherHorde

    BuildCost         = 150
    BuildTime         = WEAK_BUILDTIME

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload         		= GondorArcher_Denethor 15
        Slots             		= 15
        PassengerFilter        		= NONE +INFANTRY
        ShowPips         		= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        		= X:0 Y:0
        MeleeBehavior         		= Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorArcher_Denethor    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorArcher_Denethor Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorArcher_Denethor Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorArcher_Denethor Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End
End


Object GondorRangerHorde

    ButtonImage       = UPGondor_Ranger
    SelectPortrait    = UPGondor_Ranger

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorRanger
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorRangerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRangerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GondorRangerMissileHordeRangefinder
        Weapon = TERTIARY   GondorRangerMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost            = ITHILIENRANGERHORDE_BUILDCOST
    BuildTime            = MEDIUM_BUILDTIME
    VisionRange          = 425
    ShroudClearingRange  = 475
    VisionSide           = 50%
    VisionRear           = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints        = 50

    CrushableLevel = 0
    CrusherLevel   = 0
    UseCrushAttack = No

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorRangerHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        CanAttackWhileContained    = Yes
        AILuaEventsList            = InfantryFunctions
        AttackPriority             = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorRanger 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = GondorRangerInfantryBanner
        BannerCarrierPosition    = UnitType:GondorRanger        Pos:X:40.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:GondorRanger Position:X:20 Y:0            Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorRanger Position:X:0 Y:0    Leader 1 0     Position:X:0 Y:25 Leader 1 1    Position:X:0 Y:-25 Leader 1 2    Position:X:0 Y:50 Leader 1 3    Position:X:0 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    CommandSet = GondorRangerHordeCommandSet

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate         = SpecialAbilityMenLongShot
        OCL                          = OCL_LongShotAbility
        CreateLocation               = CREATE_AT_LOCATION
        UpdateModuleStartsAttack     = No

        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility       = Yes
        SpecialWeapon           = MenLongShotWeapon
        NeedLivingTargets       = No
        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS     = No
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp  = ANY +CRATE -TheDroppedRing
        ScanRange      = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = ObjectCreationUpgrade ModuleTag_IamAI
        TriggeredBy  = Upgrade_EasyAISinglePlayer Upgrade_EasyAIMultiPlayer Upgrade_MediumAISinglePlayer Upgrade_MediumAIMultiPlayer Upgrade_HardAISinglePlayer Upgrade_HardAIMultiPlayer Upgrade_BrutalAISinglePlayer Upgrade_BrutalAIMultiPlayer
        Delay        = 120000
        GrantUpgrade = Upgrade_FireArrows
    End





    Behavior = AISpecialPowerUpdate GondorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RangerLongshotAI
	CommandButtonName  = Command_MenLongShotAbility
	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


ChildObject GondorRangerInnHorde GondorRangerHorde
    BuildCost = 350
    EquivalentTo = GondorRangerHorde_Summoned
    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorRangerInn 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:7 Y:7
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorRangerInfantryBanner
        BannerCarrierPosition    = UnitType:GondorRangerInn        Pos:X:25.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:GondorRangerInn Position:X:20 Y:0            Position:X:25 Y:25        Position:X:20 Y:-25        Position:X:30 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorRangerInn Position:X:0 Y:0    Leader 1 0     Position:X:-10 Y:25 Leader 1 1    Position:X:0 Y:-25 Leader 1 2    Position:X:-5 Y:50 Leader 1 3    Position:X:0 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


ChildObject GondorRangerHorde_Summoned GondorRangerHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorRangerHordeCommandSet_Summoned
    EquivalentTo = GondorRangerInnHorde

    DisplayName  =  OBJECT:HordeDunedainRanger
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorRanger_Summoned 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:4 Y:4


        RankInfo = RankNumber:1 UnitType:GondorRanger_Summoned Position:X:0 Y:0    Position:X:0 Y:20    Position:X:0 Y:-20    Position:X:0 Y:40    Position:X:0 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorRanger_Summoned Position:X:15 Y:0    Position:X:15 Y:20    Position:X:15 Y:-20    Position:X:15 Y:40    Position:X:15 Y:-40

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime      = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime      = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange       = 100
        DetectionRate        = 500
        CancelOneRingEffect  = Yes
    End
End

ChildObject GondorRangerFreeHorde GondorRangerHorde
    BuildCost = 0
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER LARGE_RECTANGLE_PATHFIND
End


Object GondorKnightHorde

    ButtonImage       = WOR_GondorKnights
    SelectPortrait    = UPGondor_Knight

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorKnight
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorKnightHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorKnightHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = GondorKnightHordeCommandSetMod


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 500
    BuildTime             = STRONG_BUILDTIME
    VisionRange             = 200
    VisionSide             = 35%
    VisionRear             = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 250
    VisionBonusPercentPerFoot     = 5.0%
    ShroudClearingRange         = 350

    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorCavalry  10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +GondorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorCavalryBanner
        BannerCarrierPosition    = UnitType:GondorCavalry    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorCavalry Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorCavalry Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorKnightHordeWedgeFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End




    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion                =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorKnightArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorKnightWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End


ChildObject GondorKnightHordeWedgeFormation GondorKnightHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = GondorCavalry 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +GondorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorCavalryBanner
        BannerCarrierPosition    = UnitType:GondorCavalry    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorCavalry Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorCavalry Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = GondorKnightHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End



ChildObject GondorKnightHorde_Summoned GondorKnightHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorKnightHordeCommandSet_Summoned
    EquivalentTo = GondorKnightHorde

    DisplayName = OBJECT:HordeGondorKnight

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorCavalry_Summoned 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +GondorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorCavalry_Summoned Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:GondorCavalry_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object RohanOathbreakerHorde

    SelectPortrait         = UPOathBreakers

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUOat
        End
    End


    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeOathBreakers

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    OathbreakerSword

    End

    CommandSet = RohanOathbreakerHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost = 0
    BuildTime = 0
    VisionRange = 500
    VisionSide = 50%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50


    CrushableLevel = 4
    CrusherLevel = 5
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 0
    CrushZFactor = 100.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NO_FORMATION_MOVEMENT ARMY_OF_DEAD SCARY SUMMONED

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     DefaultAttackPriority
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = OATHBREAKER_LIFETIME
        MaxLifetime        = OATHBREAKER_LIFETIME
        DeathType       = FADED
    End

    Behavior = AODHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanOathbreaker 40
        Slots = 40
        PassengerFilter = ANY +INFANTRY +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0


        FrequencyScale = 0.3
        FrequencyRandomness = 0.3
        AmplitudeScale = 20
        AmplitudeRandomness = 0.4
        StillAmplitude = 0.10


        FrequencyScaleZ = 0.2
        FrequencyRandomnessZ = 0.4
        AmplitudeScaleZ = 4
        AmplitudeRandomnessZ = 0.2
        StillAmplitudeZ = 0.15


        LargeUnitHeightFactor = 0.85
        LargeUnitMinHeight = 20.0
        LargeUnitMaxHeight = 300.0
        LargeUnitTimeout = 12000
        LargeUnitTailOff = 2.0f



        ScatterSpeedFactor = 0.4
        ScatterRandomness = 0.1


        RankInfo = RankNumber:1 UnitType:RohanOathbreaker    Position:X:45            Y:0    Position:X:45 Y:90        Position:X:45 Y:-45
        RankInfo = RankNumber:6 UnitType:RohanOathbreaker Position:X:45 Y:45
        RankInfo = RankNumber:2 UnitType:RohanOathbreaker    Position:X:0            Y:0    Position:X:0 Y:45        Position:X:0 Y:90
        RankInfo = RankNumber:7 UnitType:RohanOathbreaker Position:X:0 Y:-45
        RankInfo = RankNumber:3 UnitType:RohanOathbreaker    Position:X:-45 Y:0    Position:X:-45 Y:45            Position:X:-45 Y:-45
        RankInfo = RankNumber:8 UnitType:RohanOathbreaker Position:X:-45 Y:90
        RankInfo = RankNumber:4 UnitType:RohanOathbreaker    Position:X:-91 Y:45    Position:X:-91 Y:-45        Position:X:-91 Y:90
        RankInfo = RankNumber:9 UnitType:RohanOathbreaker Position:X:-91 Y:0
        RankInfo = RankNumber:5 UnitType:RohanOathbreaker    Position:X:-135 Y:0    Position:X:-135 Y:45            Position:X:-135 Y:-45    Position:X:-135 Y:90

        RankInfo = RankNumber:10 UnitType:RohanOathbreaker    Position:X:-180            Y:0    Position:X:-180 Y:90        Position:X:-180 Y:-45
        RankInfo = RankNumber:15 UnitType:RohanOathbreaker Position:X:-180 Y:45
        RankInfo = RankNumber:11 UnitType:RohanOathbreaker    Position:X:-225            Y:0    Position:X:-225 Y:45        Position:X:-225 Y:90
        RankInfo = RankNumber:16 UnitType:RohanOathbreaker Position:X:-225 Y:-45
        RankInfo = RankNumber:12 UnitType:RohanOathbreaker    Position:X:-270 Y:0    Position:X:-270 Y:45            Position:X:-270 Y:-45
        RankInfo = RankNumber:17 UnitType:RohanOathbreaker Position:X:-270 Y:90
        RankInfo = RankNumber:13 UnitType:RohanOathbreaker    Position:X:-315 Y:45    Position:X:-315 Y:-45        Position:X:-315 Y:90
        RankInfo = RankNumber:18 UnitType:RohanOathbreaker Position:X:-315 Y:0
        RankInfo = RankNumber:14 UnitType:RohanOathbreaker    Position:X:-360 Y:0    Position:X:-360 Y:45            Position:X:-360 Y:-45    Position:X:-360 Y:90















        RanksToReleaseWhenAttacking = 1 2

    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = OathbreakersFadeAwayBehavior ModuleTag_05
        FadeOutTime   = 999999
    End

  Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
  End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 30.0
    End

    LocomotorSet
        Locomotor     = AODHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = AOD_HORDE_SPEED
    End






    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 10.0
    GeometryIsSmall = No
End



Object RohanOathbreakerHordeSmall

    SelectPortrait         = UPOathBreakers

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUOat
        End
    End


    Side = Men
    IsTrainable = No
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeOathBreakers

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    OathbreakerSword
    End

    CommandSet = RohanOathbreakerHordeSmallCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 700
    BuildTime = STRONG_BUILDTIME
    VisionRange = 500
    VisionSide = 50%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 7


    CrushableLevel = 4
    CrusherLevel = 5
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 0
    CrushZFactor = 100.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE NO_FORMATION_MOVEMENT ARMY_OF_DEAD SCARY SUMMONED LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     DefaultAttackPriority
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = OATHBREAKER_LIFETIME
        MaxLifetime        = OATHBREAKER_LIFETIME
        DeathType       = FADED
    End

    Behavior = AODHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanOathbreaker 16
        Slots = 16
        PassengerFilter = ANY +INFANTRY +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0


        FrequencyScale = 0.3
        FrequencyRandomness = 0.3
        AmplitudeScale = 20
        AmplitudeRandomness = 0.4
        StillAmplitude = 0.10


        FrequencyScaleZ = 0.2
        FrequencyRandomnessZ = 0.4
        AmplitudeScaleZ = 4
        AmplitudeRandomnessZ = 0.2
        StillAmplitudeZ = 0.15


        LargeUnitHeightFactor = 0.85
        LargeUnitMinHeight = 20.0
        LargeUnitMaxHeight = 300.0
        LargeUnitTimeout = 12000
        LargeUnitTailOff = 2.0f



        ScatterSpeedFactor = 0.4
        ScatterRandomness = 0.1


        RankInfo = RankNumber:1 UnitType:RohanOathbreaker Position:X:10 Y:0    Position:X:10 Y:30        Position:X:10 Y:-30        Position:X:10 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-10 Y:0    Position:X:-10 Y:30        Position:X:-10 Y:-30        Position:X:-10 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-30 Y:0    Position:X:-30 Y:30        Position:X:-30 Y:-30        Position:X:-30 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-50 Y:0    Position:X:-50 Y:30        Position:X:-50 Y:-30        Position:X:-50 Y:60
        RanksToReleaseWhenAttacking = 1 2 3 4


    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 20.0
    End

    Behavior = OathbreakersFadeAwayBehavior ModuleTag_05
        FadeOutTime   = 999999
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    LocomotorSet
        Locomotor     = AODHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = AOD_HORDE_SPEED
    End






    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 15.0
    GeometryMinorRadius = 15.0
    GeometryHeight = 10.0
    GeometryIsSmall = No
End



Object RohanOathbreakersCavalryHordeSmall

    SelectPortrait         = UPOathBreakers

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUOat
        End
    End


    Side = Men
    IsTrainable = No
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeOathBreakers

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    OathbreakerSwordMounted
    End

    CommandSet = RohanOathbreakerHordeSmallCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 700
    BuildTime = STRONG_BUILDTIME
    VisionRange = 500
    VisionSide = 50%
    VisionRear = 25%
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 7


    CrushableLevel = 4
    CrusherLevel = 5
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 0
    CrushZFactor = 100.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY INFANTRY HORDE NO_FORMATION_MOVEMENT ARMY_OF_DEAD SCARY SUMMONED LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AttackPriority                =     DefaultAttackPriority
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = OATHBREAKER_LIFETIME
        MaxLifetime        = OATHBREAKER_LIFETIME
        DeathType       = FADED
    End

    Behavior = AODHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanOathbreakersCavalry 16
        Slots = 16
        PassengerFilter = ANY +INFANTRY +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0


        FrequencyScale = 0.3
        FrequencyRandomness = 0.3
        AmplitudeScale = 20
        AmplitudeRandomness = 0.4
        StillAmplitude = 0.10


        FrequencyScaleZ = 0.2
        FrequencyRandomnessZ = 0.4
        AmplitudeScaleZ = 4
        AmplitudeRandomnessZ = 0.2
        StillAmplitudeZ = 0.15


        LargeUnitHeightFactor = 0.85
        LargeUnitMinHeight = 20.0
        LargeUnitMaxHeight = 300.0
        LargeUnitTimeout = 12000
        LargeUnitTailOff = 2.0f



        ScatterSpeedFactor = 0.4
        ScatterRandomness = 0.1


        RankInfo = RankNumber:1 UnitType:RohanOathbreakersCavalry Position:X:10 Y:0    Position:X:10 Y:30        Position:X:10 Y:-30        Position:X:10 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreakersCavalry Position:X:-20 Y:0    Position:X:-20 Y:30        Position:X:-20 Y:-30        Position:X:-20 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreakersCavalry Position:X:-50 Y:0    Position:X:-50 Y:30        Position:X:-50 Y:-30        Position:X:-50 Y:60
        RankInfo = RankNumber:2 UnitType:RohanOathbreakersCavalry Position:X:-80 Y:0    Position:X:-80 Y:30        Position:X:-80 Y:-30        Position:X:-80 Y:60
        RanksToReleaseWhenAttacking = 1 2 3 4


    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 20.0
    End

    Behavior = OathbreakersFadeAwayBehavior ModuleTag_05
        FadeOutTime   = 999999
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    LocomotorSet
        Locomotor     = AODHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = AOD_HORDE_CAVALRY_SPEED
    End






    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 15.0
    GeometryMinorRadius = 15.0
    GeometryHeight = 10.0
    GeometryIsSmall = No
End


Object GondorKnightsofDolHorde

    ButtonImage        = HIDolAmrothPferd_Wotr
    SelectPortrait     = UPDolAmrothPferd

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkEURIL
        End
    End

    Side                     = Men
    EditorSorting            = UNIT
    EmotionRange             = 240
    DisplayName              = OBJECT:HordeGondorKnightsofDol
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_GondorKnightsofDolHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_GondorKnightsofDolHorde

    WeaponSet
        Conditions        = None
        Weapon            = PRIMARY     NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions        = HIDDEN
        Weapon            = PRIMARY     NormalMeleeHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost        = KNIGHTSOFDOLAMROTHHORDE_BUILDCOST
    BuildTime        = ELITE_BUILDTIME
    VisionRange      = 200
	
	MaxSimultaneousOfType    = 3

    VisionSide         = 50%
    VisionRear         = 25%
    VisionBonusPercentPerFoot = 1.0%
    ShroudClearingRange   = 350

   

    CommandPoints         = 40

    FormationWidth        = 2
    FormationDepth        = 1

    CrushableLevel        = 2
    CrusherLevel          = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback             = 40
    CrushZFactor               = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf             = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE LARGE_RECTANGLE_PATHFIND ARMY_SUMMARY
    CommandSet         = GondorKnightsofDolEdainHordeCommandSet

    ThreatLevel = 175
    ThreatBreakdown ElvenRivendellLancerHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                   = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload         	       = GondorKnightsofDol 5
        Slots             	       = 5
        PassengerFilter                = NONE +CAVALRY
        ShowPips                       = No
        RandomOffset                   = X:2 y:3
        MeleeBehavior                  = Amoeba
        End

        ThisFormationIsTheMainFormation = Yes


        RankInfo = RankNumber:1 UnitType:GondorKnightsofDol     Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation 	    = GondorKnightsofDolHordeWedgeFormation
        MeleeAttackLeashDistance    = 1
        BackUpMinDelayTime          = 1
        BackUpMaxDelayTime          = 3000
        BackUpMinDistance           = 1
        BackUpMaxDistance           = 3
        BackupPercentage            = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            = 150
        FearScanDistance            = CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate   = SpecialAbilityFakeLeadership
        TriggeredBy            = Upgrade_MiniHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused              = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive        = No
        BonusName           = InspirationAmrothReiter
        TriggeredBy         = Upgrade_MiniHordeLvl2
        RefreshDelay        = 2000
        Range               = 200
        ObjectFilter        = ANY +CAVALRY -GondorKnightsofDol -INFANTRY -HERO -STRUCTURE -SHIP -MACHINE -DOZER ALLIES
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DisziplinUnpause
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        TriggeredBy          = Upgrade_MiniHordeLvl7
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_DisziplinUpdate
        SpecialPowerTemplate = SpecialAbilityUrukHauptmannSchwertkampfer
        Duration             = 30000
        AttributeModifier    = DolAmrothDisziplinModifier
        LockWeaponSlot       = SECONDARY
        StartsPaused         = Yes
    End

    Behavior = AutoAbilityBehavior ModuleTag_DisziplinAutoAbility
	SpecialAbility	= SpecialAbilityUrukHauptmannSchwertkampfer
	ForbiddenStatus = INSIDE_GARRISON
	MaxScanRange	= 300
	Query		= 8 ALL ENEMIES -WALL_UPGRADE -WALL_HUB -WALL_SEGMENT -DEFENSIVE_WALL -FS_BASE_DEFENSE
	Query           = 1 ANY ENEMIES +HERO +MONSTER
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = No
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        TriggeredBy                = Upgrade_MiniHordeLvl2
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenMirkwoodArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate DolAmrothChargeAI
	CommandButtonName = Command_SpecialAbilityDisziplin
	SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
    End

    Geometry 		= BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight 	= 20.0
    GeometryIsSmall 	= No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerWeapon
    End
End

ChildObject GondorKnightsofDolHordeWedgeFormation GondorKnightsofDolHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = GondorKnightsofDol 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorKnightsofDol Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorKnightsofDol Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = GondorKnightsofDolHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End






ChildObject GondorTowerShieldGuardHordeUpgradet_Summoned GondorTowerShieldGuardHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    GondorTowerShieldGuardCommandSet_Summoned
    EquivalentTo  =    GondorTowerShieldGuardHorde

    DisplayName = OBJECT:HordeGondorTowerGuard

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorTowerShieldGuardUpgraded_Summoned 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuardUpgraded_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuardUpgraded_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = GondorTowerShieldGuardHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorTowerShieldGuardHordeBoromirRing_Summoned GondorTowerShieldGuardHorde
    CommandPoints =    0
    CommandSet      =    GondorBoromirHordenCommandSet_Summoned
    EquivalentTo  =    GondorTowerShieldGuardHorde

    DisplayName = OBJECT:HordeGondorTowerGuard

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorTowerShieldGuardBoromirRing_Summoned 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End

        RankInfo = RankNumber:1 UnitType:GondorTowerShieldGuardBoromirRing_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorTowerShieldGuardBoromirRing_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = GondorTowerShieldGuardHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = ObjectCreationUpgrade ModuleTag_ObjectCreationUpgrade
        TriggeredBy   = Upgrade_MenFaction
        GrantUpgrade  = Upgrade_BasicTraining
        Delay         = 0
    End

End


ChildObject GondorArcherHordeUpgradet_Summoned GondorArcherHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    GondorArcherHordeCommandSet_Summoned
    EquivalentTo  =    GondorArcherHorde

    DisplayName = OBJECT:HordeGondorArcher

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorArcherUpgradet_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBannerUpgraded_Summoned
        BannerCarrierPosition    = UnitType:GondorArcherUpgradet_Summoned  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:GondorArcherUpgradet_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorArcherUpgradet_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorArcherUpgradet_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorArcherHordeBoromirRing_Summoned GondorArcherHorde
    CommandPoints =    0
    CommandSet      =    GondorBoromirHordenCommandSet_Summoned
    EquivalentTo  =    GondorArcherHorde

    DisplayName = OBJECT:HordeGondorArcher

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorArcherBoromirRing_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorArcherBoromirRing_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorArcherBoromirRing_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorArcherBoromirRing_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End


    Behavior = ObjectCreationUpgrade ModuleTag_ObjectCreationUpgrade
        TriggeredBy   = Upgrade_MenFaction
        GrantUpgrade  = Upgrade_BasicTraining
        Delay         = 0
    End
End

ChildObject GondorFighterHordeUpgradet_Summoned GondorFighterHorde

    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    GondorFighterHordeCommandSet_Summoned
    EquivalentTo  =    GondorFighterHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorFighterUpgraded_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorInfantryBannerUpgraded_Summoned
        BannerCarrierPosition    = UnitType:GondorFighterUpgraded_Summoned  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:GondorFighterUpgraded_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFighterUpgraded_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighterUpgraded_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorFighterHordeBoromirRing_Summoned GondorFighterHorde
    CommandPoints =    0
    CommandSet    =    GondorBoromirHordenCommandSet_Summoned
    EquivalentTo  =    GondorFighterHorde

    DisplayName  =  OBJECT:HordeGondorSoldier

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = GondorFighterBoromirRing_Summoned 15
        Slots         = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorFighterBoromirRing_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFighterBoromirRing_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFighterBoromirRing_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = ObjectCreationUpgrade ModuleTag_ObjectCreationUpgrade
        TriggeredBy   = Upgrade_MenFaction
        GrantUpgrade  = Upgrade_BasicTraining
        Delay         = 0
    End

End


ChildObject GondorFaramirRangerHorde_Summoned GondorRangerHorde

    IsTrainable    =    No
    CommandPoints  =    0
    CommandSet     =    GondorRangerHordeEdainCommandSet_Summoned
    EquivalentTo   =    GondorRangerHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorFaramirRanger_Summoned 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End

        RankInfo = RankNumber:1 UnitType:GondorFaramirRanger_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorFaramirRanger_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorFaramirRanger_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


ChildObject GondorCavalryUpgradetHorde_Summoned GondorKnightHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorKnightHordeCommandSet_Summoned
    EquivalentTo = GondorKnightHorde

    DisplayName = OBJECT:HordeGondorKnight

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorCavalryUpgradet_Summoned 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +GondorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorCavalryUpgradet_Summoned
        BannerCarrierPosition    = UnitType:GondorCavalryUpgradet_Summoned  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:GondorCavalryUpgradet_Summoned Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:GondorCavalryUpgradet_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorCavalryHordeBoromirRing_Summoned GondorKnightHorde
    CommandPoints = 0
    CommandSet = GondorBoromirHordenCommandSet_Summoned
    EquivalentTo = GondorKnightHorde

    DisplayName = OBJECT:HordeGondorKnight

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorCavalryBoromirRing_Summoned 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +GondorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorCavalryBoromirRing_Summoned Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:GondorCavalryBoromirRing_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = ObjectCreationUpgrade ModuleTag_ObjectCreationUpgrade
        TriggeredBy   = Upgrade_MenFaction
        GrantUpgrade  = Upgrade_BasicTraining
        Delay         = 0
    End

End


Object GondorWaechterderFesteHorde


    ButtonImage        = WOR_GondorTowerGuard
    SelectPortrait    = UPGondor_TowerGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorWaechterderFeste
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorWaechterderFeste
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorWaechterderFeste

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost = GONDOR_TOWERGUARD_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%

    MaxSimultaneousOfType    = 3

    CommandPoints = GONDOR_SOLDIER_HORDE_COMMAND_POINTS

    CommandSet = GondorWaechterderFesteHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorWaechterderFeste 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = GondorWaechterderFeste
        BannerCarrierPosition    = UnitType:GondorWaechterderFeste    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorWaechterderFeste Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorWaechterderFeste Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorWaechterderFeste Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2


        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



Object GondorSpearmanHorde

    SelectPortrait         = GondorSpearmanPic
    ButtonImage            = GondorSpearmanPic

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GondorSpearmenHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorSpearmanHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorSpearmanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End



    BuildCost = 250
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = GondorTowerShieldGuardCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 100
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorSpearman 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorSpearman    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorSpearman Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorSpearman Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorSpearman Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorSpearmanHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GondorSpearmanHordePorcupine GondorSpearmanHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = GondorSpearman 15
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorSpearmanHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = GondorSpearmanHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = GondorInfantryBanner
        BannerCarrierPosition            = UnitType:GondorSpearman    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:GondorSpearman Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End

ChildObject GondorSpearmanHorde_Denethor GondorSpearmanHorde

    EquivalentTo      =    GondorSpearmanHorde
    CommandSet        =    GondorTowerShieldGuardCommandSet_Denethor

    BuildCost = 175
    BuildTime = WEAK_BUILDTIME

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorSpearman_Denethor 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus           =    30.0
            AngleLimitCos         =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings   =    140
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorSpearman_Denethor    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorSpearman_Denethor Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorSpearman_Denethor Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorSpearman_Denethor Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End
End

ChildObject GondorSpearmanHordeUpgradet_Summoned GondorSpearmanHorde

    IsTrainable   =    No
    CommandPoints =    0
    CommandSet    =    GondorSpearmanHordeCommandSet_Summoned
    EquivalentTo  =    GondorSpearmanHorde


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorSpearmanUpgradet_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = GondorInfantryBannerUpgraded_Summoned
        BannerCarrierPosition    = UnitType:GondorSpearmanUpgradet_Summoned  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:GondorSpearmanUpgradet_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorSpearmanUpgradet_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:GondorSpearmanUpgradet_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object GondorRangerGraueScharHorde


    SelectPortrait         = UPDunedainRanger
    ButtonImage            = HSDunedainRanger

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorRangerGraueSchar
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorRangerGraueScharHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRangerGraueScharHorde

   WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = GondorGraueScharHordeCommandSet






    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = 700
    BuildTime = STRONG_BUILDTIME
    VisionRange = 350
    ShroudClearingRange = 400
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 60

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE

    ThreatLevel = ELVEN_LORIENWARRIOR_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = GondorRangerGraueSchar 10
        Slots = 10
        PassengerFilter = NONE +GondorRangerGraueSchar
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorRangerInfantryBanner
        BannerCarrierPosition    = UnitType:GondorRangerGraueSchar    Pos:X:40.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:GondorRangerGraueSchar Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorRangerGraueSchar Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

     Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GondorRangerGraueScharHorde_Summoned GondorRangerGraueScharHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorGraueScharHordeCommandSet_Summoned
    EquivalentTo = GondorRangerGraueScharHorde

    DisplayName  =  OBJECT:HordeGraueSchar
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = GondorRangerGraueSchar_Summoned 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:GondorRangerGraueSchar_Summoned Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorRangerGraueSchar_Summoned Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType        = FADED
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange        = 100
        DetectionRate        = 500
        CancelOneRingEffect = Yes
    End
End


Object GondorOrkjagerHorde

    ButtonImage       = WOR_IthilienRangers
    SelectPortrait    = UPGondor_Ranger

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorOrkjager
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorOrkjagerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRangerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = GONDOR_RANGER_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 425
    ShroudClearingRange     = 475
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = GONDOR_RANGER_HORDE_COMMAND_POINTS

    CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE

    ThreatLevel = ELVEN_LORIENWARRIOR_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End


    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = GondorOrkjager 10
        Slots = 10
        PassengerFilter = NONE +GondorOrkjager
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:GondorOrkjager Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorOrkjager Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base






         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    CommandSet = GondorOrkjagerHordeCommandSet

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityMenLongShot
        OCL                            = OCL_LongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No



        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No



        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS        = No
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


ChildObject GondorOrkjagerHorde_Summoned GondorOrkjagerHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorOrkjagerHordeCommandSet
    EquivalentTo = GondorOrkjagerHorde

    DisplayName  =  OBJECT:HordeGondorOrkjager
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = GondorOrkjager_Summoned 10
        Slots = 10
        PassengerFilter = NONE +GondorOrkjager_Summoned
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:GondorOrkjager_Summoned Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:GondorOrkjager_Summoned Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange        = 100
        DetectionRate        = 500
        CancelOneRingEffect = Yes
    End
End


Object GondorBoromirGuardHorde


    SelectPortrait      = UPStadtwachter
    ButtonImage         = HIStadtwachter_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorBoromirGuard
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorBoromirGuardHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorBoromirGuardHorde

    MaxSimultaneousOfType    = 1

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 1100
    BuildTime = ELITE_BUILDTIME
    ShroudClearingRange = 300
    VisionRange = 200
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 175
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = GondorBoromirGuard 5
        Slots = 5
        PassengerFilter    = NONE +INFANTRY +GondorBoromirGuard
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        RankInfo = RankNumber:1 UnitType:GondorBoromirGuard Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End



    Behavior = SpecialPowerModule ModuleTag_BoromirLeadershipUpdate
        SpecialPowerTemplate     = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack = No
        StartsPaused             = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_BoromirLeadership
        StartsActive             = Yes
        BonusName                = BoromirGuardLeadership
        RefreshDelay             = 2000
        Range                    = 200
        AntiCategory             = BUFF
        ObjectFilter             = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    CommandSet = GondorWachterderweienStadtHordeCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object RohanRohirrimHorde_forMM


    ButtonImage        = WOR_Rohirrim
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 80

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND
    CommandSet = RohirrimHordeCommandSet_forMM

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim  10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrim Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    	      =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End



    Behavior = MonitorConditionUpdate ModuleTag_CommandSetSwapper
        WeaponSetFlags            = WEAPONSET_TOGGLE_1
        WeaponToggleCommandSet    = RohirrimHordeBowCommandSet_forMM
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End

ChildObject RohanRohirrimHorde_forMM_Summoned RohanRohirrimHorde_forMM
    IsTrainable    =    No
    CommandPoints  =    0
    EquivalentTo   =    RohanRohirrimHorde_forMM

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim_Summoned  10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner_Summoned
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner_Summoned
        BannerCarrierPosition    = UnitType:RohanRohirrim_Summoned  Pos:X:75.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL +FADED

        RankInfo = RankNumber:1 UnitType:RohanRohirrim_Summoned Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrim_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 180000
        MaxLifetime      = 180000
        DeathType        = FADED
    End
End

Object GondorWachterderVesteHorde

    ButtonImage            = UCGondorVeteran
    SelectPortrait         = UPWachterderVeste

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeWachterderVeste
    DisplayNameStrategic = CONTROLBAR:LW_Unit_WachterderVesteHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_WachterderVesteHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    

    CommandSet = GondorWachterVesteHordeCommandSet



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    CrushableLevel = 0
    CrusherLevel   = 0

    BuildCost = 850
    BuildTime = STRONG_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 475
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50
	MaxSimultaneousOfType = 4
    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList             = InfantryFunctions
        AttackPriority              = AttackPriority_Infantry
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         		= STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         		= STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload 			= GondorWachterderVeste 5
        Slots 				= 5
        PassengerFilter 		= NONE +GondorWachterderVeste
        ShowPips 			= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset			= X:0 Y:0
        MeleeBehavior 			= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorWachterderVeste Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay  = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                  = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                   = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance          = 150
        FearScanDistance          = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

     Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End






    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DefendStructureUnpause
        SpecialPowerTemplate        = SpecialAbilityDefendStructure
        TriggeredBy                 = Upgrade_MiniHordeLvl3
    End

    Behavior = SpecialPowerModule DefendStructure_ModuleTag
        SpecialPowerTemplate        = SpecialAbilityDefendStructure
        AttributeModifier           = DefendStructureModifier
        AttributeModifierRange      = 55
        AttributeModifierAffects    = ANY +STRUCTURE ALLIES
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = HEALING_AMOUNT_HEROUNIT
        Radius                     = 55
        StartHealingDelay          = START_HEALING_DELAY_HEROUNIT
        HealingDelay               = HEALING_DELAY_HEROUNIT
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = RESPAWN_MINIMUM_DELAY_HEROUNIT
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GondorWachterderVesteHorde_Summoned GondorWachterderVesteHorde
    IsTrainable     = No
    CommandPoints   = 0
    CommandSet      = GondorWachterVesteHordeCommandSet_Summoned
    EquivalentTo    = GondorWachterderVesteHorde

    DisplayName  =  OBJECT:GondorWachterderVesteHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         		= STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         		= STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload     		= GondorWachterderVeste_Summoned 5
        Slots         			= 5
        PassengerFilter   		= NONE +GondorWachterderVeste_Summoned
        ShowPips     			= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    		= X:0 Y:0
        MeleeBehavior    		= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorWachterderVeste_Summoned Position:X:15 Y:0    Position:X:15 Y:25        Position:X:15 Y:-25        Position:X:15 Y:50        Position:X:15 Y:-50

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime      = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

ChildObject GondorWachterderVesteHorde_Denethor GondorWachterderVesteHorde

    CommandSet    = GondorWachterVesteHordeCommandSet_Denethor
    EquivalentTo  = GondorWachterderVesteHorde

    BuildCost = 500
    BuildTime = MEDIUM_BUILDTIME

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         		= STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         		= STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload 			= GondorWachterderVeste 5
        Slots 				= 5
        PassengerFilter			= NONE +GondorWachterderVeste_Denethor
        ShowPips 			= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset			= X:0 Y:0
        MeleeBehavior 			= Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorWachterderVeste_Denethor Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

End

Object IthilienSchwertkampferHorde

    SelectPortrait         = UPRangerFighterPool
    ButtonImage            = HIRangerFighterPool_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIthilienSchwertkampfer
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IthilienSchwertkampferHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 350
    BuildTime = MEDIUM_BUILDTIME
    ShroudClearingRange = 350
    VisionRange = 200
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                     = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IthilienSchwertkampfer 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = GondorRangerInfantryBanner
        BannerCarrierPosition    = UnitType:IthilienSchwertkampfer       Pos:X:40.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IthilienSchwertkampfer Position:X:20 Y:0            Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:IthilienSchwertkampfer Position:X:0 Y:0    Leader 1 0     Position:X:0 Y:25 Leader 1 1    Position:X:0 Y:-25 Leader 1 2    Position:X:0 Y:50 Leader 1 3    Position:X:0 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base



        AddEmotion            =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End






    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    CommandSet = IthilienSchwertkampferHordeCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object IthilienSpeertragerHorde

    SelectPortrait         = UPIthilienSpear
    ButtonImage            = HIIthilienSpeere_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIthilienSpeertrager
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IthilienSpeertragerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorSpearmanHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost             = 400
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = GONDOR_TOWERGUARD_HORDE_VISION_RANGE
    ShroudClearingRange         = GONDOR_TOWERGUARD_HORDE_SHROUD_RANGE
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
    CommandPoints             = 40

    CommandSet = IthilienSpeertragerHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 100
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        =    500
        MaxCowerTime            =    5000
        MinCowerTime            =    3000
        AILuaEventsList            =    InfantryFunctions
        AttackPriority            =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = IthilienSpeertrager 10
        Slots             = 10
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus    = 30.0
            AngleLimitCos    = -0.17
            InnerRange    = 30
            OuterRange    = 80
            OuterRangeBuildings    = 140
        End


        BannerCarriersAllowed    = GondorRangerInfantryBanner
        BannerCarrierPosition    = UnitType:IthilienSpeertrager    Pos:X:40.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IthilienSpeertrager Position:X:20 Y:0            Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:IthilienSpeertrager Position:X:0 Y:0    Leader 1 0     Position:X:0 Y:25 Leader 1 1    Position:X:0 Y:-25 Leader 1 2    Position:X:0 Y:50 Leader 1 3    Position:X:0 Y:-50 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = IthilienSpeertragerHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject IthilienSpeertragerHordePorcupine IthilienSpeertragerHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IthilienSpeertrager 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IthilienSpeertragerHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = GondorRangerInfantryBanner
        BannerCarrierPosition            = UnitType:IthilienSpeertrager    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:IthilienSpeertrager Position:X:-16.18 Y:11.76    Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End




Object GondorWachterderKompanieHorde

    ButtonImage            = HIWachterderVeste_Wotr
    SelectPortrait         = UPWachterderVeste

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorWachterderKompanie
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorWachterderKompanieHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorWachterderKompanieHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost           = GONDOR_RANGER_BUILDCOST
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 425
    ShroudClearingRange = 475
    VisionSide          = 50%
    VisionRear          = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 80

    CrushableLevel = 0
    CrusherLevel   = 0
    UseCrushAttack = No

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE PIKE ARMY_SUMMARY MELEE_HORDE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = GondorWachterderKompanie 8
        Slots = 8
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:GondorWachterderKompanie Position:X:20 Y:10    Position:X:20 Y:-10      Position:X:20 Y:30    Position:X:20 Y:-30
        RankInfo = RankNumber:2 UnitType:GondorWachterderKompanie Position:X:0 Y:10     Position:X:0 Y:-10       Position:X:0 Y:30     Position:X:0 Y:-30

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation       = GondorWachterderKompanieHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    CommandSet = WachterweieKompanieHordeCommandSet



    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End







    Behavior = AISpecialPowerUpdate GondorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry 		= BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight 	= 10.0
    GeometryIsSmall 	= No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorRangerArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorRangerUpgradedWeapon
    End
End

ChildObject GondorWachterderKompanieHordePorcupine GondorWachterderKompanieHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         		= STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         		= STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload                  = GondorWachterderKompanie 8
        Slots                           = 8
        PassengerFilter                 = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking     = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers              = GondorSpearmanHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation              = GondorWachterderKompanieHorde
        VisionRearOverride              = 100%
        VisionSideOverride              = 100%
        NotComboFormation               = Yes

        RankInfo    = RankNumber:1 UnitType:GondorWachterderKompanie Position:X:18 Y:-18   Position:X:18 Y:0   Position:X:18 Y:18   Position:X:0 Y:18   Position:X:-18 Y:18   Position:X:-18 Y:0   Position:X:-18 Y:-18   Position:X:0 Y:-18
    End
End


Object GondorArcherMonsterHunterHorde

    ButtonImage       = BIMonsterHunterArcher
    SelectPortrait    = UPMonsterHunterArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorArcherMonsterHunter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorArcherMonsterHunterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorArcherMonsterHunterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GondorArcherMonsterHunterMissileHordeRangefinder
        Weapon = TERTIARY   GondorArcherMonsterHunterMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 500
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange       = 300
    ShroudClearingRange     = 350
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints             = 60

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown GondorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = GondorMonsterHunterHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                     = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                   = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload 		       = GondorArcherMonsterHunter 12
        Slots 			       = 12
        PassengerFilter                = NONE +INFANTRY
        ShowPips                       = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset                   = X:0 Y:0
        MeleeBehavior                  = Amoeba
        End

        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorArcherMonsterHunter    Pos:X:70.0 Y:10.0

        RankInfo = RankNumber:1 UnitType:GondorArcherMonsterHunter Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40          Position:X:50 Y:60
        RankInfo = RankNumber:2 UnitType:GondorArcherMonsterHunter Position:X:30 Y:0            Position:X:30 Y:20        Position:X:30 Y:-20        Position:X:30 Y:40        Position:X:30 Y:-40          Position:X:30 Y:60

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance   = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance          = 1
        BackUpMaxDistance          = 3
        BackupPercentage           = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    75
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    100
        FearScanDistance             =     10

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion   	      =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion  	      =    CheerIdle_Base
        AddEmotion   	      =    CheerBusy_Base
        AddEmotion   	      =    HeroCheerIdle_Base
        AddEmotion    	      =    HeroCheerBusy_Base
        AddEmotion  	      =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End

ChildObject GondorFighterHorde_Earnur GondorFighterHorde
End

ChildObject GondorSpearmanHorde_Earnur GondorSpearmanHorde
End

ChildObject GondorArcherHorde_Earnur GondorArcherHorde
End

ChildObject GondorKnightHorde_Earnur GondorKnightHorde
End

ChildObject GondorTowerShieldGuardHorde_Earnur GondorTowerShieldGuardHorde
End

Object GondorWachterBrunnenHorde

    SelectPortrait         = UPWachterBrunnen
    ButtonImage            = HSWachterBrunnen

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Men
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeGondorWachterBrunnen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorWachterBrunnenHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorWachterBrunnenHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost             = 500
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = 200
    ShroudClearingRange         = 300
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
    CommandPoints             = GONDOR_WACHTERBRUNNEN_HORDE_COMMAND_POINTS

    CommandSet = GondorWachterBrunnenCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        =    500
        MaxCowerTime            =    5000
        MinCowerTime            =    3000
        AILuaEventsList            =    InfantryFunctions
        AttackPriority            =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = GondorWachterBrunnen 10
        Slots             = 10
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus    = 30.0
            AngleLimitCos    = -0.17
            InnerRange    = 30
            OuterRange    = 80
            OuterRangeBuildings    = 140
        End


        BannerCarriersAllowed    = GondorInfantryBanner
        BannerCarrierPosition    = UnitType:GondorWachterBrunnen    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondorWachterBrunnen Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:GondorWachterBrunnen Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GondorWachterBrunnenHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End



    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_LeadershipEnabler
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy                  = Upgrade_MiniHordeLvl2
    End
    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = No
        StartsPaused = Yes
    End
    Behavior = AttributeModifierAuraUpdate ModuleTag_FaramirLeadership
        StartsActive    = No
        BonusName        = WachterBrunnen
        TriggeredBy        = Upgrade_MiniHordeLvl2
        RefreshDelay    = 2500
        Range            = 200
        AntiCategory    = BUFF
        ObjectFilter    = NONE +GondorRanger +GondorTowerShieldGuard +GondorSpearman +GondorFighter +GondorArcher
    End



    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End





ChildObject GondorWachterBrunnenHordePorcupine GondorWachterBrunnenHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay         = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = GondorWachterBrunnen 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = GondorWachterBrunnenHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = GondorInfantryBanner
        BannerCarrierPosition            = UnitType:GondorWachterBrunnen    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:GondorWachterBrunnen Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End

