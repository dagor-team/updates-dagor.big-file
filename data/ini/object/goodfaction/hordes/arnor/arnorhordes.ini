Object ArnorFighterHorde

    ButtonImage        = UPNumenorSol
    SelectPortrait     = UPNumenorSol

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorSoldier
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorFighterHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = 380
    BuildTime         = WEAK_BUILDTIME
    ShroudClearingRange     = GONDOR_SOLDIER_HORDE_SHROUD_RANGE
    VisionRange         = GONDOR_SOLDIER_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 0
    CrusherLevel           = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown ArnorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = ArnorFighter 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorFighter Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation         = ArnorFighterHordeBlock
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded         = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_PurchaseHordeSpecialUnitNo1
    End

	Behavior = ObjectCreationUpgrade CaptainsReady
		TriggeredBy		= Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_BasicTraining
		RequiresAllTriggers	= Yes		
		Delay			= 10
		GrantUpgrade		= Upgrade_MiniHordeLvl6
	End

    Behavior = SpecialPowerModule ModuleTag_UpgradewithCaptainStarter
        SpecialPowerTemplate     = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HordeToggle
         SpecialPowerTemplate = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate      = ArnorFighterCaptainComboHorde
         UnpackTime           = 1000
         PreparationTime      = 0
         PackTime             = 0
         OpacityTarget        = .0
         AwardXPForTriggering = 0
         IgnoreFacingCheck    = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_PurchaseHordeSpecialUnitNo1
        GetUpgradeCommandButtonName = Command_SpecialAbilityToggleArnorFighterCaptainHorde
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    CommandSet = ArnorFighterHordeNewCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_ArnorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject ArnorFighterHorde_Summoned ArnorFighterHorde

    SelectPortrait = UPNumenorSwordman
    ButtonImage    = HSNumenorSwordman

    IsTrainable     = No
    CommandPoints   = 0
    CommandSet      = ArnorFighterHordeCommandSet_Summoned
    EquivalentTo    = ArnorFighterHorde
    KindOf          = +SUMMONED

    DisplayName      = OBJECT:HordeArnorSoldier

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = ArnorFighter_Summoned 15
        Slots             = 15
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:ArnorFighter_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorFighter_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorFighter_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End
End


ChildObject ArnorFighterHordeBlock ArnorFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload            = ArnorFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots                = 15
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers        = GondorFighterBlock_Edain
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:-2.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:ArnorFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = ArnorFighterHorde
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End
End

Object ArnorFighterCaptainComboHorde

    ButtonImage    = HSNumsoldier
    SelectPortrait = UPNumsoldier

    EquivalentTo    = ArnorFighterHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:ArnorFighterCaptainComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorFighterCaptainComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorFighterCaptainComboHorde

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = 250
    BuildTime         = WEAK_BUILDTIME
    ShroudClearingRange = GONDOR_SOLDIER_HORDE_SHROUD_RANGE
    VisionRange         = GONDOR_SOLDIER_HORDE_VISION_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45
    CommandSet 			= ArnorFighterCaptainHordeCommandSet
    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 0
    CrusherLevel           = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown ArnorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority            = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = ArnorFighter 15
        InitialPayload         = ArnorCaptain_ForHorde 1
        Slots             = 16
        PassengerFilter        = NONE +INFANTRY
        ShowPips         = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset        = X:0 Y:0
        MeleeBehavior         = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:10.0 

        RankInfo = RankNumber:1 UnitType:ArnorFighter Position:X:50 Y:0			Position:X:50 Y:20     		 Position:X:50 Y:-20     		Position:X:50 Y:40     		Position:X:50 Y:-40 
        RankInfo = RankNumber:2 UnitType:ArnorFighter Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2		Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorFighter Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2		Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:ArnorCaptain_ForHorde Position:X:70 Y:-10  

        RanksToReleaseWhenAttacking = 1

        AlternateFormation       = ArnorFighterCaptainComboHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded         = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades
        UpgradeToGrant      = Upgrade_BasicTraining
        GiveOnBuildComplete = Yes
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades2
        UpgradeToGrant      = Upgrade_ForgedBlades
        GiveOnBuildComplete = Yes
    End
	
    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades3
        UpgradeToGrant      = Upgrade_HeavyArmor
        GiveOnBuildComplete = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_BasicTraining
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End
	
    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_ArnorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject ArnorFighterCaptainComboHordeBlock ArnorFighterCaptainComboHorde

    EquivalentTo    = ArnorFighterHordeBlock
    CommandSet = ArnorFighterCaptainHordeCommandSet

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload       = ArnorFighter GOOD_MEN_GIANT_HORDE_SIZE
        InitialPayload       = ArnorCaptain_ForHorde 1
        Slots                = 16
        PassengerFilter      = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers        = ArnorFighterBlockCaptain
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:-2.0 Y:6.0

        RankInfo = RankNumber:1 UnitType:ArnorFighter Position:X:34 Y:0            	Position:X:34 Y:10		Position:X:34 Y:-10               Position:X:34 Y:20               Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:ArnorFighter Position:X:22 Y:0 Leader 1 0	Position:X:22 Y:10 Leader 1 1	Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorFighter Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:10 Leader 2 1	Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RankInfo = RankNumber:4 UnitType:ArnorCaptain_ForHorde Position:X:-2 Y:-6

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = ArnorFighterCaptainComboHorde
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End
End

Object ArnorTowerShieldGuardHorde

    ButtonImage        = UPNumspear
    SelectPortrait     = UPNumspear

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorTowerGuard
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorTowerGuardHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorTowerGuardHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost = 400
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_TOWERGUARD_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_TOWERGUARD_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = ArnorPikeManHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown ArnorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorTowerShieldGuard 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorTowerShieldGuard Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorTowerShieldGuard Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorTowerShieldGuard Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = ArnorTowerShieldGuardHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_PurchaseHordeSpecialUnitNo1
    End

	Behavior = ObjectCreationUpgrade CaptainsReady
		TriggeredBy		= Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_BasicTraining
		RequiresAllTriggers	= Yes		
		Delay			= 10
		GrantUpgrade		= Upgrade_MiniHordeLvl6
	End

    Behavior = SpecialPowerModule ModuleTag_UpgradewithCaptainStarter
        SpecialPowerTemplate     = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack = Yes
        StartsPaused             = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HordeToggle
         SpecialPowerTemplate = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate      = ArnorTowerShieldGuardCaptainComboHorde
         UnpackTime           = 1000
         PreparationTime      = 0
         PackTime             = 0
         OpacityTarget        = .0
         AwardXPForTriggering = 0
         IgnoreFacingCheck    = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_PurchaseHordeSpecialUnitNo1
        GetUpgradeCommandButtonName = Command_SpecialAbilityToggleArnorFighterCaptainHorde
    End

    Behavior = AISpecialPowerUpdate ArnorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_ArnorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject ArnorTowerShieldGuardHorde_Summoned ArnorTowerShieldGuardHorde
    IsTrainable      =    No
    CommandPoints =    0
    CommandSet      =    ArnorTowerShieldGuardCommandSet_Summoned
    EquivalentTo  =    ArnorTowerShieldGuardHorde
    KindOf                = +SUMMONED

    DisplayName = OBJECT:HordeArnorTowerGuard

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorTowerShieldGuard_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorTowerShieldGuard_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorTowerShieldGuard_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorTowerShieldGuard_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End
End

ChildObject ArnorTowerShieldGuardHordePorcupine ArnorTowerShieldGuardHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload                  = ArnorTowerShieldGuard 15
        Slots                           = 15
        PassengerFilter                 = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking     = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers              = EdainHordePorcupine	
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation               = ArnorTowerShieldGuardHorde
        VisionRearOverride               = 100%
        VisionSideOverride               = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = ArnorInfantryBanner
        BannerCarrierPosition            = UnitType:ArnorTowerShieldGuard    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:ArnorTowerShieldGuard Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


Object ArnorTowerShieldGuardCaptainComboHorde

    ButtonImage		= HSNumspear
    SelectPortrait	= UPNumspear

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:ArnorTowerShieldGuardCaptainComboHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorTowerShieldGuardCaptainComboHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorTowerShieldGuardCaptainComboHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End

    BuildCost = 400
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_TOWERGUARD_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_TOWERGUARD_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = ArnorPikeManCaptainComboHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown ArnorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorTowerShieldGuard 15
        InitialPayload         = ArnorCaptain_ForHorde 1
        Slots = 16
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:10.0

        RankInfo = RankNumber:1 UnitType:ArnorTowerShieldGuard Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorTowerShieldGuard Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorTowerShieldGuard Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RankInfo = RankNumber:4 UnitType:ArnorCaptain_ForHorde Position:X:70 Y:-10

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = ArnorTowerShieldGuardCaptainComboHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades
        UpgradeToGrant      = Upgrade_BasicTraining
        GiveOnBuildComplete = Yes
    End

    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades2
        UpgradeToGrant      = Upgrade_ForgedBlades
        GiveOnBuildComplete = Yes
    End
	
    Behavior = GrantUpgradeCreate ModuleTag_EnableUpgrades3
        UpgradeToGrant      = Upgrade_HeavyArmor
        GiveOnBuildComplete = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = AISpecialPowerUpdate ArnorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_ArnorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject ArnorTowerShieldGuardCaptainComboHordePorcupine ArnorTowerShieldGuardCaptainComboHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained 	=
        InitialPayload                  = ArnorTowerShieldGuard 15
        InitialPayload         = ArnorCaptain_ForHorde 1
        Slots                           = 16
        PassengerFilter                 = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking     = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers              = ArnorSpearmenCaptainHordePorcupine	
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation               = ArnorTowerShieldGuardCaptainComboHorde
        VisionRearOverride               = 100%
        VisionSideOverride               = 100%
        NotComboFormation                = Yes

        BannerCarriersAllowed            = ArnorInfantryBanner
        BannerCarrierPosition            = UnitType:ArnorTowerShieldGuard    Pos:X:0.0 Y:-5.0

        RankInfo    = RankNumber:1 UnitType:ArnorTowerShieldGuard Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
        RankInfo = RankNumber:2 UnitType:ArnorCaptain_ForHorde Position:X:4 Y:5

    End
End


Object ArnorArcherHorde

    SelectPortrait	= UPNumenorBogi
    ButtonImage	= HSNumarcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY    GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 350
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_ARCHER_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_ARCHER_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown ArnorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = ArnorArcherHordeNewCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle   = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate          = 500
        MaxCowerTime                 = 5000
        MinCowerTime                 = 3000
        CanAttackWhileContained      = Yes
        AILuaEventsList              = InfantryFunctions
        AttackPriority               = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle              = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay            = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload 		= ArnorArcher 15
        Slots 			= 15
        PassengerFilter    	= NONE +INFANTRY
        ShowPips 		= No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset		= X:0 Y:0
        MeleeBehavior 		= Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorArcher    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorArcher Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorArcher Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

	Behavior = RemoveUpgradeUpgrade ModuleTag_RUU1
		TriggeredBy	= Upgrade_FireArrows
		UpgradeToRemove = Upgrade_RangedWeapons_No2
		RemoveFromAllPlayerObjects	= No
		SuppressEvaEventForRemoval	= Yes
	End

	Behavior = RemoveUpgradeUpgrade ModuleTag_RUU2
		TriggeredBy	= Upgrade_RangedWeapons_No2
		UpgradeToRemove = Upgrade_FireArrows
		RemoveFromAllPlayerObjects	= No
		SuppressEvaEventForRemoval	= Yes
	End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End


    Behavior = AISpecialPowerUpdate ArnorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ArnorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ArnorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

ChildObject ArnorArcherHorde_Summoned ArnorArcherHorde

    SelectPortrait   = UPNumenorArcher
    ButtonImage      = HSNumenorArcher

    IsTrainable      = No
    CommandPoints    = 0
    CommandSet       = ArnorArcherHordeCommandSet_Summoned
    EquivalentTo     = ArnorArcherHorde
    KindOf           = +SUMMONED

    DisplayName = OBJECT:HordeArnorArcher

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorArcher_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset =X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:ArnorArcher_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorArcher_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorArcher_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime    = 180000
        MaxLifetime    = 180000
        DeathType    = FADED
    End
End


Object ArnorRangerHorde

    SelectPortrait         = UPDunedainRanger
    ButtonImage            = HSDunedainRanger

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side          = Arnor
    EditorSorting = UNIT
    EmotionRange  = 240
    DisplayName   = OBJECT:HordeArnorRanger
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorRangerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorRangerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GondorRangerMissileHordeRangefinder
        Weapon = TERTIARY   GondorRangerMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = ARNORRANGERHORDE_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_RANGER_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_RANGER_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    CrushableLevel = 0
    CrusherLevel   = 0
    UseCrushAttack = No

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown ArnorRangerHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        CanAttackWhileContained    = Yes
        AILuaEventsList            = InfantryFunctions
        AttackPriority             = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle               = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay             = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained  =
        InitialPayload           = ArnorRanger 10
        Slots                    = 10
        PassengerFilter          = NONE +INFANTRY +ArnorInfantryBanner
        ShowPips                 = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset             = X:0 Y:0

        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryRangerBanner
        BannerCarrierPosition    = UnitType:ArnorRanger       Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorRanger Position:X:50 Y:0     Position:X:50 Y:20       Position:X:50 Y:-20       Position:X:50 Y:40       Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorRanger Position:X:30 Y:0     Position:X:30 Y:20       Position:X:30 Y:-20       Position:X:30 Y:40       Position:X:30 Y:-40

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf              = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    CommandSet = ArnorRangerHordeCommandSet_New

    Behavior = CommandSetUpgrade ModuleTag_HugelwachenCommandSet
        TriggeredBy       = Upgrade_ArnorRangerHugelwachen
        CommandSet        = ArnorRangerHordeCommandSet_Hugelwachen
    End

    Behavior = CommandSetUpgrade ModuleTag_AranarthsGetreueCommandSet
        TriggeredBy       = Upgrade_ArnorRangerAranarthsGetreue
        CommandSet        = ArnorRangerHordeCommandSet_AranarthsGetreue
    End


    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate         = SpecialAbilityMenLongShot
        OCL                          = OCL_LongShotAbility
        CreateLocation               = CREATE_AT_LOCATION
        UpdateModuleStartsAttack     = No

        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityMenLongShot
        PackTime                = 5000
        MustFinishAbility       = Yes
        SpecialWeapon           = MenLongShotWeapon
        NeedLivingTargets       = No
        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS     = No
    End


    Behavior = OCLSpecialPower ModuleTag_Storfeuer
        SpecialPowerTemplate        = SpecialAbilityArnorLongShot
        OCL                         = OCL_StorfeuerAbility
        CreateLocation              = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No

        SetModelCondition           = ModelConditionState:USER_1
        SetModelConditionTime       = 5.0
        DisableDuringAnimDuration   = Yes
    End

    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_StorfeuerUpdate
        SpecialPowerTemplate    = SpecialAbilityArnorLongShot
        PackTime                = 5000
        MustFinishAbility       = Yes
        SpecialWeapon           = MenLongShotWeapon
        NeedLivingTargets       = No
        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS     = No
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ArnorRangerHugelwachen
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_ArnorRangerAranarthsGetreue
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly      = Yes
        StuffToPickUp       = ANY +CRATE -TheDroppedRing
        ScanRange           = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate ArnorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RangerLongshotAI1
	CommandButtonName = Command_ArnorPfeilhagelAbility
	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate RangerLongshotAI2
	CommandButtonName = Command_ArnorStorfeuerAbility
	SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Geometry            = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight      = 10.0
    GeometryIsSmall     = No

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ArnorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ArnorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


ChildObject ArnorRangerInnHorde ArnorRangerHorde
    BuildCost = INN_UNIT_BUILDCOST_MEN
    EquivalentTo = ArnorRangerHorde_Summoned
    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorRangerInn GOOD_MEN_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorRangerInn        Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorRangerInn Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:2 UnitType:ArnorRangerInn Position:X:20 Y:0    Position:X:15 Y:25    Position:X:20 Y:-25    Position:X:20 Y:50    Position:X:20 Y:-50

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


ChildObject ArnorRangerHorde_Summoned ArnorRangerHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = ArnorRangerHordeCommandSet_Summoned
    EquivalentTo = ArnorRangerInnHorde

    DisplayName  =  OBJECT:HordeDunedainRanger
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorRanger_Summoned 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:4 Y:4


        RankInfo = RankNumber:1 UnitType:ArnorRanger_Summoned Position:X:0 Y:0    Position:X:0 Y:20    Position:X:0 Y:-20    Position:X:0 Y:40    Position:X:0 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorRanger_Summoned Position:X:15 Y:0    Position:X:15 Y:20    Position:X:15 Y:-20    Position:X:15 Y:40    Position:X:15 Y:-40

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = DUNEDAIN_ALLIES_LIFETIME
        MaxLifetime        = DUNEDAIN_ALLIES_LIFETIME
        DeathType        = FADED
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRange        = 100
        DetectionRate        = 500
        CancelOneRingEffect = Yes
    End
End


Object ArnorKnightHorde

    ButtonImage        = BIArnorKnights
    SelectPortrait     = UPNumknight

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model     = None
        End
        ModelConditionState = HORDE_EMPTY
            Model     = None
        End
        ModelConditionState = WORLD_BUILDER
            Model     = HordeMarkGUKni
        End
    End

    Side             = Arnor
    EditorSorting         = UNIT
    EmotionRange         = 240
    DisplayName         = OBJECT:HordeArnorKnight
    DisplayNameStrategic     = CONTROLBAR:LW_Unit_ArnorKnightHorde
    DescriptionStrategic     = CONTROLBAR:LW_ToolTip_ArnorKnightHorde

    WeaponSet
        Conditions     = None
        Weapon         = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet         = ArnorKnightHordeCommandSetMod

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 500
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = GONDOR_KNIGHT_HORDE_VISION_RANGE
    VisionSide             = 35%
    VisionRear             = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot     = 5.0%
    ShroudClearingRange         = GONDOR_KNIGHT_HORDE_SHROUD_RANGE

    CommandPoints             = 50

    FormationWidth             = 2
    FormationDepth             = 1

    CrushableLevel             = 2
    CrusherLevel             = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback             = 40
    CrushZFactor             = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        AILuaEventsList            = CavalryFunctions
        AttackPriority            = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = ArnorCavalry  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots                 = 10
        PassengerFilter         = NONE +CAVALRY +ArnorCavalryBanner
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior            = Amoeba
        End


        BannerCarriersAllowed        = ArnorCavalryBanner
        BannerCarrierPosition        = UnitType:ArnorCavalry    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorCavalry Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorCavalry Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4
        AlternateFormation = ArnorKnightHordeWedgeFormation
        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf            =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance        =    150
         FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =       BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =       CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ArnorKnightHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorKnightHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorKnightArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorKnightUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorKnightWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End

ChildObject ArnorKnightHordeWedgeFormation ArnorKnightHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = ArnorCavalry 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +ArnorCavalryBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = ArnorCavalryBanner
        BannerCarrierPosition    = UnitType:ArnorCavalry    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorCavalry Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorCavalry Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = ArnorKnightHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


ChildObject ArnorKnightHorde_Summoned ArnorKnightHorde
    IsTrainable         = No
    CommandPoints         = 0
    CommandSet         = ArnorKnightHordeCommandSet_Summoned
    EquivalentTo         = ArnorKnightHorde

    DisplayName         = OBJECT:HordeArnorKnight

    Behavior         = HorseHordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload             = ArnorCavalry_Summoned GOOD_RIDER_LARGE_HORDE_SIZE
        Slots                 = 10
        PassengerFilter         = NONE +CAVALRY +ArnorCavalryBanner
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:ArnorCavalry_Summoned Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30        Position:X:40 Y:-30
        RankInfo = RankNumber:2 UnitType:ArnorCavalry_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3    Position:X:10 Y:-30 Leader 1 4

        RanksToReleaseWhenAttacking     = 1

        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object LindonWarriorHorde

    ButtonImage    = UPLindonKrieger
    SelectPortrait = UPLindonKrieger


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:ElvenLindonWarrior
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ElvenLindonWarriorHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ElvenLindonWarriorHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = LindonKampferHordeCommandSet

    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = ELVEN_LINDONWARRIOR_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange = ELVEN_LINDONWARRIOR_HORDE_VISION_RANGE
    ShroudClearingRange = 161
    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = LindonElvenWarrior 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1
        AlternateFormation = LAElvenWarriorLineFormation


        BannerCarriersAllowed    = ElvenBanner
        BannerCarrierPosition    = UnitType:LindonElvenWarrior    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:LindonElvenWarrior Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:LindonElvenWarrior Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
    End

    Behavior = StealthUpdate StealthUpdateModuleTag
        StealthDelay                        = 500
        FriendlyOpacityMin                    = STEALTH_FRIENDLY_OPACITY_MIN
        FriendlyOpacityMax                    = STEALTH_FRIENDLY_OPACITY_MAX
        PulseFrequency                        = 750
        StealthForbiddenConditions            = AWAY_FROM_TREES ATTACKING
        OrderIdleEnemiesToAttackMeUponReveal= Yes
        DetectedByAnyoneRange                = 120
        RevealWeaponSets                    = CLOSE_RANGE CONTESTING_BUILDING
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SilverThornArrows
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_FAST_HORDE_SPEED
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate LindonWarriorHordeToggleWeapon
        CommandButtonName = Command_ToggleElvenWarriorWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End


Object ImladrisWarriorHorde

    ButtonImage = BEElvenBarracks_LorienWarrior
    SelectPortrait         = UPElven_LorienWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:ElvenLindonWarrior
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ElvenImladrisWarriorHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ElvenImladrisWarriorHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = ElvenLindonWarriorHordeCommandSet

    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = ELVEN_LINDONWARRIOR_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange = ELVEN_LINDONWARRIOR_HORDE_VISION_RANGE
    ShroudClearingRange = 161
    CommandPoints = 48

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = ElvenImladrisWarrior 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1
        AlternateFormation = LAElvenWarriorLineFormation

        BannerCarriersAllowed    = ElvenBanner
        BannerCarrierPosition    = UnitType:ElvenImladrisWarrior    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:ElvenImladrisWarrior Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ElvenImladrisWarrior Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
    End

    Behavior = StealthUpdate StealthUpdateModuleTag
        StealthDelay                        = 500
        FriendlyOpacityMin                    = STEALTH_FRIENDLY_OPACITY_MIN
        FriendlyOpacityMax                    = STEALTH_FRIENDLY_OPACITY_MAX
        PulseFrequency                        = 750
        StealthForbiddenConditions            = AWAY_FROM_TREES ATTACKING
        OrderIdleEnemiesToAttackMeUponReveal= Yes
        DetectedByAnyoneRange                = 120
        RevealWeaponSets                    = CLOSE_RANGE CONTESTING_BUILDING
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_SilverThornArrows
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_FAST_HORDE_SPEED
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Behavior = AISpecialPowerUpdate ImladrisWarriorHordeToggleWeapon
        CommandButtonName = Command_ToggleElvenWarriorWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End


Object ArnorArcherHordeMod

    ButtonImage       = WOR_GondorArcher
    SelectPortrait    = UPNumenorBogi

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorArcher
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY   GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 350
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_ARCHER_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_ARCHER_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints  = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 100
    ThreatBreakdown ArnorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = ArnorArcherHordeCommandSetNew

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorArcher 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorArcher    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorArcher Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:ArnorArcher Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      =    1000
        TauntAndPointExcluded         =    NONE
        AfraidOf                      =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                       =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion    	      =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

	Behavior = RemoveUpgradeUpgrade ModuleTag_RUU1
		TriggeredBy	= Upgrade_FireArrows
		UpgradeToRemove = Upgrade_RangedWeapons_No2
		RemoveFromAllPlayerObjects	= No
		SuppressEvaEventForRemoval	= Yes
	End

	Behavior = RemoveUpgradeUpgrade ModuleTag_RUU2
		TriggeredBy	= Upgrade_RangedWeapons_No2
		UpgradeToRemove = Upgrade_FireArrows
		RemoveFromAllPlayerObjects	= No
		SuppressEvaEventForRemoval	= Yes
	End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED   
    End

    Behavior = AISpecialPowerUpdate ArnorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ArnorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End


Object ArnorRangerHordeMod

    SelectPortrait         = UPGondor_Ranger
    ButtonImage            = HSDunedainRanger

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGURan
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorRanger
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorRangerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorRangerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GondorRangerMissileHordeRangefinder
        Weapon = TERTIARY   GondorRangerMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = GONDOR_RANGER_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = GONDOR_RANGER_HORDE_VISION_RANGE
    ShroudClearingRange = GONDOR_RANGER_HORDE_SHROUD_RANGE
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 50

    CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_RANGER_HORDE_THREAT
    ThreatBreakdown ArnorRangerHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = ArnorRanger 10
        Slots = 10
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:4 Y:4
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = ArnorInfantryBanner
        BannerCarrierPosition    = UnitType:ArnorRanger        Pos:X:40.0 Y:0.0

        RandomOffset = X:0 Y:-12

        RankInfo = RankNumber:1 UnitType:ArnorRanger Position:X:0 Y:12    Position:X:0 Y:-12    Position:X:0 Y:-36    Position:X:0 Y:36    Position:X:0 Y:-60     Position:X:0 Y:60
        RankInfo = RankNumber:2 UnitType:ArnorRanger Position:X:20 Y:12    Position:X:15 Y:-12    Position:X:20 Y:-36    Position:X:20 Y:36    Position:X:20 Y:-60    Position:X:20 Y:60

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base


         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    CommandSet = ArnorRangerHordeNewCommandSet

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate        = SpecialAbilityArnorLongShot
        OCL                            = OCL_LongShotAbility
        CreateLocation                = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No

        SetModelCondition            = ModelConditionState:USER_1
        SetModelConditionTime        = 5.0
        DisableDuringAnimDuration    = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate
        SpecialPowerTemplate    = SpecialAbilityArnorLongShot
        PackTime                = 5000
        MustFinishAbility        = Yes
        SpecialWeapon            = MenLongShotWeapon
        NeedLivingTargets        = No

        TriggerSound            = RangerVoiceLongShot
        ApproachRequiresLOS        = No
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = AISpecialPowerUpdate ArnorRangerHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 60.0
    GeometryHeight = 10.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ArnorRangerHordeBody

    AutoResolveArmor
        Armor = AutoResolve_ArnorRangerArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_ArnorRangerWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object ArnorPalantirwachterHorde

    ButtonImage            = UPPalaWache
    SelectPortrait         = UPPalaWache

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorPalantirwachter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorPalantirwachterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorPalantirwachterHorde
	MaxSimultaneousOfType = 6
    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = ArnorPalantirwachterHordeCommandSet

    CrushableLevel = 0
    CrusherLevel   = 0

    BuildCost = 1100
    BuildTime = STRONG_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 475
    VisionSide = 35%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 100

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE PIKE ARMY_SUMMARY MELEE_HORDE

    ThreatLevel = ELVEN_LORIENWARRIOR_HORDE_THREAT

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle  = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate         = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained     = Yes
        AILuaEventsList             = InfantryFunctions
        AttackPriority              = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = ArnorPalantirwachter 10
        Slots = 10
        PassengerFilter = NONE +ArnorPalantirwachter +ArnorPalantirwaechterBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = ArnorPalantirwaechterBanner
        BannerCarrierPosition    = UnitType:ArnorPalantirwachter  Pos:X:40.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorPalantirwachter Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorPalantirwachter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
		
		AlternateFormation            = PlanterGaurdPorcupine
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      =    1000
        TauntAndPointExcluded         =    NONE
        AfraidOf                      =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
        PointAt                       =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS
        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DefendStructureUnpause
        SpecialPowerTemplate        = SpecialAbilityDefendStructure
        TriggeredBy                 = Upgrade_MiniHordeLvl5
    End

    Behavior = SpecialPowerModule DefendStructure_ModuleTag
        SpecialPowerTemplate        = SpecialAbilityDefendStructure
        AttributeModifier           = DefendStructureModifier
        AttributeModifierRange      = 55
        AttributeModifierAffects    = ANY +STRUCTURE ALLIES
        UpdateModuleStartsAttack    = No
        StartsPaused                = Yes
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED   
    End

     Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_RangedWeapons_No2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_HeavyArmor
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorWachterderVesteWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject PlanterGaurdPorcupine ArnorPalantirwachterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained         =
        InitialPayload                = ArnorPalantirwachter 10
        Slots                    = 10
        PassengerFilter                = NONE +INFANTRY
        ShowPips                = No
        ThisFormationIsTheMainFormation     = No
        RandomOffset                = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking           = 0
        AttributeModifiers            = EdainHordePorcupine
        IsPorcupineFormation        = Yes
        MinimumHordeSize            = 5

        AlternateFormation          = ArnorPalantirwachterHorde
        VisionRearOverride          = 100%
        VisionSideOverride          = 100%
        NotComboFormation           = Yes

        BannerCarriersAllowed       = ArnorPalantirwaechterBanner
        BannerCarrierPosition       = UnitType:ArnorPalantirwachter    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:ArnorPalantirwachter Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End

Object ArnorHueterHorde

    SelectPortrait         = UPHofgarde
    ButtonImage            = UPHofgarde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Arnor
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeArnorHueterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_ArnorHueterHordeHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_ArnorHueterHordeHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost         = ARNORGUARDIANSHORDE_BUILDCOST
    BuildTime         = STRONG_BUILDTIME
    ShroudClearingRange  = GONDOR_SOLDIER_HORDE_SHROUD_RANGE
    VisionRange       = GONDOR_SOLDIER_HORDE_VISION_RANGE
    VisionSide        = 50%
    VisionRear        = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints     = 65
    CommandSet        = ArnorHueterHordeCommandSet

    FormationWidth         = 2
    FormationDepth         = 1

    CrushableLevel         = 0
    CrusherLevel           = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 150
    ThreatBreakdown ArnorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime               = 5000
        MinCowerTime               = 3000
        AILuaEventsList            = InfantryFunctions
        AttackPriority             = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle            = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay          = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload        = ArnorHueter 10
        Slots                 = 10
        PassengerFilter       = NONE +INFANTRY
        ShowPips              = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset          = X:0 Y:0
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = ArnorHueterBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorHueter Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:ArnorHueter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation         = ArnorHueterHordeBlock
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf                     = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance             = 150
        FearScanDistance             = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = ScaredMeleeHordeLocomotor
        Condition     = SET_SCARED
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate = SpecialAbilityFakeLeadership
        TriggeredBy = Upgrade_ObjectLevel3
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate      = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack  = Yes
        StartsPaused = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive     = No
        BonusName        = ArnorHuterLeadership
        TriggeredBy      = Upgrade_ObjectLevel3
        RefreshDelay     = 2000
        Range            = 200
        AntiCategory     = BUFF
        ObjectFilter     = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -MACHINE -SHIP ALLIES
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate ArnorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_ArnorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_ArnorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ArnorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject ArnorHueterHorde_Elendil ArnorHueterHorde
End

ChildObject ArnorHueterHordeBlock ArnorHueterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay         = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained        =
        InitialPayload            = ArnorHueter 10
        Slots                = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers        = GondorFighterBlock_Edain
        RandomOffset            = X:0 Y:0
        MeleeBehavior             = Amoeba
        End

        BannerCarriersAllowed    = ArnorHueterBanner
        BannerCarrierPosition    = UnitType:ArnorFighter    Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:ArnorHueter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:ArnorHueter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = ArnorHueterHorde
        MeleeAttackLeashDistance     = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End
End