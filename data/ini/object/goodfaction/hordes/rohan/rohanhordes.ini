Object RohanRohirrimHorde

    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait     = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    BuildCost     = 450
    BuildTime     = MEDIUM_BUILDTIME
    VisionRange   = 250
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY
    CommandSet = RohanModRohirrimHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanBanner
        ShowPips = No
        RandomOffset = X:2 Y:3
        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim   Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrim Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrim Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        AlternateFormation = RohanRohirrimHordeWedgeFormation

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
         AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base
         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base
         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End



ChildObject RohanRohirrimHordeWedgeFormation RohanRohirrimHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrim Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanRohirrimHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End





ChildObject RohanRohirrimHorde_Summoned RohanRohirrimHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorKnightHordeCommandSet_Summoned
    EquivalentTo = RohanRohirrimHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim_Summoned 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanBanner
        ShowPips = No
        RandomOffset = X:2 Y:3
        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim_Summoned   Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrim_Summoned Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrim_Summoned Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrim_Summoned Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object RohanRohirrimHordeHerold

    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait        = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Obsolete
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    BuildCost = 400
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 250
    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY
    CommandSet = RohanModRohirrimHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        RandomOffset = X:2 Y:3
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim  Pos:X:60.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrim Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrim Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        AlternateFormation = RohanRohirrimHordeWedgeFormationHerold

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor

End



ChildObject RohanRohirrimHordeWedgeFormationHerold RohanRohirrimHordeHerold

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanRohirrim  Pos:X:30.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrim Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanRohirrimHordeHerold

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End





ChildObject RohanRohirrimArcherHorde RohanRohirrimHorde

    DisplayName = OBJECT:RohanRohirrimArchers

    ButtonImage     = HSRohirrimBogis
    SelectPortrait  = UPRohirrimBogis

    BuildCost = 550
    BuildTime = MEDIUM_BUILDTIME

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End

    CommandSet = RohanArcherModHordeCommandSet
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY ARCHER

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanBanner
        ShowPips = No
        RandomOffset = X:2 Y:3
        ThisFormationIsTheMainFormation = Yes
    
        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod    Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod  Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod  Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrimArcher_mod  Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        AlternateFormation = RohanRohirrimArcherHordeWedgeFormation
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                   = 5000
        MinCowerTime                   = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                 = AttackPriority_Cavalry
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    MaxSimultaneousOfType    = 6

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End
End



ChildObject RohanRohirrimArcherHordeWedgeFormation RohanRohirrimHorde

    
    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:7 Y:3


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40


        RanksToReleaseWhenAttacking = 1

        AlternateFormation = RohanRohirrimArcherHorde
        AttributeModifiers = RohanHorseWegde
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End
End

Object RohanSpearmenHorde

    ButtonImage        = WOR_RhnSpearman
    SelectPortrait     = UPRohanSpearmanPortrait

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side                    = Rohan
    EditorSorting                = UNIT
    EmotionRange                = 240
    DisplayName                = OBJECT:HordeRohanSpearThrower
    DisplayNameStrategic            = CONTROLBAR:LW_Unit_RohanSpearThrowerHorde
    DescriptionStrategic            = CONTROLBAR:LW_ToolTip_RohanSpearThrowerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ShortRangedMissileHordeRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End





    BuildCost             = 250
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = 200
    ShroudClearingRange         = 300
    VisionSide             = 50%
    VisionRear             = 25%
    MaxVisionBonusPercent         = 300%
    VisionBonusTestRadius         = 200
    VisionBonusPercentPerFoot     = 1.0%
    CommandPoints             = 30

    CommandSet = RohanPikeModCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE CAN_USE_SIEGE_TOWER
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_SPEARMEN_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = MORDOR_HARADRIM_LANCER_SWITCH_RANGE_HORDE
    End


    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained         =
        InitialPayload             = RohanSpearmen 10
        Slots                 = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips             = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset            = X:3 Y:3
        MeleeBehavior             = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanSpearmen   Pos:X:30.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:RohanSpearmen Position:X:0 Y:0    Position:X:0 Y:25    Position:X:0 Y:-25    Position:X:0 Y:50    Position:X:0 Y:-50
        RankInfo = RankNumber:1 UnitType:RohanSpearmen Position:X:30 Y:0    Position:X:30 Y:25    Position:X:30 Y:-25    Position:X:30 Y:50    Position:X:30 Y:-50

        RanksToReleaseWhenAttacking    = 1 2
        MeleeAttackLeashDistance    = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay  =    1000
        TauntAndPointExcluded     =    NONE
        AfraidOf                  =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf            =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                   =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance          =    150
        FearScanDistance          =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion        =    CheerIdle_Base
        AddEmotion        =    CheerBusy_Base
        AddEmotion        =    HeroCheerIdle_Base
        AddEmotion        =    HeroCheerBusy_Base
        AddEmotion        =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject RohanSpearmenHordeHordePorcupine RohanSpearmenHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained     =
        InitialPayload            = RohanSpearmenHorde GOOD_MEN_HORDE_SIZE
        Slots                = 15
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation = No
        RandomOffset            = X:2 Y:1
        RanksToReleaseWhenAttacking    = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers        = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation        = Yes
        MinimumHordeSize        = 5

        AlternateFormation        = RohanSpearmenHorde
        VisionRearOverride        = 100%
        VisionSideOverride        = 100%
        NotComboFormation        = Yes


        BannerCarriersAllowed        = GondorInfantryBanner
        BannerCarrierPosition        = UnitType:RohanSpearmen    Pos:X:0.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanSpearmen     Position:X:20 Y:0    Position:X:-16.18 Y:11.76    Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


Object RohanPeasantHorde_modneu

    ButtonImage     = HIRohanPeasant_Wotr
    SelectPortrait  = UPRohanPeasant

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUPea
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanPeasant
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanPeasantHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanPeasantHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = RohanBauernHordeCommandSet



    CrushableLevel = 0
    CrusherLevel   = 0

    BuildCost = 100
    BuildTime = 30
    VisionRange = 200
    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT

    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanPeasant_modneu 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:4 Y:4


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanPeasant_modneu   Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanPeasant_modneu Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20               Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanPeasant_modneu Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanPeasant_modneu Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded       =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf              =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
        PointAt                     =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy  = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap     = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_RohanAxes
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_VerraterEnabler
        SpecialPowerTemplate         = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
        TriggeredBy                  = Upgrade_TestBuilding
    End

    Behavior = SpecialPowerModule ModuleTag_VerraterStarter
         SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_VerraterToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonRhudaurSlingers
         MountedTemplate            = IsengardVerraeterHorde
         UnpackTime                 = 1000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                 = Upgrade_TestBuilding
        GetUpgradeCommandButtonName = Command_SpecialAbilityTogglePeasentVerrater
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_HelmHammerhandEnabler
        SpecialPowerTemplate         = SpecialAbilityGandalfGeprufte
        TriggeredBy                  = Upgrade_TestBuilding_2
    End

    Behavior = SpecialPowerModule ModuleTag_HelmHammerhandStarter
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         UpdateModuleStartsAttack    = Yes
         StartsPaused                = Yes
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HelmHammerhandToggle
         SpecialPowerTemplate        = SpecialAbilityGandalfGeprufte
         MountedTemplate             = RohanHelmAxeGuardPeasantHorde
         UnpackTime                  = 1000
         PreparationTime             = 0
         PackTime                    = 0
         OpacityTarget               = .0
         AwardXPForTriggering        = 0
         IgnoreFacingCheck           = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgradeHelmHammerhand
        TriggeredBy                 = Upgrade_TestBuilding_2
        GetUpgradeCommandButtonName = Command_SpecialAbilityGandalfGeprufte
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_RohanAxes
End


ChildObject RohanPeasantHorde_Summoned RohanPeasantHorde_modneu
    IsTrainable = No
    CommandPoints = 0
    CommandSet = RohanBauernHordeCommandSet
    EquivalentTo = RohanPeasantHorde_modneu

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End
    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanPeasant_Summoned 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset= X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanPeasant_Summoned    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanPeasant_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanPeasant_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanPeasant_Summoned Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

Object RohanRohirrimArcherHordeMod

    ButtonImage     = HIRohirrimBogis_Wotr
    SelectPortrait  = UPRohirrimBogis

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrimArchers
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimBogisHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimBogisHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMissileHordeRangefinder1
    End

    BuildCost = 500
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 350
    CommandPoints = 50
    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0
    MaxSimultaneousOfType  = 4

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE

    CommandSet = RohanRohirrimArcherHordeCommandSet
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY ARCHER

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        RandomOffset = X:2 Y:3
        ThisFormationIsTheMainFormation = Yes

        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod  Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrimArcher_mod Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = RohanRohirrimArcherHordeModHordeWedgeFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End


ChildObject RohanRohirrimArcherHordeModHordeWedgeFormation RohanRohirrimArcherHordeMod

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanRohirrimArcherHordeMod

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


Object RohanRohirrimArcherHordeModHerold

    ButtonImage     = HSRohirrimBogis
    SelectPortrait  = UPRohirrimBogis

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    MaxSimultaneousOfType    = 2
    DisplayName = OBJECT:HordeRohanRohirrimArchers
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 550
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 350
    CommandPoints = ROHAN_ROHIRRIM_ARCHER_COMMAND_POINTS
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = RohanArcherModHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod  Pos:X:60.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanRohirrimArcher_mod Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3
        AlternateFormation = RohanRohirrimArcherHordeModHordeWedgeFormationHerold
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End



ChildObject RohanRohirrimArcherHordeModHordeWedgeFormationHerold RohanRohirrimArcherHordeModHerold


	 
    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanRohirrimArcher_mod 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanRohirrimArcher_mod  Pos:X:30.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher_mod Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher_mod Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanRohirrimArcherHordeModHerold

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End






Object RohanRoyalGuardHorde_mod

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUHuo
        End
    End

    Side = Obsolete
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:Horde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = RohanRoyalGuardHordemodCommandSet



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost = ROYALGUARDCAVALRYHORDE_BUILDCOST
    BuildTime = ELITE_BUILDTIME
    VisionRange = 250
    CommandPoints = 60

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                = CavalryFunctions
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRoyalGuard_mod 8
        Slots = 8
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        RandomOffset = X:7 Y:3
        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:RohanRoyalGuard_mod Position:X:40 Y:0        Position:X:40 Y:15        Position:X:40 Y:-15        Position:X:40 Y:30
        RankInfo = RankNumber:2 UnitType:RohanRoyalGuard_mod Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:15 Leader 1 1    Position:X:10 Y:-15 Leader 1 2    Position:X:10 Y:30 Leader 1 3

        RanksToReleaseWhenAttacking = 1
    End



    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance       = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded       = NONE
        AfraidOf                    = NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf              = NONE +MordorBalrog +RohanOathbreaker +MordorSauron
        PointAt                     = NONE +MordorFellBeast +MordorWitchKingOnFellBeast
        HeroScanDistance            = 150
        FearScanDistance            = CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    OVERRIDE Point_Base
             Duration         =    2500
        End

        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base

        AddEmotion            =    OVERRIDE HeroCheerIdle_Base
        End
        AddEmotion            =    OVERRIDE HeroCheerBusy_Base
        End
        AddEmotion            =    Alert_Base
        AddEmotion            =    CheerForAboutToCrush_Base

     End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Geometry 		= BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight 	= 20.0
    GeometryIsSmall 	= No
End


Object RohanArcherHorde_mod

    SelectPortrait    = UPFreisassen
    ButtonImage       = HIFreisassen_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanArcherHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanArcherHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY    GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 300
    ShroudClearingRange = 350
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints = 45

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown GondorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = RohanArcherModHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanArcher_mod 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanArcher_mod    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanArcher_mod Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanArcher_mod Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanArcher_mod Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base



        AddEmotion            =    Doom_Base



        AddEmotion    =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End


Object RohanArcherHordeHerold


    SelectPortrait    = UPFreisassen
    ButtonImage       = HSFreisassen

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanFreisassen
    DisplayNameStrategic = CONTROLBAR:LW_Unit_Freisassen
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorArcherHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
        Weapon = TERTIARY    GoodArcherMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 300
    ShroudClearingRange = 350
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown GondorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    CommandSet = RohanArcherModHordeCommandSetHerold

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanArcher_mod 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanArcher_mod   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanArcher_mod Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanArcher_mod Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanArcher_mod Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base



        AddEmotion            =    Doom_Base



        AddEmotion    =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End





Object RohanLancerHorde

    ButtonImage        = HIRohanWachterMeduselds_Wotr
    SelectPortrait     = UPRohanWachterMeduselds

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanWachterMeduselds
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorRohanWachterMeduselds
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRohanWachterMeduselds

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End



    BuildCost = 250
    BuildTime = WEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = RohanMeduseldHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanLancer 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanLancer    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanLancer Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanLancer Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanLancer Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = RohanLancerHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject RohanLancerHordePorcupine RohanLancerHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = RohanLancer GOOD_MEN_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = RohanLancerHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = RohanBanner
        BannerCarrierPosition            = UnitType:RohanLancer    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:RohanLancer Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End


Object RohanWachterMeduseldsHordeHerold


    ButtonImage        = HSRohanWachterMeduselds
    SelectPortrait     = UPRohan_BannerCarrier

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanWachterMeduselds
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GondorRohanWachterMeduselds
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRohanWachterMeduselds

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost = ROHAN_WACHTERMEDUSELDS_BUILDCOST
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = ROHAN_WACHTERMEDUSELDS_COMMAND_POINTS_HORDE

    CommandSet = RohanMeduseldHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanLancer GOOD_MEN_GIANT_HORDE_SIZE
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanLancer   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanLancer Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanLancer Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanLancer Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = RohanWachterMeduseldsHordeHeroldPorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject RohanWachterMeduseldsHordeHeroldPorcupine RohanWachterMeduseldsHordeHerold

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = RohanLancer GOOD_MEN_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = RohanWachterMeduseldsHordeHerold
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = RohanHeroldBanner
        BannerCarrierMinLevel            = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType      = +NORMAL
        BannerCarrierPosition            = UnitType:RohanLancer    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:RohanLancer Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64    Position:X:26.77 Y:29.73    Position:X:-39.13 Y:-8.32    Position:X:36.54 Y:-16.27    Position:X:-20 Y:34.64    Position:X:-4.18 Y:-39.78
    End
End



Object RohanFighterHorde

    SelectPortrait      = UPRohanFighter
    ButtonImage         = HIRohanFighter_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanFighterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    BuildCost = 200
    BuildTime = WEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = RohanFighterHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanFighter 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanFighter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation       = RohanFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject RohanFighterHordeBlock RohanFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = RohanFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = GondorFighterBlock
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanFighter    Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:RohanFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = RohanFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


Object RohanFighterHordeHerold

    SelectPortrait      = UPRohan_BannerCarrier
    ButtonImage         = HSRohanFighter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanFighterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End







    BuildCost = 200
    BuildTime = WEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = ROHAN_WACHTERMEDUSELDS_COMMAND_POINTS_HORDE

    CommandSet = RohanFighterHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanFighter   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanFighter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = RohanFighterHordeHeroldBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject RohanFighterHordeHeroldBlock RohanFighterHordeHerold

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = RohanFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = GondorFighterBlock
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanFighter   Pos:X:46.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:RohanFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = RohanFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


Object RohanAxeFighterHorde

    SelectPortrait         = UPRohanaxt
    ButtonImage            = HIRohanaxt_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanAxeFighterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanAxeFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanAxeFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End



    BuildCost = 250
    BuildTime = WEAK_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 45

    CommandSet = RohanFighterHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanAxeFighter 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanAxeFighter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanAxeFighter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanAxeFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanAxeFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = RohanAxeFighterHordeBlock
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject RohanAxeFighterHordeBlock RohanAxeFighterHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = RohanAxeFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = GondorFighterBlock
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanAxeFighter    Pos:X:46.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanAxeFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:RohanAxeFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanAxeFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = RohanAxeFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


Object RohanAxeFighterHordeHerold


    SelectPortrait         = UPRohanaxt
    ButtonImage            = HSRohanaxt

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanAxeFighterHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanAxeFighterHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanAxeFighterHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End






    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 30

    CommandSet = RohanFighterHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanAxeFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
            FacingBonus            =    30.0
            AngleLimitCos        =    -0.17
            InnerRange            =    30
            OuterRange            =    80
            OuterRangeBuildings    =    140
        End


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanAxeFighter   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanAxeFighter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanAxeFighter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanAxeFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = RohanFighterHordeBlockHerold
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End



ChildObject RohanFighterHordeBlockHerold RohanAxeFighterHordeHerold

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = RohanAxeFighter GOOD_MEN_GIANT_HORDE_SIZE
        Slots                            = 15
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = GondorFighterBlock
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanAxeFighter   Pos:X:46.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanAxeFighter Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:RohanAxeFighter Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanAxeFighter Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:10 Leader 2 1    Position:X:10 Y:-10 Leader 2 2    Position:X:10 Y:20 Leader 2 3    Position:X:10 Y:-20 Leader 2 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = RohanAxeFighterHorde
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End


Object DruedainKriegerHorde

    ButtonImage    = HIDruedainKrieger_Wotr
    SelectPortrait = UPDruedain

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkMUArc
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    DisplayName = OBJECT:HordeDruedainKrieger
    DisplayNameStrategic = CONTROLBAR:LW_Unit_DruedainKriegerHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_DruedainKriegerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY     DruedainArcherBowMissileHordeRangefinder
        Weapon = TERTIARY    DruedainArcherBowMissileHordeRangefinderBombard
        AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT
    End

    WeaponSet
        Conditions        = HIDDEN
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME

    MaxSimultaneousOfType                = 6

    ShroudClearingRange = 350
    VisionRange = 350

    VisionSide = 50%
    VisionRear = 25%

    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%


    CrushableLevel   = 0
    CrusherLevel     = 0
    UseCrushAttack   = No
    CommandPoints    = 40
    CommandSet       = DruedainHordeCommandSet

    FormationWidth = 2
    FormationDepth = 2

    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = 115
    ThreatBreakdown MordorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

   #include "..\..\..\includes\CaptureBuilding.inc"


    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle     = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate            = 500
        MaxCowerTime            = 5000
        MinCowerTime            = 3000
        CanAttackWhileContained        = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload         = DruedainKrieger 10
        Slots             = 10
        PassengerFilter     = NONE +INFANTRY +DruedainKrieger +DruedainWeiserBanner
        ShowPips         = No
        RandomOffset        = X:3 Y:3
        MeleeBehavior         = Amoeba
        End


        BannerCarriersAllowed    = DruedainWeiserBanner
        BannerCarrierPosition    = UnitType:DruedainKrieger    Pos:X:55.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:DruedainKrieger Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:DruedainKrieger Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End


    Behavior         = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    = 1000
        TauntAndPointExcluded        = NONE
        AfraidOf            = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf            = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance        = 150
        FearScanDistance        = ARCHER_FEAR_SCAN_RADIUS

        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =       BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base_Evil
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_EVIL_INFANTRY_HORDE_SPEED
    End

    #include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End







    Behavior = AISpecialPowerUpdate MordorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry         = BOX
    GeometryMajorRadius     = 40.0
    GeometryMinorRadius     = 50.0
    GeometryHeight         = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_MordorArcherHordeBody

    AutoResolveArmor
        Armor = AutoResolve_MordorArcherArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_MordorArcherUpgradedWeapon
    End

End


Object RohanArcherHorde


    ButtonImage        = HSFreisassen
    SelectPortrait        = UPFreisassen

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUYeo
        End
    End

    Side = Obsolete
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanArcherMod

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMissileHordeRangefinder
    End

    CommandSet = RohanArcherHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 300
    ShroudClearingRange = 350
    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanArcher 15
        Slots = 15
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        AlternateFormation = RohanArcherHordeSkirmishFormation


        BannerCarriersAllowed    = RohanArcher
        BannerCarrierPosition    = UnitType:RohanArcher        Pos:X:20.0 Y:0.0


        RandomOffset = X:6 Y:4
        RankInfo = RankNumber:1 UnitType:RohanArcher Position:X:50 Y:0            Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanArcher Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:RohanArcher Position:X:10 Y:0 Leader 2 0    Position:X:10 Y:20 Leader 2 1    Position:X:10 Y:-20 Leader 2 2    Position:X:10 Y:40 Leader 2 3    Position:X:10 Y:-40 Leader 2 4
        RanksToReleaseWhenAttacking = 1 2 3



        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
        HeroScanDistance        =    150
        FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_FireArrows
    End


    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End



ChildObject RohanArcherHordeSkirmishFormation RohanArcherHorde


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanArcher GOOD_MEN_HORDE_SIZE
        Slots = 5
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:7 Y:7


        BannerCarriersAllowed    = RohanArcher
        BannerCarrierPosition    = UnitType:RohanArcher    Pos:X:15.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanArcher Position:X:0 Y:-40    Position:X:-25 Y:-25    Position:X:0 Y:0    Position:X:-25 Y:25    Position:X:0 Y:40


        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanArcherHorde
        AttributeModifiers = RohanArcherSkirmish
    End
End


Object RohanElvenWarriorHorde


    ButtonImage            = BEElvenBarracks_LorienWarrior
    SelectPortrait         = UPElven_LorienWarrior


    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Obsolete
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanElves

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ElvenArcherMissileHordeRangefinder
    End
    WeaponSet
        Conditions = WEAPONSET_TOGGLE_1
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = RohanElvenWarriorHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


     CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = 700
    BuildTime = STRONG_BUILDTIME
    VisionRange = 400
    ShroudClearingRange = 450
    CommandPoints = 20

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanElvenWarrior GOOD_MEN_HORDE_SIZE
        Slots = 5
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanElvenWarrior    Pos:X:35.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:RohanElvenWarrior Position:X:13 Y:0    Position:X:13 Y:25        Position:X:13 Y:-25        Position:X:13 Y:50        Position:X:13 Y:-50


        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS



        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_FireArrows
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End


ChildObject RohanElvenWarriorHorde_Summoned RohanElvenWarriorHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = RohanElvenWarriorHordeCommandSet_Summoned
    EquivalentTo = RohanElvenWarriorHorde

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 180000
        MaxLifetime        = 180000
        DeathType        = FADED
    End
    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanElvenWarrior_Summoned GOOD_MEN_HORDE_SIZE
        Slots = 5
        PassengerFilter = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:1 Y:1






        RankInfo = RankNumber:1 UnitType:RohanElvenWarrior_Summoned Position:X:13 Y:0    Position:X:13 Y:25        Position:X:13 Y:-25        Position:X:13 Y:50        Position:X:13 Y:-50

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

End



Object RohanHobbitHorde


    ButtonImage = BRArcheryRange_YeomanArchers

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRUYeo
        End
    End

    Side = Obsolete
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:Horde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMissileHordeRangefinder
    End

    CommandSet = RohanHobbitHordeCommandSet




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost = 800
    BuildTime = STRONG_BUILDTIME
    VisionRange = 300
    ShroudClearingRange = 161
    CommandPoints = 4

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanFrodo 1
        InitialPayload = RohanSam 1
        InitialPayload = RohanMerry 1
        InitialPayload = RohanPippin 1
        Slots = 4
        PassengerFilter = NONE +HOBBIT
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:5 Y:5

        RankInfo = RankNumber:1 UnitType:RohanFrodo Position:X:20 Y:0
        RankInfo = RankNumber:2 UnitType:RohanSam Position:X:20 Y:30
        RankInfo = RankNumber:3 UnitType:RohanMerry Position:X:-15 Y:0
        RankInfo = RankNumber:4 UnitType:RohanPippin Position:X:-15 Y:30

        RanksToReleaseWhenAttacking = 1 2 3 4
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No
End


ChildObject RohanHobbitHordeFrodoSam RohanHobbitHorde

  CommandPoints = 2

  Behavior = HordeContain ModuleTag_HordeContain
    ObjectStatusOfContained =
        InitialPayload = RohanFrodo 1
        InitialPayload = RohanSam 1
        Slots = 2
        PassengerFilter = NONE +HOBBIT
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:5 Y:5




        RankInfo = RankNumber:1 UnitType:RohanFrodo Position:X:20 Y:0
        RankInfo = RankNumber:2 UnitType:RohanSam Position:X:20 Y:30
        RanksToReleaseWhenAttacking = 1 2
    End
End

ChildObject RohanHobbitHordeMerryPippin RohanHobbitHorde

  CommandPoints = 2

  Behavior = HordeContain ModuleTag_HordeContain
    ObjectStatusOfContained =
        InitialPayload = RohanMerry 1
        InitialPayload = RohanPippin 1
        Slots = 2
        PassengerFilter = NONE +HOBBIT
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:5 Y:5




        RankInfo = RankNumber:1 UnitType:RohanMerry Position:X:20 Y:0
        RankInfo = RankNumber:2 UnitType:RohanPippin Position:X:20 Y:30
        RanksToReleaseWhenAttacking = 1 2
    End
End


Object RohanAxtrohirrimHorde

    SelectPortrait    = UPRohirrimAxte
    ButtonImage       = HIRohirrimAxte_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohirrimAxeHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohirrimAxeHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohirrimAxeHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = RohanModRohirrimHordeCommandSet



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 450
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange           = 250
    VisionSide            = 35%
    VisionRear            = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot    = 5.0%
    ShroudClearingRange          = 400

    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0
    MaxSimultaneousOfType = 10


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_KNIGHT_HORDE_THREAT
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanAxtrohirrim  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanAxtrohirrim  Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanAxtrohirrim Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanAxtrohirrim Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanAxtrohirrim Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = RohanAxtrohirrimHordeWedgeFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
         AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion            =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields
End


ChildObject RohanAxtrohirrimHordeWedgeFormation RohanAxtrohirrimHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanAxtrohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanAxtrohirrim    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanAxtrohirrim Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanAxtrohirrim Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanAxtrohirrimHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End



ChildObject RohanAxtrohirrimHorde_Summoned RohanAxtrohirrimHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorKnightHordeCommandSet_Summoned
    EquivalentTo = RohanAxtrohirrimHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanAxtrohirrim_Summoned   GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End
        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanAxtrohirrim_Summoned   Pos:X:60.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanAxtrohirrim_Summoned Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanAxtrohirrim_Summoned Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanAxtrohirrim_Summoned Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End


Object RohanAxtrohirrimHordeHerold


    SelectPortrait    = UPRohirrimAxte
    ButtonImage       = HSRohirrimAxte

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohirrimAxeHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohirrimAxeHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohirrimAxeHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = RohanModRohirrimHordeCommandSet





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = 450
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = 250
    VisionSide             = 35%
    VisionRear             = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 200
    VisionBonusPercentPerFoot     = 5.0%
    ShroudClearingRange         = 400

    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_KNIGHT_HORDE_THREAT
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanAxtrohirrim  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanAxtrohirrim  Pos:X:60.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanAxtrohirrim Position:X:30 Y:-25 Position:X:30 Y:0 Position:X:30 Y:25
        RankInfo = RankNumber:2 UnitType:RohanAxtrohirrim Position:X:0 Y:-40 Position:X:8 Y:-10 Position:X:-8 Y:10 Position:X:0 Y:40
        RankInfo = RankNumber:3 UnitType:RohanAxtrohirrim Position:X:-30 Y:-25 Position:X:-30 Y:0 Position:X:-30 Y:25

        RanksToReleaseWhenAttacking = 1 2 3

        AlternateFormation = RohanAxtrohirrimHordeWedgeFormationHerold
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End




    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion                =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End






    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor

End


ChildObject RohanAxtrohirrimHordeWedgeFormationHerold RohanAxtrohirrimHordeHerold

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanAxtrohirrim 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:RohanAxtrohirrim  Pos:X:30.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanAxtrohirrim Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanAxtrohirrim Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanAxtrohirrimHordeHerold

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End


Object RohanYeomanSpearThrowerHorde


    SelectPortrait     = UPRohanSpearmanPortrait
    ButtonImage       = WOR_GondorTowerGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName                = OBJECT:HordeRohanYeomanSpearThrower
    DisplayNameStrategic            = CONTROLBAR:LW_Unit_RohanYeomanSpearThrowerHorde
    DescriptionStrategic            = CONTROLBAR:LW_ToolTip_RohanYeomanSpearThrowerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ShortRangedMissileHordeRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End





    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost = 450
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 250
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints = 24

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE

    ThreatLevel = GONDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown GondorInfantryHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    CommandSet = RohanYeomanSpearthrowerHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = MORDOR_HARADRIM_LANCER_SWITCH_RANGE_HORDE
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle        = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        CanAttackWhileContained            = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End



    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanYeomanSpearThrower 8
        Slots = 8
        PassengerFilter    = NONE +RohanYeomanSpearThrower
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanYeomanSpearThrower    Pos:X:40.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:RohanYeomanSpearThrower    Position:X:20 Y:12.5    Position:X:20 Y:-12.5    Position:X:20 Y:37.5    Position:X:20 Y:-37.5
        RankInfo = RankNumber:2 UnitType:RohanYeomanSpearThrower    Position:X:0 Y:12.5    Position:X:0 Y:-12.5    Position:X:0 Y:37.5    Position:X:0 Y:-37.5

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance    = 25
        AlternateFormation        = RohanYeomanSpearThrowerHordeWedge
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion    =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No

End


ChildObject RohanYeomanSpearThrowerHordeWedge RohanYeomanSpearThrowerHorde


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained        =
        InitialPayload            = RohanYeomanSpearThrower 8
        Slots                = 8
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation    = No
        RandomOffset            = X:2 Y:2


        BannerCarriersAllowed        = RohanBanner
        BannerCarrierPosition        = UnitType:RohanYeomanSpearThrower    Pos:X:35.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanYeomanSpearThrower    Position:X:25 Y:10    Position:X:25 Y:-10     Position:X:15 Y:20    Position:X:15 Y:-20    Position:X:5 Y:30    Position:X:5 Y:-30    Position:X:-5 Y:40    Position:X:-5 Y:-40

        RanksToReleaseWhenAttacking    = 1

        AlternateFormation        = RohanYeomanSpearThrowerHorde
        AttributeModifiers        = GondorKnightWedge
    End
End



Object RohanYeomanSpearThrowerHordeHerold

    SelectPortrait    = UPRohanSpearmanPortrait
    ButtonImage       = WOR_GondorTowerGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_TAUNTING EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED  EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUArc
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName                = OBJECT:HordeRohanYeomanSpearThrower
    DisplayNameStrategic       = CONTROLBAR:LW_Unit_RohanYeomanSpearThrowerHorde
    DescriptionStrategic       = CONTROLBAR:LW_ToolTip_RohanYeomanSpearThrowerHorde

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    ShortRangedMissileHordeRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"


    BuildCost         = 450
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = 250
    ShroudClearingRange     = 300
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1%
    CommandPoints         = 30

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0
    UseCrushAttack = No

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_ARCHER_HORDE_THREAT
    ThreatBreakdown GondorArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Behavior = DualWeaponBehavior ModuleTag_13
        SwitchWeaponOnCloseRangeDistance = MORDOR_HARADRIM_LANCER_SWITCH_RANGE_HORDE
    End

    CommandSet = RohanYeomanSpearthrowerHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained        =    Yes
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanYeomanSpearThrower 10
        Slots = 10
        PassengerFilter    = NONE +RohanYeomanSpearThrower
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanYeomanSpearThrower  Pos:X:40.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


        RankInfo = RankNumber:1 UnitType:RohanYeomanSpearThrower    Position:X:20 Y:0      Position:X:20 Y:12.5    Position:X:20 Y:-12.5    Position:X:20 Y:25    Position:X:20 Y:-25
        RankInfo = RankNumber:2 UnitType:RohanYeomanSpearThrower    Position:X:0 Y:0       Position:X:0 Y:12.5    Position:X:0 Y:-12.5    Position:X:0 Y:25    Position:X:0 Y:-25

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance    = 25
        AlternateFormation        = RohanYeomanSpearThrowerHordeHeroldWedge
    End


    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance        =    150
        FearScanDistance        =     ARCHER_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base



        AddEmotion            =    Doom_Base



        AddEmotion    =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End





    Behavior = AISpecialPowerUpdate GondorArcherHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_GondorArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorArcherArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_GondorArcherWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows Upgrade_HeavyArmor
End


ChildObject RohanYeomanSpearThrowerHordeHeroldWedge RohanYeomanSpearThrowerHordeHerold


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained        =
        InitialPayload            = RohanYeomanSpearThrower 10
        Slots                = 10
        PassengerFilter            = NONE +INFANTRY
        ShowPips            = No
        ThisFormationIsTheMainFormation    = No
        RandomOffset            = X:2 Y:2


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:RohanYeomanSpearThrower  Pos:X:35.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:RohanYeomanSpearThrower    Position:X:25 Y:10    Position:X:25 Y:-10     Position:X:15 Y:20    Position:X:15 Y:-20    Position:X:5 Y:30    Position:X:5 Y:-30    Position:X:-5 Y:40    Position:X:-5 Y:-40    Position:X:-15 Y:50    Position:X:-15 Y:-50

        RanksToReleaseWhenAttacking    = 1

        AlternateFormation        = RohanYeomanSpearThrowerHordeHerold
        AttributeModifiers        = GondorKnightWedge
    End
End




Object RohanSpeerwerferHorde

    SelectPortrait     = UPRohanSpearmanPortrait
    ButtonImage        = HIRohanSpeerwerfer_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side           = Rohan
    EditorSorting  = UNIT
    EmotionRange   = 240
    DisplayName    = OBJECT:RohanSpeerwerferHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanSpeerwerfer
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanSpeerwerferHorde

    WeaponSet
        Conditions 		= None
        Weapon     		= PRIMARY  RohanSpeerwerferRangefinder
        Weapon     		= TERTIARY RohanSpeerwerferRangefinder
        AutoChooseSources       = PRIMARY  FROM_PLAYER FROM_SCRIPT
        AutoChooseSources       = TERTIARY FROM_PLAYER FROM_SCRIPT
        ShareWeaponReloadTime   = Yes
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
    End



    BuildCost           = 450
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange    	= MORDOR_HARADRIM_HORDE_VISION_RANGE
    VisionSide          = 35%
    VisionRear          = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%
    CommandPoints       = 50

    CommandSet = RohanSpeerwerferHordeCommandSet_Standard

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE CAN_USE_SIEGE_TOWER
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle               = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained  =
        InitialPayload           = RohanSpeerwerfer 10
        Slots                    = 10
        PassengerFilter          = NONE +INFANTRY
        ShowPips                 = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset             = X:0 Y:0
        MeleeBehavior            = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanSpeerwerfer    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanSpeerwerfer Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20        	     Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanSpeerwerfer Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_Enabler
        SpecialPowerTemplate = SpecialAbilityHammerschlage
        TriggeredBy          = Upgrade_AllFactionUpgrade
    End

    Behavior = WeaponModeSpecialPowerUpdate ModuleTag_PowerUpdate
        SpecialPowerTemplate = SpecialAbilityHammerschlage
        Duration             = 20000
        AttributeModifier    = RohanSpeerwerferBonus
        LockWeaponSlot       = TERTIARY
        StartsPaused         = No
    End

    Behavior = AutoAbilityBehavior ModuleTag_PowerAutoAbility
	SpecialAbility		= SpecialAbilityHammerschlage
	ForbiddenStatus 	= INSIDE_GARRISON
	MaxScanRange		= 300
	Query			= 3 ALL ENEMIES
	Query			= 1 ANY ENEMIES +HERO +MONSTER
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp  = ANY +CRATE -TheDroppedRing
        ScanRange      = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight      = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


Object RohanRoyalGuardInfantryHorde

    ButtonImage     = HIEliteBogis_Wotr
    SelectPortrait  = UPEliteBogis

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeTemp_5By2
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRoyalGuardInfantry
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeRoyalGuardInfantry
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeRoyalGuardInfantry

    WeaponSet
        Conditions                 = None
        Weapon                     = PRIMARY  GondorRangerMissileHordeRangefinder
    End

    WeaponSet
        Conditions                 = CONTAINED
        Weapon                     = PRIMARY GarrisonedUnitBowHordeRangefinder
    End

    WeaponSet
        Conditions                 = WEAPONSET_TOGGLE_1
        Weapon                     = PRIMARY  NormalMeleeHordeRangefinder
    End



    CrushableLevel = 0
    CrusherLevel = 0

    BuildCost = ROYALGUARDARCHERHORDE_BUILDCOST
    BuildTime = STRONG_BUILDTIME
    VisionRange = 370
    ShroudClearingRange = 400
    CommandPoints = 60
    CommandSet = RohanRoyalGuardInfantryHordeCommandSet
    MaxSimultaneousOfType  = 6

    FormationWidth = 2
    FormationDepth = 1

    TransportSlotCount = 1
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    ThreatLevel = 150

    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate        = 500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        CanAttackWhileContained    = Yes
        AILuaEventsList                = InfantryFunctions
        AttackPriority                =     AttackPriority_Archer
    End


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRoyalGuardInfantry 10
        Slots = 10
        PassengerFilter = NONE +RohanRoyalGuardInfantry
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset = X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanRoyalGuardInfantry    Pos:X:40.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:RohanRoyalGuardInfantry Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:RohanRoyalGuardInfantry Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50

        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
        HeroScanDistance        =    150
        FearScanDistance        =    ARCHER_FEAR_SCAN_RADIUS
        AddEmotion    =    Terror_Base
        AddEmotion    =    Doom_Base
        AddEmotion    =    UncontrollableFear_Base
        AddEmotion    =    FearIdle_Base
        AddEmotion    =    FearBusy_Base
        AddEmotion    =    Point_Base
        AddEmotion    =    Taunt_Base
        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End


    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 45
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_FireArrows
    End


    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 20.0
    GeometryMinorRadius = 20.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor Upgrade_ForgedBlades Upgrade_FireArrows
End

ChildObject RohanRoyalGuardInfantryHorde_Summoned RohanRoyalGuardInfantryHorde
    IsTrainable    = No
    CommandPoints  = 0
    CommandSet     = RohanRoyalGuardInfantryHordeCommandSet_Summoned
    EquivalentTo   = RohanRoyalGuardInfantryHorde

    DisplayName = OBJECT:HordeRoyalGuardInfantry

    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRoyalGuardInfantry_Summoned 10
        Slots = 10
        PassengerFilter = NONE +RohanRoyalGuardInfantry_Summoned
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:RohanRoyalGuardInfantry_Summoned Position:X:20 Y:0    Position:X:20 Y:25        Position:X:20 Y:-25        Position:X:20 Y:50        Position:X:20 Y:-50
        RankInfo = RankNumber:2 UnitType:RohanRoyalGuardInfantry_Summoned Position:X:0 Y:0     Position:X:0 Y:25         Position:X:0 Y:-25         Position:X:0 Y:50         Position:X:0 Y:-50
        RanksToReleaseWhenAttacking = 1  2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage        = 80%
    End


    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End
End

Object RohanRoyalGuardHorde

    ButtonImage        = HIRohanRoyalGuard_Wotr
    SelectPortrait     = UPRohanRoyalGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:RohanRoyalGuardHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanKoniglicheGardeHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanKoniglicheGardeHorde
    MaxSimultaneousOfType    = 6

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End




    BuildCost        = ROYALGUARDCAVALRYHORDE_BUILDCOST
    BuildTime        = ELITE_BUILDTIME
    VisionRange      = 250
    CommandPoints    = 70
    CommandSet       = RohanRoyalHeroHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel   = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 45
    CrushZFactor   = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 175
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanRoyalGuard 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:RohanRoyalGuard Position:X:6 Y:0        Position:X:0 Y:25        Position:X:0 Y:-25        Position:X:-7 Y:50        Position:X:-7 Y:-50

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanKoniglicheGardeHordeLineFormation
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End




    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate     = SpecialAbilityTheodenGloriousCharge
        TriggeredBy         = Upgrade_MiniHordeLvl7
    End
    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate         = SpecialAbilityTheodenGloriousCharge
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
        AttributeModifier            = TodundGlorien
        AttributeModifierAffectsSelf = Yes
        AttributeModifierFX          = FX_TheodenGloriousChargeFX
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime              = 1000
        UnpackingVariation      = 1

        SpecialPowerTemplate    = SpecialAbilityTheodenGloriousCharge
        PreparationTime         = 0
        PersistentPrepTime      = 0
        PackTime                = 1330
     End



    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive               = Yes
        HealOnlyIfNotInCombat      = Yes
        HealOnlyIfNotUnderAttack   = Yes
        HealingAmount              = 30
        Radius                     = 55
        StartHealingDelay          = 7500
        HealingDelay               = 5000
        UnitHealPulseFX            = FX_SpellHealUnitHealBuff
        NonStackable               = Yes
        RespawnNearbyHordeMembers  = Yes
        RespawnFXList              = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay        = 200
    End


    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay     =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                     =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
         AlwaysAfraidOf               =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                      =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance             =    150
         FearScanDistance             =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

        AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

        AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
        AddEmotion                    =    CheerBusy_Base

        AddEmotion                    =    OVERRIDE HeroCheerIdle_Base
         End
        AddEmotion                    =    OVERRIDE HeroCheerBusy_Base
         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No




    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_ElvenRivendellLancerHordeBody

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_ElvenRivendellLancerWeapon
    End
End



ChildObject RohanKoniglicheGardeHordeLineFormation RohanRoyalGuardHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = EliteKnightWedge
        ObjectStatusOfContained =
        InitialPayload = RohanRoyalGuard 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End

        BannerCarrierPosition    = UnitType:RohanRoyalGuard    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanRoyalGuard    Position:X:0 Y:20       Position:X:0 Y:-20      Position:X:0 Y:40       Position:X:0 Y:-40        Position:X:0 Y:60         Position:X:0 Y:-60       Position:X:0 Y:80        Position:X:0 Y:-80        Position:X:0 Y:100        Position:X:0 Y:-100

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = RohanRoyalGuardHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

ChildObject RohanKoniglicheGardeHorde_Summoned RohanRoyalGuardHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = RohirrimHordeCommandSet_Summoned
    EquivalentTo = RohanRoyalGuardHorde

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE SUMMONED

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = 75000
        MaxLifetime        = 75000
        DeathType        = FADED
    End
    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = RohanKoniglicheGardeHorde_Summoned 5
        Slots = 5
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes

        RankInfo = RankNumber:1 UnitType:RohanKoniglicheGardeHorde_Summoned Position:X:6 Y:0        Position:X:0 Y:25        Position:X:0 Y:-25        Position:X:-7 Y:50        Position:X:-7 Y:-50

        RanksToReleaseWhenAttacking = 1
        MeleeAttackLeashDistance = 25
    End

End


Object IsenfurtReiterHorde

    SelectPortrait    = UPIsenfurtReiter
    ButtonImage       = HSIsenfurtReiter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtReiter



    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    BuildCost = 750
    BuildTime = STRONG_BUILDTIME
    VisionRange = 250
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY
    CommandSet = IsenfurtReiterHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        AlternateFormation = IsenfurtReiterHordeWedgeFormation
        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields

End

ChildObject IsenfurtReiterHordeLineFormation IsenfurtReiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = WestfoldLineFormation
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter    Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter    Position:X:0 Y:0       Position:X:0 Y:20      Position:X:0 Y:-20       Position:X:0 Y:40        Position:X:0 Y:-40      Position:X:-30 Y:0      Position:X:-30 Y:20       Position:X:-30 Y:-20        Position:X:-30 Y:40        Position:X:-30 Y:-40

        RanksToReleaseWhenAttacking = 1 2
        AlternateFormation = IsenfurtReiterHordeWedgeFormation

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

ChildObject IsenfurtReiterHordeWedgeFormation IsenfurtReiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter   Pos:X:30.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsenfurtReiterHorde

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

ChildObject IsenfurtReiterHorde_Summoned IsenfurtReiterHorde
    IsTrainable = No
    CommandPoints = 0
    CommandSet = GondorKnightHordeCommandSet_Summoned
    EquivalentTo = IsenfurtReiterHorde

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter_Summoned 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter_Summoned    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter_Summoned Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter_Summoned Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType          = FADED
    End
End

Object IsenfurtReiterHordeHerold


    SelectPortrait    = UPIsenfurtReiter
    ButtonImage       = HSIsenfurtReiter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtReiter

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End





    BuildCost = 750
    BuildTime = STRONG_BUILDTIME
    VisionRange = 250
    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY
    CommandSet = IsenfurtReiterHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        AlternateFormation = IsenfurtReiterHordeWedgeFormationHerold
        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor

End

ChildObject IsenfurtReiterHordeWedgeFormationHerold IsenfurtReiterHordeHerold

    Behavior = HorseHordeContain ModuleTag_HordeContain
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHeroldHorseBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldHorseBanner
        BannerCarrierPosition    = UnitType:IsenfurtReiter  Pos:X:30.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = IsenfurtReiterHordeHerold

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End

Object RohanHeerlagerRohirrimHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 60

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object RohanHeerlagerRohirrim_WaffenkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_Waffenkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_Waffenkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_Waffenkammer    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_Waffenkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_Waffenkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object RohanHeerlagerRohirrim_RustkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_Rustkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_Rustkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_Rustkammer    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_Rustkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_Rustkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object RohanHeerlagerRohirrim_RustkammerWaffenkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_RustkammerWaffenkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_RustkammerWaffenkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohirrimBanner
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_RustkammerWaffenkammer    Pos:X:75.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_RustkammerWaffenkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_RustkammerWaffenkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object RohanHeerlagerRohirrim_GeneralszeltHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_Generalszelt

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_Generalszelt  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
    End



        BannerCarriersAllowed    = RohanHeerlagerHauptmann
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_Generalszelt  Pos:X:80.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_Generalszelt Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_Generalszelt Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


Object RohanHeerlagerRohirrim_GeneralszeltWaffenkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End




    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_GeneralszeltWaffenkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_GeneralszeltWaffenkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = RohanHeerlagerHauptmann
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_GeneralszeltWaffenkammer  Pos:X:80.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_GeneralszeltWaffenkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_GeneralszeltWaffenkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End


Object RohanHeerlagerRohirrim_GeneralszeltRustkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_GeneralszeltRustkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_GeneralszeltRustkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = RohanHeerlagerHauptmann
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammer  Pos:X:80.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object RohanHeerlagerRohirrim_GeneralszeltRustkammerWaffenkammerHorde


    ButtonImage        = HIRohanRohirrim_Wotr
    SelectPortrait    = UPGondor_Rohirrim

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeRohanRohirrim
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanRohirrimHorde
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanRohirrimHorde

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY    NormalMeleeHordeRangefinder
    End

    WeaponSet
        Conditions    = WEAPONSET_TOGGLE_1
        Weapon        = PRIMARY    NormalMissileHordeRangefinder
    End






    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost         = ROHAN_ROHIRRIM_BUILDCOST
    BuildTime         = MEDIUM_BUILDTIME
    VisionRange         = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    ShroudClearingRange     = ROHAN_ROHIRRIM_HORDE_SHROUD_RANGE
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints         = 45

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND
    CommandSet = HeerlagerRohorrimHordeCommandSet_GeneralszeltRustkammerWaffenkammer

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
    ThreatBreakdown RohanRohirrimHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = RohanHeerlagerRohirrim_GeneralszeltRustkammerWaffenkammer  GOOD_RIDER_LARGE_HORDE_SIZE
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohirrimBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End



        BannerCarriersAllowed    = RohanHeerlagerHauptmann
        BannerCarrierPosition    = UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammerWaffenkammer  Pos:X:80.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL


        RankInfo = RankNumber:1 UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammerWaffenkammer Position:X:45 Y:0        Position:X:45 Y:20        Position:X:45 Y:-20        Position:X:45 Y:40        Position:X:45 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanHeerlagerRohirrim_GeneralszeltRustkammerWaffenkammer Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

      Behavior = StatusBitsUpgrade ModuleTag_ForgedBlades
          TriggeredBy             = Upgrade_ForgedBlades
      End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End


    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    #include "..\..\..\includes\CaptureBuilding.inc"





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate RohirrimHordeToggleWeapon
        CommandButtonName = Command_ToggleRohirrimWeapon
        SpecialPowerAIType = AI_SPECIAL_POWER_TOGGLE_MELEE_AND_RANGE
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody


    AutoResolveArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimForgedBladesAndFireArrows
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimFireArrows
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_FireArrows
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_FireArrows
End

Object IsenfurtSpeertragerHorde


    SelectPortrait         = UPIsenfurtSpeertrager
    ButtonImage            = HSIsenfurtSpeertrager

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtSpeertrager
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsenfurtSpeertrager
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRohanWachterMeduselds

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost = 450
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 60


    MaxSimultaneousOfType    = 3

    CommandSet = WestfoldSpeertragerHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtSpeertrager 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:IsenfurtSpeertrager    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:IsenfurtSpeertrager Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtSpeertrager Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = IsenfurtSpeertragerHordePorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base

        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsenfurtSpeertragerHordePorcupine IsenfurtSpeertragerHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IsenfurtSpeertrager 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IsenfurtSpeertragerHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed            = RohanBanner
        BannerCarrierPosition            = UnitType:IsenfurtSpeertrager    Pos:X:0.0 Y:0.0

        RankInfo    = RankNumber:1 UnitType:IsenfurtSpeertrager Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End


ChildObject IsenfurtSpeertragerHorde_Summoned IsenfurtSpeertragerHorde
    IsTrainable    =    No
    CommandPoints     =    0
    CommandSet    =    GondorTowerShieldGuardCommandSet_Summoned
    EquivalentTo      =    IsenfurtSpeertragerHorde

    MaxSimultaneousOfType    = 6

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtSpeertrager_Summoned 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsenfurtSpeertrager_Summoned Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtSpeertrager_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = IsenfurtSpeertragerHordePorcupine_Summoned
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate

        MinLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        MaxLifetime        = CREATE_A_HERO_REINFORCEMENT_LIFETIME
        DeathType        = FADED
    End

End


ChildObject IsenfurtSpeertragerHordePorcupine_Summoned IsenfurtSpeertragerHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IsenfurtSpeertrager 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IsenfurtSpeertragerHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes

        RankInfo    = RankNumber:1 UnitType:IsenfurtSpeertrager_Summoned  Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End



Object IsenfurtSpeertragerHordeHerold


    SelectPortrait         = UPIsenfurtSpeertrager
    ButtonImage            = HSIsenfurtSpeertrager

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtSpeertrager
    DisplayNameStrategic = CONTROLBAR:LW_Unit_IsenfurtSpeertrager
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GondorRohanWachterMeduselds

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    TowerGuardHordeRangefinder
    End






    BuildCost = 300
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    ShroudClearingRange = 300
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 40

    CommandSet = RohanMeduseldHordeCommandSet

    FormationWidth = 2
    FormationDepth = 1

     CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_TOWERSHIELDGUARD_HORDE_THREAT
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            =    500
        MaxCowerTime                =    5000
        MinCowerTime                =    3000
        AILuaEventsList                =    InfantryFunctions
        AttackPriority                =     AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtSpeertrager 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:IsenfurtSpeertrager   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:IsenfurtSpeertrager Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtSpeertrager Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4


        RanksToReleaseWhenAttacking = 1

        AlternateFormation = IsenfurtSpeertragerHordePorcupineHerold
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base

         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject IsenfurtSpeertragerHordePorcupineHerold IsenfurtSpeertragerHordeHerold

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE_FORMATION
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                    = IsenfurtSpeertrager 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking        = 0
        RanksToJustFreeWhenAttacking   = 0
        AttributeModifiers                = GondorTowerShieldGuardHordePorcupine
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation                = IsenfurtSpeertragerHorde
        VisionRearOverride                = 100%
        VisionSideOverride                = 100%
        NotComboFormation                = Yes


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:IsenfurtSpeertrager   Pos:X:0.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo    = RankNumber:1 UnitType:IsenfurtSpeertrager Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End

Object IsenfurtWachterHorde

    SelectPortrait         = UPIsenfurtWachter
    ButtonImage            = HSIsenfurtWachter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtWachter

    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY    NormalMeleeHordeRangefinder
        Weapon                = TERTIARY    DwarvenZealotBoomAxeRangeFinder
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources     = TERTIARY FROM_PLAYER FROM_SCRIPT
        ShareWeaponReloadTime = Yes
    End

    MaxSimultaneousOfType    = 3


    BuildCost = 500
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = 200
    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY
    CommandSet = IsenfurtWachterHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                =    RohanIsenfurtWachterFunctions
        MinCowerTime                =    3000
        MaxCowerTime                =    5000
        AttackPriority                =     AttackPriority_Infantry
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = IsenfurtWachter 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanFighter    Pos:X:70.0 Y:0.0


        RankInfo = RankNumber:1 UnitType:IsenfurtWachterIsenfurtWachter Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtWachter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End


    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End


    Behavior = SpecialPowerModule ModuleTag_ZealotBoomAxeStarter
        SpecialPowerTemplate        = SpecialAbilityZealotBoomAxe
        UpdateModuleStartsAttack    = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ZealotBoomAxeWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityZealotBoomAxe



        WhichSpecialWeapon        = 1

        PackTime            = 2500
        StartAbilityRange        = 200

        SpecialWeapon            = DwarvenZealotBoomAxeRangeFinder
        ApproachUntilMembersInRange    = Yes

    End


    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_MOUNTED
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor Upgrade_ForgedBlades
End


ChildObject IsenfurtWachterHorde_Summoned IsenfurtWachterHorde
    IsTrainable       =    No
    CommandPoints     =    0
    CommandSet        =    IsenfurtWachterHordeCommandSet_Summoned
    EquivalentTo      =    IsenfurtWachterHorde

    MaxSimultaneousOfType    = 6

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload     = IsenfurtWachter_Summoned 10
        Slots         = 10
        PassengerFilter    = NONE +INFANTRY
        ShowPips     = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset    = X:0 Y:0
        MeleeBehavior     = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsenfurtWachter_Summoned Position:X:50 Y:0            Position:X:50 Y:20                Position:X:50 Y:-20                Position:X:50 Y:40                Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtWachter_Summoned Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
        DeathType          = FADED
    End

End


Object IsenfurtWachterHordeHerold


    SelectPortrait         = UPIsenfurtWachter
    ButtonImage            = HSIsenfurtWachter

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsenfurtWachter

    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY    NormalMeleeHordeRangefinder
        Weapon                = TERTIARY    DwarvenZealotBoomAxeRangeFinder
        AutoChooseSources     = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
        AutoChooseSources     = TERTIARY FROM_PLAYER FROM_SCRIPT
        ShareWeaponReloadTime = Yes
    End





    BuildCost = 500
    BuildTime = MEDIUM_BUILDTIME
    VisionRange = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
    CommandPoints = 40

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY
    CommandSet = IsenfurtWachterHordeCommandSet

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        AILuaEventsList                =    GondorFighterFunctions
        MinCowerTime                =    3000
        MaxCowerTime                =    5000
        AttackPriority                =     AttackPriority_Infantry
    End


    Behavior = HordeContain ModuleTag_HordeContain
        ObjectStatusOfContained =
        InitialPayload = IsenfurtWachter 10
        Slots = 10
        PassengerFilter    = NONE +IsenfurtWachter
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHeroldBanner
        BannerCarrierPosition    = UnitType:IsenfurtWachter   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0
        BannerCarrierDestroyHordeOnDeath = No
        BannerCarrierHordeDeathType = +NORMAL

        RankInfo = RankNumber:1 UnitType:IsenfurtWachter Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtWachter Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
        AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base

         End
         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base

         End
        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End


    Behavior = SpecialPowerModule ModuleTag_ZealotBoomAxeStarter
        SpecialPowerTemplate        = SpecialAbilityWestfoldWachterSpear
        UpdateModuleStartsAttack    = Yes
    End
    Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_ZealotBoomAxeWeaponFireUpdate
        SpecialPowerTemplate        = SpecialAbilityWestfoldWachterSpear



        WhichSpecialWeapon        = 1

        PackTime            = 2500
        StartAbilityRange        = 200

        SpecialWeapon            = DwarvenZealotBoomAxeRangeFinder
        ApproachUntilMembersInRange    = Yes

    End


    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_MOUNTED
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_HeavyArmor
End


Object GetreueSpeerHordeHauptmann

    EquivalentTo = RohanCaptain

    SelectPortrait = UPIsenfurtSpeertrager
    ButtonImage    = HIIsenfurtSpeertrager_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GetreueHordeHauptmann
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GetreueHordeHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GetreueHordeHauptmann

    WeaponSet
        Conditions = None
        Weapon     = PRIMARY TowerGuardHordeRangefinder
    End

    VisionRange = 450
    ShroudClearingRange = 200
    VisionSide = 35%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%

    CommandPoints = 50

    CommandSet = RohanHauptmannCommandSet_Spear

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 150
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    =    Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           =    500
        MaxCowerTime                  =    5000
        MinCowerTime                  =    3000
        AILuaEventsList               =    InfantryFunctions
        AttackPriority                =    AttackPriority_Spearman
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtSpeertrager_Hauptmann 10
        Slots = 10
        PassengerFilter    = NONE +INFANTRY +RohanHauptmannBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanHauptmannBanner
        BannerCarrierPosition    = UnitType:IsenfurtSpeertrager_Hauptmann   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0

        RankInfo = RankNumber:1 UnitType:IsenfurtSpeertrager_Hauptmann Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtSpeertrager_Hauptmann Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1

        AlternateFormation = GetreueSpeerHordeHauptmannPorcupine
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay    =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance            =    150
        FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 45
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End


    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End



    AutoResolveUnitType = AutoResolveUnit_Pikemen
    AutoResolveCombatChain = AutoResolve_PikemenCombatChain

    AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorTowerGuardArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorTowerGuardWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

ChildObject GetreueSpeerHordeHauptmannPorcupine GetreueSpeerHordeHauptmann

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle             = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload                  = IsenfurtSpeertrager_Hauptmann 10
        Slots                           = 10
        PassengerFilter                 = NONE +INFANTRY +RohanHauptmannBanner
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        RandomOffset                    = X:2 Y:1
        RanksToReleaseWhenAttacking     = 0
        RanksToJustFreeWhenAttacking    = 0
        AttributeModifiers              = FormenosGuardShieldWallBonus
        IsPorcupineFormation            = Yes
        MinimumHordeSize                = 5

        AlternateFormation              = GetreueSpeerHordeHauptmann
        VisionRearOverride              = 100%
        VisionSideOverride              = 100%
        NotComboFormation               = Yes

        BannerCarriersAllowed    = RohanHauptmannBanner
        BannerCarrierPosition    = UnitType:IsenfurtSpeertrager_Hauptmann   Pos:X:0.0 Y:0.0
        BannerCarrierMinLevel    = 0

        RankInfo    = RankNumber:1 UnitType:IsenfurtSpeertrager_Hauptmann Position:X:20 Y:0    Position:X:-16.18 Y:11.76        Position:X:6.18 Y:-19.02    Position:X:6.18 Y:19.02    Position:X:-16.18 Y:-11.76    Position:X:36.54 Y:16.27    Position:X:-39.13 Y:8.32    Position:X:26.77 Y:-29.73    Position:X:-4.18 Y:39.78    Position:X:-20 Y:-34.64
    End
End


Object GetreueSchwertHordeHauptmann

    EquivalentTo = RohanCaptain

    SelectPortrait = UPIsenfurtWachter
    ButtonImage    = HIIsenfurtWachter_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GetreueSchwertHordeHauptmann
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GetreueSchwertHordeHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GetreueSchwertHordeHauptmann

    WeaponSet
        Conditions            = None
        Weapon                = PRIMARY    NormalMeleeHordeRangefinder
        Weapon                = SECONDARY  NormalMeleeHordeRangefinder
        AutoChooseSources     = PRIMARY    FROM_PLAYER FROM_SCRIPT FROM_AI
        OnlyAgainst           = SECONDARY  PIKE
    End


    VisionRange = 450
    ShroudClearingRange = 200
    VisionSide = 35%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%

    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY

    CommandSet = RohanHauptmannCommandSet_Sword

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 150

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        AILuaEventsList               = GondorFighterFunctions
        MinCowerTime                  = 3000
        MaxCowerTime                  = 5000
        AttackPriority                =  AttackPriority_Infantry
    End


    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtWachter_Hauptmann 10
        Slots = 10
        PassengerFilter    = NONE +IsenfurtWachter_Hauptmann +RohanHauptmannBanner
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHauptmannBanner
        BannerCarrierPosition    = UnitType:IsenfurtWachter_Hauptmann   Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0

        RankInfo = RankNumber:1 UnitType:IsenfurtWachter_Hauptmann Position:X:50 Y:0        Position:X:50 Y:20        Position:X:50 Y:-20        Position:X:50 Y:40        Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtWachter_Hauptmann Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2
        AlternateFormation = GetreueSchwertHordeHauptmannWedge
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000

        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
         AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
         AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base
         End

         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base
         End

        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = 45
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End






    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorWachterderVesteArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorWachterderVesteUpgradedWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End


ChildObject GetreueSchwertHordeHauptmannWedge GetreueSchwertHordeHauptmann

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                    = IsenfurtWachter_Hauptmann 10
        Slots                            = 10
        PassengerFilter                    = NONE +INFANTRY +IsenfurtWachter_Hauptmann +RohanHauptmannBanner
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers                = LaketownMonstertoterFormation
        RandomOffset                    = X:0 Y:0
        MeleeBehavior = Amoeba
        End


        BannerCarriersAllowed    = RohanHauptmannBanner
        BannerCarrierPosition    = UnitType:IsenfurtWachter_Hauptmann   Pos:X:46.0 Y:0.0
        BannerCarrierMinLevel   = 0


        RankInfo = RankNumber:1 UnitType:IsenfurtWachter_Hauptmann Position:X:34 Y:0            Position:X:34 Y:10                Position:X:34 Y:-10                Position:X:34 Y:20                Position:X:34 Y:-20
        RankInfo = RankNumber:2 UnitType:IsenfurtWachter_Hauptmann Position:X:22 Y:0 Leader 1 0    Position:X:22 Y:10 Leader 1 1    Position:X:22 Y:-10 Leader 1 2    Position:X:22 Y:20 Leader 1 3    Position:X:22 Y:-20 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        AlternateFormation = GetreueSchwertHordeHauptmann
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End
End

Object GetreueReiterHordeHauptmann

    EquivalentTo = RohanCaptain

    SelectPortrait = UPIsenfurtReiter
    ButtonImage    = HIIsenfurtReiter_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkRURoh
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:GetreueReiterHordeHauptmann
    DisplayNameStrategic = CONTROLBAR:LW_Unit_GetreueReiterHordeHauptmann
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_GetreueReiterHordeHauptmann

    WeaponSet
        Conditions    = None
        Weapon        = PRIMARY     NormalMeleeHordeRangefinder
    End


    VisionRange = 350
    VisionSide         = 50%
    VisionRear         = 25%
    MaxVisionBonusPercent     = 300%
    VisionBonusTestRadius     = 200
    VisionBonusPercentPerFoot = 1.0%

    CommandPoints = 50

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY
    CommandSet = RohanHauptmannCommandSet_Cavalry

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    ThreatLevel = 150
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End
    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter_Hauptmann 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHauptmannBannerMounted
        ShowPips = No
        RandomOffset = X:3 Y:4
        ThisFormationIsTheMainFormation = Yes


        BannerCarriersAllowed    = RohanHauptmannBannerMounted
        BannerCarrierPosition    = UnitType:IsenfurtReiter_Hauptmann  Pos:X:70.0 Y:0.0
        BannerCarrierMinLevel   = 0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter_Hauptmann Position:X:40 Y:0        Position:X:40 Y:20        Position:X:40 Y:-20        Position:X:40 Y:40        Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter_Hauptmann Position:X:10 Y:0 Leader 1 0    Position:X:10 Y:20 Leader 1 1    Position:X:10 Y:-20 Leader 1 2    Position:X:10 Y:40 Leader 1 3    Position:X:10 Y:-40 Leader 1 4

        AlternateFormation = GetreueReiterHordeHauptmannWedgeFormation
        RanksToReleaseWhenAttacking = 1 2
        MeleeAttackLeashDistance = 25
    End

    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 40.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
        AfraidOf                    =    NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil
        AlwaysAfraidOf                =    NONE +MordorBalrog +RohanOathbreaker +MordorSauron
         PointAt                =    NONE +MordorFellBeast +MordorWitchKingOnFellBeast
         HeroScanDistance        =    150
         FearScanDistance        =    CAVALRY_FEAR_SCAN_RADIUS

        AddEmotion                    =    Terror_Base

         AddEmotion                    =    OVERRIDE Point_Base
             Duration            =    2500
         End

         AddEmotion                    =    Taunt_Base
         AddEmotion                    =    CheerIdle_Base
         AddEmotion                    =    CheerBusy_Base

         AddEmotion                    =    OVERRIDE HeroCheerIdle_Base
         End

         AddEmotion                    =    OVERRIDE HeroCheerBusy_Base
         End

        AddEmotion    =    Alert_Base
        AddEmotion    =   CheerForAboutToCrush_Base

     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
        TriggeredBy = Upgrade_Shields
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
        TriggeredBy = Upgrade_RohanZuchtpferde
    End

    Geometry = BOX
    GeometryMajorRadius = 12.0
    GeometryMinorRadius = 24.0
    GeometryHeight = 20.0
    GeometryIsSmall = No





    Behavior = AISpecialPowerUpdate MenRohirrimHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_RohanRohirrimHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_RohanRohirrimArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimForgedBlades
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_RohanRohirrimWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor Upgrade_Shields

End

ChildObject GetreueReiterHordeHauptmannWedgeFormation GetreueReiterHordeHauptmann

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                    = STANDARD_INFANTRY_FLANKEDDELAY
        AttributeModifiers = GondorKnightWedge
        ObjectStatusOfContained =
        InitialPayload = IsenfurtReiter_Hauptmann 10
        Slots = 10
        PassengerFilter = NONE +CAVALRY +RohanHauptmannBannerMounted
        ShowPips = No
        ThisFormationIsTheMainFormation = No
        RandomOffset = X:8 y:3
        MeleeBehavior = Amoeba
        End

        BannerCarriersAllowed    = RohanHauptmannBannerMounted
        BannerCarrierPosition    = UnitType:IsenfurtReiter_Hauptmann  Pos:X:30.0 Y:0.0
        BannerCarrierMinLevel   = 0

        RankInfo = RankNumber:1 UnitType:IsenfurtReiter_Hauptmann Position:X:0 Y:0        Position:X:-20 Y:20       Position:X:-20 Y:-20      Position:X:-40 Y:40       Position:X:-40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsenfurtReiter_Hauptmann Position:X:-30 Y:0      Position:X:-50 Y:20       Position:X:-50 Y:-20      Position:X:-70 Y:40       Position:X:-70 Y:-40

        RanksToReleaseWhenAttacking = 1
        AlternateFormation = GetreueReiterHordeHauptmann

        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End
End




Object RohanSpeerwerferHorde_AI

    SelectPortrait     = UPRohanSpearmanPortrait
    ButtonImage        = HIRohanSpeerwerfer_Wotr

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUTow
        End
    End

    Side           = Rohan
    EditorSorting  = UNIT
    EmotionRange   = 240
    DisplayName    = OBJECT:RohanSpeerwerferHorde
    DisplayNameStrategic = CONTROLBAR:LW_Unit_RohanSpeerwerfer
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_RohanSpeerwerferHorde

    WeaponSet
        Conditions 		= None
        Weapon     		= PRIMARY  RohanSpeerwerferRangefinder
    End

    WeaponSet
        Conditions = CLOSE_RANGE
        Weapon     = PRIMARY    NormalMeleeHordeRangefinder
    End



    BuildCost           = 450
    BuildTime           = MEDIUM_BUILDTIME
    VisionRange         = 400
    ShroudClearingRange = 425
    VisionSide          = 35%
    VisionRear          = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 2.0%
    CommandPoints       = 50

    CommandSet = RohanSpeerwerferHordeCommandSet_Standard

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel   = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE CAN_USE_SIEGE_TOWER
    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = 120
    ThreatBreakdown GondorTowerShieldGuardHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        CanAttackWhileContained       = Yes
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle               = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay             = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained  =
        InitialPayload           = RohanSpeerwerfer_AI 10
        Slots                    = 10
        PassengerFilter          = NONE +INFANTRY
        ShowPips                 = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset             = X:0 Y:0
        MeleeBehavior            = Amoeba
        End


        BannerCarriersAllowed    = RohanBanner
        BannerCarrierPosition    = UnitType:RohanSpeerwerfer_AI    Pos:X:70.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:RohanSpeerwerfer_AI Position:X:50 Y:0               Position:X:50 Y:20               Position:X:50 Y:-20        	     Position:X:50 Y:40               Position:X:50 Y:-40
        RankInfo = RankNumber:2 UnitType:RohanSpeerwerfer_AI Position:X:30 Y:0 Leader 1 0    Position:X:30 Y:20 Leader 1 1    Position:X:30 Y:-20 Leader 1 2    Position:X:30 Y:40 Leader 1 3    Position:X:30 Y:-40 Leader 1 4

        RanksToReleaseWhenAttacking = 1 2

        MeleeAttackLeashDistance  = 1
        BackUpMinDelayTime        = 1
        BackUpMaxDelayTime        = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage          = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay     =    1000
        TauntAndPointExcluded        =    NONE
        AfraidOf                     =    EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf               =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                      =    EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance             =    150
        FearScanDistance             =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base

        AddEmotion            =    OVERRIDE Taunt_Base
         End

        AddEmotion    =    CheerIdle_Base
        AddEmotion    =    CheerBusy_Base
        AddEmotion    =    HeroCheerIdle_Base
        AddEmotion    =    HeroCheerBusy_Base
        AddEmotion    =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp  = ANY +CRATE -TheDroppedRing
        ScanRange      = 200
        ScanIntervalSeconds = 0.5
    End

    LocomotorSet
        Locomotor     = NormalMeleeHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_FOOT_MED_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
        TriggeredBy = Upgrade_ForgedBlades
    End

    Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
        TriggeredBy = Upgrade_HeavyArmor
    End





    Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Geometry            = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight      = 20.0
    GeometryIsSmall     = No



    AutoResolveUnitType = AutoResolveUnit_Archer
    AutoResolveCombatChain = AutoResolve_ArcherCombatChain

    AutoResolveBody = AutoResolve_ElvenMirkwoodArcherHordeBody

    AutoResolveArmor
        RequiredUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveArmor
        ExcludedUpgrades = Upgrade_HeavyArmor
        Armor = AutoResolve_GondorSoldierArmor
    End

    AutoResolveWeapon
        RequiredUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End

    AutoResolveWeapon
        ExcludedUpgrades = Upgrade_ForgedBlades
        Weapon = AutoResolve_GondorSoldierWeapon
    End

    WorldMapArmoryUpgradesAllowed = Upgrade_BasicTraining Upgrade_ForgedBlades Upgrade_HeavyArmor
End

Object IsengardVerraeterHorde

    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HIIsengardVerraeter_Wotr

    EquivalentTo = IsengardVerraeterCavalryHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
        DefaultModelConditionState
            Model = None
        End

        ModelConditionState = HORDE_EMPTY
            Model = None
        End

        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUSol
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardVerraeter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeIsengardVerraeter
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeIsengardVerraeter

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End


    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    UnitSpecificSounds
        VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge
    End

    BuildCost = 250
    BuildTime = WEAK_BUILDTIME
    ShroudClearingRange = 300
    VisionRange = 200
    VisionSide = 50%
    VisionRear = 25%
    MaxVisionBonusPercent = 300%
    VisionBonusTestRadius = 200
    VisionBonusPercentPerFoot = 1.0%
    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 0
    CrusherLevel = 0

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
    ThreatBreakdown GondorFighterHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate           = 500
        MaxCowerTime                  = 5000
        MinCowerTime                  = 3000
        AILuaEventsList               = InfantryFunctions
        AttackPriority                = AttackPriority_Infantry
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardVerraeter 15
        Slots = 15
        PassengerFilter    = NONE +INFANTRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardVerraeter Position:X:35 Y:0              Position:X:30 Y:25              Position:X:30 Y:-25              Position:X:40 Y:40              Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardVerraeter Position:X:15 Y:0 Leader 1 0   Position:X:10 Y:20 Leader 1 1   Position:X:10 Y:-20 Leader 1 2   Position:X:15 Y:40 Leader 1 3   Position:X:15 Y:-40 Leader 1 4
        RankInfo = RankNumber:3 UnitType:IsengardVerraeter Position:X:-5 Y:0 Leader 2 0   Position:X:-10 Y:20 Leader 2 1  Position:X:-10 Y:-20 Leader 2 2  Position:X:0 Y:40 Leader 2 3    Position:X:0 Y:-40 Leader 2 4

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime         = 1
        BackUpMaxDelayTime         = 3000
        BackUpMinDistance         = 1
        BackUpMaxDistance         = 3
        BackupPercentage         = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
    End

       Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance     = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay = 1000
        TauntAndPointExcluded     = NONE
        AfraidOf                 = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf             = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                     = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance         = 150
        FearScanDistance         = INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base



        AddEmotion            =   BraceForBeingCrushed_Base

        AddEmotion            =    UncontrollableFear_Base



        AddEmotion            =    FearIdle_Base



        AddEmotion            =    FearBusy_Base



        AddEmotion            =    Point_Base




        AddEmotion            =    Taunt_Base



         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = SpecialPowerModule ModuleTag_SummonWolfRidersStarter
        SpecialPowerTemplate        = SpecialAbilityAngmarThrallMasterSummonWolfRiders
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
         SpecialPowerTemplate       = SpecialAbilityAngmarThrallMasterSummonWolfRiders
         MountedTemplate            = IsengardVerraeterCavalryHorde
         UnpackTime                 = 2000
         PreparationTime            = 0
         PackTime                   = 0
         OpacityTarget              = .0
         AwardXPForTriggering       = 0
         IgnoreFacingCheck          = Yes
    End

    Behavior = DoCommandUpgrade Module_DoCommandUpgrade
        TriggeredBy                     = Upgrade_PurchaseRohanHorses
        GetUpgradeCommandButtonName     = Command_SpecialAbilityToggleMountedHorde
    End



    LocomotorSet
        Locomotor     = NormalRangedHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    Behavior = LevelUpUpgrade ModuleTag_BasicTraining
        TriggeredBy = Upgrade_BasicTraining
        LevelsToGain = 1
        LevelCap = 2
    End





    Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    CommandSet = IsengardVerraeterHordeCommandSet

    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight = 20.0
    GeometryIsSmall = No







    AutoResolveUnitType = AutoResolveUnit_Soldier
    AutoResolveCombatChain = AutoResolve_SoldierCombatChain

    AutoResolveBody = AutoResolve_GondorFighterHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorSoldierHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorSoldierUpgradedWeapon
    End
End

Object IsengardVerraeterCavalryHorde

    SelectPortrait         = UPIsengardVerraeter
    ButtonImage            = HIIsengardVerraeter_Wotr

    EquivalentTo = IsengardVerraeterHorde

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkGUKni
        End
    End

    Side = Rohan
    EditorSorting = UNIT
    EmotionRange = 240
    DisplayName = OBJECT:HordeIsengardVerraeter
    DisplayNameStrategic = CONTROLBAR:LW_Unit_HordeIsengardVerraeter
    DescriptionStrategic = CONTROLBAR:LW_ToolTip_HordeIsengardVerraeterMount

    WeaponSet
        Conditions = None
        Weapon = PRIMARY    NormalMeleeHordeRangefinder
    End

    CommandSet = IsengardVerraeterHordeCommandSet



    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    BuildCost             = GONDOR_KNIGHT_BUILDCOST
    BuildTime             = MEDIUM_BUILDTIME
    VisionRange             = 200
    VisionSide             = 35%
    VisionRear             = 25%
    MaxVisionBonusPercent        = 300%
    VisionBonusTestRadius        = 250
    VisionBonusPercentPerFoot     = 5.0%
    ShroudClearingRange         = 350

    CommandPoints = 30

    FormationWidth = 2
    FormationDepth = 1

    CrushableLevel = 2
    CrusherLevel = 1
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD
    CrushKnockback = 40
    CrushZFactor = 1.0


    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    ThreatLevel = GONDOR_KNIGHT_HORDE_THREAT
    ThreatBreakdown GondorKnightHorde_DetailedThreat
        AIKindOf = CAVALRY
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle    = Yes ATTACK_BUILDINGS
        MoodAttackCheckRate            = 500
        MaxCowerTime                = 5000
        MinCowerTime                = 3000
        AILuaEventsList                = CavalryFunctions
        AttackPriority                = AttackPriority_Cavalry
    End

    Behavior = HorseHordeContain ModuleTag_HordeContain
        FrontAngle = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained =
        InitialPayload = IsengardVerraeterCavalry 15
        Slots = 15
        PassengerFilter = NONE +CAVALRY
        ShowPips = No
        ThisFormationIsTheMainFormation = Yes
        RandomOffset=X:0 Y:0
        MeleeBehavior = Amoeba
        End

        RankInfo = RankNumber:1 UnitType:IsengardVerraeterCavalry Position:X:40 Y:0     Position:X:40 Y:20      Position:X:40 Y:-20    Position:X:40 Y:40    Position:X:40 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardVerraeterCavalry Position:X:10 Y:0     Position:X:10 Y:20      Position:X:10 Y:-20    Position:X:10 Y:40    Position:X:10 Y:-40
        RankInfo = RankNumber:2 UnitType:IsengardVerraeterCavalry Position:X:-20 Y:0    Position:X:-20 Y:20     Position:X:-20 Y:-20   Position:X:-20 Y:40   Position:X:-20 Y:-40

        RanksToReleaseWhenAttacking = 1 2 3
        MeleeAttackLeashDistance = 1
        BackUpMinDelayTime       = 1
        BackUpMaxDelayTime       = 3000
        BackUpMinDistance        = 1
        BackUpMaxDistance        = 3
        BackupPercentage         = 80%
    End



    Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
        ScanWidth = 70.0
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance        =    INFANTRY_TAUNT_POINT_RADIUS
         TauntAndPointUpdateDelay    =    1000
         TauntAndPointExcluded        =    NONE
         AfraidOf                    =    EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                =    EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
         PointAt                        =    EMOTION_POINTAT_OBJECTFILTER
         HeroScanDistance            =    150
         FearScanDistance            =    INFANTRY_FEAR_SCAN_RADIUS

        AddEmotion            =    Terror_Base
        AddEmotion            =    Doom_Base
        AddEmotion            =   BraceForBeingCrushed_Base
        AddEmotion            =    UncontrollableFear_Base
        AddEmotion            =    FearIdle_Base
        AddEmotion            =    FearBusy_Base
        AddEmotion            =    Point_Base
        AddEmotion            =    Taunt_Base
         AddEmotion            =    CheerIdle_Base
        AddEmotion            =    CheerBusy_Base
        AddEmotion            =    HeroCheerIdle_Base
        AddEmotion            =    HeroCheerBusy_Base
        AddEmotion            =    Alert_Base
        AddEmotion                =   CheerForAboutToCrush_Base
     End

    LocomotorSet
        Locomotor     = NormalCavalryHordeLocomotor
        Condition     = SET_NORMAL
        Speed         = NORMAL_MOUNTED_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End




    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly = Yes
        StuffToPickUp = ANY +CRATE -TheDroppedRing
        ScanRange = 200
        ScanIntervalSeconds = 0.5
    End





    Behavior = AISpecialPowerUpdate GondorKnightHordeCaptureBuildingAI
        CommandButtonName = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End


    Geometry = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 40.0
    GeometryHeight = 20.0
    GeometryIsSmall = No



    AutoResolveUnitType = AutoResolveUnit_Cavalry
    AutoResolveCombatChain = AutoResolve_CavalryCombatChain

    AutoResolveBody = AutoResolve_GondorKnightHordeBody

    AutoResolveArmor
        Armor = AutoResolve_GondorKnightHeavyArmor
    End

    AutoResolveWeapon
        Weapon = AutoResolve_GondorKnightUpgradedWeapon
    End
End

