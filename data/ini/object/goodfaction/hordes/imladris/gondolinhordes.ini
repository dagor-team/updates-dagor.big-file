Object GondolinArcherHorde

    SelectPortrait = HPGondolinArcher
    ButtonImage    = HPGondolinArcher

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEULoW
        End
    End

    Side                             = Imladris
    EditorSorting                    = UNIT
    EmotionRange                     = 240
    DisplayName                      = OBJECT:GondolinArcherHorde
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_GondolinArcherHorde
    DescriptionStrategic             = CONTROLBAR:LW_ToolTip_GondolinArcherHorde
    ThreatLevel                      = 150
    TransportSlotCount               = TRANSPORTSLOTCOUNT_SMALL_HORDE

    BuildCost                        = 900
    BuildTime                        = FirstAgeHordeBuildtime

    VisionRange                      = 350
    ShroudClearingRange              = 420
    VisionSide                       = 35%
    VisionRear                       = 25%
    MaxVisionBonusPercent            = 300%
    VisionBonusTestRadius            = 200
    VisionBonusPercentPerFoot        = 2.0%

    CrushableLevel                   = 0
    CrusherLevel                     = 0
    CrushRevengeWeapon               = BasicInfantryCrushRevenge

    CommandPoints                    = 50
    CommandSet                       = GondolinArcherHordeCommandSet

    WeaponSet
        Conditions                   = None
        Weapon                       = PRIMARY GaladhrimArcherMissileHordeRangefinder
    End

    WeaponSet
        Conditions                   = CONTAINED
        Weapon                       = PRIMARY GarrisonedUnitBowHordeRangefinder
    End

    FormationWidth = 2
    FormationDepth = 1

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY ARCHER HORDE ARMY_SUMMARY MELEE_HORDE LARGE_RECTANGLE_PATHFIND

    ThreatBreakdown ElvenMirkwoodArcherHorde_DetailedThreat
        AIKindOf = ARCHER
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        MaxCowerTime                    = 5000
        MinCowerTime                    = 3000
        CanAttackWhileContained         = Yes
        AILuaEventsList                 = InfantryFunctions
        AttackPriority                  = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                       = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                     = GondolinArcher 5
        Slots                              = 5
        PassengerFilter                    = NONE +INFANTRY +GondolinBanner
        ShowPips                           = No
        ThisFormationIsTheMainFormation    = Yes
        RandomOffset                       = X:0 Y:0
        MeleeBehavior                      = Amoeba
        End

        BannerCarriersAllowed              = GondolinBanner
        BannerCarrierPosition              = UnitType:GondolinArcher    Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinArcher Position:X:0 Y:0   Position:X:0 Y:20   Position:X:0 Y:-20   Position:X:0 Y:40    Position:X:0 Y:-40

        RanksToReleaseWhenAttacking     = 1  2
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay        = 1000
        TauntAndPointExcluded           = NONE
        AfraidOf                        = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                  = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                         = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance                = 150
        FearScanDistance                = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion                      = Terror_Base
        AddEmotion                      = Doom_Base
        AddEmotion                      = UncontrollableFear_Base
        AddEmotion                      = FearIdle_Base
        AddEmotion                      = FearBusy_Base
        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base
        AddEmotion                      = HeroCheerIdle_Base
        AddEmotion                      = HeroCheerBusy_Base
        AddEmotion                      = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly                  = Yes
        StuffToPickUp                   = ANY +CRATE -TheDroppedRing
        ScanRange                       = 200
        ScanIntervalSeconds             = 0.5
    End

    LocomotorSet
        Locomotor = NormalMeleeHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_ELVEN_FAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                   = No
        HealOnlyIfNotInCombat          = Yes
        HealOnlyIfNotUnderAttack       = Yes
        TriggeredBy                    = Upgrade_EliteHordeLvl2
        HealingAmount                  = 30
        Radius                         = 100
        StartHealingDelay              = 7500
        HealingDelay                   = 5000
        UnitHealPulseFX                = FX_SpellHealUnitHealBuff
        NonStackable                   = Yes
        RespawnNearbyHordeMembers      = Yes
        RespawnFXList                  = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay            = 200
    End

    Behavior = DualWeaponBehavior ModuleTag_09
        SwitchWeaponOnCloseRangeDistance = 40
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                     = Upgrade_AllFactionUpgrade
        AttributeModifier               = FearlessForever
    End

    Behavior = StatusBitsUpgrade ForgedBlades_UpgradeDetection
        TriggeredBy                     = Upgrade_FormenosForgedBlades
    End

    Behavior = SubObjectsUpgrade ModuleTag_MakingThebla
        TriggeredBy                     = Upgrade_EliteHordeLvl1
        HideSubObjects                  = FIREAROWTIP
    End

    Behavior = SubObjectsUpgrade ForgedBlades_Upgrade
        TriggeredBy                     = Upgrade_FormenosForgedBlades
        ShowSubObjects                  = FIREAROWTIP
    End











    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                 = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                = No
        BonusName                   = GondolinArcherBonus
        TriggeredBy                 = Upgrade_EliteHordeLvl2
        RefreshDelay                = 2000
        Range                       = 200
        AntiCategory                = BUFF
        ObjectFilter                = ANY +GondolinArcher +GondolinArcher_Summoned +GondolinArcherHorde +GondolinArcherHorde_Summoned ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FormenosArmorUpgradeEnabler
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership2
        TriggeredBy                  = Upgrade_EliteHordeLvl5
    End

    Behavior = SpecialPowerModule ModuleTag_FormenosArmorUpgradeStarter
        SpecialPowerTemplate         = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack     = Yes
        StartsPaused                 = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                  = Upgrade_EliteHordeLvl5
        ArmorSetFlag                 = PLAYER_UPGRADE
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry             = BOX
    GeometryMajorRadius  = 30.0
    GeometryMinorRadius  = 45.0
    GeometryHeight       = 20.0
    GeometryIsSmall      = No





    AutoResolveUnitType            = AutoResolveUnit_Archer
    AutoResolveCombatChain         = AutoResolve_ArcherCombatChain

    AutoResolveBody                = AutoResolve_EliteLegndaryHordeBody

    AutoResolveArmor
        Armor                      = AutoResolve_EliteLegndaryArcherArmor
    End

    AutoResolveWeapon
        Weapon                     = AutoResolve_EliteLegndaryArcherWeapon
    End
End


Object GondolinGuardHorde

    SelectPortrait = HPGondolinGuard
    ButtonImage    = HPGondolinGuard

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEULoW
        End
    End

    Side                            = Imladris
    EditorSorting                   = UNIT
    EmotionRange                    = 240
    DisplayName                     = OBJECT:GondolinGuardHorde
    DisplayNameStrategic            = CONTROLBAR:LW_Unit_GondolinGuardHorde
    DescriptionStrategic            = CONTROLBAR:LW_ToolTip_GondolinGuardHorde
    ThreatLevel                     = 150
    TransportSlotCount              = TRANSPORTSLOTCOUNT_SMALL_HORDE

    BuildCost                       = 900
    BuildTime                       = FirstAgeHordeBuildtime

    VisionRange                     = 320
    ShroudClearingRange             = 380
    VisionSide                      = 35%
    VisionRear                      = 25%
    MaxVisionBonusPercent           = 300%
    VisionBonusTestRadius           = 200
    VisionBonusPercentPerFoot       = 2.0%

    CrushableLevel                  = 0
    CrusherLevel                    = 0
    CrushRevengeWeapon              = SuperInfantryCrushRevenge

    CommandPoints                   = 50
    CommandSet                      = GondolinGuardHordeCommandSet

    WeaponSet
        Conditions                  = None
        Weapon                      = PRIMARY TowerGuardHordeRangefinder
    End

    FormationWidth = 2
    FormationDepth = 1

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND PIKE

    ThreatBreakdown ElvenMithlondSentryHorde_DetailedThreat
        AIKindOf = PIKEMAN
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        MaxCowerTime                    = 5000
        MinCowerTime                    = 3000
        CanAttackWhileContained         = Yes
        AILuaEventsList                 = InfantryFunctions
        AttackPriority                  = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                       = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay                     = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained          =
        InitialPayload                   = GondolinGuard 5
        Slots                            = 5
        PassengerFilter                  = NONE +INFANTRY +GondolinBanner
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = Yes
        RandomOffset                     = X:0 Y:0
        MeleeBehavior                    = Amoeba
        End

        BannerCarriersAllowed            = GondolinBanner
        BannerCarrierPosition            = UnitType:GondolinGuard    Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinGuard Position:X:0 Y:0   Position:X:0 Y:20   Position:X:0 Y:-20   Position:X:0 Y:40    Position:X:0 Y:-40

        RanksToReleaseWhenAttacking      = 1  2
        AlternateFormation               = GondolinGuardHordeShieldWall
        MeleeAttackLeashDistance         = 1
        BackUpMinDelayTime               = 1
        BackUpMaxDelayTime               = 3000
        BackUpMinDistance                = 1
        BackUpMaxDistance                = 3
        BackupPercentage                 = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult             = 1.0
    End

    Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance         = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay      = 1000
        TauntAndPointExcluded         = NONE
        AfraidOf                      = EMOTION_AFRAIDOF_OBJECTFILTER_LANCERS
        AlwaysAfraidOf                = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER_LANCERS
        PointAt                       = EMOTION_POINTAT_OBJECTFILTER_LANCERS
        HeroScanDistance              = 150
        FearScanDistance              = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion                    = Terror_Base
        AddEmotion                    = Doom_Base
        AddEmotion                    = UncontrollableFear_Base
        AddEmotion                    = FearIdle_Base
        AddEmotion                    = FearBusy_Base
        AddEmotion                    = Point_Base
        AddEmotion                    = Taunt_Base
        AddEmotion                    = CheerIdle_Base
        AddEmotion                    = CheerBusy_Base
        AddEmotion                    = HeroCheerIdle_Base
        AddEmotion                    = HeroCheerBusy_Base
        AddEmotion                    = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly                = Yes
        StuffToPickUp                 = ANY +CRATE -TheDroppedRing
        ScanRange                     = 200
        ScanIntervalSeconds           = 0.5
    End

    LocomotorSet
        Locomotor = NormalMeleeHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_MED_HORDE_SPEED
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                  = No
        HealOnlyIfNotInCombat         = Yes
        HealOnlyIfNotUnderAttack      = Yes
        TriggeredBy                   = Upgrade_EliteHordeLvl2
        HealingAmount                 = 30
        Radius                        = 100
        StartHealingDelay             = 7500
        HealingDelay                  = 5000
        UnitHealPulseFX               = FX_SpellHealUnitHealBuff
        NonStackable                  = Yes
        RespawnNearbyHordeMembers     = Yes
        RespawnFXList                 = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay           = 200
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        AttributeModifier             = FearlessForever
    End

    Behavior = StatusBitsUpgrade ForgedBlades_UpgradeDetection
        TriggeredBy                   = Upgrade_FormenosForgedBlades
    End

    Behavior = SubObjectsUpgrade ForgedBlades_Upgrade1
        TriggeredBy                   = Upgrade_AllFactionUpgrade
        HideSubObjects                = Forged_Blade
    End

    Behavior = SubObjectsUpgrade ModuleTag_FireArrowSwapUpgrade
        TriggeredBy                   = Upgrade_FormenosForgedBlades
        ShowSubObjects                = Forged_Blade
    End











    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                 = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                = No
        BonusName                   = GondolinGuardBonus
        TriggeredBy                 = Upgrade_EliteHordeLvl2
        RefreshDelay                = 2000
        Range                       = 200
        AntiCategory                = BUFF
        ObjectFilter                = ANY +GondolinGuard +GondolinGuard_Summoned +GondolinGuardHorde +GondolinGuardHorde_Summoned ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FormenosArmorUpgradeEnabler
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        TriggeredBy                     = Upgrade_EliteHordeLvl5
    End

    Behavior = SpecialPowerModule ModuleTag_FormenosArmorUpgradeStarter
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                     = Upgrade_EliteHordeLvl5
        ArmorSetFlag                    = PLAYER_UPGRADE
    End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End

    Geometry             = BOX
    GeometryMajorRadius  = 30.0
    GeometryMinorRadius  = 45.0
    GeometryHeight       = 20.0
    GeometryIsSmall      = No





    AutoResolveUnitType            = AutoResolveUnit_Pikemen
    AutoResolveCombatChain         = AutoResolve_PikemenCombatChain

    AutoResolveBody                = AutoResolve_EliteLegndaryHordeBody

    AutoResolveArmor
        Armor                      = AutoResolve_EliteLegndaryPikemanArmor
    End

    AutoResolveWeapon
        Weapon                     = AutoResolve_EliteLegndaryPikemanWeapon
    End
End


ChildObject GondolinGuardHordeShieldWall GondolinGuardHorde

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay                    = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained         =
        InitialPayload                  = GondolinGuard 5
        Slots                           = 5
        PassengerFilter                 = NONE +INFANTRY +GondolinBanner
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers              = FormenosGuardShieldWallBonus
        RandomOffset                    = X:0 Y:0
        MeleeBehavior                   = Amoeba
        End

        BannerCarriersAllowed           = GondolinBanner
        BannerCarrierPosition           = UnitType:GondolinGuard  Pos:X:-20 Y:0

        RankInfo = RankNumber:1 UnitType:GondolinGuard Position:X:0 Y:0   Position:X:0 Y:12   Position:X:0 Y:-12   Position:X:0 Y:24    Position:X:0 Y:-24

        RanksToReleaseWhenAttacking     = 1
        AlternateFormation              = GondolinGuardHorde
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End
End


Object GondolinWarriorHorde

    SelectPortrait = HPGondolinWarrior
    ButtonImage    = HPGondolinWarrior

    Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
        DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
        DefaultModelConditionState
            Model = None
        End
        ModelConditionState = HORDE_EMPTY
            Model = None
        End
        ModelConditionState = WORLD_BUILDER
            Model = HordeMarkEULoW
        End
    End

    Side                             = Imladris
    EditorSorting                    = UNIT
    EmotionRange                     = 240
    DisplayName                      = OBJECT:GondolinWarriorHorde
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_GondolinWarriorHorde
    DescriptionStrategic             = CONTROLBAR:LW_ToolTip_GondolinWarriorHorde
    ThreatLevel                      = 150
    TransportSlotCount               = TRANSPORTSLOTCOUNT_SMALL_HORDE

    BuildCost                        = 950
    BuildTime                        = FirstAgeHordeBuildtime

    VisionRange                      = 300
    ShroudClearingRange              = 370
    VisionSide                       = 35%
    VisionRear                       = 25%
    MaxVisionBonusPercent            = 300%
    VisionBonusTestRadius            = 200
    VisionBonusPercentPerFoot        = 2.0%

    CrushableLevel                   = 0
    CrusherLevel                     = 0
    CrushRevengeWeapon               = SuperInfantryCrushRevenge

    CommandPoints                    = 50
    CommandSet                       = GondolinWarriorHordeCommandSet

    WeaponSet
        Conditions                   = None
        Weapon                       = PRIMARY NormalMeleeHordeRangefinder
    End

    FormationWidth = 2
    FormationDepth = 1

    #include "..\..\..\includes\StandardHordeEvaEvents.inc"

    KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND

    ThreatBreakdown ElvenLorienWarriorHorde_DetailedThreat
        AIKindOf = INFANTRY
    End

    Body = ImmortalBody ModuleTag_ImmortalBody
        MaxHealth = 1
    End

    Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

    Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
        AutoAcquireEnemiesWhenIdle      = Yes ATTACK_BUILDINGS STEALTHED
        MoodAttackCheckRate             = 500
        MaxCowerTime                    = 5000
        MinCowerTime                    = 3000
        CanAttackWhileContained         = Yes
        AILuaEventsList                 = InfantryFunctions
        AttackPriority                  = AttackPriority_Archer
    End

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                        = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                      = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GondolinWarrior 5
        Slots                             = 5
        PassengerFilter                   = NONE +INFANTRY +GondolinBanner
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = Yes
        RandomOffset                      = X:0 Y:0
        MeleeBehavior                     = Amoeba
        End

        BannerCarriersAllowed             = GondolinBanner
        BannerCarrierPosition             = UnitType:GondolinWarrior    Pos:X:15.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinWarrior  Position:X:50 Y:-40  Position:X:25 Y:-25  Position:X:50 Y:0  Position:X:25 Y:25  Position:X:50 Y:40

        RanksToReleaseWhenAttacking       = 1
        MeleeAttackLeashDistance          = 1
        BackUpMinDelayTime                = 1
        BackUpMaxDelayTime                = 3000
        BackUpMinDistance                 = 1
        BackUpMaxDistance                 = 3
        BackupPercentage                  = 80%
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
        GravityMult = 1.0
    End

     Behavior = EmotionTrackerUpdate    Module_EmotionTracker
        TauntAndPointDistance           = INFANTRY_TAUNT_POINT_RADIUS
        TauntAndPointUpdateDelay        = 1000
        TauntAndPointExcluded           = NONE
        AfraidOf                        = EMOTION_AFRAIDOF_OBJECTFILTER
        AlwaysAfraidOf                  = EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
        PointAt                         = EMOTION_POINTAT_OBJECTFILTER
        HeroScanDistance                = 150
        FearScanDistance                = INFANTRY_FEAR_SCAN_RADIUS
        AddEmotion                      = Terror_Base
        AddEmotion                      = Doom_Base
        AddEmotion                      = UncontrollableFear_Base
        AddEmotion                      = FearIdle_Base
        AddEmotion                      = FearBusy_Base
        AddEmotion                      = Point_Base
        AddEmotion                      = Taunt_Base
        AddEmotion                      = CheerIdle_Base
        AddEmotion                      = CheerBusy_Base
        AddEmotion                      = HeroCheerIdle_Base
        AddEmotion                      = HeroCheerBusy_Base
        AddEmotion                      = Alert_Base
    End

    Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
        SkirmishAIOnly                 = Yes
        StuffToPickUp                  = ANY +CRATE -TheDroppedRing
        ScanRange                      = 200
        ScanIntervalSeconds            = 0.5
    End

    LocomotorSet
        Locomotor = NormalMeleeHordeLocomotor
        Condition = SET_NORMAL
        Speed     = NORMAL_FOOT_VERYFAST_HORDE_SPEED
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
        GiveNoXP = Yes
    End

    #include "..\..\..\includes\CaptureBuilding.inc"

    Behavior = AutoHealBehavior ModuleTag_HearthHeal
        StartsActive                   = No
        HealOnlyIfNotInCombat          = Yes
        HealOnlyIfNotUnderAttack       = Yes
        TriggeredBy                    = Upgrade_EliteHordeLvl2
        HealingAmount                  = 30
        Radius                         = 100
        StartHealingDelay              = 7500
        HealingDelay                   = 5000
        UnitHealPulseFX                = FX_SpellHealUnitHealBuff
        NonStackable                   = Yes
        RespawnNearbyHordeMembers      = Yes
        RespawnFXList                  = FX_BannerCarrierSpawnUnit
        RespawnMinimumDelay            = 200
    End

    Behavior = AttributeModifierUpgrade ModuleTag_AMU
        TriggeredBy                    = Upgrade_AllFactionUpgrade
        AttributeModifier              = FearlessForever
    End

    Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
        TriggeredBy                   = Upgrade_FormenosForgedBlades
    End

    Behavior = StatusBitsUpgrade ForgedBlades_UpgradeDetection
        TriggeredBy                    = Upgrade_FormenosForgedBlades
    End

    Behavior = SubObjectsUpgrade ModuleTag_MakingThebla
        TriggeredBy                    = Upgrade_EliteHordeLvl1
        HideSubObjects                 = FORGED_BLADE
    End

    Behavior = SubObjectsUpgrade ForgedBlades_Upgrade
        TriggeredBy                    = Upgrade_FormenosForgedBlades
        ShowSubObjects                 = FORGED_BLADE
    End











    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenLeadership
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        TriggeredBy                 = Upgrade_EliteHordeLvl2
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenLeadershipUpdate
        SpecialPowerTemplate        = SpecialAbilityFakeLeadership
        UpdateModuleStartsAttack    = Yes
        StartsPaused                = No
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive                = No
        BonusName                   = GondolinWarriorBonus
        TriggeredBy                 = Upgrade_EliteHordeLvl2
        RefreshDelay                = 2000
        Range                       = 200
        AntiCategory                = BUFF
        ObjectFilter                = ANY +GondolinWarrior +GondolinWarrior_Summoned +GondolinWarriorHorde ALLIES
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_FormenosArmorUpgradeEnabler
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        TriggeredBy                     = Upgrade_EliteHordeLvl5
    End

    Behavior = SpecialPowerModule ModuleTag_FormenosArmorUpgradeStarter
        SpecialPowerTemplate            = SpecialAbilityFakeLeadership2
        UpdateModuleStartsAttack        = Yes
        StartsPaused                    = Yes
    End

    Behavior = ArmorUpgrade ArmorUpgradeModuleTag
        TriggeredBy                     = Upgrade_EliteHordeLvl5
        ArmorSetFlag                    = PLAYER_UPGRADE
    End





    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_TheodenGloriousChargeEnabler
        SpecialPowerTemplate             = SpecialAbilityHeulenRudelfuhrer
        TriggeredBy                      = Upgrade_EliteHordeLvl10
    End

    Behavior = SpecialPowerModule ModuleTag_TheodenGloriousChargeUpdate
        SpecialPowerTemplate             = SpecialAbilityHeulenRudelfuhrer
        UpdateModuleStartsAttack         = Yes
        StartsPaused                     = No
        AttributeModifier                = GrenzwachterStandfestigkeit
        AttributeModifierAffectsSelf     = Yes
        AttributeModifierFX              = FX_GrenzwachterStandfestigkeitFX
        InitiateSound                    = KnightsDolAmrothGloriousCharge
    End

    Behavior = SpecialAbilityUpdate ModuleTag_GloriousChargeAnimation
        UnpackTime                       = 0
        UnpackingVariation               = 1
        SpecialPowerTemplate             = SpecialAbilityHeulenRudelfuhrer
        PreparationTime                  = 0
        PersistentPrepTime               = 0
        PackTime                         = 0
     End







    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
        CommandButtonName  = Command_SetStanceBattle
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
        CommandButtonName  = Command_SetStanceAggressive
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
    End

    Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
        CommandButtonName  = Command_SetStanceHoldGround
        SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
    End

    Behavior = AISpecialPowerUpdate ElvenLorienWarriorHordeCaptureBuildingAI
        CommandButtonName  = Command_CaptureBuilding
        SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
    End


    Behavior = AISpecialPowerUpdate Charge_AI
        CommandButtonName  = Command_GondolinWarriorCharge
        SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
    End

    Geometry            = BOX
    GeometryMajorRadius = 30.0
    GeometryMinorRadius = 45.0
    GeometryHeight      = 20.0
    GeometryIsSmall     = No





    AutoResolveUnitType             = AutoResolveUnit_Soldier
    AutoResolveCombatChain          = AutoResolve_SoldierCombatChain

    AutoResolveBody                 = AutoResolve_EliteLegndaryHordeBody

    AutoResolveArmor
        Armor                       = AutoResolve_EliteLegndaryInfantryArmor
    End

    AutoResolveWeapon
        Weapon                      = AutoResolve_EliteLegndaryInfantryWeapon
    End
End

ChildObject GondolinArcherHorde_Summoned GondolinArcherHorde

    KindOf = +SUMMONED
    DisplayName                      = OBJECT:GondolinArcherHorde_Summoned
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_GondolinArcherHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                        = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                      = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained           =
        InitialPayload                    = GondolinArcher_Summoned 5
        Slots                             = 5
        PassengerFilter                   = NONE +GondolinArcher_Summoned +GondolinBanner_Summoned
        ShowPips                          = No
        ThisFormationIsTheMainFormation   = Yes
        RandomOffset                      = X:0 Y:0
        MeleeBehavior                     = Amoeba
        End

        BannerCarriersAllowed             = GondolinBanner_Summoned
        BannerCarrierPosition             = UnitType:GondolinArcher_Summoned    Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinArcher_Summoned Position:X:0 Y:0   Position:X:0 Y:20   Position:X:0 Y:-20   Position:X:0 Y:40    Position:X:0 Y:-40

        RanksToReleaseWhenAttacking     = 1 2
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 120000
        MaxLifetime      = 120000
        DeathType        = FADED
    End
End

ChildObject GondolinWarriorHorde_Summoned GondolinWarriorHorde

    KindOf = +SUMMONED
    DisplayName                      = OBJECT:GondolinWarriorHorde_Summoned
    DisplayNameStrategic             = CONTROLBAR:LW_Unit_GondolinWarriorHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                         = STANDARD_INFANTRY_FRONTANGLE
        FlankedDelay                       = STANDARD_INFANTRY_FLANKEDDELAY
        ObjectStatusOfContained            =
        InitialPayload                     = GondolinWarrior_Summoned 5
        Slots                              = 5
        PassengerFilter                    = NONE +GondolinWarrior_Summoned +GondolinBanner_Summoned
        ShowPips                           = No
        ThisFormationIsTheMainFormation    = Yes
        RandomOffset                       = X:0 Y:0
        MeleeBehavior                      = Amoeba
        End

        BannerCarriersAllowed              = GondolinBanner_Summoned
        BannerCarrierPosition              = UnitType:GondolinWarrior_Summoned    Pos:X:15.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinWarrior_Summoned  Position:X:50 Y:-40  Position:X:25 Y:-25  Position:X:50 Y:0  Position:X:25 Y:25  Position:X:50 Y:40

        RanksToReleaseWhenAttacking     = 1
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 120000
        MaxLifetime      = 120000
        DeathType        = FADED
    End
End

ChildObject GondolinGuardHorde_Summoned GondolinGuardHorde

    KindOf = +SUMMONED
    DisplayName                       = OBJECT:GondolinGuardHorde_Summoned
    DisplayNameStrategic              = CONTROLBAR:LW_Unit_GondolinGuardHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                       = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay                     = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained          =
        InitialPayload                   = GondolinGuard_Summoned 5
        Slots                            = 5
        PassengerFilter                  = NONE +INFANTRY +GondolinBanner_Summoned
        ShowPips                         = No
        ThisFormationIsTheMainFormation  = Yes
        RandomOffset                     = X:0 Y:0
        MeleeBehavior                    = Amoeba
        End

        BannerCarriersAllowed            = GondolinBanner_Summoned
        BannerCarrierPosition            = UnitType:GondolinGuard_Summoned    Pos:X:20.0 Y:0.0

        RankInfo = RankNumber:1 UnitType:GondolinGuard_Summoned Position:X:0 Y:0   Position:X:0 Y:20   Position:X:0 Y:-20   Position:X:0 Y:40    Position:X:0 Y:-40

        RanksToReleaseWhenAttacking     = 1  2
        AlternateFormation              = GondolinGuardHordeShieldWall_Summoned
        MeleeAttackLeashDistance        = 1
        BackUpMinDelayTime              = 1
        BackUpMaxDelayTime              = 3000
        BackUpMinDistance               = 1
        BackUpMaxDistance               = 3
        BackupPercentage                = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 120000
        MaxLifetime      = 120000
        DeathType        = FADED
    End
End

ChildObject GondolinGuardHordeShieldWall_Summoned GondolinGuardHorde_Summoned

    DisplayName                     = OBJECT:GondolinGuardHorde_Summoned
    DisplayNameStrategic            = CONTROLBAR:LW_Unit_GondolinGuardHorde_Summoned

    Behavior = HordeContain ModuleTag_HordeContain
        FrontAngle                      = STANDARD_PIKEMAN_FRONTANGLE
        FlankedDelay                    = STANDARD_PIKEMAN_FLANKEDDELAY
        ObjectStatusOfContained         =
        InitialPayload                  = GondolinGuard_Summoned 5
        Slots                           = 5
        PassengerFilter                 = NONE +INFANTRY +GondolinBanner_Summoned
        ShowPips                        = No
        ThisFormationIsTheMainFormation = No
        AttributeModifiers              = FormenosGuardShieldWallBonus
        RandomOffset                    = X:0 Y:0
        MeleeBehavior                   = Amoeba
        End

        BannerCarriersAllowed           = GondolinBanner_Summoned
        BannerCarrierPosition           = UnitType:GondolinGuard_Summoned  Pos:X:-20 Y:0

        RankInfo = RankNumber:1 UnitType:GondolinGuard_Summoned Position:X:0 Y:0   Position:X:0 Y:12   Position:X:0 Y:-12   Position:X:0 Y:24    Position:X:0 Y:-24

        RanksToReleaseWhenAttacking    = 1
        AlternateFormation             = GondolinGuardHorde_Summoned
        MeleeAttackLeashDistance       = 1
        BackUpMinDelayTime             = 1
        BackUpMaxDelayTime             = 3000
        BackUpMinDistance              = 1
        BackUpMaxDistance              = 3
        BackupPercentage               = 80%
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 120000
        MaxLifetime      = 120000
        DeathType        = FADED
    End
End

