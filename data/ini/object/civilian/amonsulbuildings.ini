







Object AmonSulKeep

    SelectPortrait = HPAmonSulCitadel






  Draw = W3DScriptedModelDraw ModuleTag_Draw

        ExtraPublicBone    = Arrow01
        ExtraPublicBone    = Arrow02
        ExtraPublicBone    = Arrow03
        ExtraPublicBone    = Arrow04
        ExtraPublicBone    = Arrow05
        ExtraPublicBone    = Arrow06
        ExtraPublicBone    = Arrow07
        ExtraPublicBone    = Arrow08


    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    StaticModelLODMode = Yes

    DefaultModelConditionState
    Model = CBAmonSulKeep
    WeaponLaunchBone = PRIMARY Arrow

    End

    IdleAnimationState
        StateName = STATE_None
    End


        ModelConditionState   = AWAITING_CONSTRUCTION
        Model               = CBAmonSulKeep
    End

    ModelConditionState    =    ACTIVELY_BEING_CONSTRUCTED
        Model        =    CBAmonSulKeep
    End



    ModelConditionState  = DAMAGED
      Model         = CBASKEEPD1
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingMedium
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 FireBuildingSmall
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = DAMAGED
        EnteringStateFX    = FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = CBASKEEPD2
        ParticleSysBone FireSmall01 FireBuildingLarge
        ParticleSysBone FireSmall02 FireBuildingLarge
        ParticleSysBone FireSmall03 FireBuildingMedium
        ParticleSysBone FireSmall04 SmokeBuildingLarge
        ParticleSysBone FireSmall05 SmokeBuildingLarge
    End
    AnimationState = REALLYDAMAGED
          Animation                =    RubbleAnimation
            AnimationName        =    CBASKEEPD2_skl.CBASKEEPD2_AN
            AnimationMode        =    ONCE
          End
        EnteringStateFX    = FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = CBASKEEPD3
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = RUBBLE
          Animation                =    RubbleAnimation
            AnimationName        =    CBASKEEPD3_skl.CBASKEEPD3_BLD
            AnimationMode        =    ONCE
          End
      EnteringStateFX    = FX_BuildingReallyDamagedWithSound
    End











  End

    Draw = W3DScriptedModelDraw ModuleTag_DrawDoor
        OkToChangeModelColor  = Yes
        UseStandardModelNames = Yes
        StaticModelLODMode = Yes

        DefaultModelConditionState
            Model = CBAmnKD_CLS
        End


        IdleAnimationState
            Animation            = IDLE
                AnimationName        = CBAmnKD_SKL.CBAmnKD_CLS
                AnimationMode        = LOOP
            End
            Flags = START_FRAME_FIRST
        End

        ModelConditionState = DAMAGED
            Model = CBAmnKD_CLS
            Texture = AmonSulCentralTower_D.tga AmonSul_D1.tga
        End

        ModelConditionState = REALLYDAMAGED
            Model = CBAmnKD_CLS
            Texture = AmonSulCentralTower_D.tga AmonSul_D1.tga
        End

        ModelConditionState = RUBBLE
            Model = CBAmnKD_CLS
        End


        AnimationState                = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
        End


        AnimationState                = DOOR_1_OPENING
            Animation            = CBAmnKD_OPA
                AnimationName        = CBAmnKD_SKL.CBAmnKD_OPAN
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
            End
        End


        AnimationState                = DOOR_1_WAITING_OPEN
            Animation            = CBAmnKD_OP
                AnimationName        = CBAmnKD_SKL.CBAmnKD_OP
                AnimationMode        = LOOP
                AnimationBlendTime    = 0
            End
        Flags = START_FRAME_FIRST
        End


        AnimationState                = DOOR_1_CLOSING
            Animation            = CBAmnKD_CLA
                AnimationName        = CBAmnKD_SKL.CBAmnKD_CLSAN
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
            End
        End









    End



  DisplayName         = OBJECT:AmonSulStronghold
  Side                = Arnor
  EditorSorting       = STRUCTURE
  Browser = REGION WEATHERTOP  STRUCTURE
  ThreatLevel = 1.0

  BuildCost           = 7500
  BuildTime           = 45.0
  VisionRange         = VISION_BASE_DEFENSE
  ShroudClearingRange = SHROUD_CLEAR_BASE_DEFENSE


    WeaponSet
        Weapon                = PRIMARY AmonSulArrowTowerBow
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions        = None
        Armor            = CitadelFortressArmor
    End

  CommandSet          = EmptyCommandSet



      SoundOnDamaged            = BuildingLightDamageStone
    SoundOnReallyDamaged    = BuildingHeavyDamageStone
    VoiceSelect = MenFortressSelect

    UnitSpecificSounds
        UnderConstruction        = BuildingConstructionLoop
        UnderRepairFromDamage    = NoSound
        UnderRepairFromRubble    = BuildingConstructionLoop
    End



    RadarPriority       = STRUCTURE
    KindOf              = VITAL_FOR_BASE_SURVIVAL PRELOAD SELECTABLE STRUCTURE IMMOBILE SCORE CASTLE_KEEP MP_COUNT_FOR_VICTORY DONT_HIDE_IF_FOGGED CAN_ATTACK FS_FACTORY AUTO_RALLYPOINT DOZER_FACTORY NEVER_CULL_FOR_MP COMMANDCENTER

    Behavior = QueueProductionExitUpdate ModuleTag_QueuePEU
        UnitCreatePoint            = X:0.0 Y:-75.0 Z:0.0
        NaturalRallyPoint        = X:0.0 Y:-150.0 Z:0.0
            ExitDelay        = STANDARD_HORDE_EXIT_DELAY
            PlacementViewAngle    = -90
    End



    Behavior = CommandSetUpgrade ModuleTag_CommandSetDwarven
        TriggeredBy    = Upgrade_DwarfFaction
        CommandSet    = DwarvenMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetMen
        TriggeredBy    = Upgrade_MenFaction
        CommandSet    = GondorMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModueTag_LevelCommandSet_Gandalf
        TriggeredBy         = Upgrade_GandalfWhite Upgrade_BandGefahrten
        RequiresAllTriggers = Yes
        CommandSet          = GondorMonumentFortressRebuildCommandSet_Gandalf
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetRohan
        TriggeredBy    = Upgrade_RohanFaction
        CommandSet    = RohanMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetKing
        TriggeredBy    = Upgrade_RuhmdesKonigsUpgrade
        CommandSet    = RohanMonumentFortressRebuildCommandSet_RuhmdesKonigs
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetImladris
        TriggeredBy    = Upgrade_ImladrisFaction
        CommandSet    = ImladrisMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetElven
        TriggeredBy    = Upgrade_LothlorienFaction
        CommandSet    = LothlorienMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModueTag_CommandSetNachRing
        TriggeredBy   = Upgrade_GaladrielRingannehmen
        CommandSet    = LothlorienMonumentFortressRebuildCommandSet_NachRing
    End
    Behavior = CommandSetUpgrade ModueTag_CommandSetOhneRing
        TriggeredBy   = Upgrade_GaladrielRingablehnen
        CommandSet    = LothlorienMonumentFortressRebuildCommandSet_OhneRing
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetArnor
        TriggeredBy    = Upgrade_ArnorFaction
        CommandSet    = ArnorMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetIsengard
        TriggeredBy    = Upgrade_IsengardFaction
        CommandSet    = IsengardMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetMordor
        TriggeredBy    = Upgrade_MordorFaction
        CommandSet    = MordorMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetWild
        TriggeredBy    = Upgrade_WildFaction
        CommandSet    = WildMonumentFortressRebuildCommandSetMod
    End
    Behavior = CommandSetUpgrade ModuleTag_CommandSetAngmar
        TriggeredBy    = Upgrade_AngmarFaction
        CommandSet    = AngmarMonumentFortressRebuildCommandSetMod
    End


    Behavior = CommandSetUpgrade ModuleTag_CommandSet1
        TriggeredBy       = Upgrade_SubFactionErebor
        CommandSet        = DwarvenMonumentFortressRebuildCommandSet_Erebor
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandSet2
        TriggeredBy       = Upgrade_SubFactionIronHills
        CommandSet        = DwarvenMonumentFortressRebuildCommandSet_Eisenberge
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandSet3
        TriggeredBy       = Upgrade_SubFactionEredLuin
        CommandSet        = DwarvenMonumentFortressRebuildCommandSet_EredLuin
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandSetKrone1
        TriggeredBy         = Upgrade_GreatGoblinCrown
        CommandSet          = WildMonumentFortressRebuildCommandSetMod_King
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandSetKrone2
        TriggeredBy         = Upgrade_DurbutzCrown
        CommandSet          = WildMonumentFortressRebuildCommandSetMod_King
    End

    Behavior = CommandSetUpgrade ModuleTag_CommandSetKrone3
        TriggeredBy         = Upgrade_GorkilCrown
        CommandSet          = WildMonumentFortressRebuildCommandSetMod_King
    End


    Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SummonPortalEnabler
        SpecialPowerTemplate         = SpellSummonUnderworldPortal
        TriggeredBy                  = Upgrade_GlobalFirstAgeSpell
    End

    Behavior = OCLSpecialPower ModuleTag_SummonPortal
        SpecialPowerTemplate         = SpellSummonUnderworldPortal
        OCL                          = OCL_SummonUnderworldPortal
        CreateLocation               = CREATE_AT_LOCATION
        StartsPaused                 = Yes
    End

    Behavior = AISpecialPowerUpdate SummonPortal_AI
        CommandButtonName  = Command_SummonUnderworldPortal
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 1000
        RandomizeTargetLocation = Yes
    End


    Behavior = CastleUpgrade ModuleTag_PassOutAufmarschUpgrade
        TriggeredBy    = Upgrade_IsengardAufmarschTrigger
        Upgrade        = Upgrade_IsengardAufmarsch
    End

    Behavior = CastleUpgrade ModuleTag_PassOutNumenorUpgrade1
        TriggeredBy    = Upgrade_AngmarGefalleneDunedainTrigger
        Upgrade        = Upgrade_AngmarGefalleneDunedain
    End

    Behavior = CastleUpgrade ModuleTag_PassOutNumenorUpgrade2
        TriggeredBy    = Upgrade_AngmarSchwarzeGardeTrigger
        Upgrade        = Upgrade_AngmarSchwarzeGarde
    End

    Behavior = CastleUpgrade ModuleTag_PassOutNumenorUpgrade3
        TriggeredBy    = Upgrade_AngmarHexerdesZwielichtsTrigger
        Upgrade        = Upgrade_AngmarHexerdesZwielichts
    End

    Behavior = CastleUpgrade ModuleTag_PassOutNumenorUpgrade4
        TriggeredBy    = Upgrade_AngmarDieVerdammtenTrigger
        Upgrade        = Upgrade_AngmarDieVerdammten
    End

    Behavior = CastleUpgrade ModuleTag_PassOutMirkwoodUpgrade
        TriggeredBy    = Upgrade_BundnisWaldelbenTrigger
        Upgrade        = Upgrade_BundnisWaldelben
    End



    Behavior = AutoDepositUpdate AutoDepositModuleTag
        DepositTiming           = GENERIC_KEEP_MONEY_TIME
        DepositAmount           = GENERIC_KEEP_MONEY_AMOUNT
        InitialCaptureBonus     = 0
    End

    Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
        Radius            = GENERIC_KEEP_MONEY_RANGE
        MaxIncome        = 0
        IncomeInterval    = 999999
        HighPriority    = Yes
    End

    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End

    Behavior = GettingBuiltBehavior GetBuiltBehaviorTag
        SelfBuildingLoop        = BuildingConstructionLoop
        SelfRepairFromDamageLoop    = NoSound
        SelfRepairFromRubbleLoop    = BuildingConstructionLoop
        SpawnTimer            = -1.0
        RebuildTimeSeconds        = 180
    End



    Body                        = StructureBody ModuleTag_Body
        MaxHealth                = 8000.0
        MaxHealthDamaged        = 4000.0
        MaxHealthReallyDamaged  = 2000.0
    End


    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
         AutoAcquireEnemiesWhenIdle    = Yes
         MoodAttackCheckRate            = 250
     End

    Behavior = ProductionUpdate ModuleTag_06
          NumDoorAnimations            = 1
        DoorOpeningTime              = 3000
        DoorWaitOpenTime             = 3000
        DoorCloseTime                = 3000
    End

      Geometry              = CYLINDER
      GeometryMajorRadius   = 120.0
      GeometryHeight        = 200.0
      GeometryIsSmall       = No
      Shadow                = SHADOW_VOLUME

    Shadow                = SHADOW_VOLUME

End


Object AmonSulGate

    SelectPortrait = HPAmonSul_Gate


    Draw = W3DScriptedModelDraw ModuleTag_Draw
        OkToChangeModelColor      = Yes
        UseStandardModelNames     = Yes
        StaticModelLODMode    = Yes

        DefaultModelConditionState
            Model = CBASGTE
        End

        IdleAnimationState
             StateName = STATE_None
        End



        ModelConditionState   = DAMAGED
            Model               = CBASGTED1
        End
        AnimationState = DAMAGED
            EnteringStateFX    = FX_WallDamaged
        End

        ModelConditionState   = REALLYDAMAGED
            Model               = CBASGTED2
        End

                AnimationState = REALLYDAMAGED
                  Animation                =    RubbleAnimation
                AnimationName        =    CBASGTED2_skl.CBASGTED2_AN
                AnimationMode        =    ONCE
             End
            EnteringStateFX    = FX_BuildingReallyDamaged
           End

        ModelConditionState  = COLLAPSING
            Model         = CBASGTED3
        End

        AnimationState = COLLAPSING
                  Animation            = RubbleAnimation
                AnimationName        = CBASGTED3_skl.CBASGTED3_AN
                AnimationMode        = ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

        ModelConditionState  = RUBBLE
            Model         = CBASGTED3
        End

        AnimationState = RUBBLE
                  Animation            = RubbleAnimation
                AnimationName        = CBASGTED3_skl.CBASGTED3_AN
                AnimationMode        = ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_DrawDoor
        OkToChangeModelColor      = Yes
        UseStandardModelNames     = Yes
        StaticModelLODMode    = Yes

        DefaultModelConditionState
            Model = CBAmnGN_CLS
        End

        IdleAnimationState
             StateName = STATE_None
        End


        ModelConditionState   = DAMAGED
            Model               = CBAmnGN_CLS
            Texture                = AmonSulCentralTower_D.tga AmonSul_D1.tga
        End

        ModelConditionState   = REALLYDAMAGED
            Model               = CBAmnGN_CLS
            Texture                = AmonSulCentralTower_D.tga AmonSul_D1.tga
        End

        ModelConditionState  = COLLAPSING
            Model         = None
        End

        ModelConditionState  = RUBBLE
            Model         = None
        End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End


        ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
            Model    = None
        End


        AnimationState = DOOR_1_OPENING
            Flags = START_FRAME_LAST
            StateName = Door_Open
            Animation                =    Death
                AnimationName        =    CBAmnGN_OPSKL.CBAmnGN_CLS
                AnimationMode        =    ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Door_Close" then CurDrawableSetTransitionAnimState("TRANS_Closed_To_Open") end
            EndScript
        End
        TransitionState = TRANS_Closed_To_Open
            Animation = Open
                AnimationName    =    CBAmnGN_OPSKL.CBAmnGN_OPAN
                AnimationMode    =    ONCE
            End
        End

        AnimationState = DOOR_1_CLOSING
            Flags = START_FRAME_LAST
            StateName = Door_Close
            Animation                =    Death
                AnimationName        =    CBAmnGN_OPSKL.CBAmnGN_OP
                AnimationMode        =    ONCE
            End
            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "Door_Open" then CurDrawableSetTransitionAnimState("TRANS_Open_To_Closed") end
            EndScript
        End
        TransitionState = TRANS_Open_To_Closed
            Animation = Open
                AnimationName    =    CBAmnGN_OPSKL.CBAmnGN_CLSAN
                AnimationMode    =    ONCE
            End
        End
    End



    DisplayName         = OBJECT:CarnDumMainGate
    Side                = Civilian
    EditorSorting       = STRUCTURE
    Browser = REGION WEATHERTOP  STRUCTURE
    ThreatLevel            = 1.0

    BuildCost           = MONUMENT_FORTRESS_GATE_BUILDCOST
    BuildTime           = DWARVEN_WALLGATE_SMALL_BUILDTIME
    VisionRange         = DWARVEN_WALLGATE_SMALL_VISION_RANGE
    ShroudClearingRange = DWARVEN_WALLGATE_SMALL_SHROUD_CLEAR



    #include "..\Includes\StandardBuildingEvaEvents.inc"
    SoundOnDamaged        = BuildingLightDamageStone
    SoundOnReallyDamaged    = BuildingHeavyDamageStone
    VoiceSelectUnderConstruction    = BuildingEvilVoiceSelectUnderConstruction

    UnitSpecificSounds
        UnderConstruction        = BuildingConstructionLoop
        UnderRepairFromRubble    = BuildingConstructionLoop
    End

    ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_PlayCollapseSound
        ModelCondition = REQUIRED:RUBBLE Sound:BuildingSink
    End

    CampnessValue = CAMPNESS_WALL


    RadarPriority       = STRUCTURE
    KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE WALL_GATE MADE_OF_STONE BLOCKING_GATE IGNORE_FOR_VICTORY DONT_HIDE_IF_FOGGED NEVER_CULL_FOR_MP

    CommandSet            = CastleGateCommandSet_NoSell

    ArmorSet
        Conditions        = None
        Armor             = CitadelFortressArmor
        DamageFX          = None
    End

    Body                = StructureBody ModuleTag_05
        MaxHealth         = 3000
        MaxHealthDamaged        = 2000
        MaxHealthReallyDamaged    = 1000
    End

    Behavior = AIUpdateInterface ModuleTag_AIForSequentialScriptsToWork
    End

    Behavior = DoCommandUpgrade Module_DoCommandCloseGate
        TriggeredBy     			= Upgrade_AllFactionUpgrade
        GetUpgradeCommandButtonName = Command_ToggleGate
    End

    Behavior = GateOpenAndCloseBehavior ModuleTag_GATE
        ResetTimeInMilliseconds         = 4000
        OpenByDefault                   = No
        PercentOpenForPathing           = 50
        SoundOpeningGateLoop            = GateOpenStart
        SoundClosingGateLoop            = GateCloseStart
        SoundFinishedOpeningGate        = GateOpenEnd
        SoundFinishedClosingGate        = GateCloseEnd
        TimeBeforePlayingOpenSound      = 3000
        TimeBeforePlayingClosedSound    = 3000
    End

    Behavior                  = StructureCollapseUpdate ModuleTag_Collapse
        MinCollapseDelay        = 000
        MaxCollapseDelay        = 000
        CollapseDamping         = .5
        MaxShudder              = 0.6
        MinBurstDelay           = 250
        MaxBurstDelay           = 800
        BigBurstFrequency       = 4
        FXList                  = INITIAL   FX_StructureMediumCollapse
        FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
        DestroyObjectWhenDone   = Yes
        CollapseHeight          = 126
    End

    Behavior = FakePathfindPortalBehaviour ModuleTag_FAKEPATHFIND
        AllowEnemies              = No
        AllowNonSkirmishAIUnits   = No
    End

    Behavior = AIGateUpdate ModuleTage_AIGateUpdate
        TriggerWidthX = 450.0
        TriggerWidthY = 225.0
    End

    GeometryIsSmall          = No


    Geometry              = CYLINDER
    GeometryMajorRadius   = 15.0
    GeometryHeight        = 100
    GeometryOffset        = X:0 Y:60 Z:0


    AdditionalGeometry    = CYLINDER
    GeometryMajorRadius   = 15.0
    GeometryHeight        = 100
    GeometryOffset        = X:0 Y:-60 Z:0


    AdditionalGeometry    = BOX
    GeometryName        = "Closed"
    GeometryMajorRadius   = 16.0
    GeometryMinorRadius   = 115.0
    GeometryHeight        = 50


    AdditionalGeometry    = BOX
    GeometryName         = "OpenLeft"
    GeometryMajorRadius   = 16.0
    GeometryMinorRadius   = 40
    GeometryHeight        = 40
    GeometryOffset        = X:0 Y:-75  Z:0


    AdditionalGeometry    = BOX
    GeometryName          = "OpenRight"
    GeometryMajorRadius   = 16.0
    GeometryMinorRadius   = 40
    GeometryHeight        = 40
    GeometryOffset        = X:0 Y:75 Z:0


    Shadow                = SHADOW_VOLUME
    BuildCompletion     = PLACED_BY_PLAYER
End


ChildObject  FornostMainGate     AmonSulGate
    Scale    = 1.3
    GeometryIsSmall          = No


    Geometry              = CYLINDER
    GeometryMajorRadius   = 19.5
    GeometryHeight        = 130
    GeometryOffset        = X:0 Y:78 Z:0


    AdditionalGeometry    = CYLINDER
    GeometryMajorRadius   = 19.5
    GeometryHeight        = 130
    GeometryOffset        = X:0 Y:-78 Z:0


    AdditionalGeometry    = BOX
    GeometryName        = "Closed"
    GeometryMajorRadius   = 20.8
    GeometryMinorRadius   = 149.5
    GeometryHeight        = 65


    AdditionalGeometry    = BOX
    GeometryName         = "OpenLeft"
    GeometryMajorRadius   = 19.5
    GeometryMinorRadius   = 52
    GeometryHeight        = 52
    GeometryOffset        = X:0 Y:-97.5  Z:0


    AdditionalGeometry    = BOX
    GeometryName          = "OpenRight"
    GeometryMajorRadius   = 19.5
    GeometryMinorRadius   = 52
    GeometryHeight        = 52
    GeometryOffset        = X:0 Y:97.5 Z:0


    Shadow                = SHADOW_VOLUME
    BuildCompletion     = PLACED_BY_PLAYER

End

Object AmonSulWall

    SelectPortrait = HPAmonSulWallPortrait



  Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode        = Yes

     DefaultModelConditionState
          Model = CBAmonSulWall
     End

     IdleAnimationState
    StateName = STATE_None
    End



             ModelConditionState  = DAMAGED
                 Model         = CBASWallD1
             End

             AnimationState = DAMAGED
                 EnteringStateFX    = FX_WallDamaged
             End

             ModelConditionState  = REALLYDAMAGED
                 Model         = CBASWallD2
             End

                 AnimationState = REALLYDAMAGED
                   Animation                =    RubbleAnimation
                     AnimationName        =     CBASWallD2_SKL.CBASWallD2_AN
                     AnimationMode        =    ONCE
                   End
                 EnteringStateFX    = FX_WallDamaged
             End

        ModelConditionState  = COLLAPSING
            Model         = CBASWallD3
        End
        AnimationState = COLLAPSING
                  Animation                =    CollapsingAnimation
                AnimationName        =     CBASWallD3_skl.CBASWallD3_AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

        ModelConditionState  = RUBBLE
            Model         = None
        End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End

        ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
            Model    = None
        End
End


  DisplayName      = OBJECT:AmonSulWall
    Side                = Civilian
      EditorSorting       = STRUCTURE
      Browser = REGION WEATHERTOP  STRUCTURE
ArmorSet
    Conditions        = None
    Armor             = CitadelFortressArmor
    DamageFX          = GateDamageFX
End

CommandSet          = EmptyCommandSet


  KindOf = PRELOAD STRUCTURE SELECTABLE IMMOBILE WALL_SEGMENT MADE_OF_STONE DONT_HIDE_IF_FOGGED NEVER_CULL_FOR_MP
  Shadow          = SHADOW_VOLUME


    Behavior = KeepObjectDie ModuleTag_IWantRubble
        DeathTypes            = ALL -SUICIDED
    End
    Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
        DeathTypes            = NONE +SUICIDED
        DestructionDelay = 5000
    End

    Body                = StructureBody ModuleTag_05
        MaxHealth         = 3000
        MaxHealthDamaged        = 2000
        MaxHealthReallyDamaged    = 1000
    End




  Geometry              = BOX
  GeometryMajorRadius   = 21
  GeometryMinorRadius   = 16
  GeometryHeight        = 50
  GeometryIsSmall       = No

End


Object AmonSulWall45

    SelectPortrait = HPAmonSul_Hub


  Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode        = Yes

     DefaultModelConditionState
          Model = CBAmonSul45
     End

    IdleAnimationState
    StateName = STATE_None
    End



             ModelConditionState  = DAMAGED
                 Model         = AmSull45_D1
             End

             AnimationState = DAMAGED
                 EnteringStateFX    = FX_WallDamaged
             End

             ModelConditionState  = REALLYDAMAGED
                 Model         = AmSull45_D2
             End

                 AnimationState = REALLYDAMAGED
                   Animation                =    RubbleAnimation
                     AnimationName        =     AmSull45_D2SKL.AmSull45_D2AN
                     AnimationMode        =    ONCE
                   End
                 EnteringStateFX    = FX_WallDamaged
             End

        ModelConditionState  = COLLAPSING
            Model         = AmSull45_D3
        End
        AnimationState = COLLAPSING
                  Animation                =    CollapsingAnimation
                AnimationName        =     AmSull45_D3SKL.AmSull45_D3AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

        ModelConditionState  = RUBBLE
            Model         = None
        End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End

        ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
            Model    = None
        End
End


  DisplayName      = OBJECT:AmonSulWall
    Side                = Civilian
      EditorSorting       = STRUCTURE
      Browser = REGION WEATHERTOP  STRUCTURE


ArmorSet
    Conditions        = None
    Armor             = CitadelFortressArmor
    DamageFX          = GateDamageFX
End


CommandSet          = EmptyCommandSet


  KindOf = PRELOAD STRUCTURE SELECTABLE IMMOBILE WALL_SEGMENT MADE_OF_STONE DONT_HIDE_IF_FOGGED NEVER_CULL_FOR_MP
  Shadow          = SHADOW_VOLUME

    Body                = StructureBody ModuleTag_05
        MaxHealth         = 3000
        MaxHealthDamaged        = 2000
        MaxHealthReallyDamaged    = 1000
    End



    Behavior = KeepObjectDie ModuleTag_IWantRubble
        DeathTypes            = ALL -SUICIDED
    End
    Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
        DeathTypes            = NONE +SUICIDED
        DestructionDelay = 5000
    End


    Geometry              = CYLINDER
    GeometryMajorRadius   = 20.0
    GeometryHeight        = 75
    GeometryOffset        = X:0 Y:0 Z:0


    AdditionalGeometry    = BOX
      GeometryMajorRadius   = 24
      GeometryMinorRadius   = 16
      GeometryHeight        = 50
     GeometryOffset        = X:-24 Y:0 Z:0


    AdditionalGeometry    = CYLINDER
      GeometryMajorRadius   = 23
      GeometryHeight        = 50
     GeometryOffset        = X:21 Y:21 Z:0


     GeometryIsSmall       = No

End



Object AmonSulTower

    SelectPortrait = HPAmonSulTowerPortrait


  Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone         = Arrow01
        ExtraPublicBone         = Arrow02
        ExtraPublicBone         = Arrow03
        ExtraPublicBone         = Arrow04
        ExtraPublicBone         = Arrow05
        ExtraPublicBone         = Arrow06
    StaticModelLODMode        = Yes

     DefaultModelConditionState
          Model = CBAmonSulTwrTl
     WeaponLaunchBone    = PRIMARY Arrow

     End








        ModelConditionState  = DAMAGED
            Model         = CBAmnST_D1
        End
        AnimationState = DAMAGED
            EnteringStateFX    = FX_WallDamaged
        End

        ModelConditionState  = REALLYDAMAGED
            Model         = CBAmnST_D2
        End

        AnimationState = REALLYDAMAGED
              Animation                =    RubbleAnimation
                AnimationName        =     CBAmnST_D2SKL.CBAmnST_D2AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX    = FX_BuildingReallyDamaged
        End

        ModelConditionState  = COLLAPSING
            Model         = CBAmnST_D3
        End
        AnimationState = COLLAPSING
              Animation                =    RubbleAnimation
                AnimationName        =     CBAmnST_D3SKL.CBAmnST_D3AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

             ModelConditionState  = RUBBLE
                 Model         = None
             End

             AnimationState = RUBBLE
             End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End

        ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
            Model    = None
        End
End


  DisplayName      = OBJECT:AmonSulTower
    Side                = Civilian
      EditorSorting       = STRUCTURE
      Browser = REGION WEATHERTOP  STRUCTURE
      VisionRange         = VISION_BASE_DEFENSE
      ShroudClearingRange = SHROUD_CLEAR_BASE_DEFENSE

    WeaponSet
        Weapon                = PRIMARY AmonSulArrowTowerBow
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End

    ArmorSet
        Conditions        = None
        Armor             = CitadelFortressArmor
        DamageFX          = None
    End


CommandSet          = EmptyCommandSet


  KindOf = STRUCTURE IMMOBILE SELECTABLE CAN_ATTACK CAN_SHOOT_OVER_WALLS NEVER_CULL_FOR_MP DONT_HIDE_IF_FOGGED IGNORE_FOR_VICTORY

    Body                = StructureBody ModuleTag_05
        MaxHealth         = 3000
        MaxHealthDamaged        = 2000
        MaxHealthReallyDamaged    = 1000
    End


    Behavior = KeepObjectDie ModuleTag_IWantRubble
        DeathTypes            = ALL -SUICIDED
    End
    Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
        DeathTypes            = NONE +SUICIDED
        DestructionDelay = 5000
    End


    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
         AutoAcquireEnemiesWhenIdle    = Yes
         MoodAttackCheckRate            = 250
     End

  Geometry              = CYLINDER
  GeometryMajorRadius   = 24.0
  GeometryHeight        = 175.0
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME


End


Object AmonSulTower2

    SelectPortrait = HPAmonSulTowerPortrait


  Draw = W3DScriptedModelDraw ModuleTag_01
        ExtraPublicBone         = Arrow01
        ExtraPublicBone         = Arrow02
        ExtraPublicBone         = Arrow03
        ExtraPublicBone         = Arrow04
        ExtraPublicBone         = Arrow05
        ExtraPublicBone         = Arrow06
    StaticModelLODMode        = Yes

     DefaultModelConditionState
         Model = CBAmonSulTwrSh
     WeaponLaunchBone    = PRIMARY Arrow

     End







        ModelConditionState  = DAMAGED
            Model         = CBASTSD1
        End
        AnimationState = DAMAGED
            EnteringStateFX    = FX_WallDamaged
        End

        ModelConditionState  = REALLYDAMAGED
            Model         = CBASTSD2
        End

        AnimationState = REALLYDAMAGED
              Animation                =    RubbleAnimation
                AnimationName        =     CBASTSD2_skl.CBASTSD2_AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX    = FX_BuildingReallyDamaged
        End

        ModelConditionState  = COLLAPSING
            Model         = CBASTSD3
        End
        AnimationState = COLLAPSING
              Animation                =    RubbleAnimation
                AnimationName        =     CBASTSD3_skl.CBASTSD3_AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX            = FX_StructureMediumCollapse
        End

        ModelConditionState  = RUBBLE
            Model         = None
        End

        ModelConditionState  = POST_RUBBLE
            Model         = NONE
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_RUBBLE
        End

        ModelConditionState  = POST_COLLAPSE
        Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        AnimationState = POST_COLLAPSE
        End

        ModelConditionState = ACTIVELY_BEING_CONSTRUCTED
            Model    = None
        End
End



  DisplayName      = OBJECT:AmonSulTower
    Side                = Civilian
      EditorSorting       = STRUCTURE
      Browser = REGION WEATHERTOP  STRUCTURE
      VisionRange         = VISION_BASE_DEFENSE
      ShroudClearingRange = SHROUD_CLEAR_BASE_DEFENSE

    ArmorSet
        Conditions        = None
        Armor             = CitadelFortressArmor
        DamageFX          = None
    End

    WeaponSet
        Weapon                = PRIMARY AmonSulArrowTowerBow
        AutoChooseSources    = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
    End


CommandSet          = EmptyCommandSet


  KindOf = STRUCTURE IMMOBILE SELECTABLE CAN_ATTACK CAN_SHOOT_OVER_WALLS NEVER_CULL_FOR_MP DONT_HIDE_IF_FOGGED IGNORE_FOR_VICTORY


    Body                = StructureBody ModuleTag_05
        MaxHealth         = 3000
        MaxHealthDamaged        = 2000
        MaxHealthReallyDamaged    = 1000
    End

    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
         AutoAcquireEnemiesWhenIdle    = Yes
         MoodAttackCheckRate            = 250
     End


    Behavior = KeepObjectDie ModuleTag_IWantRubble
        DeathTypes            = ALL -SUICIDED
    End
    Behavior            = SlowDeathBehavior ModuleTag_SlowDeath
        DeathTypes            = NONE +SUICIDED
        DestructionDelay = 5000
    End


      Geometry              = CYLINDER
      GeometryMajorRadius   = 24.0
      GeometryHeight        = 100.0

    AdditionalGeometry              = BOX
      GeometryMajorRadius   = 60
      GeometryMinorRadius   = 16
      GeometryHeight        = 50



  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME

End


Object AmonSulMallornTree

    SelectPortrait = BPEMallornTree

  Draw = W3DScriptedModelDraw ModuleTag_Draw
        OkToChangeModelColor  = Yes
        StaticModelLODMode = Yes
        UseStandardModelNames = Yes


        DefaultModelConditionState
            Model = EBMalTree

        End


    IdleAnimationState
    End





        ModelConditionState     = DAMAGED
            Model               = EBMalTree_D1
        End
        AnimationState =    DAMAGED
            EnteringStateFX    = FX_StatueDamaged
            ParticleSysBone = NONE MalTreeleaves
            ParticleSysBone = NONE Maltreedust
        End


        ModelConditionState     = REALLYDAMAGED
            Model               = EBMalTree_D2
        End
        AnimationState =    REALLYDAMAGED
            Animation    = RubbleAnimation
                AnimationName        =    EBMalTree_D2SK.EBMalTree_D2AN
                AnimationMode        =    ONCE
              End
            EnteringStateFX    = FX_StatueDamaged
        End


        ModelConditionState  = RUBBLE
            Model         =  EBMalTree_D3
            ParticleSysBone SmokeLarge01 SmokeBuildingLarge
        End
        AnimationState = RUBBLE
            Animation    = RubbleAnimation
                AnimationName        =    EBMalTree_D3SK.EBMalTree_D3AN
                AnimationMode        =    ONCE
              End
              EnteringStateFX    = FX_StructureMediumCollapse
        End

        ModelConditionState  = POST_RUBBLE
            Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End
        ModelConditionState  = POST_COLLAPSE
            Model         = None
            ParticleSysBone NONE SmokeBuildingMediumRubble
        End

        ModelConditionState = SNOW
            Model = EBMalTree
            Texture = EBMalTree.tga EBMalTree_Snow.tga
        End
  End


  Draw = W3DFloorDraw ModuleTag_DrawFloor
        StaticModelLODMode = Yes
     ModelName = EBMalTree_Bib
     WeatherTexture        = SNOWY EBMalTree_Bib_snow.tga
          HideIfModelConditions    =    AWAITING_CONSTRUCTION
          HideIfModelConditions    =    PARTIALLY_CONSTRUCTED
  End



  PlacementViewAngle  = 45


  DisplayName            = OBJECT:ElvenMallornTree
  Side                = Civilian
  EditorSorting       = STRUCTURE
  Browser = REGION WEATHERTOP  STRUCTURE
  ThreatLevel            = 1.0

  VisionRange             = VISION_BASE_DEFENSE
  ShroudClearingRange     = SHROUD_CLEAR_BASE_DEFENSE
  BountyValue         = ELVEN_MALLORN_TREE_BOUNTY_VALUE

  CommandSet = SellableCommandSet

  ArmorSet
    Conditions        = None
    Armor             = ResourceArmor

  End

    WeaponSet
        Conditions    = NONE
        Weapon        = PRIMARY ElvenFloodgateWeapon
    End






    SoundOnDamaged        = BuildingLightDamageWood
    SoundOnReallyDamaged    = BuildingHeavyDamageWood

    VoiceSelectUnderConstruction    = BuildingGoodVoiceSelectUnderConstruction
    VoiceFullyCreated        = EVA:GenericBuildingComplete-Builder-Elf

    UnitSpecificSounds
        UnderConstruction    = BuildingConstructionLoop

        UnderRepairFromRubble    = BuildingConstructionLoop
    End

    EvaEventDamagedOwner        = UnderAttackResource

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:StatueHeroicBuildStoneExplode    Animation:RPHeroStat_A.RPHeroStat_A        Frames:620
        AnimationSound = Sound:StatueHeroicBuildStoneDebris1    Animation:RPHeroStat_A.RPHeroStat_A        Frames:635
        AnimationSound = Sound:StatueHeroicBuildStoneDebris2    Animation:RPHeroStat_A.RPHeroStat_A        Frames:650
    End

     CampnessValue = CAMPNESS_RESOURCE_BUILDING



    RadarPriority       = STRUCTURE
    KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_STONE CAN_ATTACK IGNORE_FOR_VICTORY


    Body                        = StructureBody ModuleTag_05
      MaxHealth                 = ELVEN_MALLORN_TREE_HEALTH
      MaxHealthDamaged            = ELVEN_MALLORN_TREE_HEALTH_DAMAGED
      MaxHealthReallyDamaged      = ELVEN_MALLORN_TREE_HEALTH_REALLY_DAMAGED
    End

    Flammability
        Fuel          =   ELVEN_MALLORNTREE_FIRE_FUEL
        MaxBurnRate   =   ELVEN_MALLORNTREE_FIRE_MAX_BURN_RATE
        Decay         =   ELVEN_MALLORNTREE_FIRE_DECAY
        Resistance    =   ELVEN_MALLORNTREE_FIRE_RESISTANCE
    End

    Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
        DestructionDelay  = 5000
    End

    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
        AutoAcquireEnemiesWhenIdle    = Yes
        MoodAttackCheckRate        = 250
    End

    Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
        WorkerName    = ElvenWorkerNoSelect
        SpawnTimer    = DEFAULT_STRUCTURE_HEALDELAY
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag

    End



    Behavior                  = StructureCollapseUpdate ModuleTag_Collapse
        MinCollapseDelay        = 000
        MaxCollapseDelay        = 000
        CollapseDamping         = .5
        MaxShudder              = 0.6
        MinBurstDelay           = 250
        MaxBurstDelay           = 800
        BigBurstFrequency       = 4
        FXList                  = INITIAL   FX_StructureMediumCollapse
        FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
        DestroyObjectWhenDone    = Yes
        CollapseHeight        = 126
    End

    Behavior = SubObjectsUpgrade ModuleTag_HideAll
        TriggeredBy        = Upgrade_StructureLevel1
        HideSubObjects        = V1 V1a V2 V2a
    End




    Behavior = BuildingBehavior ModuleTag_Building
        NightWindowName    = N_WINDOW N_GLOW



    End



    Geometry              = CYLINDER
    GeometryMajorRadius   = 40
    GeometryMinorRadius   = 40
    GeometryHeight        = 76F
    GeometryOffset        = X:0 Y:0 Z:0
    GeometryIsSmall       = No
    Shadow                = SHADOW_VOLUME
    BuildCompletion         = PLACED_BY_PLAYER

      GeometryContactPoint    = X:-33        Y:10        Z:0        Repair
    GeometryContactPoint    = X:30        Y:10        Z:0        Repair
End

ChildObject  AmonSulSunFlareMallorn AmonSulMallornTree

  DisplayName            = OBJECT:MallornSunFlare

END


ChildObject  AmonSulCloudBreakMallorn AmonSulMallornTree

  DisplayName            = OBJECT:MallornCloudBreak

END


ChildObject  AmonSulRebuildMallorn AmonSulMallornTree

  DisplayName            = OBJECT:MallornRebuild

END


ChildObject  AmonSulSummonMallorn AmonSulMallornTree

  DisplayName            = OBJECT:MallornSummon

END


ChildObject  AmonSulElvenWoodMallorn AmonSulMallornTree

  DisplayName            = OBJECT:MallornElvenWood

END

