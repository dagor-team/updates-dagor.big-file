Object EvilSpellBook
    EditorSorting = SYSTEM

    Draw                = W3DDefaultDraw ModuleTag_01
    End

    #include "\includes\systemevil.inc"


     Behavior   = TaintSpecialPower ModuleTag_IsengardTaint
        SpecialPowerTemplate    = SpellBookIsengardTaint
        TaintObject             = TaintLand
        TaintRadius             = SPELLBOOK_TAINT_RADIUS
        TaintFX                 = FX_TaintSpellFX
        TaintOCL                = OCL_TaintSeed
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

     Behavior   = TaintSpecialPower ModuleTag_Taint
        SpecialPowerTemplate    = SpellBookTaint
        TaintObject             = TaintLand
        TaintRadius             = SPELLBOOK_TAINT_RADIUS
        TaintFX                 = FX_TaintSpellFX
        TaintOCL                = OCL_TaintSeed
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Blight
        SpecialPowerTemplate = SpellBookBlight
        OCL                  = OCL_BlightPing
        TriggerFX            = FX_BlightSpellFX
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior   = OCLSpecialPower ModuleTag_ChillWind
        SpecialPowerTemplate    = SpellBookChillWind
        OCL                     = OCL_SpellBookChillWind
        CreateLocation          = CREATE_AT_LOCATION
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLEyeOfSauron
        SpecialPowerTemplate    = SpellBookEyeofSauron
        OCL                     = SUPERWEAPON_SpawnEyeOfSauron
        CreateLocation          = CREATE_AT_LOCATION
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLEvilEyeOfSauron
        SpecialPowerTemplate    = SpellBookEvilEyeofSauron
        OCL                        = SUPERWEAPON_SpawnEyeOfSauron
        CreateLocation            = CREATE_AT_LOCATION
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

       Behavior = OCLSpecialPower    ModuleTag_Barricade
        SpecialPowerTemplate              = SpellBookBarricade
        OCL                               = OCL_SpellBookBarricade
        CreateLocation                    = CREATE_AT_LOCATION
        AvailableAtStart                  = No
        RequirementsFilterMPSkirmish      = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic       = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = SpecialPowerModule        SpellBookWarChant_ModuleTag
        SpecialPowerTemplate         = SpellBookWarChant
        AttributeModifier            = SpellBookWarChant
        AttributeModifierRange       = 100
        AttributeModifierAffects     = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
        TriggerFX                    = FX_SpellWarChantI
        UpdateModuleStartsAttack     = No
        AvailableAtStart             = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior                 = OCLSpecialPower ModuleTag_PalantirVision
        SpecialPowerTemplate = SpellBookPalantirVision
        AttributeModifier    = PalantirVision_Old
        AttributeModifierRange    = 200
        AttributeModifierAffects = ANY +CAVALRY +MACHINE +HERO +INFANTRY +HORDE -STRUCTURE -BASE_FOUNDATION
        OCL                  = SpecialPowerPalantirVision
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLCrebain
        SpecialPowerTemplate    = SpellBookCrebain
        OCL                        = SUPERWEAPON_SpawnCrebain
        CreateLocation            = CREATE_AT_LOCATION
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower    ModuleTag_OCLCaveBats
        SpecialPowerTemplate    = SpellBookCaveBats
        OCL                        = OCL_SpellBookCaveBats
        CreateLocation            = CREATE_AT_LOCATION
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower        ModuleTag_FrozenLand
        SpecialPowerTemplate        = SpellBookFrozenLand
        TriggerFX                   = FX_FrozenLandFX
        OCL                         = OCL_SpecialPowerFrozenLand
        CreateLocation              = CREATE_AT_LOCATION
        UpdateModuleStartsAttack    = No
        AvailableAtStart            = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

     Behavior   = SpecialPowerModule ModuleTag_Snowbind
        SpecialPowerTemplate        = SpellBookSnowbind
        AttributeModifier        = SpellBookSnowbind
        AttributeModifierRange        = SNOWBIND_EFFECT_RADIUS
        AttributeModifierAffects    = SNOWBIND_TYPE_SPELL_OBJECT_FILTER
        TriggerFX            = FX_SnowbindSpellFX
        UpdateModuleStartsAttack    = No
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC

        TargetAllSides = Yes
    End

    Behavior = SpecialPowerModule        SpellBookIndustry_ModuleTag
        SpecialPowerTemplate        = SpellBookIndustry
        AttributeModifier            = SpellBookIndustry
        AttributeModifierRange        = INDUSTRY_EFFECT_RADIUS
        AttributeModifierAffects    = INDUSTRY_TYPE_SPELL_OBJECT_FILTER
        TriggerFX                    = FX_Industry
        UpdateModuleStartsAttack    = No
        AvailableAtStart            = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = PlayerHealSpecialPower SpellBookRebuild_ModuleTag2
        SpecialPowerTemplate    = SpellBookRebuild
        HealAffects          	= STRUCTURE
        HealAsPercent       	= No
        HealAmount           	= 100000
        HealRadius          	= SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
        HealFX               	= FX_Industry
        AvailableAtStart     	= No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC

    End

    Behavior = PlayerHealSpecialPower  SpellBookRebuild_ModuleTag_Kampgne
        SpecialPowerTemplate    = SpellBookRebuild_Kampagne
        HealAffects          	= STRUCTURE
        HealAsPercent        	= No
        HealAmount           	= 100000
        HealRadius           	= SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
        HealFX               	= FX_Industry
        AvailableAtStart     	= No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Bombard
        SpecialPowerTemplate = SpellBookEvilBombard
        OCL                  = OCL_SpellBookBombardSeed
        CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
        NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonOrcs
        SpecialPowerTemplate = SpellBookSummonOrcs
        OCL                  = OCL_SpellBookSummonOrcs
        TriggerFX             = FX_SummonWildmen
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = DevastateSpecialPower    ModuleTag_DevastateSpecialPower
        SpecialPowerTemplate         = SpellBookDevastation
        Radius                       = SPECIALPOWER_DEVASTATION_RADIUS
        TreeValueMultiplier          = 50%
        TreeValueTotalCap            = 1500
        TriggerFX                    = FX_DevastationFlare
        FX                           = FX_Devastation
        AvailableAtStart             = No
        FireWeapon                   = DevastationEntWeaponMod
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = UntamedAllegianceSpecialPower ModuleTag_UntamedAllegiance
        SpecialPowerTemplate        = SpellBookUntamedAllegiance
        TargetEnemy                    = Yes
        AttributeModifierAffects    = CREEP_OBJECTFILTER
        AttributeModifierRange        = 60
        TriggerFX                    = FX_SarumanDominateTrigger
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
        SpecialPowerTemplate = SpellBookArrowVolleyEvil
        OCL                  = OCL_SpellBookArrowVolley
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonWildMen
        SpecialPowerTemplate = SpellBookWildMenAllies
        OCL                  = OCL_SpellBookWildMenAllies
        TriggerFX            = FX_SummonWildmen
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = ScavengerSpecialPower ModuleTag_Scavenger
        SpecialPowerTemplate    = SpellBookScavenger
        BountyPercent            = 0.75
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = ProductionSpeedBonus ModuleTag_CalltheHorde
        SpecialPowerTemplate    = SpellBookCalltheHorde
        NumberOfFrames            = 180
        SpeedMulitplier            = 20.0
        Type                    = MordorAufseher MordorFighterHorde MordorArcherHorde MordorPikemanHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = ProductionSpeedBonus ModuleTag_MordorCalltheHorde
        SpecialPowerTemplate    = SpellBookMordorCalltheHorde
        NumberOfFrames            = 180
        SpeedMulitplier            = 20.0
        Type                    = MordorAufseher MordorFighterHorde MordorArcherHorde MordorPikemanHorde GoblinFighterHorde GoblinArcherHorde GoblinFighterHorde_FromDefectedLair GoblinArcherHorde_FromDefectedLair
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonSpiderlings
        SpecialPowerTemplate   = SpellBookSpiderlingAllies
        OCL                    = OCL_SpawnSpiderlingsEgg
        TriggerFX              = FX_SpiderlingsSummonStart
        CreateLocation         = CREATE_AT_LOCATION
        UpgradeName            = Upgrade_Spiderlings
        AvailableAtStart       = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior   = DarknessSpecialPower ModuleTag_Darkness
        SpecialPowerTemplate            = SpellBookDarkness
        AttributeModifier                = SpellBookDarkness
        AttributeModifierAffects        = ANY +INFANTRY +CAVALRY +MONSTER -HERO -HORDE -DOZER ALLIES
        AttributeModifierWeatherBased    = Yes
        WeatherDuration                    = SPELL_DARKNESS_DURATION
        ChangeWeather                    = CLOUDY
        AvailableAtStart                = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_AwakenWyrm
        SpecialPowerTemplate = SpellBookAwakenWyrm
        OCL                  = OCL_Wyrm
        TriggerFX             = FX_WrymSummonStart
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonGiants
        SpecialPowerTemplate         = SpellBookSummonGiants
        OCL                          = OCL_SpellBookSummonGiants
        TriggerFX             = FX_SummonWildmen
        CreateLocation               = CREATE_AT_LOCATION
        AvailableAtStart         = No
        RequirementsFilterMPSkirmish     = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic     = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = FreezingRainSpecialPower ModuleTag_FreezingRain
        SpecialPowerTemplate            = SpellBookFreezingRain
        AttributeModifierAffects        = ALL -HERO -STRUCTURE ENEMIES
        AntiCategory                    = LEADERSHIP
        AttributeModifierWeatherBased    = Yes
        WeatherDuration                    = SPELL_FREEZINGRAIN_DURATION
        ChangeWeather                    = RAINY
        AvailableAtStart                = No
        BurnRateModifier                = -100
        BurnDecayModifier                = 20
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = SpecialPowerModule        SpellBookFuelTheFires_ModuleTag
        SpecialPowerTemplate         = SpellBookFueltheFires
        UpdateModuleStartsAttack     = No
        AvailableAtStart             = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonWatcher
        SpecialPowerTemplate = SpellBookWatcherAlly
        OCL                  = OCL_WatcherSummoning
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonWights
        SpecialPowerTemplate         = SpellBookSummonWights
        OCL                          = OCL_SpellBookSummonBarrowWights
        TriggerFX             	     = FX_SummonWights
        CreateLocation               = CREATE_AT_LOCATION
        AvailableAtStart             = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonBalrog
        SpecialPowerTemplate = SpellBookBalrogAlly
        OCL                  = OCL_BalrogSummoning
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonShadeOfWolf
        SpecialPowerTemplate = SpellBookSummonShadeOfWolf
        OCL                  = OCL_ShadeofWolfSummoning
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_RainOfFire
        SpecialPowerTemplate = SpellBookRainOfFire
        OCL                  = OCL_SpellBookRainOfFire
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_RainOfFire02
        SpecialPowerTemplate = SpellBookRainOfFire
        OCL                  = OCL_SpellBookRainOfFire
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_DragonAlly
        SpecialPowerTemplate = SpellBookDragonAlly
        OCL                  = OCL_SummonedDragon
        TriggerFX             = FX_SummonDragon
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_DragonStrike
        SpecialPowerTemplate = SpellBookDragonStrike
        OCL                  = OCL_SpellBookDragonStrike
        CreateLocation       = CREATE_AT_EDGE_NEAR_TARGET_AND_MOVE_TO_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Avalanche
        SpecialPowerTemplate         = SpellBookAvalanche
        OCL                          = OCL_SpellBookAvalancheEgg
        CreateLocation               = CREATE_AT_LOCATION
        TriggerFX                    = FX_Avalanche
        AvailableAtStart             = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = ObjectCreationUpgrade ModuleTag_PingHerrderErde
        TriggeredBy     = Upgrade_HerrderErde
        Delay           = 0
        ThingToSpawn    = HerrderErdePingObject
    End

    Behavior = BuildableHeroListUpgrade BitsUpgrade
        TriggeredBy = Upgrade_RingHero
    End








    Behavior = AISpecialPowerUpdate Command_SpellBookWarChantIsengartAI
        CommandButtonName = Command_SpellBookWarChantIsengart
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookPalantirVisionAI
        CommandButtonName = Command_SpellBookPalantirVision
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookCrebainAI
        CommandButtonName = Command_SpellBookCrebain
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookIsengardTaintModAI
        CommandButtonName = Command_SpellBookIsengardTaintMod
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookDevastationAI
        CommandButtonName = Command_SpellBookDevastation
        SpecialPowerAIType = AI_SPELLBOOK_TREE_KILLER
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWildMenAlliesAI
        CommandButtonName = Command_SpellBookWildMenAllies
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWargBowAI
        CommandButtonName = Command_SpellBookWargBow
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBundnissderzweiTurmeAI
        CommandButtonName = Command_SpellBookBundnissderzweiTurme
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 300
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookIsengardMinenRegenAI
        CommandButtonName = Command_SpellBookIsengardMinenRegen
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookTaintAI
        CommandButtonName = Command_SpellBookTaint
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEndloseHordenAI
        CommandButtonName = Command_SpellBookEndloseHorden
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate SpellBookEyeofSauronAI
        CommandButtonName = Command_SpellBookEyeofSauron
        SpecialPowerAIType = AI_SPELLBOOK_SHROUD_REVEAL
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBarricadeAI
        CommandButtonName = Command_SpellBookBarricade
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpellMakesAStructure = Yes
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookCalltheHordeModAI
        CommandButtonName = Command_SpellBookCalltheHordeMod
        SpecialPowerAIType = AI_SPELLBOOK_CALLTHEHORDE
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookMorannonOrksAI
        CommandButtonName = Command_SpellBookMorannonOrks
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEvilBombardAI
        CommandButtonName = Command_SpellBookEvilBombard
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEvilBombardMinasAI
        CommandButtonName = Command_SpellBookMinasMorgulBombard
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookFellbestienAllyAI
        CommandButtonName = Command_SpellBookFellbestienAlly
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookZorndesMorgulfurstenAI
        CommandButtonName = Command_SpellBookZorndesMorgulfursten
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate SpellBookBalrogAllyAI
        CommandButtonName = Command_SpellBookBalrogAlly
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookThargelionArmyAI
        CommandButtonName = Command_SpellBookThargelionArmy
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 150
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookMordorEvilMenArmyAI
        CommandButtonName = Command_SpellBookMordorEvilMenArmy
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 150
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookFeuerbrunstAI
        CommandButtonName = Command_SpellBookFeuerbrunst
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookCaveBatsAI
        CommandButtonName = Command_SpellBookCaveBats
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookCreepStructureAI
        CommandButtonName = Command_SpellBookCreepStructure
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpellMakesAStructure = Yes
        RandomizeTargetLocation = Yes
    End

	Behavior = AISpecialPowerUpdate SpellBookWildTaintAI
		CommandButtonName = Command_SpellBookTaintGundabad
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = SPELLBOOK_TAINT_RADIUS
		SpecialPowerRange = 500
	End

    Behavior = AISpecialPowerUpdate Command_SpellBookWarChantWildAI
        CommandButtonName = Command_SpellBookWarChantWild
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookPaktdesHassesAI
        CommandButtonName = Command_SpellBookPaktdesHasses
    SpecialPowerAIType = AI_SPELLBOOK_CAPTURE_CREEP
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSpiderlingAlliesAI
        CommandButtonName = Command_SpellBookSpiderlingAllies
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookTrommelninderTiefeAI
        CommandButtonName = Command_SpellBookTrommelninderTiefe
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWatcherAllyAI
        CommandButtonName = Command_SpellBookWatcherAlly
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAwakenWyrmAI
        CommandButtonName = Command_SpellBookAwakenWyrm
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpecialPowerRange = 50
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWildDragonStrike AI
        CommandButtonName = Command_SpellBookDragonStrike
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAzogArmyWildAI
        CommandButtonName = Command_SpellBookAzogArmyWild
    SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
    SpecialPowerRadius = 100
    SpecialPowerRange = 150
    RandomizeTargetLocation = Yes
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookAngmarWargLairAI
        CommandButtonName = Command_SpellBookAngmarWargLair
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpellMakesAStructure = Yes
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookKriegshornAngmarsAI
        CommandButtonName = Command_SpellBookKriegshornAngmars
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBlightAI
        CommandButtonName = Command_SpellBookBlight
        SpecialPowerAIType = AI_SPELLBOOK_DEBUFFECONOMYBUILDING
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookChillWindAI
        CommandButtonName = Command_SpellBookChillWind
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookFrozenLandAI
        CommandButtonName = Command_SpellBookFrozenLand
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSummonWightsAI
        CommandButtonName = Command_SpellBookSummonWights
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSnowbindAI
        CommandButtonName = Command_SpellBookSnowbind
        SpecialPowerAIType = AI_SPELLBOOK_REBUILD
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAngmarKaltdrachenAI
        CommandButtonName = Command_SpellBookAngmarKaltdrachen
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSpawnSeucheAI
        CommandButtonName = Command_SpellBookSpawnSeuche
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAvalancheAI
        CommandButtonName = Command_SpellBookAvalanche
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 150
    End


CommandSet          = EvilSpellBookCommandSet
    RadarPriority       = NOT_ON_RADAR
    KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MordorSpellBook EvilSpellBook
    CommandSet          = MordorSpellBookCommandSet
End

ChildObject IsengardSpellBook EvilSpellBook
    CommandSet          = IsengardSpellBookCommandSet
End

ChildObject WildSpellBook EvilSpellBook
    CommandSet          = WildSpellBookCommandSet
End

ChildObject AngmarSpellBook EvilSpellBook
    CommandSet          = AngmarSpellBookCommandSet
End

ChildObject HaradSpellBook EvilSpellBook
    CommandSet          = HaradSpellBookCommandSet
End

ChildObject MinasMorgulSpellBook EvilSpellBook
    CommandSet          = MinasMorgulSpellBookCommandSet
End

ChildObject DolGuldurSpellBook EvilSpellBook
    CommandSet          = DolGuldurSpellBookCommandSet
End






Object GoodSpellBook
    EditorSorting = SYSTEM


    Draw                = W3DDefaultDraw ModuleTag_01

    End

    #include "\includes\systemgood.inc"

    Behavior = PlayerHealSpecialPower ModuleTag_Heal
        SpecialPowerTemplate    = SpellBookHeal
        HealAffects             = INFANTRY CAVALRY MONSTER MACHINE SHIP DOZER HERO MACHINE
        HealAmount              = 0.6
        HealRadius              = SPELL_HEAL_RADIUS_UNIT_SCAN
        HealFX                  = FX_SpellHealUnitHealBuff
        HealOCL                 = OCL_HealSpellHordeReplenishPing
        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = PlayerUpgradeSpecialPower    SpellBookElvenGifts_ModuleTag
        SpecialPowerTemplate        = SpellBookElvenGifts
        UpgradeName                 = Upgrade_ElvenGift
        UpdateModuleStartsAttack    = No
        AffectAllies                = No
        AvailableAtStart            = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SpawnLoneTower
        SpecialPowerTemplate = SpellBookSpawnLoneTower
        OCL                  = OCL_GondorSpellBookSpawnLoneTower
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC


    End

    Behavior = OCLSpecialPower ModuleTag_SpawnLoneTowerDwarf
        SpecialPowerTemplate = SpellBookSpawnLoneTowerDwarf
        OCL                  = OCL_DwarfSpellBookSpawnLoneTower
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC


    End

    Behavior = OCLSpecialPower ModuleTag_EnshroudingMist
        SpecialPowerTemplate = SpellBookEnshroudingMist
        OCL                  = OCL_SpecialPowerEnshroudingMist
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = SpecialPowerModule ModuleTag_RallyingCall
        SpecialPowerTemplate        = SpellBookRallyingCall
        AttributeModifier            = SpellBookRallyingCallModifier
        AttributeModifierRange        = 100
        AttributeModifierAffects    = ANY +HORDE +INFANTRY -HERO -IsengardFanatic -IsengardBerserkerHorde  -DwarvenZerker -DwarvenZerkerHorde -NoldorWarrior -NoldorWarriorHorde
        TriggerFX                    = FX_SpellRallyingCallGondor
        UpdateModuleStartsAttack    = No
        AvailableAtStart            = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    ; Behavior = OCLSpecialPower ModuleTag_TomBombadil
        ; SpecialPowerTemplate = SpellBookTomBombadil
        ; OCL                  = OCL_SpawnTomBombadilEgg
        ; CreateLocation       = CREATE_AT_LOCATION
        ; AvailableAtStart     = No
        ; RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        ; RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    ; End

    Behavior = OCLSpecialPower ModuleTag_SummonHobbits
        SpecialPowerTemplate = SpellBookHobbitAllies
        OCL                  = OCL_SpawnHobbitsEgg
        TriggerFX            = FX_HobbitSummon
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior                 = OCLSpecialPower ModuleTag_Farsight
        SpecialPowerTemplate = SpellBookFarsight
        OCL                  = OCL_SpecialPowerFarSeeing
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = PlayerHealSpecialPower ModuleTag_Rebuild
        SpecialPowerTemplate = SpellBookRebuild
        HealAffects          = STRUCTURE
        HealAsPercent        = No
        HealAmount           = 100000
        HealRadius           = SPELL_REBUILD_RADIUS_STRUCTURE_SCAN
        HealFX               = FX_SpellRebuild
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic  = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_ArrowVolleyGood
        SpecialPowerTemplate = SpellBookArrowVolleyGood
        OCL                  = OCL_SpellBookArrowVolley
        CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
        NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior           = ElvenWoodSpecialPower ModuleTag_ElvenWood
        SpecialPowerTemplate    = SpellBookElvenWood
        ElvenGroveObject        = ElvenGrove
        ElvenWoodRadius            = SPELLBOOK_TAINT_RADIUS
        ElvenWoodFX                = FX_ElvenWoodSpellFX
        ElvenWoodOCL            = OCL_ElvenWoodSeed

        AvailableAtStart        = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = SpecialPowerModule ModuleTag_DwarvenRiches
        SpecialPowerTemplate        = SpellBookDwarvenRiches
        AttributeModifier            = SpellBookDwarvenRiches
        AttributeModifierRange        = DWARVENRICHES_EFFECT_RADIUS
        AttributeModifierAffects    = INDUSTRY_TYPE_SPELL_OBJECT_FILTER
        TriggerFX                    = FX_DwarvenRiches
        UpdateModuleStartsAttack    = No
        AvailableAtStart            = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_MenOfDaleAllies
        SpecialPowerTemplate = SpellBookMenOfDaleAllies
        OCL                  = OCL_SpawnMenOfDaleMinifaction_New

        CreateLocation       = CREATE_AT_LOCATION
        UpgradeName             = Upgrade_MenOfDaleAllies
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = CloudBreakSpecialPower    ModuleTag_CloudBreak
        SpecialPowerTemplate            = SpellBookCloudBreak
        SunbeamObject                    = CloudBreakSunbeam
        ObjectSpacing                    = 300
        AttributeModifierAffects        = ANY +INFANTRY +CAVALRY +MONSTER -HERO ENEMIES
        ReEnableAntiCategory            = Yes
        AttributeModifierWeatherBased    = Yes
        WeatherDuration                    = SPELL_CLOUDBREAK_DURATION
        ChangeWeather                    = SUNNY
        AvailableAtStart                = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonRohan
        SpecialPowerTemplate = SpellBookRohanAllies
        OCL                  = OCL_SpawnRohanRohirrimEgg
        TriggerFX             = FX_RohirimSummon
        CreateLocation       = CREATE_AT_LOCATION
        UpgradeName             = Upgrade_RohanAllies
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonDunedain
        SpecialPowerTemplate = SpellBookDunedainAllies
        OCL                  = OCL_SpawnDunedainRangersEgg
        TriggerFX             = FX_DunedainSummon
        CreateLocation       = CREATE_AT_LOCATION
        UpgradeName             = Upgrade_DunedainAllies
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonEnts
        SpecialPowerTemplate = SpellBookEntAllies
        OCL                  = OCL_SpawnEnts
        TriggerFX             = FX_SummonEntAllies
        CreateLocation       = CREATE_AT_LOCATION
        UpgradeName             = Upgrade_EntAllies
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonEagles
        SpecialPowerTemplate = SpellBookEagleAllies
        OCL                  = OCL_SpawnEagles
        CreateLocation       = CREATE_ABOVE_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Undermine
        SpecialPowerTemplate = SpellBookUndermine
        OCL                  = OCL_SpellBookUndermine
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
        OnTriggerRechargeSpecialPower = SpellBookSpawnLoneTowerZwerge
    End

    Behavior = OCLSpecialPower ModuleTag_Bombard
        SpecialPowerTemplate = SpellBookBombard
        OCL                  = OCL_SpellBookBombardSeed
        CreateLocation       = USE_SECONDARY_OBJECT_LOCATION
        NearestSecondaryObjectFilter = NONE SAME_PLAYER +CASTLE_KEEP
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_SummonDead
        SpecialPowerTemplate = SpellBookArmyoftheDead
        OCL                  = OCL_GondorArmyofTheDeadEgg
        TriggerFX             = FX_SummonAOD
        CreateLocation         = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Earthquake
        SpecialPowerTemplate = SpellBookEarthquake
        OCL                  = OCL_SpellBookEarthquake
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = OCLSpecialPower ModuleTag_Flood
        SpecialPowerTemplate = SpellBookFlood
        OCL                  = OCL_SpellBookFlood
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End
	
	Behavior = OCLSpecialPower ModuleTag_Citadel
        SpecialPowerTemplate = SpellBookCitadel
        OCL                  = OCL_SpellBookCitadel
        CreateLocation       = CREATE_AT_LOCATION
        AvailableAtStart     = No
        RequirementsFilterMPSkirmish = SPELL_BOOK_REQUIREMENTS_FILTER
        RequirementsFilterStrategic = SPELL_BOOK_REQUIREMENTS_FILTER_STRATEGIC
    End

    Behavior = BuildableHeroListUpgrade BitsUpgrade
        TriggeredBy = Upgrade_RingHero
    End







    Behavior = AISpecialPowerUpdate Command_SpellBookHornRohansAI
        CommandButtonName = Command_SpellBookHornRohans
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookRohanHealAI
        CommandButtonName = Command_SpellBookRohanHeal
        SpecialPowerAIType = AI_SPELLBOOK_HEAL
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookDraftAI
        CommandButtonName = Command_SpellBookDraft
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookRadagastRohanAI
        CommandButtonName = Command_SpellBookRadagastRohan
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBeistandGandalfsAI
        CommandButtonName = Command_SpellBookBeistandGandalfs
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSteppenRohansAI
        CommandButtonName = Command_SpellBookSteppenRohans
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookErkenbrandWestfoldAI
        CommandButtonName = Command_SpellBookHaldirElben
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBandderGefahrtenAI
        CommandButtonName = Command_SpellBookBandderGefahrten
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookZornFangornsAI
        CommandButtonName = Command_SpellBookZornFangorns
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 250
    End

    Behavior = AISpecialPowerUpdate SummonHeerlagerAI
        CommandButtonName = Command_SpellBookSummonHeerlager
        SpecialPowerAIType = AI_SPELLBOOK_CITADEL
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
        SpellMakesAStructure = Yes
    End

	Behavior = AISpecialPowerUpdate SpellBookDesertLandAI
        CommandButtonName = Command_SpellBookDesertCracks
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
        SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_LeuchtfeuerGondorAI
        CommandButtonName = Command_SpellBookGroundView
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookHealModAI
        CommandButtonName = Command_SpellBookHealMod
        SpecialPowerAIType = AI_SPELLBOOK_HEAL
    SpecialPowerRadius = 100
    End

	Behavior = AISpecialPowerUpdate SpellBookGondorSignalFireAI
		CommandButtonName = Command_SpellBookGondorSignalFire
		SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
		SpecialPowerRadius = 120
		SpecialPowerRange = 500
		RandomizeTargetLocation = Yes
	End

    Behavior = AISpecialPowerUpdate Command_SpellBookHornGondorsAI
        CommandButtonName = Command_SpellBookHornGondors
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBaumeisterGondorsAI
        CommandButtonName = Command_SpellBookBaumeisterGondors
    SpecialPowerAIType = AI_SPELLBOOK_REBUILD
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookLoneTower_EdainAI
        CommandButtonName = Command_SpellBookLoneTower_Edain
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    SpellMakesAStructure = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWaelderIthiliensAI
        CommandButtonName = Command_SpellBookWaelderIthiliens
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookDieGraueSchaarAI
        CommandButtonName = Command_SpellBookDieGraueSchaar
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAdlerAI
        CommandButtonName = Command_SpellBookAdler
    SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate SpellBookFloodOarniAI
        CommandButtonName = Command_SpellBookFloodOarni
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookLetzteAllianzGondorAI
        CommandButtonName = Command_SpellBookSummonRohanGondor
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 150
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookHornNoldorAI
        CommandButtonName = Command_SpellBookHornNoldor
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookForestLothlorien
        CommandButtonName = Command_SpellBookForestLothlorien
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWindhauchAI
        CommandButtonName = Command_SpellBookWindhauch
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookLothlorienPfeilsalveAI
        CommandButtonName = Command_SpellBookLothlorienPfeilsalve
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookVerzauberterFlussAI
        CommandButtonName = Command_SpellBookVerzauberterFluss
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookElberethGilthonielAI
        CommandButtonName = Command_SpellBookElberethGilthoniel
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookElkriderSpawnAI
        CommandButtonName = Command_SpellBookElkriderSpawn
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookTraenenderValarAI
        CommandButtonName = Command_SpellBookTraenenderValar
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookNoldorAmanAI
        CommandButtonName = Command_SpellBookNoldorAman
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 160
        SpecialPowerRange = 150
    End




    Behavior = AISpecialPowerUpdate Command_SpellBookWaffenNoldorAI
        CommandButtonName = Command_SpellBookWaffenNoldor
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookHausElrondsAI
        CommandButtonName = Command_SpellBookHausElronds
        SpecialPowerAIType = AI_SPELLBOOK_HEAL
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEnshroudingMistImladrisAI
        CommandButtonName = Command_SpellBookEnshroudingMistImladris
        SpecialPowerAIType = AI_SPELLBOOK_ENSHROUDINGMIST
    End

    Behavior = AISpecialPowerUpdate SpellBookHobbitAlliesAI
        CommandButtonName = Command_SpellBookHobbitAllies
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate SpellBookHobbitAlliesAI2
        CommandButtonName = Command_SpellBookHobbitAlliesEdain
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookElvenWoodImladrisAI
        CommandButtonName = Command_SpellBookElvenWoodImladris
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate SpellBookWindsOfProtectionAI
        CommandButtonName  = Command_SpellBookWindsOfProtection
        SpecialPowerAIType = AI_SPELLBOOK_REBUILD
        SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookTomBombadilundGoldbeereAI
        CommandButtonName = Command_SpellBookTomBombadilundGoldbeere
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookTomBombadilundGoldbeereAI2
        CommandButtonName = Command_SpellBookTomBombadilundGoldbeereLothlorien
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSpecialPowerElrondsRatAI
        CommandButtonName = Command_SpellBookSpecialPowerElrondsRat
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
		SpecialPowerRadius = 100
		RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookThlimEcthelAI
        CommandButtonName  = Command_SpellBookThlimEcthel
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 160
        SpecialPowerRange  = 150
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookSternEarendilsAI
        CommandButtonName = Command_SpellBookSternEarendils
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 50
        SpecialPowerRange = 150
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookZwergenhornAI
        CommandButtonName = Command_SpellBookZwergenhorn
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookZwergenbierAI
        CommandButtonName = Command_SpellBookZwergenbier
        SpecialPowerAIType = AI_SPELLBOOK_HEAL
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookUndermineAI
        CommandButtonName = Command_SpellBookUndermine
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
        SpellMakesAStructure = Yes
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookUndermineAI2
        CommandButtonName = Command_SpellBookUndermineKampagne
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
        SpellMakesAStructure = Yes
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookTrotzderZwergeAI
        CommandButtonName = Command_SpellBookTrotzderZwerge
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEredLuinGandalfAI
        CommandButtonName = Command_SpellBookEredLuinGandalf
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End







    Behavior = AISpecialPowerUpdate Command_SpellBookLoneTowerZwergeAI
        CommandButtonName = Command_SpellBookLoneTowerZwerge
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    SpellMakesAStructure = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookZwergeStructureDecreaseAI
        CommandButtonName = Command_SpellBookZwergeStructureDecrease
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBombardAI
        CommandButtonName = Command_SpellBookBombard
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBombardAI2
        CommandButtonName = Command_SpellBookBombardKampagne
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        SpecialPowerRange = 200
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEarthquakeAI
        CommandButtonName = Command_SpellBookEarthquake
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookEarthquakeAI2
        CommandButtonName = Command_SpellBookEarthquakeKampagne
        SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BASEKILL
		SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate SpellBookCitadelAI
        CommandButtonName = Command_SpellBookCitadel
        SpecialPowerAIType = AI_SPELLBOOK_CITADEL
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
        SpellMakesAStructure = Yes
    End

    Behavior = AISpecialPowerUpdate SpellBookCitadelAI2
        CommandButtonName = Command_SpellBookCitadelKampagne
        SpecialPowerAIType = AI_SPELLBOOK_CITADEL
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
        SpellMakesAStructure = Yes
    End



    Behavior = AISpecialPowerUpdate Command_SpellBookHealingOfTheOldAI
        CommandButtonName = Command_SpellBookHealingOfTheOld
        SpecialPowerAIType = AI_SPELLBOOK_HEAL
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookHornOfArnorAI
        CommandButtonName = Command_SpellBookHornOfArnor
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookBaumeisterArnorsAI
        CommandButtonName = Command_SpellBookBaumeisterArnors
    SpecialPowerAIType = AI_SPELLBOOK_REBUILD
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookGiftOfTheKingdomAI
        CommandButtonName = Command_SpellBookGiftOfTheKingdom
        SpecialPowerAIType = AI_SPELLBOOK_ALWAYS_FIRE
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookWaelderCardolansAI
        CommandButtonName = Command_SpellBookWaelderCardolans
        SpecialPowerAIType = AI_SPELLBOOK_BUFFTERRAIN
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookArnorSummonHobbitsAI
        CommandButtonName = Command_SpellBookArnorSummonHobbits
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_BUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookLoneTowerArnorAI
        CommandButtonName = Command_SpellBookLoneTowerArnor
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    RandomizeTargetLocation = Yes
    SpellMakesAStructure = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookAdlerArnorAI
        CommandButtonName = Command_SpellBookAdlerArnor
    SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
    SpecialPowerRadius = 100
    End

    Behavior = AISpecialPowerUpdate Command_SchwerterderWesternisAI
        CommandButtonName = Command_SpellBookSchwerterderWesternis
        SpecialPowerAIType = AI_SPELLBOOK_ASSIST_BATTLE_DEBUFF
        SpecialPowerRadius = 100
        RandomizeTargetLocation = Yes
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookRunBitchWatersCominAI
        CommandButtonName = Command_SpellBookRunBitchWatersComin
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 150
    End

    Behavior = AISpecialPowerUpdate Command_SpellBookLetztesBundnissArnorAI
        CommandButtonName = Command_SpellBookLetztesBundnissArnor
        SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
        SpecialPowerRadius = 100
        SpecialPowerRange = 300
    End

    Behavior = CommandPointsUpgrade CommandPoints_Upgrade
        TriggeredBy        = Upgrade_MarketplaceUpgradeGrandHarvest
        CommandPoints    = 100
        RequiredObject    = NONE +GondorMarketPlace
    End

    CommandSet          = GoodSpellBookCommandSet
    RadarPriority       = NOT_ON_RADAR
    KindOf              = SPELL_BOOK IMMOBILE IGNORES_SELECT_ALL INERT
End

ChildObject MenSpellBook GoodSpellBook
    CommandSet          = MenSpellBookCommandSet
End

ChildObject ElvesSpellBook GoodSpellBook
    CommandSet          = ElvesSpellBookCommandSet
End

ChildObject DwarvesSpellBook GoodSpellBook
    CommandSet          = DwarvesSpellBookCommandSet
End

ChildObject KDDwarvesSpellBook GoodSpellBook
    CommandSet          = KDDwarvesSpellBookCommandSet
End

ChildObject EBDwarvesSpellBook GoodSpellBook
    CommandSet          = EBDwarvesSpellBookCommandSet
End

ChildObject ArnorSpellBook GoodSpellBook
    CommandSet          = ArnorSpellBookCommandSet
End

ChildObject HKRohanSpellBook GoodSpellBook
    CommandSet          = HKRohanSpellBookCommandSet
End

ChildObject EdorasRohanSpellBook GoodSpellBook
    CommandSet          = EdorasRohanSpellBookCommandSet
End

ChildObject MMGondorSpellBook GoodSpellBook
    CommandSet          = MMGondorSpellBookCommandSet
End

ChildObject ImladrisSpellBook GoodSpellBook
    CommandSet          = ImladrisSpellBookCommandSet
End

ChildObject RohanSpellBook GoodSpellBook
    CommandSet          = RohanSpellBookCommandSet
End

ChildObject GondorSpellBook GoodSpellBook
    CommandSet          = GondorSpellBookCommandSet
End










Object RallyPointMarker

    EditorSorting = SYSTEM
    KindOf = DRAWABLE_ONLY


    Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
            Model = RallyFlag_SKN
        End
        IdleAnimationState
            Animation = IDLE
                AnimationName     = RallyFlag_SKL.RallyFlag_WAVA
                AnimationMode     = LOOP
            End
        End
    End
End


Object MoveHint




  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCMoveHint
    End
  End

End


Object AttackHint




  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCAttckHnt
    End
  End

End


Object SelectIcon




  EditorSorting = SYSTEM
  KindOf = DRAWABLE_ONLY




  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = SCSelect
    End
  End

End



Object GenericDebris


  Draw                  = W3DDebrisDraw ModuleTag_01

  End


  EditorSorting = SYSTEM




  KindOf                = UNATTACKABLE

  Behavior = PhysicsBehavior ModuleTag_03
    AllowBouncing           = Yes
    KillWhenRestingOnGround = Yes
  End

  Behavior = SlowDeathBehavior ModuleTag_04
    SinkDelay        = 1000
    SinkRate            = 1
    DestructionDelay = 2000
  End

End


Object GenericBridge


  Draw                = W3DDefaultDraw ModuleTag_01

  End


  EditorSorting       = SYSTEM
  ArmorSet
    Conditions        = None
    Armor             = NoArmor
    DamageFX          = EmptyDamageFX
  End


  RadarPriority       = NOT_ON_RADAR
  KindOf              = STRUCTURE IMMOBILE BRIDGE
  Body                = ImmortalBody ModuleTag_02
    MaxHealth         = 1.0
  End

  Behavior                = BridgeBehavior ModuleTag_03
    LateralScaffoldSpeed  = 100.0
    VerticalScaffoldSpeed = 70.0
  End




  Geometry            = BOX
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No
  Shadow              = NONE
End

























































Object WaterWaveBridge


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model         = CMFldBrdg_A
    End
    AnimationState = NONE
      Animation = Falling
        AnimationName     = CMFldBrdg_A.CMFldBrdg_A
        AnimationMode = ONCE
      End
    End
  End


  EditorSorting   = SYSTEM


  KindOf              = IMMOBILE

  Geometry            = BOX
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = Yes
  Shadow              = NONE

End


Object CivilianVehicleTrainGuide


  DisplayName         = OBJECT:TrainGuide
  EditorSorting       = SYSTEM





  Behavior                 = DestroyDie ModuleTag_01

  End

End



Object FireFieldSmall


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
      ParticleSysBone = None FireFieldSmallFire
      ParticleSysBone = None FireFieldSmallFlare
      ParticleSysBone = None FireFieldSmallEmbers
    End
  End


  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE IGNORE_FOR_VICTORY


  Body = InactiveBody ModuleTag_02

  End
  Behavior = FireWeaponUpdate ModuleTag_03
        FireWeaponNugget
            WeaponName = LavaFieldWeapon
            FireDelay = 0
            OneShot = No
        End
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End

  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No

End


Object GenericDamageField


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
    End
  End


  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE INERT IGNORE_FOR_VICTORY


  Body = InactiveBody ModuleTag_02

  End
  Behavior = FireWeaponUpdate ModuleTag_03
        FireWeaponNugget
            WeaponName = SmallFireFieldWeapon
            FireDelay = 0
            OneShot = No
        End
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End

  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No

End


Object GenericDamageWarning


  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model = NONE
    End
  End


  EditorSorting = SYSTEM
  KindOf = IMMOBILE NO_COLLIDE INERT IGNORE_FOR_VICTORY


  Body = InactiveBody ModuleTag_02

  End

  Behavior = DelayedLuaEventUpdate ModuleTag_03
  End

  Behavior = DeletionUpdate ModuleTag_04
    MinLifetime = 3000
    MaxLifetime = 3000
  End

  Geometry            = CYLINDER
  GeometryMajorRadius = 0.8
  GeometryMinorRadius = 0.8
  GeometryHeight      = 0.8
  GeometryIsSmall     = No

End


Object ParticleFXTestObject




  EditorSorting = SYSTEM


  KindOf              = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = SCMoveHint
    End
  End

  Body               = ActiveBody ModuleTag_02
    MaxHealth        = 1.0
  End

  Behavior = FXListDie ModuleTag_03
    DeathTypes = ALL

  End

  Behavior = SlowDeathBehavior ModuleTag_04
    DeathTypes = ALL
    SinkDelay = 0
    SinkRate = 0.40
    DestructionDelay = 1800
    OCL = INITIAL SUPERWEAPON_PartTheHeavens
  End

  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes

End


Object FXParticleFXTestObject




  EditorSorting = SYSTEM


  KindOf              = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = SCMoveHint
    End
  End

  Body               = ActiveBody ModuleTag_02
    MaxHealth        = 1.0
  End

  Behavior = FXListDie ModuleTag_03
    DeathTypes = ALL
    DeathFX = FX_FXParticleTestFX
  End

  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes

End








































Object PartTheHeavens



  EditorSorting = SYSTEM


  KindOf        = NO_COLLIDE NO_HEAL_ICON IGNORES_SELECT_ALL IGNORED_IN_GUI UNATTACKABLE IGNORE_FOR_VICTORY

  Behavior = DestroyEnvironmentUpdate ModuleTag_01
    StartTime       = 5000
    DestructionTime = 2000
  End

  Behavior = PartTheHeavensUpdate ModuleTag_02

    Texture = SCCommandBar
    Color = R:255 G:255 B:255
    Radius = FCurve
      Key = T:0 V:0 O:0
      Key = T:20 V:100
    End
    Opacity = FCurve
      Key = T:0 V:0
      Key = T:100 V:.50
    End
    Angle = FCurve
      InPadding = HOLD
      OutPadding = CYCLE
      Key = T:0 V:0
      Key = T:100 V:360 I:0 O:0
      Key = T:200 V:0 I:0
    End
  End

  Behavior = DeletionUpdate ModuleTag_03
    MinLifetime = 10000
    MaxLifetime = 10000
  End
End



Object GBLiteBall



  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = GBLiteBall

      ParticleSysBone = particleBone01 LighteningBallSmoke
    End
  End




  DisplayName     = OBJECT:Lightning
  EditorSorting   = STRUCTURE


  KindOf          = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Shadow          = SHADOW_VOLUME
  Body            = ActiveBody ModuleTag_03
    MaxHealth       = 99999.0
  End

  Geometry = CYLINDER
  GeometryMajorRadius = 2.4
  GeometryMinorRadius = 2.4
  GeometryHeight = 4.8
  GeometryIsSmall = Yes
End



Object GBFireObject














  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = GBFireObject

      ParticleSysBone = emberBone fireFlare
      ParticleSysBone = emberBone FireSmoke
      ParticleSysBone = emberBone campfireEmbers
      ParticleSysBone = emberBone fireGlow
    End
  End


    SoundAmbient = Campfire1AmbientLoop


  DisplayName     = OBJECT:Fire
  EditorSorting   = STRUCTURE


  KindOf          = SELECTABLE IMMOBILE IGNORE_FOR_VICTORY
  Shadow          = SHADOW_VOLUME
  Body            = ActiveBody ModuleTag_03
    MaxHealth       = 99999.0
  End

  Geometry = CYLINDER
  GeometryMajorRadius = 2.4
  GeometryMinorRadius = 2.4
  GeometryHeight = 4.8
  GeometryIsSmall = Yes
End


Object MapRevealPing


  VisionRange     = 240.0
  EditorSorting   = SYSTEM
  KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER IGNORE_FOR_VICTORY


  Body = ImmortalBody ModuleTag_01
    MaxHealth = 1
  End

  Behavior = DynamicShroudClearingRangeUpdate ModuleTag_02
    FinalVision = 0.0
    ShrinkDelay = 10000
    ShrinkTime = 5000
    GrowDelay = 0
    GrowTime = 1000
    GrowInterval = 10
    ChangeInterval = 80
    GridDecalTemplate
      Texture           = EXGrid
      Style             = SHADOW_ADDITIVE_DECAL
      OpacityMin        = 50%
      OpacityMax        = 100%
      OpacityThrobTime  = 500
      Color             = R:32 G:64 B:128 A:0
    End
  End

  Behavior = DeletionUpdate ModuleTag_03
    MinLifetime = 13000
    MaxLifetime = 13000
  End

  Behavior = StealthDetectorUpdate ModuleTag_04
    DetectionRate = 500
  End
End



Object CastleTemplateKeeperForMapINIs

    EditorSorting = SYSTEM

    Behavior = CastleBehavior ModuleTagCB
        CastleToUnpackForFaction  = Men   Camp_MenSW
        CastleToUnpackForFaction  = Men   Camp_MenNW
        CastleToUnpackForFaction  = Men   Camp_MenSE
        CastleToUnpackForFaction  = Men   Camp_MenNE
        CastleToUnpackForFaction  = Men   Camp_Men

        CastleToUnpackForFaction  = Elves    Camp_ElvesSW
        CastleToUnpackForFaction  = Elves    Camp_ElvesNW
        CastleToUnpackForFaction  = Elves    Camp_ElvesSE
        CastleToUnpackForFaction  = Elves    Camp_ElvesNE
        CastleToUnpackForFaction  = Elves    Camp_Elves

        CastleToUnpackForFaction  = Dwarves    Camp_DwarvesSW
        CastleToUnpackForFaction  = Dwarves    Camp_DwarvesNW
        CastleToUnpackForFaction  = Dwarves    Camp_DwarvesSE
        CastleToUnpackForFaction  = Dwarves    Camp_DwarvesNE
        CastleToUnpackForFaction  = Dwarves    Camp_Dwarves

        CastleToUnpackForFaction  = Mordor   Camp_MordorSW
        CastleToUnpackForFaction  = Mordor   Camp_MordorNW
        CastleToUnpackForFaction  = Mordor   Camp_MordorSE
        CastleToUnpackForFaction  = Mordor   Camp_MordorNE
        CastleToUnpackForFaction  = Mordor   Camp_Mordor
        CastleToUnpackForFaction  = Mordor   Camp_HaradNE
        CastleToUnpackForFaction  = Mordor   Camp_HaradNW
        CastleToUnpackForFaction  = Mordor   Castle_HaradNE

        CastleToUnpackForFaction  = Isengard Camp_IsengardSW
        CastleToUnpackForFaction  = Isengard Camp_IsengardNW
        CastleToUnpackForFaction  = Isengard Camp_IsengardSE
        CastleToUnpackForFaction  = Isengard Camp_IsengardNE
        CastleToUnpackForFaction  = Isengard Camp_Isengard

        CastleToUnpackForFaction  = Wild    Camp_WildSW
        CastleToUnpackForFaction  = Wild    Camp_WildNW
        CastleToUnpackForFaction  = Wild    Camp_WildSE
        CastleToUnpackForFaction  = Wild    Camp_WildNE
        CastleToUnpackForFaction  = Wild    Camp_Wild

        FilterValidOwnedEntries = ANY +STRUCTURE +WALK_ON_TOP_OF_WALL +BASE_FOUNDATION +TACTICAL_MARKER

    End
End


Object SarumanLightning


    EditorSorting   = SYSTEM
    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 1000
        MaxLifetime        = 1000
    End
End


Object PalantirVisionBase


    EditorSorting   = SYSTEM
    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate   = 500
    End
End


ChildObject PalantirVisionPing PalantirVisionBase
    VisionRange     = 300.0

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
    End


    Behavior = AttributeModifierAuraUpdate ModuleTag_TroopBonus
        StartsActive    = Yes
        BonusName        = PalantirVision_Old
        RefreshDelay    = 1000
        Range            = 200
        ObjectFilter    = ANY +ORC +URUK +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO
    End
End


ChildObject FarSeeingPing PalantirVisionBase
    VisionRange    = 250

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 120000
        MaxLifetime        = 120000
    End

End


Object IvoryTowerVisionBase


    EditorSorting   = SYSTEM
    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = MEN_FORTRESS_IVORY_TOWER_VISION_TIME
        MaxLifetime        = MEN_FORTRESS_IVORY_TOWER_VISION_TIME
    End


    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate   = 500
    End

End


ChildObject IvoryTowerVisionPing IvoryTowerVisionBase
    VisionRange     = MEN_FORTRESS_IVORY_TOWER_VISION_RANGE

    Behavior = AttributeModifierAuraUpdate ModuleTag_TroopBonus
        StartsActive     = Yes
        BonusName        = PalantirVision
        RefreshDelay     = 1000
        Range            = 200
        ObjectFilter     = ANY +ORC +URUK +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO
    End
End



Object EnshroudingMistPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 60000
        MaxLifetime        = 60000
    End

    Behavior = InvisibilityUpdate ModuleTag_BroadcastCamouflage
        InvisibilityNugget
            InvisibilityType    = CAMOUFLAGE
            DetectionRange        = ELVEN_MIST_CAMOUFLAGE_DETECTION_RANGE
        End
        UpdatePeriod            = 1000
        Broadcast                = Yes
        BroadcastRange            = ENSHROUDING_MIST_EFFECT_RADIUS
        BroadcastObjectFilter    = ELVEN_MIST_OBJECT_FILTER
        StartsActive            = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisage
        StartsActive    = Yes
        BonusName        = GenericDebuff
        RefreshDelay    = 2000
        Range            = 200
        TargetEnemy        = Yes
        AntiCategory    = LEADERSHIP BUFF
        ObjectFilter    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

End



Object HealSpellHordeReplenishPing

    EvaEnemyObjectSightedEvent = None


    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION


    Body = ImmortalBody ModuleTag_01
        MaxHealth = 10000
        InitialHealth = 10000
    End

    Behavior = DeletionUpdate ModuleTag_DeletionUpdate
        MinLifetime        = 1000
        MaxLifetime        = 1000
    End

    Behavior = BannerCarrierUpdate BannerCarrierUpdateModuleTag
        IdleSpawnRate            = 2000
        UnitSpawnFX              = FX_BannerCarrierSpawnUnit
        ReplenishNearbyHorde     = Yes
        ReplenishAllNearbyHordes = Yes
        ScanHordeDistance        = SPELL_HEAL_RADIUS_HORDE_SCAN
    End
End


Object SuperweaponPing


  ShroudClearingRange     = 150.0
  EditorSorting   = SYSTEM
  KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER


  Body = ImmortalBody ModuleTag_01
    MaxHealth = 1
    InitialHealth = 1
  End

  Behavior = DeletionUpdate ModuleTag_02
    MinLifetime = 10000
    MaxLifetime = 10000
  End



  Geometry            = BOX
  GeometryMajorRadius = 10.0
  GeometryMinorRadius = 1.0
  GeometryHeight      = 3.0
  GeometryIsSmall     = No
  Shadow              = NONE
End


Object InGameMarker
     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = EXMarker
              ParticleSysBone NONE Pointer
              Shadow = SHADOW_ADDITIVE_DECAL_DYNAMIC
              ShadowSizeX = 135
            ShadowSizeY = 135
            ShadowTexture = EXSpotLight
            ShadowOpacityStart = 0
            ShadowOpacityFadeInTime = 1000
            ShadowOpacityPeak = 255
            ShadowOpacityFadeOutTime = 1000
            ShadowOpacityEnd = 0
            ShadowOverrideLODVisibility = Yes
        End
      End


      EvaEnemyObjectSightedEvent = None


      EditorSorting       = SYSTEM
    Side                 = Civilian
      KindOf = NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION
      ThreatLevel        = 0.0
    CommandPoints    = 0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE

    VisionRange        = 200.0

    Body = ActiveBody ModuleTag_02
        MaxHealth         = 200000
        MaxHealthDamaged  = 100000
        RecoveryTime      = 5000
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior        ModuleTag_PhysicsBehavior
    End
    LocomotorSet
        Locomotor = EyeLocomotor
        Condition = SET_NORMAL
        Speed     = 200
     End
     Geometry = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight        = 1.0
    GeometryIsSmall        = Yes

    ShadowOpacityStart = 0
    ShadowOpacityFadeInTime = 1000
    ShadowOpacityPeak = 255
    ShadowOpacityFadeOutTime = 1000
    ShadowOpacityEnd = 0
End



Object InGameMarker2
     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = EXThroneShaft
              ParticleSysBone NONE Pointer
              Shadow = SHADOW_ADDITIVE_DECAL_DYNAMIC
              ShadowSizeX = 135
            ShadowSizeY = 135
            ShadowTexture = EXSpotLight
            ShadowOpacityStart = 0
            ShadowOpacityFadeInTime = 1000
            ShadowOpacityPeak = 255
            ShadowOpacityFadeOutTime = 1000
            ShadowOpacityEnd = 0
            ShadowOverrideLODVisibility = Yes
        End
      End


      EvaEnemyObjectSightedEvent = None


      EditorSorting       = SYSTEM
    Side                 = Civilian
      KindOf = NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION
      ThreatLevel        = 0.0
    CommandPoints    = 0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE

    VisionRange        = 200.0

    Body = ActiveBody ModuleTag_02
        MaxHealth         = 200000
        MaxHealthDamaged  = 100000
        RecoveryTime      = 5000
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior        ModuleTag_PhysicsBehavior
    End
    LocomotorSet
        Locomotor = EyeLocomotor
        Condition = SET_NORMAL
        Speed     = 200
     End
     Geometry = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight        = 1.0
    GeometryIsSmall        = Yes

    ShadowOpacityStart = 0
    ShadowOpacityFadeInTime = 1000
    ShadowOpacityPeak = 255
    ShadowOpacityFadeOutTime = 1000
    ShadowOpacityEnd = 0
End


Object SpellBookEarthquakePiece
     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model = Earthquake02
        End

        IdleAnimationState
            Animation
                AnimationName = Earthquake02.Earthquake02
                AnimationMode = ONCE
            End
        End
    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End
End


Object SpellBookEarthquake

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = None
        End
     End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes



    SoundAmbient = SpellEarthquakeRumbleLoop


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = EarthquakePhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = EarthquakePhaseOneWeapon
            FireDelay = 800
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = EarthquakePhaseTwoWeapon
            FireDelay = 1200
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = EarthquakePhaseThreeWeapon
            FireDelay = 1800
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = EarthquakePhaseFinalWeapon
            FireDelay = 3400
            OneShot = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object SpellBookFlood

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = None
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes


    Body = ImmortalBody ModuleTag_02
        MaxHealth     = 1
        InitialHealth = 1s
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FloodUpdate ModuleTag_FloodCentral
        AngleOfFlow         = 25
        DirectionIsRelative = No

        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:150 Z:0
            ControlPointOffsetThree =    X:100 Y:150 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 20
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:100 Z:0
            ControlPointOffsetThree =    X:100 Y:100 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 21
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:50 Z:0
            ControlPointOffsetThree =    X:100 Y:50 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 20
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:0 Z:0
            ControlPointOffsetThree =    X:100 Y:0 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 22
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:-50 Z:0
            ControlPointOffsetThree =    X:100 Y:-50 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 20
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:-100 Z:0
            ControlPointOffsetThree =    X:100 Y:-100 Z:0
            ControlPointOffsetFour =    X:200 Y:0 Z:0
            MemberSpeed = 21
        End
        FloodMember
            MemberTemplateName = FloodHorse
            ControlPointOffsetOne =        X:-200 Y:0 Z:0
            ControlPointOffsetTwo =        X:-100 Y:-150 Z:0
            ControlPointOffsetThree =    X:100 Y:-150 Z:0
            ControlPointOffsetFour =    X:210 Y:0 Z:-60
            MemberSpeed = 20
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object FloodHorse

    Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = Yes
        DefaultModelConditionState
            Model = FloodHorse_SKN
            ParticleSysBone = Bone05 WaterHorseTrail FollowBone:Yes
            ParticleSysBone = Bone05 WaterHorseTrail2 FollowBone:Yes
            ParticleSysBone = Bone05 WaterHorseTrail3 FollowBone:Yes
        End

        IdleAnimationState
            StateName                = STATE_Idle
            Animation                = IDLE
                AnimationName        = FloodHorse_SKL.FloodHorse_RUNA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = FloodHorse_SKL.FloodHorse_RUNA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End

    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT


    Body = HighlanderBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = FloodHorseRadiusWeapon
            Offset = X:-25 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeOut
        DeathTypes            = ALL
        DestructionDelay    = 0
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 17.6
    GeometryHeight = 32.0
    GeometryIsSmall = No
End


ChildObject FloodGateHorse FloodHorse

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = FloodGateHorseRadiusWeapon
            Offset = X:-25 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End
End



Object PackWolf

    Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = Yes
        DefaultModelConditionState
            Model = CUWolf_SKN



        End

        IdleAnimationState
            StateName                = STATE_Idle
            Animation                = IDLE
                AnimationName        = CUWolf_SKL.CUWolf_RUNA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End

        AnimationState                = MOVING
            Animation                = RUNA
                AnimationName        = CUWolf_SKL.CUWolf_RUNA
                AnimationMode        = LOOP
            End
            Flags                    = RANDOMSTART
        End

    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT

    Scale = 1.25
    VoiceMove = NeutralWargVoxMove
    SoundAmbient                = WargAmbienceVOX
    SoundImpact                = ImpactHorse
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:WargMoveFootsteps Animation:CUWolf_SKL.CUWolf_RUNA Frames:0
    End


    Behavior = LargeGroupAudioUpdate ModuleTag_LGAU
        Key = Warg
    End


    Body = HighlanderBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = PackWolfRadiusWeapon
            Offset = X:-25 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeOut
        DeathTypes            = ALL
        DestructionDelay        = 250
        FadeDelay            = 0
        FadeTime            = 250


    End

    Geometry = CYLINDER
    GeometryMajorRadius = 17.6
    GeometryHeight = 32.0
    GeometryIsSmall = No
End


Object SpellBookAvalancheEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 1700
        OCL    = MIDPOINT OCL_SpellBookAvalanche
        OCL    = FINAL OCL_SpellBookAvalancheSecond
        DoNotRandomizeMidpoint     = Yes
    End

End


Object FireDepth

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = None
        End
     End
       
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
    ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
    
    ; *** AUDIO Parameters ***
    
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 1800
        ;AnimationSound = Sound:SpellRainOfFireProjectileFlyBy    Animation:EXMeteor.EXMeteor        Frames: 20 49 55 61
        ;AnimationSound = Sound:ImpactRainOfFire                    Animation:EXMeteor.EXMeteor        Frames: 52 75 79 89
        ;AnimationSound = Sound:SpellRainOfFirePlume                Animation:EXMeteor.EXMeteor        Frames: 85
    End
        
    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 10000
        MaxLifetime = 10000
    End
    
    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = FireDepthWeapon
            FireDelay = 0
            OneShot = Yes    ; Alternative is to fire as often as the reload time of this weapon allows
        End
        
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE ; doesn't actually have a model...
End



Object SpellBookAvalanche

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = None
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 7000
        MaxLifetime = 7000
    End


    Behavior = FloodUpdate ModuleTag_FloodCentral
        AngleOfFlow = 0
        DirectionIsRelative = No

        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:0 Y:250 Z:0
            ControlPointOffsetFour =    X:0 Y:250 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:0 Y:-250 Z:0
            ControlPointOffsetFour =    X:0 Y:-250 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:20 Y:0 Z:0
            ControlPointOffsetThree =    X:250 Y:0 Z:0
            ControlPointOffsetFour =    X:250 Y:0 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-250 Y:0 Z:0
            ControlPointOffsetFour =    X:-250 Y:0 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-200 Y:-200 Z:0
            ControlPointOffsetFour =    X:-200 Y:-200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-200 Y:200 Z:0
            ControlPointOffsetFour =    X:-200 Y:200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:200 Y:-200 Z:0
            ControlPointOffsetFour =    X:200 Y:-200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:200 Y:200 Z:0
            ControlPointOffsetFour =    X:200 Y:200 Z:0
            MemberSpeed = 30
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object SpellBookAvalancheSecond

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = None
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 7000
        MaxLifetime = 7000
    End


    Behavior = FloodUpdate ModuleTag_FloodCentral
        AngleOfFlow = 22.5
        DirectionIsRelative = No

        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:0 Y:250 Z:0
            ControlPointOffsetFour =    X:0 Y:250 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:0 Y:-250 Z:0
            ControlPointOffsetFour =    X:0 Y:-250 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:20 Y:0 Z:0
            ControlPointOffsetThree =    X:250 Y:0 Z:0
            ControlPointOffsetFour =    X:250 Y:0 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-250 Y:0 Z:0
            ControlPointOffsetFour =    X:-250 Y:0 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-200 Y:-200 Z:0
            ControlPointOffsetFour =    X:-200 Y:-200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:-200 Y:200 Z:0
            ControlPointOffsetFour =    X:-200 Y:200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:200 Y:-200 Z:0
            ControlPointOffsetFour =    X:200 Y:-200 Z:0
            MemberSpeed = 30
        End
        FloodMember
            MemberTemplateName = Avalanchechunk
            ControlPointOffsetOne =        X:0 Y:0 Z:0
            ControlPointOffsetTwo =        X:0 Y:0 Z:0
            ControlPointOffsetThree =    X:200 Y:200 Z:0
            ControlPointOffsetFour =    X:200 Y:200 Z:0
            MemberSpeed = 30
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object Avalanchechunk

    Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = Yes
        DefaultModelConditionState
            Model = None
        End


    End

    CrusherLevel   = 3
    CrushWeapon    = AvalancheCrush
    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    CrushKnockback = 40
    CrushZFactor = 1.0

    EditorSorting   = SYSTEM
    KindOf =  IMMOBILE UNATTACKABLE INERT


    Body = HighlanderBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName = AvalancheRadiusWeapon
            Offset = X:0 Y:0 Z:0
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_FadeOut
        DeathTypes          = ALL
        DestructionDelay    = 250
        FadeDelay           = 0
        FadeTime            = 250
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 10.0
    GeometryHeight = 12.0
    GeometryIsSmall = Yes
End


Object BarrowCorruptProxy

    Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = Yes
        DefaultModelConditionState
            Model = None
            ParticleSysBone = NONE FX_BarrowCorruption
        End
    End

    DisplayName      = OBJECT:Prop
      Side                = Civilian
      EditorSorting   = STRUCTURE
      Browser = REGION WEATHERTOP STRUCTURE

    KindOf =  IMMOBILE UNATTACKABLE INERT




    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 5000
        MaxLifetime = 5000
    End


    Geometry = CYLINDER
    GeometryMajorRadius = 10.0
    GeometryHeight = 12.0
    GeometryIsSmall = Yes
End



Object SpellBookRainOfFire02

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = EXMeteor02
            ParticleSysBone Meteor RainTrail FollowBone:Yes
            ParticleSysBone Meteor01 MRainTrail2 FollowBone:Yes
            ParticleSysBone Meteor02 RainTrail2 FollowBone:Yes
            ParticleSysBone Meteor03 RainTrail2 FollowBone:Yes
            ParticleSysBone Meteor04 RainTrail2 FollowBone:Yes
            ParticleSysBone Meteor05 RainTrail2 FollowBone:Yes
            ParticleSysBone Meteor06 RainTrail2 FollowBone:Yes
            ParticleSysBone Meteor07 RainTrail2 FollowBone:Yes

            ParticleSysBone Meteor01 RainHit FollowBone:Yes
            ParticleSysBone Meteor02 RainHit FollowBone:Yes
            ParticleSysBone Meteor04 RainHit2 FollowBone:Yes
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXMeteor02.EXMeteor02
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes



    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 1800
        AnimationSound = Sound:SpellRainOfFireProjectileFlyBy    Animation:EXMeteor.EXMeteor        Frames: 20 49 55 61
        AnimationSound = Sound:ImpactRainOfFire                    Animation:EXMeteor.EXMeteor        Frames: 52 75 79 89

    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = RainOfFirePhaseInitialWeapon02
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = RainOfFirePhaseOneWeapon02
            FireDelay = 2500
            OneShot = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object SpellBookRainOfFire

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = EXMeteor
            ParticleSysBone Meteor MeteorTrail FollowBone:Yes
            ParticleSysBone Meteor01 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor02 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor03 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor04 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor05 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor06 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor07 MeteorTrail2 FollowBone:Yes

            ParticleSysBone Meteor01 MeteorHit FollowBone:Yes
            ParticleSysBone Meteor02 MeteorHit FollowBone:Yes
            ParticleSysBone Meteor04 MeteorHit2 FollowBone:Yes
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXMeteor.EXMeteor
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes



    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 1800
        AnimationSound = Sound:SpellRainOfFireProjectileFlyBy    Animation:EXMeteor.EXMeteor        Frames: 20 49 55 61
        AnimationSound = Sound:ImpactRainOfFire                    Animation:EXMeteor.EXMeteor        Frames: 52 75 79 89

    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = RainOfFirePhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = RainOfFirePhaseOneWeapon
            FireDelay = 2500
            OneShot = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End



Object AngmarNecroCorpseRainSeed
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = IMMOBILE UNATTACKABLE TAINTEFFECT

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End

    Behavior = LifetimeUpdate ModuleTag_Lifetime
        MinLifetime = 0
        MaxLifetime = 6000
    End

    Behavior = SlowDeathBehavior ModuleTag_SpawnRealTree

        OCL = FINAL OCL_AngmarNecroCorpseRainProjectile
    End
End



Object AngmarNecroCorpseRainProjectile

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model =  EXGoblin_FLYC
            ParticleSysBone SKULL_HE09 CorpseRainProjectileFire FollowBone:Yes
            ParticleSysBone SKULL_HE09 CorpseRainProjectileSmoke FollowBone:Yes
            ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers FollowBone:Yes
            ParticleSysBone SKULL_HE09 CorpseRainProjectileEmbers2 FollowBone:Yes
            ParticleSysBone SKULL_HE09 CorpseRainProjectileGlow FollowBone:Yes
        End
       IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXGoblin_FLYC.EXGoblin_FLYC
                AnimationMode     = ONCE
            End
        End
     End




















    EditorSorting        = SYSTEM
    KindOf            = IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
    ForceLuaRegistration    = Yes
    ShroudClearingRange    = 100


    Body = ActiveBody ModuleTag_04
            MaxHealth = 99999.0
    End

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = 1000
        MaxLifetime = 1000
    End

    Behavior = SlowDeathBehavior ModuleTag_03
        DeathTypes = ALL
        FX = FINAL FX_CorpseRainExplosion
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = AngmarCorpseRainPhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AngmarCorpseRainProjectileWeapon
            FireDelay = 600
            OneShot = Yes
        End
    End










    Geometry            = BOX
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 300.0
    GeometryIsSmall     = No
    Shadow              = NONE






End



Object AngmarNecroCorpseRainProjectileMith

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = DE_Barrage
            ParticleSysBone Dummy BarrageProjectileFireMith FollowBone:Yes
            ParticleSysBone Dummy BarrageProjectileSmokeMith FollowBone:Yes
            ParticleSysBone Dummy BarrageProjectileEmbersMith FollowBone:Yes
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = DE_Barrage.DE_Barrage
                AnimationMode     = ONCE
            End
        End
      End

    EditorSorting            = SYSTEM
    KindOf                    = IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
    ForceLuaRegistration    = Yes
    ShroudClearingRange        = 100


    Body = ActiveBody ModuleTag_04
            MaxHealth = 99999.0
    End

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = 1000
        MaxLifetime = 1000
    End

    Behavior = SlowDeathBehavior ModuleTag_03
        DeathTypes = ALL
        FX = FINAL FX_CatapultHumanHeadsExplosion
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = AngmarCorpseRainPhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AngmarCorpseRainProjectileWeapon
            FireDelay = 600
            OneShot = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 300.0
    GeometryIsSmall     = No
    Shadow              = NONE
End



Object SpellBookBombardSeed
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = IMMOBILE UNATTACKABLE TAINTEFFECT

	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End

	Behavior = LifetimeUpdate ModuleTag_Lifetime
		MinLifetime = 3000
		MaxLifetime = 7000
	End

	Behavior = SlowDeathBehavior ModuleTag_SpawnRealTree
		OCL = FINAL OCL_SpellBookBombardProjectile
	End
End


Object SpellBookBombardProjectile

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = DE_Barrage
	        ParticleSysBone Dummy BarrageProjectileFire FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileSmoke FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileEmbers FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = DE_Barrage.DE_Barrage
		        AnimationMode     = ONCE
			End
		End
  	End

	EditorSorting			= SYSTEM
	KindOf					= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes
	ShroudClearingRange		= 100


	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_BombardExplosion
	End

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = BombardPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes
		End
		FireWeaponNugget
			WeaponName = BombardProjectileWeapon
			FireDelay = 600
			OneShot = Yes
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE
End


Object SpellBookBombardProjectileMith

 	Draw = W3DScriptedModelDraw ModuleTag_01
    	DefaultModelConditionState
	      	Model = DE_Barrage
	        ParticleSysBone Dummy BarrageProjectileFireMith FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileSmokeMith FollowBone:Yes
	        ParticleSysBone Dummy BarrageProjectileEmbersMith FollowBone:Yes
    	End
    	IdleAnimationState
			Animation = SPAWN
				AnimationName     = DE_Barrage.DE_Barrage
		        AnimationMode     = ONCE
			End
		End
  	End

	EditorSorting			= SYSTEM
	KindOf					= IMMOBILE UNATTACKABLE INERT NO_COLLIDE INERT_SHROUD_REVEALER
	ForceLuaRegistration	= Yes
	ShroudClearingRange		= 100


	Body = ActiveBody ModuleTag_04
    		MaxHealth = 99999.0
	End

	Behavior = LifetimeUpdate ModuleTag_02
		MinLifetime = 1000
		MaxLifetime = 1000
	End

	Behavior = SlowDeathBehavior ModuleTag_03
		DeathTypes = ALL
		FX = FINAL FX_BombardExplosionMith
	End

	Behavior = FireWeaponUpdate ModuleTag_DamageHandler
		FireWeaponNugget
			WeaponName = BombardPhaseInitialWeapon
			FireDelay = 0
			OneShot = Yes
		End
		FireWeaponNugget
			WeaponName = BombardProjectileWeapon
			FireDelay = 600
			OneShot = Yes
		End
	End

	Geometry            = BOX
	GeometryMajorRadius = 1.0
	GeometryMinorRadius = 1.0
	GeometryHeight      = 300.0
	GeometryIsSmall     = No
	Shadow              = NONE
End


Object TheFiresOfDoom

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
            Model = EXMeteor
            ParticleSysBone Meteor MeteorTrail FollowBone:Yes
            ParticleSysBone Meteor01 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor02 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor03 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor04 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor05 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor06 MeteorTrail2 FollowBone:Yes
            ParticleSysBone Meteor07 MeteorTrail2 FollowBone:Yes

            ParticleSysBone Meteor01 MeteorHit FollowBone:Yes
            ParticleSysBone Meteor02 MeteorHit FollowBone:Yes
            ParticleSysBone Meteor04 MeteorHit2 FollowBone:Yes
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXMeteor.EXMeteor
                AnimationMode     = ONCE
            End
        End
      End

    EditorSorting            = SYSTEM
    KindOf                   = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration     = Yes



    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 1800
        AnimationSound = Sound:SpellRainOfFireProjectileFlyBy    Animation:EXMeteor.EXMeteor        Frames: 20 49 55 61
        AnimationSound = Sound:ImpactRainOfFire                  Animation:EXMeteor.EXMeteor        Frames: 52 75 79 89
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth     = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = RainOfFirePhaseInitialWeapon
            FireDelay     = 0
            OneShot       = Yes
        End
        FireWeaponNugget
            WeaponName    = RainOfFirePhaseOneWeapon
            FireDelay     = 2500
            OneShot       = Yes
        End
    End

    Geometry            	= BOX
    GeometryMajorRadius 	= 10.0
    GeometryMinorRadius 	= 1.0
    GeometryHeight      	= 3.0
    GeometryIsSmall     	= No

    Shadow              	= SHADOW_ADDITIVE_DECAL_DYNAMIC
    ShadowSizeX         	= 400
    ShadowSizeY         	= 400
    ShadowTexture       	= EXLnzFlar1

    ShadowOpacityStart  	= 0
    ShadowOpacityFadeInTime 	= 1000
    ShadowOpacityPeak   	= 255
    ShadowOpacityFadeOutTime 	= 1000
    ShadowOpacityEnd    	= 0
End


Object SunflareSunbeam


    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = NONE
            ParticleSysBone     = None SunRays
            ParticleSysBone     = None SunFlareGlow
            ParticleSysBone     = None SunFlareProxy
        End
    End




    EditorSorting     = SYSTEM

    ArmorSet
        Armor = NoArmor
    End

    VisionRange = 0.0


    KindOf = IMMOBILE UNATTACKABLE INERT SCARY

    Body = ActiveBody ModuleTag_01
        MaxHealth = 99999.0
    End


    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = SPELL_SUNFLARE_DURATION
        MaxLifetime = SPELL_SUNFLARE_DURATION
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = SunflareWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
    End

    Behavior = AIUpdateInterface ModuleTag_03
        AILuaEventsList                = SunbeamFunctions
    End

      Geometry            = CYLINDER
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No

End


Object FearRadiator



    EditorSorting     = SYSTEM

    ArmorSet
        Armor = NoArmor
    End

    VisionRange = 0.0


    KindOf = IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_TheActiveBody
        MaxHealth = 99999.0
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius                    = 200
        EmotionPulseInterval                = 1000
        GenerateUncontrollableFear            = Yes
        InitiallyActive                        = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +ORC +URUK +MONSTER -HERO -STRUCTURE -DOZER ENEMIES

    End
End


ChildObject HaldirGoldenArrowDaylight FearRadiator
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = None
            ParticleSysBone        = None CloudBreakRays
        End
    End
    Behavior = LifetimeUpdate ModuleTag_01
        MinLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
        MaxLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
    End
End


ChildObject HaldirWhiteArrowDaylight FearRadiator
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = None
            ParticleSysBone        = None CloudBreakRaysGlorfindel
        End
    End
    Behavior = LifetimeUpdate ModuleTag_01
        MinLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
        MaxLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
    End
    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius                    = 125
        EmotionPulseInterval                = 1000
        GenerateFear                        = Yes
        InitiallyActive                        = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +ORC +URUK +MONSTER -HERO -STRUCTURE -DOZER ENEMIES
    End

        Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate2
        EmotionPulseRadius                    = 50
        EmotionPulseInterval                = 1000
        GenerateUncontrollableFear            = Yes
        InitiallyActive                        = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +ORC +URUK +MONSTER -HERO -STRUCTURE -DOZER ENEMIES
    End
End


ChildObject GlorfindelStarlightObject FearRadiator


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
      ParticleSysBone = None CloudBreakRays
    End








  End

    Behavior = LifetimeUpdate ModuleTag_01
        MinLifetime = SPELL_GLORFINDEL_STARLIGHT_DURATION_MS
        MaxLifetime = SPELL_GLORFINDEL_STARLIGHT_DURATION_MS
    End

    Behavior = AutoHealBehavior ModuleTag_HealUpdate
        StartsActive    = Yes
        HealingAmount    = 5.0
        HealingDelay    = 30
        Radius            = GLORFINDEL_STARLIGHT_RADIUS

    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
        StartsActive    = Yes
        BonusName        = GenericBuff
        RefreshDelay    = 2000
        Range            = GLORFINDEL_STARLIGHT_RADIUS
        ObjectFilter    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End
End


ChildObject GoldspitzenBuffObject FearRadiator



  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model               = None
      ParticleSysBone = None CloudBreakRays
    End

  End

    Behavior = LifetimeUpdate ModuleTag_01
        MinLifetime = 5000
        MaxLifetime = 5000
    End

End


Object MenLongShotObject

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = EXArrowVolleyL
              ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None ArrowStormEmbers
            ParticleSysBone None ArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes






    SoundAmbient        = LongshotRangerCall

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:LongshotFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:34
        AnimationSound = Sound:LongshotBowRelease                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:100
        AnimationSound = Sound:LongshotArrowBys                    Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:90

        AnimationSound = Sound:LongshotArrowImpacts                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:137
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
        FireWeaponNugget
            WeaponName    = MenLongShotWeaponReal
            FireDelay    = 4700
            OneShot        = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object GamlingLongShotObject

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = EXArrowVolleyL
              ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None ArrowStormEmbers
            ParticleSysBone None ArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes






    SoundAmbient        = LongshotRangerCall

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:LongshotFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:34
        AnimationSound = Sound:LongshotBowRelease                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:100
        AnimationSound = Sound:LongshotArrowBys                    Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:90

        AnimationSound = Sound:LongshotArrowImpacts                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:137
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
        FireWeaponNugget
            WeaponName    = GamlingLongShotWeaponReal
            FireDelay    = 4700
            OneShot        = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object SpellBookChillWind
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model           = none
        End
    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT




    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End


    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 3000
        MaxLifetime = 3000
    End



    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ChillWindWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
        FadeTime = 4000
            FadeDelay = 1000
    End


    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End



Object SpellBookArrowVolley

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = EXArrowVolleyL
              ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None ArrowStormEmbers
            ParticleSysBone None ArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes




    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:34
        AnimationSound = Sound:SpellArrowVolleyBowRelease                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:100
        AnimationSound = Sound:SpellArrowVolleyArrowBys                    Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:90
        AnimationSound = Sound:SpellArrowVolleyFlyOver                    Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:91
        AnimationSound = Sound:SpellArrowVolleyArrowImpacts                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:137
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
        FireWeaponNugget
            WeaponName    = ArrowVolleyOneWeapon
            FireDelay    = 4700
            OneShot        = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object ShellMapMD

    EditorSorting = SYSTEM
    Side          = Civilian
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT INERT_SHROUD_REVEALER CAN_CAST_REFLECTIONS


    Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
            Model = Shell02_01
        End
        IdleAnimationState
            Animation = IDLE
                AnimationName     = Shell02_01.Shell02_01
                AnimationMode     = LOOP
            End
        End
    End
End


Object ColorTableTestOBJ

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = ColorTableTest
              ParticleSysBone = Fire01 ColorTestFire FollowBone:Yes
            ParticleSysBone = Fire02 ColorTestFireball FollowBone:Yes
            ParticleSysBone = Smoke01 SmokeIsengardPitThin FollowBone:Yes
            ParticleSysBone = Smoke02 ElvenForgeSmoke FollowBone:Yes
            ParticleSysBone = Dust01 ColorTestDust01 FollowBone:Yes
            ParticleSysBone = Dust02 ColorTestDust02 FollowBone:Yes
            ParticleSysBone = Snow01 SnowColorTest FollowBone:Yes
            ParticleSysBone = Snow02 BoatDieing2 FollowBone:Yes
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes



    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End


    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object WaterSparkleTest




  EditorSorting = SYSTEM


  KindOf              = IMMOBILE IGNORE_FOR_VICTORY
  Draw                = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
      Model           = None
      ParticleSysBone = NONE WaterSparkleTest
    End
  End

  Geometry            = SPHERE
  GeometryMajorRadius = 0.8
  GeometryIsSmall     = Yes

End


Object ShroudRevealer_Bombard

    EditorSorting        = SYSTEM
    ShroudClearingRange    = EVIL_SHIP_BOMBARD_REVEAL_RADIUS


    KindOf              = IMMOBILE REVEAL_TO_ALL NOT_AUTOACQUIRABLE UNATTACKABLE

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model        = None
        End
    End

    Body = HighlanderBody ModuleTag_Body
        MaxHealth      = 1.0
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = EVIL_SHIP_BOMBARD_REVEAL_TIMEOUT
        MaxLifetime        = EVIL_SHIP_BOMBARD_REVEAL_TIMEOUT
    End

    Behavior = BezierProjectileBehavior ModuleTag_Projectile
        CrushStyle        = Yes
    End

    Geometry            = SPHERE
    GeometryMajorRadius = 0.8
    GeometryIsSmall     = Yes

End


ChildObject ShroudRevealer_BattleShip ShroudRevealer_Bombard

    ShroudClearingRange    = EVIL_SHIP_ANTI_SHIP_REVEAL_RADIUS

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = EVIL_SHIP_ANTI_SHIP_REVEAL_TIMEOUT
        MaxLifetime        = EVIL_SHIP_ANTI_SHIP_REVEAL_TIMEOUT
    End

End





Object IsengardDetonateRangedObj

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = EXArrowVolleyL
              ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None ArrowStormEmbers
            ParticleSysBone None ArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes




    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:SpellArrowVolleyFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:34
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 4000
        MaxLifetime = 4000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot        = Yes
        End





    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object AngmarLongIceShotObject

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
              Model = EXArrowVolleyL
              Texture        = EXArrowStorm.tga EXArrowStormIce.tga
                  ParticleSysBone Flame IceArrowVolleyTrail FollowBone:Yes
                  ParticleSysBone Flame IceArrowVolleyEmbers FollowBone:Yes
            ParticleSysBone Flame IceArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame IceArrowVolleyEmbers2 FollowBone:Yes
            ParticleSysBone Flame IceArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None IceArrowStormEmbers
            ParticleSysBone None IceArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes






    SoundAmbient        = LongshotRangerCall

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:LongshotFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL Frames:34
        AnimationSound = Sound:LongshotBowRelease            Animation:EXArrowVolleyL.EXArrowVolleyL Frames:100
        AnimationSound = Sound:LongshotArrowBys                Animation:EXArrowVolleyL.EXArrowVolleyL Frames:90

        AnimationSound = Sound:LongshotArrowImpacts            Animation:EXArrowVolleyL.EXArrowVolleyL Frames:137
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 7000
        MaxLifetime = 7000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot        = Yes
        End
        FireWeaponNugget
            WeaponName    = MenLongShotWeaponReal
            FireDelay    = 4700
            OneShot        = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object FrozenLandPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = FROZEN_LAND_EFFECT_DURATION
        MaxLifetime        = FROZEN_LAND_EFFECT_DURATION
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = Yes
        RefreshDelay    = 2000
        Range           = SPELLBOOK_TAINT_RADIUS
        TargetEnemy     = Yes
        AntiCategory    = LEADERSHIP BUFF
        BonusName       = FrozenLandDebuff
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION  -HERO -HORDE
    End

End

Object ArnorStorfeuerObject

     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model = EXArrowVolleyL
            ParticleSysBone Flame ArrowVolleyTrail FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyTrail2 FollowBone:Yes
            ParticleSysBone Flame ArrowVolleyFire FollowBone:Yes
            ParticleSysBone None ArrowStormDust
            ParticleSysBone None ArrowStormEmbers
            ParticleSysBone None ArrowStormShock
        End
        IdleAnimationState
            Animation = SPAWN
                AnimationName     = EXArrowVolleyL.EXArrowVolleyL
                AnimationMode     = ONCE
            End
        End
      End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes






    SoundAmbient        = LongshotRangerCall

    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 800
        AnimationSound = Sound:LongshotFireArrowWarningShot        Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:34
        AnimationSound = Sound:LongshotBowRelease                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:100
        AnimationSound = Sound:LongshotArrowBys                    Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:90

        AnimationSound = Sound:LongshotArrowImpacts                Animation:EXArrowVolleyL.EXArrowVolleyL    Frames:137
    End


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = ArrowVolleyPhaseInitialWeapon
            FireDelay    = 0
            OneShot      = Yes
        End
        FireWeaponNugget
            WeaponName   = ArnorStorfeuerWeaponReal
            FireDelay    = 4700
            OneShot      = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End



Object ObGilgaladPulse
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladPulse
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End


Object ObGilgaladWordofPower
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladsWordofPowerWeapon1
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End

Object ObGilgaladWordofPower2
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladsWordofPowerWeapon2
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End

Object ObGilgaladPulseRing
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladPulse
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End


Object ObGilgaladWordofPowerRing
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladsWordofPowerWeapon1Ring
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End

Object ObGilgaladWordofPower2Ring
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = GilgaladsWordofPowerWeapon2Ring
            FireDelay    = 0
            OneShot      = Yes
        End
    End
End


Object ObFeanorDeathWeapon
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = FeanorDeathWeaponFX
            FireDelay    = 0
            OneShot      = No
        End
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter          = ANY +NoldorFeanor +NoldorFeanor_AI -SHIP -CAVALRY -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS
        ScanRange             = 100000
        AlwaysTeleport        = No
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 8000
        MaxLifetime = 8000
    End
End


Object OathoftheFeanorPing

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = NONE
            ParticleSysBone     = None SunRays
            ParticleSysBone     = None SunFlareGlow
            ParticleSysBone     = None SunFlareProxy
        End
    End

    EditorSorting     = SYSTEM
    ThreatLevel     = 0

    ArmorSet
        Armor = NoArmor
    End

    VisionRange = 0.0


    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY SCARY

    Body = ActiveBody ModuleTag_01
        MaxHealth = 99999.0
    End


    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = 2500
        MaxLifetime = 2500
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
        StartsActive     = Yes
        BonusName        = FeanorOath
        RefreshDelay     = 2000
        Range            = 250
        ObjectFilter     = ANY +NoldorFeanor +NoldorFeanor_AI +NoldorMaedhros_Summoned +NoldorMaglor_Summoned +NoldorCelegorm_Summoned +NoldorCaranthir_Summoned +NoldorCurufin_Summoned +NoldorAmras_Summoned +NoldorAmrod_Summoned +FormenosBanner +FormenosArcher +FormenosGuard +FormenosEliteSword
    End
End


Object CurseMandosPing
  Draw = W3DScriptedModelDraw ModuleTag_Draw
     DefaultModelConditionState
        Model           = None
     End
  End

    Side                = Neutral
    IsTrainable         = No
    EditorSorting       = UNIT
    ThreatLevel         = 0.0

    KindOf = PRELOAD CAN_CAST_REFLECTIONS PATH_THROUGH_EACH_OTHER THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth        = 1
        InitialHealth    = 1
    End

    ArmorSet
        Conditions      = None
        Armor           = AttachIntrigeArmor
        DamageFX        = NormalDamageFX
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter = ANY +NoldorFeanor +NoldorFeanor_AI
        ScanRange               = 10
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = CurseMandosPingWeapon
            FireDelay    = 85000
            OneShot      = No
        End
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType    = CAMOUFLAGE
            DetectionRange      = 20
            Options             = DETECTED_BY_FRIENDLIES
        End
        UpdatePeriod            = 1000
        StartsActive            = Yes
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 130000
        MaxLifetime        = 130000
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight = 0.8
    GeometryIsSmall = Yes
End


Object FeanorSonsegg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 1000
        OCL                 = FINAL OCL_FeanorSons
    End
End






Object CarantirSilLightObject


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model           = bbox
      ParticleSysBone = NONE CarantirSilLightAura FollowBone:No
    End
  End

    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0

    ShroudClearingRange  = 1
    VisionRange          = 1


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = 30000
        MaxLifetime = 30000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +NoldorCaranthir +NoldorCaranthir_Summoned  ALLIES
        ScanRange               = 35
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius                  = 100
        EmotionPulseInterval                = 1000
        GenerateUncontrollableFear          = Yes
        InitiallyActive                     = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +ORC +MONSTER -HERO -STRUCTURE ENEMIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_DreadVisageAura
        StartsActive    = Yes
        RefreshDelay    = 2000
        Range           = 150
        TargetEnemy     = Yes
        AntiCategory    = LEADERSHIP BUFF
        BonusName       = CarantirSilLightModifier
        ObjectFilter    = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
    End
End






Object GondolinTowerPing
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE
    Side = Civilian
    EditorSorting = UNIT

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 10
        FX                  = INITIAL FX_GoldbeereWoodsFire2
    End
End






Object GondolinFountain

    SelectPortrait = BPGWell

  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
        Model = GBWell
        Shadow                      = SHADOW_ALPHA_DECAL_DYNAMIC
        ShadowSizeX                 = 250
        ShadowSizeY                 = 250
        ShadowTexture               = SCCElvenSummon
        ShadowOpacityStart          = 0
        ShadowOpacityFadeInTime     = 1000
        ShadowOpacityPeak           = 255
        ShadowOpacityFadeOutTime    = 1000
        ShadowOpacityEnd            = 0
        ShadowOverrideLODVisibility = Yes
    End
  End



    DisplayName                  = OBJECT:GondorWell
    EditorSorting                = STRUCTURE
    Side                         = Imladris
    VisionRange                  = VISION_BASE_DEFENSE
    ShroudClearingRange          = SHROUD_CLEAR_BASE_DEFENSE
    MaxSimultaneousOfType        = 1

    RadarPriority                = UNIT
    ThreatLevel                  = 11.0
    IsTrainable                  = No

    CommandSet                    = SellableCommandSet

    WeaponSet
        Conditions                = None
        Weapon                    = PRIMARY WellEnemyNearWeapon
    End

    ArmorSet
        Conditions                = None
        Armor                     = StructureArmor
    End



    SoundAmbient                        = WaterFountain1AmbientLoop

    SoundOnDamaged                    = BuildingLightDamageStone
    SoundOnReallyDamaged            = BuildingHeavyDamageStone



    KindOf = PRELOAD STRUCTURE IMMOBILE SCORE CAN_ATTACK SCARY

    Body = StructureBody ModuleTag_05
        MaxHealth                   = 1500
        MaxHealthDamaged            = 400
        MaxHealthReallyDamaged      = 200
    End

    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
        AutoAcquireEnemiesWhenIdle     = Yes
        MoodAttackCheckRate            = 250
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_GateDebuff
        StartsActive            = Yes
        BonusName               = StandardDebuff
        RefreshDelay            = 2000
        Range                   = 180
        TargetEnemy             = Yes
        ObjectFilter            = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

    Behavior = FireWeaponUpdate ModuleTag_WeaponFiring
        FireWeaponNugget
            WeaponName             = WellHealWeapon
            Offset             = X:0 Y:0 Z:0
            FireDelay             = 0
            OneShot             = No
        End
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_ElvenGroveOnelvenGrove
        StartsActive            = Yes
        BonusName               = GondolinFountainBonus
        RefreshDelay            = 2000
        Range                   = 180
        ObjectFilter            = NONE +HERO ALLIES
        RunWhileDead            = Yes
    End

    Behavior = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate
        MinCollapseDelay            = 000
        MaxCollapseDelay            = 000
        CollapseDamping                 = .5
        MaxShudder                  = 0.6
        MinBurstDelay               = 250
        MaxBurstDelay               = 800
        BigBurstFrequency           = 4
        FXList                      = INITIAL       FX_StructureMediumCollapseNoSound
        FXList                      = ALMOST_FINAL  FX_StructureAlmostCollapse
        DestroyObjectWhenDone       = Yes
        CollapseHeight              = 60
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime              = 60000
        MaxLifetime              = 60000
        DeathType                = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchTrigger2
        DeathTypes               = ALL
        DestructionDelay         = 4000
        Weapon                   = FINAL WellEnemyNearWeapon
    End


    Scale                 = 0.82
    Geometry              = BOX
    GeometryMajorRadius   = 51
    GeometryMinorRadius   = 18
    GeometryHeight        = 105
    GeometryIsSmall       = No
    GeometryOffset        = X:0 Y:32 Z:0
    Shadow                = SHADOW_VOLUME
End






Object ThingolLordoftheForestBonus

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
          Model = PTElvnWood01
            Shadow                      = SHADOW_ALPHA_DECAL_DYNAMIC
            ShadowSizeX                 = 360
            ShadowSizeY                 = 360
            ShadowTexture               = SCCElvenSummon
            ShadowOpacityStart          = 0
            ShadowOpacityFadeInTime     = 1000
            ShadowOpacityPeak           = 175
            ShadowOpacityFadeOutTime    = 1000
            ShadowOpacityEnd            = 0
            ShadowOverrideLODVisibility = Yes
    End

    IdleAnimationState
      Animation = IDLA
        AnimationName = PTElvnWood01.PTElvnWood01
        AnimationMode = ONCE
      End
    End
  End


  DisplayName = OBJECT:Tree
  EditorSorting = MISC_MAN_MADE


  KindOf = IMMOBILE UNATTACKABLE

  Body = ActiveBody ModuleTag_01
    MaxHealth = 99999.0
  End

    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
        EffectRadius         = 320
        PingDelay            = 2000
        HealPercentPerSecond = 3%
        AllowFilter          = ANY +INFANTRY +CAVALRY +HERO -MACHINE +MONSTER -IMMOBILE +DOZER ALLIES
        NonStackable         = Yes
        HealFX               = FX_SpellHealUnitHealBuff
    End

  Geometry = CYLINDER
  GeometryMajorRadius = 8.0
  GeometryMinorRadius = 8.0
  GeometryHeight = 38.4
  GeometryIsSmall = Yes
End


Object ThingolLightHopePing


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model           = MMDGRTHALLCNTRB
    End
  End

    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    ArmorSet
        Armor = NoArmor
    End

    VisionRange = 0.0

    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = 25000
        MaxLifetime = 25000
    End

    Scale = 1.7

    Behavior = SubObjectsUpgrade ModuleTag_Making
        TriggeredBy       = Upgrade_AllFactionUpgrade
        HideSubObjects    = BOW_04 BOX48 GROUND
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership1
        StartsActive     = Yes
        BonusName        = ThingolLightHope_Heal
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = ANY +HERO ALLIES
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership2
        StartsActive     = Yes
        BonusName        = ThingolLightHope_Army
        RefreshDelay     = 2000
        Range            = 200
        ObjectFilter     = ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -MACHINE -SHIP ALLIES
    End
End






Object MablungGraceofMerethAderthadProjectile


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = NONE
    End
  End




  EditorSorting     = SYSTEM
  ArmorSet
    Armor = NoArmor
  End
  VisionRange = 0.0


  KindOf = PROJECTILE
  Body = ActiveBody ModuleTag_02
    MaxHealth       = 10.0
  End

  Behavior = DestroyDie ModuleTag_03

  End

  Behavior = BezierProjectileBehavior ModuleTag_04
    FirstHeight = 60
    SecondHeight = 80
    FirstPercentIndent = 20%
    SecondPercentIndent = 90%
    FlightPathAdjustDistPerSecond = 50
    DetonateCallsKill = Yes
    CurveFlattenMinDist = 200
  End

  Behavior = PhysicsBehavior ModuleTag_05
    KillWhenRestingOnGround = Yes
    GravityMult = 0.0
  End

  Behavior = FXListDie ModuleTag_07
    DeathTypes = ALL
  End

    Behavior = CreateObjectDie ModuleTag_GoldenArrow
        DeathTypes = ALL
        CreationList = OCL_MablungGraceofMerethAderthad
    End

  Geometry = Sphere
  GeometryIsSmall = Yes
  GeometryMajorRadius = 0.8
End


Object MablungGraceofMerethAderthadPing

  Draw = W3DScriptedModelDraw ModuleTag_Draw
     DefaultModelConditionState
        Model           = None
     End
  End

    Side                = Neutral
    IsTrainable         = No
    EditorSorting       = UNIT
    ThreatLevel         = 0.0

    KindOf = PRELOAD CAN_CAST_REFLECTIONS PATH_THROUGH_EACH_OTHER THROWN_OBJECT ATTACK_NEEDS_LINE_OF_SIGHT NOTIFY_OF_PREATTACK

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth        = 1
        InitialHealth    = 1
    End

    ArmorSet
        Conditions      = None
        Armor           = AttachIntrigeArmor
        DamageFX        = NormalDamageFX
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter          = ANY +INFANTRY +CAVALRY -MONSTER -HERO -STRUCTURE ALLIES
        ScanRange             = 30
        AlwaysTeleport        = No
        AnchorToTopOfGeometry = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = MablungGraceofMerethAderthadPingWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_FizzleDeath
        DeathTypes = ALL
        DestructionDelay = 0
    End

    Behavior = InvisibilityUpdate ModuleTag_Camouflage
        InvisibilityNugget
            InvisibilityType    = CAMOUFLAGE
            DetectionRange      = 20
            Options             = DETECTED_BY_FRIENDLIES
        End
        UpdatePeriod            = 1000
        StartsActive            = Yes
    End

    Geometry 		= CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight 	= 0.8
    GeometryIsSmall 	= Yes
End


Object MablungEpesseShock
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 10
        Weapon              = MIDPOINT MablungEpesseShockWeapon
    End
End






Object MelianEnchantmentBeltWeaponEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 10
        Weapon              = MIDPOINT MelianEnchantmentBeltWeapon
        OCL                 = MIDPOINT OCL_MelianEnchantmentBeltSpawn
    End
End


Object MelianEnchantmentBeltBonusPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 2000
        MaxLifetime        = 2000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler2
        FireWeaponNugget
            WeaponName   = MelianEnchantmentBeltBonusWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End
End


Object MelianEnchantmentBeltObject

    Draw = W3DScriptedModelDraw ModuleTag_DRAW

       DefaultModelConditionState
            Model = mumofx
       End
    End

       Behavior = SubObjectsUpgrade ModuleTag_MakingTheMollok
            TriggeredBy        = Upgrade_AllFactionUpgrade
            HideSubObjects     = WATER TUBE15
       End

    Scale = 1.8
    EditorSorting            = SYSTEM
    KindOf                   = IMMOBILE UNATTACKABLE INERT NO_COLLIDE


    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 9000.0
        MaxLifetime = 9000.0
    End
End




Object PalantirSunbeam
    
    ;// *** ART Parameters ***
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = NONE
            ParticleSysBone        = None PalantirSunRays
            ParticleSysBone        = None SunFlareGlow
            ParticleSysBone        = None SunFlareProxy
        End
    End

    ;// *** AUDIO Parameters ***

    ;// ***DESIGN parameters ***
    EditorSorting     = SYSTEM
    
    ArmorSet
        Armor = NoArmor
    End
    
    VisionRange = 0.0

    ;// *** ENGINEERING Parameters ***
    KindOf = IMMOBILE UNATTACKABLE INERT SCARY

    Body = ActiveBody ModuleTag_01
        MaxHealth = 99999.0
    End

    ;// the following two modules control death fade -- uses alpha for now
    Behavior = LifetimeUpdate ModuleTag_02
        MinLifetime = SPELL_SUNFLARE_DURATION   ;// min lifetime in msec
        MaxLifetime = SPELL_SUNFLARE_DURATION   ;// max lifetime in msec
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName    = PalantirSunbeamWeapon
            FireDelay    = 0
            OneShot        = Yes    ;// Alternative is to fire as often as the reload time of this weapon allows
        End
    End

    Behavior = AIUpdateInterface ModuleTag_03    
        AILuaEventsList                = SunbeamFunctions
    End

      Geometry            = CYLINDER
    GeometryMajorRadius = 50.0
    GeometryMinorRadius = 50.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No
    
End




Object PalantirPower

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
              Model = None
    ParticleSysBone = None Shaker1
    ParticleSysBone    = None Shaker2
      ParticleSysBone        = None ArnorSunFlareGlow
      ParticleSysBone      = None ArnorIceTrailEmbers
      ParticleSysBone Dummy BarrageProjectileEmbers FollowBone:Yes
      End    
      End
    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT 
    ForceLuaRegistration = Yes ; I have no AI, but I want to send a fear message so please register me.
    
    ; *** AUDIO Parameters ***
    
    ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
        MaxUpdateRangeCap = 1800
        ;AnimationSound = Sound:SpellRainOfFireProjectileFlyBy    Animation:EXMeteor.EXMeteor        Frames: 20 49 55 61
        AnimationSound = Sound:ImpactRainOfFire                    Animation:EXMeteor.EXMeteor        Frames: 52 75 79 89
        ;AnimationSound = Sound:SpellRainOfFirePlume                Animation:EXMeteor.EXMeteor        Frames: 85
    End
        
    ; *** ENGINEERING Parameters ***
    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1    
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03 ; Not LifetimeUpdate, since I can't die.  This will DestroyObject me. 
        MinLifetime = 10000
        MaxLifetime = 10000
    End
    
    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = PalantirPowerWeapon
            FireDelay = 0
            OneShot = Yes    ; Alternative is to fire as often as the reload time of this weapon allows
        End
        
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE ; doesn't actually have a model...
End




Object ManweTornado_02



    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        DefaultModelConditionState
            Model           = EXTornado_SKN
            ParticleSysBone = NONE TornadoDust01
            ParticleSysBone = NONE TornadoDust02


            ParticleSysBone = NONE TornadoMagic01
            ParticleSysBone = NONE TornadoMagic02
            ParticleSysBone = NONE TornadoMagic03
            ParticleSysBone = B_TORNADO11 TornadoLightning FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning1 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning2 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning3 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning4 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning5 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning6 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning7 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning8 FOLLOWBONE:Yes
            ParticleSysBone = B_TORNADO11 TornadoLightning9 FOLLOWBONE:Yes
        End

        IdleAnimationState
            StateName = State_Idle
            Animation = tornadodefault
                AnimationName = EXTornado_SKL.EXTornado_IDLA
                AnimationMode = ONCE
                AnimationBlendTime = 30
                AnimationSpeedFactorRange = 0.3 0.4
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_JustBuilt"
                    then CurDrawableSetTransitionAnimState("TRANS_JustBuilt_To_Idle")
                end
            EndScript
        End


        AnimationState                = JUST_BUILT
            StateName                = State_JustBuilt
            Animation
                AnimationName        = EXTornado_SKL.EXTornado_SMNA
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
            End
        End
        TransitionState = TRANS_JustBuilt_To_Idle
            Animation = BeingSummoned
                AnimationName = EXTornado_SMNA
                AnimationMode = ONCE
            End

        End
    End

    Draw = W3DTornadoDraw ModuleTag_TornadoDraw
        DecalTemplate
              Texture        = EXTornadoGround
            Style          = SHADOW_ALPHA_DECAL
            OpacityMin     = 5%
            OpacityMax     = 20%
            MaxRadius       = 300.0
            Color          = R:200 G:200 B:200 A:255
            OnlyVisibleToOwningPlayer = Yes
            RotationsPerMinute = 0.4
            SpiralAcceleration = 1.0
        End
        DecalCount        = 7
        DecalMaxRadius    = 300.0

    End




    EditorSorting    = SYSTEM
    ThreatLevel        = 0.0










    EvaEnemyObjectSightedEvent = None

    SoundAmbient    = TornadoLoopMS
    SoundMoveStart    = TornadoMoveStart

    VoiceAttack        = TornadoSelect
    VoiceMove        = TornadoSelect
    VoiceSelect        = TornadoSelect



    RadarPriority = UNIT
    KindOf = NO_COLLIDE IMMOBILE AIRCRAFT UNATTACKABLE ORIENTS_TO_CAMERA CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL PASS_EXPERIENCE_TO_PRODUCER

    Body = HighlanderBody ModuleTag_02
    MaxHealth         = 1.0
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior        ModuleTag_PhysicsBehavior
    End







    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
    MinLifetime        = 40000
    MaxLifetime        = 40000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +ValinorManwe_Summoned +ValinorManwe +ValinorManwe_WOR -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS
        ScanRange               = 20
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive        = Yes
        BonusName           = EyeOfSauronFear
        RefreshDelay        = 1000
        Range               = 150.0
        ObjectFilter        = ANY +INFANTRY +CAVALRY
        TargetEnemy         = Yes
        MaxActiveRank       = 5
    End

    Behavior = FireWeaponUpdate ModuleTag_WINDY
    FireWeaponNugget
        WeaponName = TornadoWindWeapon
        FireDelay = 0
        OneShot = No
    End
    End

    Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL
    End

    Geometry         = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight    = 1.0
    GeometryIsSmall    = Yes
End


Object ManweTornado



    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        DefaultModelConditionState
            Model           = EXTornado_SKN

            ParticleSysBone = NONE TornadoDebris01
            ParticleSysBone = NONE TornadoDebris02
            ParticleSysBone = NONE TornadoDust01
            ParticleSysBone = NONE TornadoDust02
        End

        IdleAnimationState
            StateName = State_Idle
            Animation = tornadodefault
                AnimationName = EXTornado_SKL.EXTornado_IDLA
                AnimationMode = ONCE
                AnimationBlendTime = 30
                AnimationSpeedFactorRange = 0.3 0.4
            End


            BeginScript
                Prev = CurDrawablePrevAnimationState()
                if Prev == "State_JustBuilt"
                    then CurDrawableSetTransitionAnimState("TRANS_JustBuilt_To_Idle")
                end
            EndScript
        End

        AnimationState                = JUST_BUILT
            StateName                = State_JustBuilt
            Animation
                AnimationName        = EXTornado_SKL.EXTornado_SMNA
                AnimationMode        = ONCE
                AnimationBlendTime    = 0
            End
        End
        TransitionState = TRANS_JustBuilt_To_Idle
            Animation = BeingSummoned
                AnimationName = EXTornado_SMNA
                AnimationMode = ONCE
            End

        End
    End

    Draw = W3DTornadoDraw ModuleTag_TornadoDraw

        DecalTemplate
              Texture        = EXTornadoGround
            Style          = SHADOW_ALPHA_DECAL
            OpacityMin     = 5%
            OpacityMax     = 20%
            MaxRadius       = 300.0
            Color          = R:200 G:200 B:200 A:255
            OnlyVisibleToOwningPlayer = Yes
            RotationsPerMinute = 0.4
            SpiralAcceleration = 1.0
        End
        DecalCount        = 7
        DecalMaxRadius    = 300.0
    End


    Side            = Men
    EditorSorting    = UNIT
    ThreatLevel        = 0.0
    CommandPoints    = 0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS

    VisionRange        = 200.0
    DisplayName        = OBJECT:NaturesWrath

    CommandSet        = EmptyCommandSet




    EvaEnemyObjectSightedEvent = None

    SoundAmbient    = TornadoLoopMS
    SoundMoveStart    = TornadoMoveStart

    VoiceAttack        = TornadoSelect
    VoiceMove        = TornadoSelect
    VoiceSelect        = TornadoSelect



    RadarPriority = UNIT
    KindOf = NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY ORIENTS_TO_CAMERA CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL PASS_EXPERIENCE_TO_PRODUCER

    Body = HighlanderBody ModuleTag_02
        MaxHealth         = 1.0
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior        ModuleTag_PhysicsBehavior
    End







    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
    MinLifetime        = 40000
    MaxLifetime        = 40000
    End

    Behavior = FireWeaponUpdate ModuleTag_WINDY
        FireWeaponNugget
            WeaponName = TornadoWindWeapon
            FireDelay = 0
            OneShot = No
        End
    End


    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +ValinorManwe_Summoned +ValinorManwe +ValinorManwe_WOR -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS
        ScanRange               = 20
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive    = Yes
        BonusName        = EyeOfSauronFear
        RefreshDelay    = 1000
        Range            = 150.0
        ObjectFilter    = ANY +INFANTRY +CAVALRY
        TargetEnemy        = Yes
        MaxActiveRank    = 5
    End



    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight        = 1.0
    GeometryIsSmall        = Yes
End






Object TindomielLoudwaterProjectile


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
      Model = EUWaterHrs_skn
      ParticleSysBone ROOTTRANSFORM WaterHorseWind FollowBone:Yes
      ParticleSysBone ROOTTRANSFORM WaterHorsesAttackWater FollowBone:Yes
      ParticleSysBone     = None WaterHorseTrail
      ParticleSysBone     = None WaterHorseTrail2
      ParticleSysBone     = None WaterHorseTrail3
    End

       IdleAnimationState
        StateName                    =   STATE_Idle
        Animation = IdleA
            AnimationName       = NUHorse_SKL.NUHorse_RUNA
            AnimationPriority    = 10
            AnimationMode       = Loop
        End
            FXEvent            = Frame:4 Name:FX_WaterHorseStep1
            FXEvent            = Frame:12 Name:FX_WaterHorseStep1
            FXEvent            = Frame:6 Name:FX_WaterHorseStep2
            FXEvent            = Frame:14  Name:FX_WaterHorseStep2
        End
End

    Draw = W3DScriptedModelDraw DustEffects
        DefaultModelConditionState
          Model = None
        End
        IdleAnimationState
        End
        AnimationState = MOVING WADING
            ParticleSysBone = None FootstepSlash EntSplash
        End
        AnimationState = MOVING ACCELERATE
            ParticleSysBone = None FootstepSlash EntSplash
        End
        AnimationState = MOVING DECELERATE
            ParticleSysBone = None FootstepSlash EntSplash
        End
        AnimationState = MOVING
            ParticleSysBone = None FootstepSlash EntSplash
        End
    End




  EditorSorting     = SYSTEM
  ArmorSet
    Armor = NoArmor
  End
  VisionRange = 0.0

    CrusherLevel = 2

    CrushWeapon = KnightCrush

    MinCrushVelocityPercent = MINCRUSHVELOCITYPERCENT_STANDARD
    CrushDecelerationPercent = CRUSHDECELERATIONPERCENT_STANDARD

    RamPower = 30
    RamZMult = 0.5


  KindOf = PROJECTILE
  Body = ActiveBody ModuleTag_02
    MaxHealth       = 10.0
  End

  Behavior = DestroyDie ModuleTag_03

  End

  Behavior = BezierProjectileBehavior ModuleTag_04
    FirstHeight = 9
    SecondHeight = 9
    FirstPercentIndent = 20%
    SecondPercentIndent = 100%
    FlightPathAdjustDistPerSecond = 50
    DetonateCallsKill = Yes
    CurveFlattenMinDist = 50.0
  End

  Behavior = PhysicsBehavior ModuleTag_05
    KillWhenRestingOnGround = Yes
    GravityMult = 0.0
  End

  Behavior = FXListDie ModuleTag_07
    DeathTypes = ALL
    DeathFX = FX_WaterHorsesAttackExplode
  End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = ArveduiHeroEffect
            FireDelay    = 0
            OneShot      = No
        End
    End

  Geometry = Sphere
  GeometryIsSmall = Yes
  GeometryMajorRadius = 0.8
  Scale = 1.4
End






Object IngweGalathilionTree

    SelectPortrait = BPGCamp_Plot

  Draw = W3DScriptedModelDraw ModuleTag_01
    DefaultModelConditionState
        Model = GBSlvrTree
        Shadow                      = SHADOW_ALPHA_DECAL_DYNAMIC
        ShadowSizeX                 = 250
        ShadowSizeY                 = 250
        ShadowTexture               = SCCElvenSummon
        ShadowOpacityStart          = 0
        ShadowOpacityFadeInTime     = 1000
        ShadowOpacityPeak           = 255
        ShadowOpacityFadeOutTime    = 1000
        ShadowOpacityEnd            = 0
        ShadowOverrideLODVisibility = Yes
        ParticleSysBone             = NONE FireFlies02 FollowBone:Yes
    End
  End


    MaxSimultaneousOfType = 1
    DisplayName          = OBJECT:GalathilionTree
    EditorSorting        = STRUCTURE
    Side                 = Rohan
    VisionRange          = VISION_BASE_DEFENSE
    ShroudClearingRange  = SHROUD_CLEAR_BASE_DEFENSE
    KindOf               = PRELOAD STRUCTURE IMMOBILE SCORE CAN_ATTACK SCARY

    RadarPriority        = UNIT
    ThreatLevel          = 11.0
    IsTrainable          = No





    Body                      = StructureBody ModuleTag_05
        MaxHealth               = MORDOR_GATEWATCHEREXPANSION_HEALTH
        MaxHealthDamaged        = MORDOR_GATEWATCHEREXPANSION_HEALTH_DAMAGED
        MaxHealthReallyDamaged  = MORDOR_GATEWATCHEREXPANSION_HEALTH_REALLY_DAMAGED
    End

    CommandSet            = SellableCommandSet

    ArmorSet
        Conditions        = None
        Armor             = FortressExpansionArmor
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_GateDebuff
        StartsActive    = Yes
        BonusName       = StandardDebuff
        RefreshDelay    = 2000
        Range           = 180
        TargetEnemy     = Yes
        ObjectFilter    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End

    Behavior = PassiveAreaEffectBehavior ModuleTag_SplashOfHealingWater_Ahh
    EffectRadius        = 180
    PingDelay        = 2000
    HealPercentPerSecond    = 3%
    AllowFilter        = ANY +INFANTRY +CAVALRY -MACHINE -IMMOBILE +DOZER
    NonStackable        = Yes
    HealFX            = FX_SpellHealUnitHealBuff
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_ElvenGroveOnelvenGrove
        StartsActive    = Yes
        BonusName       = GalathilionTreeBonus
        RefreshDelay    = 2000
        Range           = 180
        ObjectFilter    = NONE +HERO ALLIES
        RunWhileDead    = Yes
    End


    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
        AutoAcquireEnemiesWhenIdle    = Yes
        MoodAttackCheckRate           = 250
    End


    Behavior = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate
        MinCollapseDelay        = 000
        MaxCollapseDelay        = 000
        CollapseDamping         = .5
        MaxShudder              = 0.6
        MinBurstDelay           = 250
        MaxBurstDelay           = 800
        BigBurstFrequency       = 4
        FXList                  = INITIAL   FX_StructureMediumCollapseNoSound
        FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
        DestroyObjectWhenDone   = Yes
        CollapseHeight          = 60
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 60000
        MaxLifetime      = 60000
        DeathType        = FADED
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchTrigger
        DeathTypes       = NONE +FADED
        DestructionDelay = 4000
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchTrigger2
        DeathTypes       = ALL
        DestructionDelay = 4000
    End


    Shadow               = SHADOW_VOLUME
    Geometry             = CYLINDER
    GeometryMajorRadius  = 5.0
    GeometryHeight       = 20.0
    GeometryIsSmall      = No
    BuildCompletion      = PLACED_BY_PLAYER
    GeometryContactPoint = X:0.0    Y:0.0        Z:0
    GeometryContactPoint = X:0.0    Y:0.0        Z:20.0        Swoop
End


Object IngweLightMindonEldalieva

    ButtonImage    = HSLightMindonEldalieva
    SelectPortrait = HSLightMindonEldalieva

    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        NoRotate = Yes

        DefaultModelConditionState
            Model           = EXMarker
        End
    End


    Side                  = Rohan
    EditorSorting         = UNIT
    ThingClass            = CHARACTER_UNIT
    ThreatLevel           = 0.0
    CommandPoints         = 0
    ShockwaveResistance   = SHOCKWAVE_RESISTANCE_IMMUNE
    MaxSimultaneousOfType = 2
    VisionRange           = 150.0
    DisplayName           = OBJECT:LightMindonEldalieva
    CommandSet            = EmptyCommandSet

    EvaEnemyObjectSightedEvent = None
    SoundAmbient               = TornadoLoopMS
    SoundMoveStart             = TornadoMoveStart
    SoundCreated               = SpellCloudBreakStereo
    VoiceAttack                = TornadoSelect
    VoiceMove                  = TornadoSelect
    VoiceSelect                = TornadoSelect


    RadarPriority = UNIT
    KindOf = SELECTABLE NO_COLLIDE AIRCRAFT UNATTACKABLE MOVE_ONLY CLICK_THROUGH HERO IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL PASS_EXPERIENCE_TO_PRODUCER

    Body = ActiveBody ModuleTag_02
        MaxHealth         = 200000
    End

    Behavior = AIUpdateInterface    ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior        ModuleTag_PhysicsBehavior
    End

    Behavior = FireWeaponUpdate ModuleTag_WINDY
        FireWeaponNugget
            WeaponName = LightMindonEldalievaWeapon
            FireDelay  = 0
            OneShot    = No
        End
    End

    LocomotorSet
        Locomotor = EyeLocomotor
        Condition = SET_NORMAL
        Speed     = 120
    End

    Behavior = LifetimeUpdate ModuleTag_03
        MinLifetime = 18000
        MaxLifetime = 18000
    End

    Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
        DetectionRate       = 500
        CancelOneRingEffect = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive        = Yes
        BonusName           = EyeOfSauronFear
        RefreshDelay        = 1000
        Range               = 100.0
        ObjectFilter        = ANY +INFANTRY +CAVALRY
        TargetEnemy         = Yes
        MaxActiveRank       = 5
    End

    Behavior = AutoHealBehavior ModuleTag_HealUpdate
        StartsActive     = Yes
        HealingAmount    = 5.0
        HealingDelay     = 40
        Radius           = 80
    End

    Behavior = SlowDeathBehavior ModuleTag_05
        DeathTypes = ALL
    End

    Geometry = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight        = 1.0
    GeometryIsSmall        = Yes
    Shadow              = SHADOW_ADDITIVE_DECAL_DYNAMIC
    ShadowSizeX         = 200
    ShadowSizeY         = 200
    ShadowTexture       = exspotlight
    ShadowOpacityStart       = 0
    ShadowOpacityFadeInTime  = 1000
    ShadowOpacityPeak        = 255
    ShadowOpacityFadeOutTime = 1000
    ShadowOpacityEnd         = 0
    ShadowOverrideLODVisibility = Yes
End


Object IngweEalentriStormBlast

    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        DefaultModelConditionState
            Model           = None
            ParticleSysBone = NONE IngweEalentriFlare01
            ParticleSysBone = NONE IngweEalentriFlare02
        End
    End

    EvaEnemyObjectSightedEvent = None


    EditorSorting   = SYSTEM
    KindOf   = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel        = 0




    SoundAmbient    = SarumanLightningMS
    SoundMoveStart  = SarumanLightningMS

    VoiceAttack     = SarumanLightningMS
    VoiceMove       = SarumanLightningMS
    VoiceSelect     = SarumanLightningMS



    Body = ActiveBody ModuleTag_02
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 25000
        MaxLifetime        = 25000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = NONE +VanyarIngwe +VanyarIngwe_AI
        ScanRange               = 20
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_WINDY
        FireWeaponNugget
            WeaponName = IngweEalentriStormBlastWeapon
            FireDelay = 0
            OneShot = No
        End
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive    = Yes
        BonusName       = EyeOfSauronFear
        RefreshDelay    = 1000
        Range           = 150.0
        ObjectFilter    = ANY +INFANTRY +CAVALRY
        TargetEnemy     = Yes
        MaxActiveRank   = 1
    End
End


Object IngweEalentriStormPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 25000
        MaxLifetime        = 25000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = NONE +VanyarIngwe +VanyarIngwe_AI
        ScanRange               = 20
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = IngweEalentriStormlWindWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End
End






Object EdainTurinAnglachelPing

    Draw = W3DScriptedModelDraw ModuleTag_Draw
        UseStandardModelNames    = Yes

        DefaultModelConditionState
            Model = None
        End
    End

    Side                    = Rohan
    EditorSorting           = UNIT
    ThreatLevel             = 11.0
    IsTrainable             = No
    BuildCost               = ELVEN_FLOODGATEEXPANSION_BUILDCOST
    BuildTime               = ELVEN_FLOODGATEEXPANSION_BUILDTIME
    VisionRange             = VISION_BASE_DEFENSE
    ShroudClearingRange     = SHROUD_CLEAR_BASE_DEFENSE

    CommandSet  = EmptyCommandset


      WeaponSet
          Weapon              = PRIMARY AnglachelWeapon
          AutoChooseSources   = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
      End



    RadarPriority       = UNIT
    KindOf              = PRELOAD INERT IMMOBILE UNATTACKABLE AUTO_RALLYPOINT SCORE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 5000
        MaxLifetime = 5000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +EdainTurin +EdainTurin_AI -SHIP -CAVALRY -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS
        ScanRange               = 15
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = ProductionUpdate ProductionUpdateModuleTag
    End

    Behavior = QueueProductionExitUpdate QueueProductionModuleTag
        UnitCreatePoint      = X:-73.206 Y:17.888 Z:0.0
        NaturalRallyPoint    = X:-170.0 Y:21.0 Z:0.0
        ExitDelay            = 50
    End

    Behavior = AIUpdateInterface ModuleTag_SoWeCanUseWeapon
        AutoAcquireEnemiesWhenIdle    = Yes
        MoodAttackCheckRate            = 250
    End
End


Object AnglachelProjectile

    EditorSorting        = SYSTEM
    VisionRange            = 0.0
    KindOf                = PROJECTILE

    ArmorSet
        Armor = NoArmor
    End

    Body = ActiveBody ModuleTag_02
        MaxHealth       = 10.0
    End

    Behavior = DestroyDie ModuleTag_03

    End

    Behavior = BezierProjectileBehavior ModuleTag_04
        FirstHeight                        = 9
        SecondHeight                    = 9
        FirstPercentIndent                = 20%
        SecondPercentIndent                = 100%
        FlightPathAdjustDistPerSecond    = 50
        DetonateCallsKill                = Yes
        CurveFlattenMinDist                = 50.0
    End

    Behavior = PhysicsBehavior ModuleTag_05
        KillWhenRestingOnGround = Yes
        GravityMult                = 0.0
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 0
        OCL                 = FINAL OCL_AnglachelLightning
    End

    Geometry            = Sphere
    GeometryIsSmall        = Yes
    GeometryMajorRadius = 0.8
End






Object EonweManweHeralFearPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 45000
        MaxLifetime        = 45000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ScanRange               = 100000
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler2
        FireWeaponNugget
            WeaponName   = EonweManweHeralFearWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End
End


Object EonweElentriStarlight


    Draw = W3DScriptedModelDraw ModuleTag_01
        OkToChangeModelColor = Yes
        NoRotate = Yes

        DefaultModelConditionState
            Model           = EXMarker
        End
    End

    EvaEnemyObjectSightedEvent = None


    EditorSorting   = SYSTEM
    ThreatLevel        = 0.0




    EvaEnemyObjectSightedEvent = None
    SoundAmbient               = TornadoLoopMS
    SoundMoveStart             = TornadoMoveStart
    SoundCreated               = SpellCloudBreakStereo

    VoiceAttack                = TornadoSelect
    VoiceMove                  = TornadoSelect
    VoiceSelect                = TornadoSelect



    KindOf            = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY

    Body = ActiveBody ModuleTag_02
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_03
        MinLifetime = 30000
        MaxLifetime = 30000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +ValinorEonwe_Summoned +ValinorEonwe +ValinorEonwe_WOR -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS
        ScanRange               = 20
        AlwaysTeleport          = No
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive        = Yes
        BonusName           = EyeOfSauronFear
        RefreshDelay        = 1000
        Range               = 150.0
        ObjectFilter        = ANY +INFANTRY +CAVALRY
        TargetEnemy         = Yes
        MaxActiveRank       = 5
    End

    Behavior = FireWeaponUpdate ModuleTag_WINDY
        FireWeaponNugget
            WeaponName = EonweElentriStarlightWeapon
            FireDelay  = 0
            OneShot    = No
        End
    End

    Geometry               = CYLINDER
    GeometryMajorRadius    = 1.0
    GeometryMinorRadius    = 1.0
    GeometryHeight         = 1.0
    GeometryIsSmall        = Yes
    Shadow                 = SHADOW_ADDITIVE_DECAL_DYNAMIC
    ShadowSizeX            = 200
    ShadowSizeY            = 200
    ShadowTexture          = exspotlight
    ShadowOpacityStart     = 0
    ShadowOpacityFadeInTime  = 1000
    ShadowOpacityPeak        = 255
    ShadowOpacityFadeOutTime = 1000
    ShadowOpacityEnd         = 0
    ShadowOverrideLODVisibility = Yes
End


Object AzaghalBaneofGlaurungSelfDamage
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 10
        FX                  = FINAL FX_BaneofGlaurung
        Weapon              = FINAL AzaghalBaneofGlaurungRadiusWeapon
    End
End


Object MenegrothEliteSpionageObject
    Side                  = Neutral
    IsTrainable           = No
    EditorSorting         = UNIT
    ThreatLevel           = 0.0

    KindOf                = UNATTACKABLE INERT_SHROUD_REVEALER NOT_AUTOACQUIRABLE INERT IGNORED_IN_GUI

    VisionRange         = 100
    ShroudClearingRange = 100

    Body = HighlanderBody ModuleTag_Body
        MaxHealth = 1.0
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter = ALL -STRUCTURE ENEMIES
    End

    Behavior = DeletionUpdate ModuleTag_Delete
        MinLifetime = 60000
        MaxLifetime = 60000
    End
	
    Behavior = AttributeModifierAuraUpdate ModuleTag_FearMe
        StartsActive        = Yes
        BonusName           = MenegrothEliteSpyBonus
        RefreshDelay        = 1000
        Range               = 1.0
        ObjectFilter        = NONE +HERO ENEMIES
        TargetEnemy         = Yes
    End	
End


Object TaniquetilWhiteArrowProjectile


    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = EXGold_AROW
            ParticleSysBone = MESH01 HaldirWhiteArrowTrail Followbone:Yes
        End
    End
    Draw = W3DStreakDraw ModuleTag_Draw2
        Length         = 100
        Width          = 2
        NumSegments    = 6
        Color          = R:180 G:180 B:180
        Texture        = EXLightStreaks2.tga
    End




    EditorSorting     = SYSTEM
    ArmorSet
        Armor = NoArmor
    End
    VisionRange = 0.0


    KindOf = PROJECTILE NO_COLLIDE
    Body = ActiveBody ModuleTag_02
        MaxHealth       = 10.0
    End

    Behavior = DestroyDie ModuleTag_03

    End

    Behavior = BezierProjectileBehavior ModuleTag_04
        DetonateCallsKill = Yes
        FirstHeight = 36
        SecondHeight = 36
        FirstPercentIndent = 20%
        SecondPercentIndent = 90%
        FlightPathAdjustDistPerSecond = 50
        CurveFlattenMinDist = 50.0
    End

    Behavior = FXListDie ModuleTag_07
        DeathTypes = ALL -CRUSHED -SPLATTED
        DeathFX = FX_WhiteArrowDeath
    End

    Geometry = Sphere
    GeometryIsSmall = Yes
    GeometryMajorRadius = 0.8
End


Object TaniquetilBurnDecreasePing
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 0
        FX                  = INITIAL FX_TaniquetilFireExtinguisher
        Weapon              = FINAL TaniquetilFireExtinguisher
    End
End


Object ThangorodrimFire

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
            Model = None
        End
     End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseOneWeapon
            FireDelay = 800
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseTwoWeapon
            FireDelay = 1200
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseThreeWeapon
            FireDelay = 1800
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseFinalWeapon
            FireDelay = 3400
            OneShot = Yes
        End
    End

    Geometry            = BOX
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object AntiLifeEquation

     Draw = W3DScriptedModelDraw ModuleTag_01
        DefaultModelConditionState
            Model = None
        End
     End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT
    ForceLuaRegistration = Yes


    Body = ImmortalBody ModuleTag_02
        MaxHealth = 1
        InitialHealth = 1
    End

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName = ThangorodrimFirePhaseInitialWeapon
            FireDelay = 0
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AntiLifePhaseOneWeapon
            FireDelay = 800
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AntiLifePhaseTwoWeapon
            FireDelay = 1200
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AntiLifePhaseThreeWeapon
            FireDelay = 1200
            OneShot = Yes
        End
        FireWeaponNugget
            WeaponName = AntiLifePhaseFinalWeapon
            FireDelay = 1200
            OneShot = Yes
        End
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 10.0
    GeometryMinorRadius = 1.0
    GeometryHeight      = 3.0
    GeometryIsSmall     = No
    Shadow              = NONE
End


Object ThangorodrimFirePiece
     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model = Earthquake02
            Texture  =  earthquakedirt.tga exthangorodrimfire.tga
        End

        IdleAnimationState
            Animation
                AnimationName = Earthquake02.Earthquake02
                AnimationMode = ONCE
            End
        End
    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End
End


Object ThangorodrimFireSmoke1

    SelectPortrait = BPGCamp_Plot

    Draw = W3DScriptedModelDraw ModuleTag_Draw

        DefaultModelConditionState
            Model               = NONE
            ParticleSysBone = None VolcanoSmoke

            Shadow =  SHADOW_ALPHA_DECAL_DYNAMIC
            ShadowSizeX = 200
            ShadowSizeY = 200
            ShadowTexture = EXTaint
            ShadowOpacityStart = 0
            ShadowOpacityFadeInTime = 1000
            ShadowOpacityPeak = 175
            ShadowOpacityFadeOutTime = 1000
            ShadowOpacityEnd = 0
            ShadowOverrideLODVisibility = Yes
        End
    End


    EditorSorting        = MISC_MAN_MADE
    Side                = Elves
    ShroudClearingRange    = SHROUD_CLEAR_SKULL_TOTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    RadarPriority        = UNIT

    Body            = ActiveBody ModuleTag_Body
        MaxHealth    = SKULL_TOTEM_HEALTH
    End

    Behavior = DestroyDie ModuleTagDeath_Die
        DeathTypes = ALL
    End

        Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 20000
        MaxLifetime        = 20000
        DeathType        = FADED
    End

    Geometry                = CYLINDER
      GeometryMajorRadius        = 5.0
    GeometryHeight            = 20.0
    GeometryIsSmall            = No
    BuildCompletion            = PLACED_BY_PLAYER
    GeometryContactPoint = X:0.0    Y:0.0        Z:0
    GeometryContactPoint = X:0.0    Y:0.0        Z:20.0        Swoop

End


Object ThangorodrimFireSmoke2

    SelectPortrait = BPGCamp_Plot

    Draw = W3DScriptedModelDraw ModuleTag_Draw

        DefaultModelConditionState
            Model               = NONE
            ParticleSysBone = None MordorSmoke

            Shadow =  SHADOW_ALPHA_DECAL_DYNAMIC
            ShadowSizeX = 200
            ShadowSizeY = 200
            ShadowTexture = EXTaint
            ShadowOpacityStart = 0
            ShadowOpacityFadeInTime = 1000
            ShadowOpacityPeak = 175
            ShadowOpacityFadeOutTime = 1000
            ShadowOpacityEnd = 0
            ShadowOverrideLODVisibility = Yes
        End
    End


    EditorSorting        = MISC_MAN_MADE
    Side                = Elves
    ShroudClearingRange    = SHROUD_CLEAR_SKULL_TOTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    RadarPriority        = UNIT

    Body            = ActiveBody ModuleTag_Body
        MaxHealth    = SKULL_TOTEM_HEALTH
    End

    Behavior = DestroyDie ModuleTagDeath_Die
        DeathTypes = ALL
    End

        Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 20000
        MaxLifetime        = 20000
        DeathType        = FADED
    End

    Geometry            = CYLINDER
      GeometryMajorRadius        = 5.0
    GeometryHeight            = 20.0
    GeometryIsSmall            = No
    BuildCompletion            = PLACED_BY_PLAYER
    GeometryContactPoint = X:0.0    Y:0.0        Z:0
    GeometryContactPoint = X:0.0    Y:0.0        Z:20.0        Swoop

End


Object ThangorodrimFireLavaObject

    SelectPortrait = BPGCamp_Plot

    Draw = W3DScriptedModelDraw ModuleTag_Draw

        DefaultModelConditionState
            Model               = NONE
                    ParticleSysBone = None LavaSmoke
                    ParticleSysBone = None LavaSmokeGlow
                        ParticleSysBone = None LavaExplosion
                        ParticleSysBone = None LavaBurst02
                        ParticleSysBone = None LavaBurst
                        ParticleSysBone = None LavaFountain01
                        ParticleSysBone = None LavaFountain02
                        ParticleSysBone = None LavaSmoke
                        ParticleSysBone = None LavaSmokeGlow
                        ParticleSysBone = None LavaSteam

            Shadow =  SHADOW_ALPHA_DECAL_DYNAMIC
            ShadowSizeX = 200
            ShadowSizeY = 200
            ShadowTexture = EXTaint
            ShadowOpacityStart = 0
            ShadowOpacityFadeInTime = 1000
            ShadowOpacityPeak = 175
            ShadowOpacityFadeOutTime = 1000
            ShadowOpacityEnd = 0
            ShadowOverrideLODVisibility = Yes
        End
    End


    EditorSorting        = MISC_MAN_MADE
    Side                = Elves
    ShroudClearingRange    = SHROUD_CLEAR_SKULL_TOTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    RadarPriority        = UNIT

    Body            = ActiveBody ModuleTag_Body
        MaxHealth    = SKULL_TOTEM_HEALTH
    End

    Behavior = DestroyDie ModuleTagDeath_Die
        DeathTypes = ALL
    End

        Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 20000
        MaxLifetime        = 20000
        DeathType        = FADED
    End

    Behavior = FireWeaponUpdate ModuleTag_SpawnWeapon
        FireWeaponNugget
            WeaponName = ThangorodrimFireLavaWeapon
            OneShot = Yes
        End
    End

    Geometry            = CYLINDER
      GeometryMajorRadius        = 5.0
    GeometryHeight            = 20.0
    GeometryIsSmall            = No
    BuildCompletion            = PLACED_BY_PLAYER
    GeometryContactPoint = X:0.0    Y:0.0        Z:0
    GeometryContactPoint = X:0.0    Y:0.0        Z:20.0        Swoop

End


Object ThangorodrimFireRock
     Draw = W3DScriptedModelDraw ModuleTag_01

        DefaultModelConditionState
            Model = CINEMorRock02
                        Texture  =  earthquakedirt.tga exthangorodrimfire.tga
        End

        IdleAnimationState
            Animation
                AnimationName = Earthquake02.Earthquake02
                AnimationMode = ONCE
            End
        End
    End

    EditorSorting   = SYSTEM
    KindOf = NO_COLLIDE IMMOBILE UNATTACKABLE INERT

    Behavior = DeletionUpdate ModuleTag_03
        MinLifetime = 10000
        MaxLifetime = 10000
    End
End






Object TarMaironLightningProjectile

 Draw = W3DScriptedModelDraw ModuleTag_Draw
  DefaultModelConditionState
      Model = None
  End
End


  EditorSorting     = SYSTEM

  ArmorSet
    Armor = NoArmor
  End

  VisionRange = 0.0


  KindOf = PROJECTILE NO_COLLIDE HIDE_IF_FOGGED
  Body = ActiveBody ModuleTag_02
    MaxHealth       = 100.0
  End

  Behavior = DestroyDie ModuleTag_03

  End

 Behavior = BezierProjectileBehavior ModuleTag_04
    FirstHeight = 9
    SecondHeight = 9
    FirstPercentIndent = 20%
    SecondPercentIndent = 90%
    FlightPathAdjustDistPerSecond = 50
    GroundHitFX = FX_TarMaironLightningCharge
    CurveFlattenMinDist = 100.0
  End

 Behavior = FXListDie ModuleTag_07
   DeathTypes = ALL
   DeathFX = FX_GandalfLightningSword
 End

  Geometry = Sphere
  GeometryIsSmall = Yes
  GeometryMajorRadius = 0.8
End






Object AncalagonDieCrusher
    Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
        Model = None
    End
    End

    Side = Mordor
    EditorSorting = UNIT
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
    MaxHealth = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
    MinLifetime = 1.0
    MaxLifetime = 1.0
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_FireWeapon
     StartsActive    = Yes
     DelayTime        = 0
    DeathWeapon    = AncalagonDeathCrush
    End

    Behavior = SlowDeathBehavior ModuleTag_Die
    End
End






Object MiniDragonEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth         = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime       = 0.0
        MaxLifetime       = 0.0
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay  = 2000
        OCL               = FINAL OCL_SpawnMiniDragon
    End
End

Object MiniDragonEggGlaurung
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth         = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime       = 0.0
        MaxLifetime       = 0.0
    End

    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay  = 2000
        OCL               = FINAL OCL_SpawnMiniDragonGlaurung
    End
End






Object CarcharothDeath

    SelectPortrait = BPGCamp_Plot

    Draw = W3DScriptedModelDraw ModuleTag_Draw

    DefaultModelConditionState
    Model               = ancarchtomb
    ParticleSysBone = None TaintHCPing HouseColor:Yes
    ParticleSysBone = None GoblinKingTaint
    End
    End


    DisplayName            = OBJECT:Tomb
    EditorSorting        = MISC_MAN_MADE
    Side            = Mordor
    ShroudClearingRange        = SHROUD_CLEAR_SKULL_TOTEM
    KindOf            = STRUCTURE IMMOBILE SELECTABLE UNATTACKABLE
    RadarPriority        = UNIT

    Body  = ActiveBody ModuleTag_Body
    MaxHealth    = SKULL_TOTEM_HEALTH
    End

    Behavior = DestroyDie ModuleTagDeath_Die
    DeathTypes = ALL
    End

    Behavior = StealthDetectorUpdate ModuleTag_DetectStealth
    DetectionRate    = SKULL_TOTEM_STEALTH_DETECT_RATE
    DetectionRange    = SKULL_TOTEM_STEALTH_DETECT_RADIUS
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime      = 120000
        MaxLifetime      = 120000
        DeathType        = FADED
    End

    Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
    StartsActive    = Yes
    BonusName    = GenericHeroLeadership
    RefreshDelay    = 2000
    Range        = 200
    AntiCategory    = BUFF
    ObjectFilter    = GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
    End
End






Object ThuringwethilPrincessofShadowsPing

    EvaEnemyObjectSightedEvent = None


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 40000
        MaxLifetime        = 40000
    End

    Behavior = AttachUpdate ModuleTag_Attach
        ObjectFilter            = ANY +TolinGaurhothThuringwethil +TolinGaurhothThuringwethil_AI -SHIP -CAVALRY -MONSTER -MACHINE -WORKING_PASSENGER -NO_COLLIDE -INERT -IGNORED_IN_GUI -PROJECTILE -NEUTRALGOLLUM -NOT_AUTOACQUIRABLE -WildSpiderling_Slaved -IsengardExplosiveMine -Wyrm -WargSentry NOT_FLYING_UNITS ALLIES
        ScanRange               = 999999999999999999999999999999999999999
        AlwaysTeleport          = Yes
        AnchorToTopOfGeometry   = Yes
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = ThuringwethilPrincessofShadowsWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler2
        FireWeaponNugget
            WeaponName   = ThuringwethilPrincessofShadowsWeapon2
            FireDelay    = 0
            OneShot      = No
        End
    End
End


Object PrincessofShadowsFearRadiator



    EditorSorting     = SYSTEM

    ArmorSet
        Armor = NoArmor
    End

    VisionRange = 0.0


    KindOf = IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_TheActiveBody
        MaxHealth = 99999.0
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 3000.0
        MaxLifetime = 3000.0
    End

    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius                  = 150
        EmotionPulseInterval                = 1000
        GenerateUncontrollableFear          = Yes
        InitiallyActive                     = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +MONSTER -SHIP -STRUCTURE -HERO -DOZER ENEMIES
    End
End






Object UnderworldWizarDarknessRuinEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End

    KindOf    = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth    = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay    = 10
        OCL                 = FINAL OCL_UnderworldWizarDarknessRuin
    End
End


Object UnderworldWizarDarknessRuinPing

    EvaEnemyObjectSightedEvent = None


    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model                  = NONE
            ParticleSysBone        = None UnderworldWizarShadowBox
            ParticleSysBone        = NONE UnderworldWizarShockSmall1
            ParticleSysBone        = NONE UnderworldWizarShockSmall2
            ParticleSysBone        = NONE UnderworldWizarShock1 FollowBone:No
            ParticleSysBone        = NONE UnderworldWizarShock2 FollowBone:No
        End
    End


    VisionRange     = 0.0
    EditorSorting   = SYSTEM
    KindOf          = NO_COLLIDE IMMOBILE UNATTACKABLE IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION MOVE_ONLY INERT SCARY
    ThreatLevel     = 0


    Body = ActiveBody ModuleTag_01
        MaxHealth        = 999999
        InitialHealth    = 999999
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 630000
        MaxLifetime        = 630000
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler
        FireWeaponNugget
            WeaponName   = UnderworldWizarDarknessRuinDebuffWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End

    Behavior = FireWeaponUpdate ModuleTag_DamageHandler2
        FireWeaponNugget
            WeaponName   = UnderworldWizarDarknessRuinShockWeapon
            FireDelay    = 5000
            OneShot      = No
        End
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 200.0
    GeometryMinorRadius = 200.0
    GeometryHeight        = 100.0
    GeometryIsSmall        = No
End


Object UnderworldWizarPitofDarkness


    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = EXWhirl02
        End
    End

    Draw = W3DScriptedModelDraw ModuleTag_DrawRipples
        DefaultModelConditionState
            Model = exoceanripples
        End
    End

    Draw = W3DTornadoDraw ModuleTag_TornadoDraw
        DecalTemplate
              Texture        = EXTornadoGround
            Style          = SHADOW_ALPHA_DECAL
            OpacityMin     = 5%
            OpacityMax     = 20%
            MaxRadius       = 300.0
            Color          = R:200 G:200 B:200 A:255
            OnlyVisibleToOwningPlayer = No
            RotationsPerMinute = 0.4
            SpiralAcceleration = 1.0
        End
        DecalCount        = 7
        DecalMaxRadius    = 300.0
    End


    Side                = Angmar
    EditorSorting       = UNIT
    ThreatLevel         = 0.0
    CommandPoints       = 0
    ShockwaveResistance = SHOCKWAVE_RESISTANCE_IMMUNE

    ShroudClearingRange        = GOOD_FIRE_SHIP_WHIRLPOOL_RADIUS

    CommandSet        = EmptyCommandSet



    SoundAmbient             = ShipWhirlpoolAttack

    EvaEnemyObjectSightedEvent = None



    RadarPriority = UNIT
    KindOf = NO_COLLIDE UNATTACKABLE MOVE_ONLY CLICK_THROUGH IGNORE_FOR_VICTORY IGNORE_FOR_EVA_SPEECH_POSITION NOT_AUTOACQUIRABLE IGNORES_SELECT_ALL

    Body = ActiveBody ModuleTag_Body
        MaxHealth         = 200000
    End

    Behavior = AIUpdateInterface ModuleTag_AIUpdateInterface
    End

    Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
    End

    LocomotorSet
        Locomotor = WhirlpoolLocomotor
        Condition = SET_NORMAL
        Speed     = 0
    End

    Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
        MinLifetime        = 10000
        MaxLifetime        = 10000
    End

    Behavior = FireWeaponUpdate ModuleTag_Whirly
        FireWeaponNugget
            WeaponName   = UnderworldWizarPitofDarknessWeapon
            FireDelay    = 0
            OneShot      = No
        End
    End

    Behavior = SlowDeathBehavior ModuleTag_Death
        DeathTypes = ALL
        DestructionDelay = 5000
        FadeTime = 4000
        FadeDelay = 1000
    End

    Geometry            = CYLINDER
    GeometryMajorRadius = 1.0
    GeometryMinorRadius = 1.0
    GeometryHeight        = 1.0
    GeometryIsSmall        = Yes
End






Object TolinGaurhothFogEffeck

    Side                = Isengard
    EditorSorting       = STRUCTURE



    CampnessValue = 0



    KindOf = STRUCTURE IMMOBILE UNATTACKABLE NOT_AUTOACQUIRABLE BASE_SITE CAN_SEE_THROUGH_STRUCTURE CAN_ATTACK FS_BASE_DEFENSE

    Body = HighlanderBody ModuleTag_02
        MaxHealth      = 50.0
    End

    Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
        FireWeaponNugget
            WeaponName = TolinGaurhothFogEffecktWeapon
            FireDelay = 5000
            OneShot = No
        End
    End

    Behavior = SlavedUpdate ModuleTag_Slave
        DieOnMastersDeath = Yes
    End

    Geometry                = CYLINDER
    GeometryMajorRadius     = 10
    GeometryHeight          = 5
    GeometryIsSmall         = No
End






Object SummonUnderworldPortalEgg
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay       = 5000
        FX                     = INITIAL  FX_SummonUnderworldPortal
        OCL                    = MIDPOINT OCL_SummonUnderworldPortalFinish
        Weapon                 = MIDPOINT SummonUnderworldPortalWeapon
    End
End


Object SummonUnderworldPortalEgg_wotr
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 0.0
        MaxLifetime = 0.0
    End
    Behavior = SlowDeathBehavior ModuleTag_HatchProcess
        DestructionDelay       = 5000
        FX                     = INITIAL  FX_SummonUnderworldPortal
        OCL                    = MIDPOINT OCL_SummonUnderworldPortalFinish_wotr

    End
End


Object SummonUnderworldPortalEggPlaceHolder
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model = None
        End
    End
    KindOf =  IMMOBILE UNATTACKABLE NOT_AUTOACQUIRABLE
    Body = ActiveBody ModuleTag_MakesKillWork
        MaxHealth = 1
    End
    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
        MinLifetime = 9000
        MaxLifetime = 9000
    End
    Geometry            = CYLINDER
    GeometryMajorRadius = 30.0
    GeometryHeight        = 70.0
    GeometryIsSmall        = No
End


ChildObject HaldirBlueArrowDaylight FearRadiator
    Draw = W3DScriptedModelDraw ModuleTag_Draw
        DefaultModelConditionState
            Model               = None
            ParticleSysBone     = None CloudBreakRaysHaldirBlue
        End
    End
    Behavior = LifetimeUpdate ModuleTag_01
        MinLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
        MaxLifetime = SPELL_HALDIR_GOLDENARROW_DAYLIGHT_DURATION_MS
    End
    Behavior = RadiateFearUpdate ModuleTag_GoldenArrowDaylightUpdate
        EmotionPulseRadius                  = 400
        EmotionPulseInterval                = 1000
        GenerateUncontrollableFear          = Yes
        InitiallyActive                     = Yes
        VictimFilter                        = ANY +INFANTRY +CAVALRY +ORC +URUK +MONSTER -HERO -STRUCTURE -DOZER ENEMIES
    End
End

Object LothlorienFortressDieCrusher
    Draw = W3DScriptedModelDraw ModuleTag_Draw
    DefaultModelConditionState
        Model = None
    End
    End

    Side = Mordor
    EditorSorting = UNIT
    KindOf = INERT IMMOBILE UNATTACKABLE

    Body = ActiveBody ModuleTag_MakesKillWork
    MaxHealth = 1
    End

    Behavior = LifetimeUpdate ModuleTag_HatchTrigger
    MinLifetime = 1.0
    MaxLifetime = 1.0
    End

    Behavior = FireWeaponWhenDeadBehavior ModuleTag_FireWeapon
     StartsActive    = Yes
     DelayTime        = 0
    DeathWeapon    = LothlorienFortressDeathCrush
    End

    Behavior = SlowDeathBehavior ModuleTag_Die
    End
End